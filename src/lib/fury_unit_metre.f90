!< FURY definition of metre unit.
module fury_unit_metre
!-----------------------------------------------------------------------------------------------------------------------------------
!< FURY definition of metre unit.
!-----------------------------------------------------------------------------------------------------------------------------------
use fury_unit_abstract
use penf
use stringifor
!-----------------------------------------------------------------------------------------------------------------------------------

!-----------------------------------------------------------------------------------------------------------------------------------
implicit none
private
public    :: unit_metre
!-----------------------------------------------------------------------------------------------------------------------------------

!-----------------------------------------------------------------------------------------------------------------------------------
type, extends(unit_abstract) :: unit_metre
  !< Definition of metre unit.
  contains
    procedure, pass(self) :: initialize    !< Initialize the unit.
    procedure, pass(self) :: is_compatible !< Check if unit is compatible with another.
endtype unit_metre
!-----------------------------------------------------------------------------------------------------------------------------------
contains
  subroutine initialize(self, error)
  !---------------------------------------------------------------------------------------------------------------------------------
  !< Initialize unit definition.
  !<
  !< @todo Load from file.
  !---------------------------------------------------------------------------------------------------------------------------------
  class(unit_metre), intent(inout)         :: self   !< The unit.
  integer(I_P),      intent(out), optional :: error  !< Initializing error code, 0 => no errors happen.
  integer(I_P)                             :: error_ !< Initializing error code, 0 => no errors happen, local variable.
  !---------------------------------------------------------------------------------------------------------------------------------

  !---------------------------------------------------------------------------------------------------------------------------------
  error_ = 1
  self%scale_factor = 1._R_P
  self%symbol = 'm,metre,metres,meter,meters'
  error_ = 0
  if (present(error)) error = error_
  !---------------------------------------------------------------------------------------------------------------------------------
  endsubroutine initialize

  elemental function is_compatible(self, unit) result(compatible)
  !---------------------------------------------------------------------------------------------------------------------------------
  !< Check if unit is compatible with another.
  !---------------------------------------------------------------------------------------------------------------------------------
  class(unit_metre),    intent(in) :: self       !< The unit.
  class(unit_abstract), intent(in) :: unit       !< The other unit.
  logical                          :: compatible !< Compatibility check result.
  !---------------------------------------------------------------------------------------------------------------------------------

  !---------------------------------------------------------------------------------------------------------------------------------
  select type(unit)
  class is(unit_metre)
    compatible = .true.
  class default
    compatible = .false.
  endselect
  !---------------------------------------------------------------------------------------------------------------------------------
  endfunction is_compatible
endmodule fury_unit_metre
