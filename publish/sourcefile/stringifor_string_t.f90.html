<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="Fortran Units (environment) for Reliable phYsical math">
    
    <meta name="author" content="Stefano Zaghi" >
    <link rel="icon" href="../favicon.png">

    <title>stringifor_string_t.F90 &ndash; FURY</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FURY </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">
              
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
				
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>stringifor_string_t.F90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 9.2% of total for source files.">1872 statements</a>
     </li> 
     
     
    <li><i class="fa fa-code"></i><a href="../src/stringifor_string_t.F90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li class="active">stringifor_string_t.F90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/stringifor_string_t.html">stringifor_string_t</a>
      
    </div>
  </div>
</div>















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/stringifor_string_t.f90.html#src">stringifor_string_t.F90</a>
  </div>
</div>


  <hr>
  

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../sourcefile/assignments.f90.html">assignments.f90</a>
      
      <a class="list-group-item" href="../sourcefile/basename_dir.f90.html">basename_dir.f90</a>
      
      <a class="list-group-item" href="../sourcefile/befor64.f90.html">befor64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/befor64.f90%7E2.html">befor64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/befor64_pack_data_m.f90.html">befor64_pack_data_m.F90</a>
      
      <a class="list-group-item" href="../sourcefile/befor64_pack_data_m.f90%7E2.html">befor64_pack_data_m.F90</a>
      
      <a class="list-group-item" href="../sourcefile/camelcase.f90.html">camelcase.f90</a>
      
      <a class="list-group-item" href="../sourcefile/capitalize.f90.html">capitalize.f90</a>
      
      <a class="list-group-item" href="../sourcefile/compact_real.f90.html">compact_real.f90</a>
      
      <a class="list-group-item" href="../sourcefile/compact_real.f90%7E2.html">compact_real.f90</a>
      
      <a class="list-group-item" href="../sourcefile/compact_real.f90%7E3.html">compact_real.f90</a>
      
      <a class="list-group-item" href="../sourcefile/concatenation.f90.html">concatenation.f90</a>
      
      <a class="list-group-item" href="../sourcefile/csv_naive_parser.f90.html">csv_naive_parser.f90</a>
      
      <a class="list-group-item" href="../sourcefile/decode.f90.html">decode.f90</a>
      
      <a class="list-group-item" href="../sourcefile/encode.f90.html">encode.f90</a>
      
      <a class="list-group-item" href="../sourcefile/equal.f90.html">equal.f90</a>
      
      <a class="list-group-item" href="../sourcefile/escape.f90.html">escape.f90</a>
      
      <a class="list-group-item" href="../sourcefile/extension.f90.html">extension.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fill.f90.html">fill.f90</a>
      
      <a class="list-group-item" href="../sourcefile/free.f90.html">free.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury.f90.html">fury.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_mixed_kinds.f90.html">fury_mixed_kinds.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_qreal128.f90.html">fury_qreal128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_qreal32.f90.html">fury_qreal32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_qreal64.f90.html">fury_qreal64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_abstract128.f90.html">fury_system_abstract128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_abstract32.f90.html">fury_system_abstract32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_abstract64.f90.html">fury_system_abstract64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_si128.f90.html">fury_system_si128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_si32.f90.html">fury_system_si32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_si64.f90.html">fury_system_si64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_bolt32.f90.html">fury_test_bolt32.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_bolt64.f90.html">fury_test_bolt64.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add.f90.html">fury_test_qreal_add.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add_aliases_failure.f90.html">fury_test_qreal_add_aliases_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add_failure.f90.html">fury_test_qreal_add_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add_mixed.f90.html">fury_test_qreal_add_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add_mixed_failure.f90.html">fury_test_qreal_add_mixed_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_aliases.f90.html">fury_test_qreal_aliases.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_assign.f90.html">fury_test_qreal_assign.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_conversions_complex.f90.html">fury_test_qreal_conversions_complex.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_conversions_si.f90.html">fury_test_qreal_conversions_si.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_conversions_simple.f90.html">fury_test_qreal_conversions_simple.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_div.f90.html">fury_test_qreal_div.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_div_mixed.f90.html">fury_test_qreal_div_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_eq.f90.html">fury_test_qreal_eq.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_eq_mixed.f90.html">fury_test_qreal_eq_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_mul.f90.html">fury_test_qreal_mul.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_mul_mixed.f90.html">fury_test_qreal_mul_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_not_eq.f90.html">fury_test_qreal_not_eq.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_not_eq_mixed.f90.html">fury_test_qreal_not_eq_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_pow.f90.html">fury_test_qreal_pow.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_sub.f90.html">fury_test_qreal_sub.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_sub_failure.f90.html">fury_test_qreal_sub_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_sub_mixed.f90.html">fury_test_qreal_sub_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_sub_mixed_failure.f90.html">fury_test_qreal_sub_mixed_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_system_si.f90.html">fury_test_system_si.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_add.f90.html">fury_test_uom_add.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_add_failure.f90.html">fury_test_uom_add_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_aliases.f90.html">fury_test_uom_aliases.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_assign.f90.html">fury_test_uom_assign.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_assign_failure.f90.html">fury_test_uom_assign_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_div.f90.html">fury_test_uom_div.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_mul.f90.html">fury_test_uom_mul.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_parse_failure.f90.html">fury_test_uom_parse_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_pow.f90.html">fury_test_uom_pow.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_sub.f90.html">fury_test_uom_sub.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_sub_failure.f90.html">fury_test_uom_sub_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom128.f90.html">fury_uom128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom32.f90.html">fury_uom32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom64.f90.html">fury_uom64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_converter.f90.html">fury_uom_converter.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_reference128.f90.html">fury_uom_reference128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_reference32.f90.html">fury_uom_reference32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_reference64.f90.html">fury_uom_reference64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_symbol128.f90.html">fury_uom_symbol128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_symbol32.f90.html">fury_uom_symbol32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_symbol64.f90.html">fury_uom_symbol64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/greater_equal_than.f90.html">greater_equal_than.f90</a>
      
      <a class="list-group-item" href="../sourcefile/greater_than.f90.html">greater_than.f90</a>
      
      <a class="list-group-item" href="../sourcefile/insert.f90.html">insert.f90</a>
      
      <a class="list-group-item" href="../sourcefile/io_basic.f90.html">io_basic.F90</a>
      
      <a class="list-group-item" href="../sourcefile/io_listdirected.f90.html">io_listdirected.F90</a>
      
      <a class="list-group-item" href="../sourcefile/is_digit.f90.html">is_digit.f90</a>
      
      <a class="list-group-item" href="../sourcefile/is_integer.f90.html">is_integer.f90</a>
      
      <a class="list-group-item" href="../sourcefile/is_number.f90.html">is_number.f90</a>
      
      <a class="list-group-item" href="../sourcefile/is_real.f90.html">is_real.f90</a>
      
      <a class="list-group-item" href="../sourcefile/join.f90.html">join.f90</a>
      
      <a class="list-group-item" href="../sourcefile/lower_equal_than.f90.html">lower_equal_than.f90</a>
      
      <a class="list-group-item" href="../sourcefile/lower_than.f90.html">lower_than.f90</a>
      
      <a class="list-group-item" href="../sourcefile/not_equal.f90.html">not_equal.f90</a>
      
      <a class="list-group-item" href="../sourcefile/partition.f90.html">partition.f90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90%7E2.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90%7E3.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90%7E4.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90%7E5.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf_b_size.f90.html">penf_b_size.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf_global_parameters_variables.f90.html">penf_global_parameters_variables.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf_stringify.f90.html">penf_stringify.F90</a>
      
      <a class="list-group-item" href="../sourcefile/read_file.f90.html">read_file.f90</a>
      
      <a class="list-group-item" href="../sourcefile/read_line.f90.html">read_line.f90</a>
      
      <a class="list-group-item" href="../sourcefile/read_lines.f90.html">read_lines.f90</a>
      
      <a class="list-group-item" href="../sourcefile/replace.f90.html">replace.f90</a>
      
      <a class="list-group-item" href="../sourcefile/reverse.f90.html">reverse.f90</a>
      
      <a class="list-group-item" href="../sourcefile/sadjustlr.f90.html">sadjustlr.f90</a>
      
      <a class="list-group-item" href="../sourcefile/scount.f90.html">scount.f90</a>
      
      <a class="list-group-item" href="../sourcefile/search.f90.html">search.f90</a>
      
      <a class="list-group-item" href="../sourcefile/sindex.f90.html">sindex.f90</a>
      
      <a class="list-group-item" href="../sourcefile/slen.f90.html">slen.f90</a>
      
      <a class="list-group-item" href="../sourcefile/slice.f90.html">slice.f90</a>
      
      <a class="list-group-item" href="../sourcefile/snakecase.f90.html">snakecase.f90</a>
      
      <a class="list-group-item" href="../sourcefile/split.f90.html">split.f90</a>
      
      <a class="list-group-item" href="../sourcefile/srepeat.f90.html">srepeat.f90</a>
      
      <a class="list-group-item" href="../sourcefile/sscan.f90.html">sscan.f90</a>
      
      <a class="list-group-item" href="../sourcefile/start_end.f90.html">start_end.f90</a>
      
      <a class="list-group-item" href="../sourcefile/startcase.f90.html">startcase.f90</a>
      
      <a class="list-group-item" href="../sourcefile/strim.f90.html">strim.f90</a>
      
      <a class="list-group-item" href="../sourcefile/stringifor.f90.html">stringifor.F90</a>
      
      <a class="list-group-item" href="../sourcefile/stringifor_string_t.f90.html">stringifor_string_t.F90</a>
      
      <a class="list-group-item" href="../sourcefile/strip.f90.html">strip.f90</a>
      
      <a class="list-group-item" href="../sourcefile/sverify.f90.html">sverify.f90</a>
      
      <a class="list-group-item" href="../sourcefile/swapcase.f90.html">swapcase.f90</a>
      
      <a class="list-group-item" href="../sourcefile/test_all.f90.html">test_all.F90</a>
      
      <a class="list-group-item" href="../sourcefile/test_all.f90.html">test_all.f90</a>
      
      <a class="list-group-item" href="../sourcefile/test_all.f90%7E2.html">test_all.f90</a>
      
      <a class="list-group-item" href="../sourcefile/test_driver.f90.html">Test_Driver.f90</a>
      
      <a class="list-group-item" href="../sourcefile/to_number.f90.html">to_number.f90</a>
      
      <a class="list-group-item" href="../sourcefile/unescape.f90.html">unescape.f90</a>
      
      <a class="list-group-item" href="../sourcefile/unique.f90.html">unique.f90</a>
      
      <a class="list-group-item" href="../sourcefile/upper_lower.f90.html">upper_lower.f90</a>
      
      <a class="list-group-item" href="../sourcefile/write_file.f90.html">write_file.f90</a>
      
      <a class="list-group-item" href="../sourcefile/write_lines.f90.html">write_lines.f90</a>
      
    </div>
  </div>
</div>


</div>  

    </div>
    <div class="col-md-9" id='text'>
    <p>StringiFor, definition of <code>string</code> type.</p>
    
    <h3>This File Depends On</h3>
    
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: sourcefile~~stringifor_string_t.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilestringifor_string_tf90EfferentGraph" width="641pt" height="48pt"
 viewBox="0.00 0.00 641.00 47.52" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~stringifor_string_t.f90~~EfferentGraph" class="graph" transform="scale(0.639721 0.639721) rotate(0) translate(4 70.2871)">
<title>sourcefile~~stringifor_string_t.f90~~EfferentGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-70.2871 999,-70.2871 999,5 -4,5"/>
<!-- sourcefile~stringifor_string_t.f90 -->
<g id="node1" class="node"><title>sourcefile~stringifor_string_t.f90</title>
<polygon fill="none" stroke="black" points="993,-57.9707 877,-57.9707 877,-31.9707 993,-31.9707 993,-57.9707"/>
<text text-anchor="middle" x="935" y="-42.5207" font-family="Helvetica,sans-Serif" font-size="10.50">stringifor_string_t.F90</text>
</g>
<!-- sourcefile~befor64.f90 -->
<g id="node2" class="node"><title>sourcefile~befor64.f90</title>
<a xlink:href="../sourcefile/befor64.f90.html" xlink:title="befor64.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="839,-37.9707 769,-37.9707 769,-11.9707 839,-11.9707 839,-37.9707"/>
<text text-anchor="middle" x="804" y="-22.5207" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">befor64.F90</text>
</a>
</g>
<!-- sourcefile~befor64.f90&#45;&gt;sourcefile~stringifor_string_t.f90 -->
<g id="edge20" class="edge"><title>sourcefile~befor64.f90&#45;&gt;sourcefile~stringifor_string_t.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M839.796,-30.4358C848.086,-31.7013 857.18,-33.0898 866.357,-34.4909"/>
<polygon fill="#000000" stroke="#000000" points="865.9,-37.9615 876.313,-36.0109 866.956,-31.0417 865.9,-37.9615"/>
</g>
<!-- sourcefile~penf.f90 -->
<g id="node3" class="node"><title>sourcefile~penf.f90</title>
<a xlink:href="../sourcefile/penf.f90.html" xlink:title="penf.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="553,-57.9707 499,-57.9707 499,-31.9707 553,-31.9707 553,-57.9707"/>
<text text-anchor="middle" x="526" y="-42.5207" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">penf.F90</text>
</a>
</g>
<!-- sourcefile~penf.f90&#45;&gt;sourcefile~stringifor_string_t.f90 -->
<g id="edge22" class="edge"><title>sourcefile~penf.f90&#45;&gt;sourcefile~stringifor_string_t.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M661,-65.9707C731.064,-66.3887 810.913,-59.4161 866.263,-53.3948"/>
<polygon fill="#000000" stroke="#000000" points="866.751,-56.8623 876.305,-52.2836 865.981,-49.9048 866.751,-56.8623"/>
</g>
<!-- sourcefile~penf.f90&#45;&gt;sourcefile~befor64.f90 -->
<g id="edge4" class="edge"><title>sourcefile~penf.f90&#45;&gt;sourcefile~befor64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.728,-51.7486C580.883,-57.8002 623.524,-65.7471 661,-65.9707"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M661,-65.9707C697.964,-66.1912 738.294,-53.3497 766.672,-41.9827"/>
<polygon fill="#000000" stroke="#000000" points="768.284,-45.1039 776.187,-38.0474 765.608,-38.6354 768.284,-45.1039"/>
</g>
<!-- sourcefile~befor64_pack_data_m.f90 -->
<g id="node4" class="node"><title>sourcefile~befor64_pack_data_m.f90</title>
<a xlink:href="../sourcefile/befor64_pack_data_m.f90.html" xlink:title="befor64_pack_data_m.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="732,-37.9707 590,-37.9707 590,-11.9707 732,-11.9707 732,-37.9707"/>
<text text-anchor="middle" x="661" y="-22.5207" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">befor64_pack_data_m.F90</text>
</a>
</g>
<!-- sourcefile~penf.f90&#45;&gt;sourcefile~befor64_pack_data_m.f90 -->
<g id="edge2" class="edge"><title>sourcefile~penf.f90&#45;&gt;sourcefile~befor64_pack_data_m.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.645,-40.8751C561.546,-39.7046 570.582,-38.366 579.982,-36.9733"/>
<polygon fill="#000000" stroke="#000000" points="580.5,-40.435 589.879,-35.5072 579.474,-33.5106 580.5,-40.435"/>
</g>
<!-- sourcefile~befor64_pack_data_m.f90&#45;&gt;sourcefile~befor64.f90 -->
<g id="edge6" class="edge"><title>sourcefile~befor64_pack_data_m.f90&#45;&gt;sourcefile~befor64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M732.081,-24.9707C740.953,-24.9707 749.833,-24.9707 758.175,-24.9707"/>
<polygon fill="#000000" stroke="#000000" points="758.413,-28.4708 768.413,-24.9707 758.413,-21.4708 758.413,-28.4708"/>
</g>
<!-- sourcefile~penf_b_size.f90 -->
<g id="node8" class="node"><title>sourcefile~penf_b_size.f90</title>
<a xlink:href="../sourcefile/penf_b_size.f90.html" xlink:title="penf_b_size.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="328,-37.9707 236,-37.9707 236,-11.9707 328,-11.9707 328,-37.9707"/>
<text text-anchor="middle" x="282" y="-22.5207" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">penf_b_size.F90</text>
</a>
</g>
<!-- sourcefile~penf_b_size.f90&#45;&gt;sourcefile~penf.f90 -->
<g id="edge14" class="edge"><title>sourcefile~penf_b_size.f90&#45;&gt;sourcefile~penf.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M307.365,-38.1727C333.234,-50.3628 374.874,-66.5143 413,-65.9707"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M413,-65.9707C438.492,-65.6072 466.685,-60.3758 488.534,-55.2259"/>
<polygon fill="#000000" stroke="#000000" points="489.523,-58.5871 498.401,-52.805 487.855,-51.7887 489.523,-58.5871"/>
</g>
<!-- sourcefile~penf_stringify.f90 -->
<g id="node10" class="node"><title>sourcefile~penf_stringify.f90</title>
<a xlink:href="../sourcefile/penf_stringify.f90.html" xlink:title="penf_stringify.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="462,-37.9707 364,-37.9707 364,-11.9707 462,-11.9707 462,-37.9707"/>
<text text-anchor="middle" x="413" y="-22.5207" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">penf_stringify.F90</text>
</a>
</g>
<!-- sourcefile~penf_b_size.f90&#45;&gt;sourcefile~penf_stringify.f90 -->
<g id="edge10" class="edge"><title>sourcefile~penf_b_size.f90&#45;&gt;sourcefile~penf_stringify.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M328.186,-24.9707C336.355,-24.9707 344.965,-24.9707 353.442,-24.9707"/>
<polygon fill="#000000" stroke="#000000" points="353.676,-28.4708 363.676,-24.9707 353.676,-21.4708 353.676,-28.4708"/>
</g>
<!-- sourcefile~penf_global_parameters_variables.f90 -->
<g id="node9" class="node"><title>sourcefile~penf_global_parameters_variables.f90</title>
<a xlink:href="../sourcefile/penf_global_parameters_variables.f90.html" xlink:title="penf_global_parameters_variables.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="199,-37.9707 1,-37.9707 1,-11.9707 199,-11.9707 199,-37.9707"/>
<text text-anchor="middle" x="100" y="-22.5207" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">penf_global_parameters_variables.F90</text>
</a>
</g>
<!-- sourcefile~penf_global_parameters_variables.f90&#45;&gt;sourcefile~penf.f90 -->
<g id="edge16" class="edge"><title>sourcefile~penf_global_parameters_variables.f90&#45;&gt;sourcefile~penf.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M159.704,-38.0068C222.465,-50.4817 324.226,-67.2365 413,-65.9707"/>
</g>
<!-- sourcefile~penf_global_parameters_variables.f90&#45;&gt;sourcefile~penf_b_size.f90 -->
<g id="edge8" class="edge"><title>sourcefile~penf_global_parameters_variables.f90&#45;&gt;sourcefile~penf_b_size.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M199.52,-24.9707C208.389,-24.9707 217.15,-24.9707 225.46,-24.9707"/>
<polygon fill="#000000" stroke="#000000" points="225.721,-28.4708 235.721,-24.9707 225.721,-21.4708 225.721,-28.4708"/>
</g>
<!-- sourcefile~penf_global_parameters_variables.f90&#45;&gt;sourcefile~penf_stringify.f90 -->
<g id="edge12" class="edge"><title>sourcefile~penf_global_parameters_variables.f90&#45;&gt;sourcefile~penf_stringify.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M159.638,-11.9557C205.702,-3.65823 270.997,4.28664 328,-2.9707 338.883,-4.3562 350.364,-6.70142 361.248,-9.35725"/>
<polygon fill="#000000" stroke="#000000" points="360.485,-12.7748 371.041,-11.865 362.221,-5.99357 360.485,-12.7748"/>
</g>
<!-- sourcefile~penf_stringify.f90&#45;&gt;sourcefile~penf.f90 -->
<g id="edge18" class="edge"><title>sourcefile~penf_stringify.f90&#45;&gt;sourcefile~penf.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M462.235,-33.6848C471.03,-35.2414 480.063,-36.8403 488.464,-38.3272"/>
<polygon fill="#000000" stroke="#000000" points="487.882,-41.7785 498.339,-40.075 489.102,-34.8856 487.882,-41.7785"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilestringifor_string_tf90EfferentGraph = svgPanZoom('#sourcefilestringifor_string_tf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="34pt"
 viewBox="0.00 0.00 188.00 34.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(1 1) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 185,-30 185,5 -4,5"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-26 2.84217e-14,-26 0,-1.24345e-14 66,-3.55271e-15 66,-26"/>
<text text-anchor="middle" x="33" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="180,-26 84,-26 84,-1.24345e-14 180,-3.55271e-15 180,-26"/>
<text text-anchor="middle" x="132" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which depends upon it. A file 
    is dependent upon another if the latter must be compiled before the former
    can be.
    </p>
    
                      </div>
                    </div>
                  </div>
                </div>
                
    
      
      <h3>Files Dependent On This One</h3>
      
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: sourcefile~~stringifor_string_t.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilestringifor_string_tf90AfferentGraph" width="641pt" height="1298pt"
 viewBox="0.00 0.00 641.00 1297.65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~stringifor_string_t.f90~~AfferentGraph" class="graph" transform="scale(0.411954 0.411954) rotate(0) translate(4 3146)">
<title>sourcefile~~stringifor_string_t.f90~~AfferentGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-3146 1553,-3146 1553,5 -4,5"/>
<!-- sourcefile~stringifor_string_t.f90 -->
<g id="node1" class="node"><title>sourcefile~stringifor_string_t.f90</title>
<polygon fill="none" stroke="black" points="117,-1346 1,-1346 1,-1320 117,-1320 117,-1346"/>
<text text-anchor="middle" x="59" y="-1330.55" font-family="Helvetica,sans-Serif" font-size="10.50">stringifor_string_t.F90</text>
</g>
<!-- sourcefile~stringifor.f90 -->
<g id="node2" class="node"><title>sourcefile~stringifor.f90</title>
<a xlink:href="../sourcefile/stringifor.f90.html" xlink:title="stringifor.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="230,-1346 154,-1346 154,-1320 230,-1320 230,-1346"/>
<text text-anchor="middle" x="192" y="-1330.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stringifor.F90</text>
</a>
</g>
<!-- sourcefile~stringifor_string_t.f90&#45;&gt;sourcefile~stringifor.f90 -->
<g id="edge346" class="edge"><title>sourcefile~stringifor_string_t.f90&#45;&gt;sourcefile~stringifor.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M117.723,-1333C126.43,-1333 135.318,-1333 143.777,-1333"/>
<polygon fill="#000000" stroke="#000000" points="143.843,-1336.5 153.843,-1333 143.843,-1329.5 143.843,-1336.5"/>
</g>
<!-- sourcefile~csv_naive_parser.f90 -->
<g id="node3" class="node"><title>sourcefile~csv_naive_parser.f90</title>
<a xlink:href="../sourcefile/csv_naive_parser.f90.html" xlink:title="csv_naive_parser.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="392,-2982 278,-2982 278,-2956 392,-2956 392,-2982"/>
<text text-anchor="middle" x="335" y="-2966.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">csv_naive_parser.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~csv_naive_parser.f90 -->
<g id="edge198" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~csv_naive_parser.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.177,-1346.35C194.227,-1497.34 214.38,-2879.66 266,-2947 267.078,-2948.41 268.246,-2949.72 269.492,-2950.96"/>
<polygon fill="#000000" stroke="#000000" points="267.357,-2953.73 277.379,-2957.17 271.687,-2948.23 267.357,-2953.73"/>
</g>
<!-- sourcefile~swapcase.f90 -->
<g id="node4" class="node"><title>sourcefile~swapcase.f90</title>
<a xlink:href="../sourcefile/swapcase.f90.html" xlink:title="swapcase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="374,-2938 296,-2938 296,-2912 374,-2912 374,-2938"/>
<text text-anchor="middle" x="335" y="-2922.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swapcase.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~swapcase.f90 -->
<g id="edge200" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~swapcase.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.217,-1346.39C194.673,-1494.95 218.072,-2831.22 266,-2898 271.177,-2905.21 278.579,-2910.5 286.629,-2914.37"/>
<polygon fill="#000000" stroke="#000000" points="285.328,-2917.62 295.909,-2918.18 287.982,-2911.15 285.328,-2917.62"/>
</g>
<!-- sourcefile~fury_system_si32.f90 -->
<g id="node5" class="node"><title>sourcefile~fury_system_si32.f90</title>
<a xlink:href="../sourcefile/fury_system_si32.f90.html" xlink:title="fury_system_si32.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1207,-2701 1089,-2701 1089,-2675 1207,-2675 1207,-2701"/>
<text text-anchor="middle" x="1148" y="-2685.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_system_si32.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_si32.f90 -->
<g id="edge202" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_si32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335,-2631C393.082,-2691.57 433.176,-2669.38 515,-2688"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2688C680.225,-2725.59 726.581,-2677.11 896,-2674 964.433,-2672.74 981.728,-2669.15 1050,-2674 1059.35,-2674.66 1069.17,-2675.68 1078.83,-2676.87"/>
<polygon fill="#000000" stroke="#000000" points="1078.44,-2680.35 1088.81,-2678.16 1079.34,-2673.41 1078.44,-2680.35"/>
</g>
<!-- sourcefile~to_number.f90 -->
<g id="node6" class="node"><title>sourcefile~to_number.f90</title>
<a xlink:href="../sourcefile/to_number.f90.html" xlink:title="to_number.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="376,-2270 294,-2270 294,-2244 376,-2244 376,-2270"/>
<text text-anchor="middle" x="335" y="-2254.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_number.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~to_number.f90 -->
<g id="edge204" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~to_number.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.21,-1346.3C194.003,-1452.61 208.104,-2162.22 266,-2235 270.736,-2240.95 277.087,-2245.32 284.025,-2248.52"/>
<polygon fill="#000000" stroke="#000000" points="283.163,-2251.94 293.754,-2252.2 285.638,-2245.39 283.163,-2251.94"/>
</g>
<!-- sourcefile~fury_uom_symbol32.f90 -->
<g id="node7" class="node"><title>sourcefile~fury_uom_symbol32.f90</title>
<a xlink:href="../sourcefile/fury_uom_symbol32.f90.html" xlink:title="fury_uom_symbol32.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="400,-2761 270,-2761 270,-2735 400,-2735 400,-2761"/>
<text text-anchor="middle" x="335" y="-2745.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom_symbol32.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_symbol32.f90 -->
<g id="edge206" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_symbol32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.321,-1346.21C195.525,-1475.65 222.513,-2515.21 266,-2645 276.59,-2676.61 299.621,-2707.67 316.163,-2727.28"/>
<polygon fill="#000000" stroke="#000000" points="313.61,-2729.68 322.801,-2734.95 318.904,-2725.1 313.61,-2729.68"/>
</g>
<!-- sourcefile~equal.f90 -->
<g id="node8" class="node"><title>sourcefile~equal.f90</title>
<a xlink:href="../sourcefile/equal.f90.html" xlink:title="equal.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-2226 307,-2226 307,-2200 363,-2200 363,-2226"/>
<text text-anchor="middle" x="335" y="-2210.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">equal.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~equal.f90 -->
<g id="edge208" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~equal.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.269,-1346.3C194.473,-1449.63 210.881,-2122.01 266,-2191 273.466,-2200.35 284.912,-2205.78 296.348,-2208.93"/>
<polygon fill="#000000" stroke="#000000" points="295.775,-2212.38 306.296,-2211.14 297.295,-2205.55 295.775,-2212.38"/>
</g>
<!-- sourcefile~fury_uom64.f90 -->
<g id="node9" class="node"><title>sourcefile~fury_uom64.f90</title>
<a xlink:href="../sourcefile/fury_uom64.f90.html" xlink:title="fury_uom64.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="720,-2394 630,-2394 630,-2368 720,-2368 720,-2394"/>
<text text-anchor="middle" x="675" y="-2378.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom64.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom64.f90 -->
<g id="edge210" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335,-2416C365.916,-2441.38 475.539,-2422.55 515,-2416"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2416C549.905,-2410.21 588.68,-2401.78 619.315,-2394.64"/>
<polygon fill="#000000" stroke="#000000" points="620.442,-2397.97 629.376,-2392.28 618.84,-2391.16 620.442,-2397.97"/>
</g>
<!-- sourcefile~escape.f90 -->
<g id="node10" class="node"><title>sourcefile~escape.f90</title>
<a xlink:href="../sourcefile/escape.f90.html" xlink:title="escape.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="367,-2182 303,-2182 303,-2156 367,-2156 367,-2182"/>
<text text-anchor="middle" x="335" y="-2166.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">escape.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~escape.f90 -->
<g id="edge212" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~escape.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.333,-1346.25C194.961,-1446.37 213.646,-2081.78 266,-2147 272.68,-2155.32 282.516,-2160.54 292.679,-2163.81"/>
<polygon fill="#000000" stroke="#000000" points="291.871,-2167.21 302.433,-2166.37 293.652,-2160.44 291.871,-2167.21"/>
</g>
<!-- sourcefile~lower_equal_than.f90 -->
<g id="node11" class="node"><title>sourcefile~lower_equal_than.f90</title>
<a xlink:href="../sourcefile/lower_equal_than.f90.html" xlink:title="lower_equal_than.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="392,-2138 278,-2138 278,-2112 392,-2112 392,-2138"/>
<text text-anchor="middle" x="335" y="-2122.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lower_equal_than.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~lower_equal_than.f90 -->
<g id="edge214" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~lower_equal_than.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.402,-1346.14C195.469,-1442.8 216.399,-2041.53 266,-2103 266.987,-2104.22 268.042,-2105.38 269.156,-2106.47"/>
<polygon fill="#000000" stroke="#000000" points="267.235,-2109.41 277.273,-2112.8 271.54,-2103.89 267.235,-2109.41"/>
</g>
<!-- sourcefile~extension.f90 -->
<g id="node12" class="node"><title>sourcefile~extension.f90</title>
<a xlink:href="../sourcefile/extension.f90.html" xlink:title="extension.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="373,-2094 297,-2094 297,-2068 373,-2068 373,-2094"/>
<text text-anchor="middle" x="335" y="-2078.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">extension.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~extension.f90 -->
<g id="edge216" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~extension.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.488,-1346.28C196.045,-1440.14 219.189,-2001.33 266,-2059 271.468,-2065.74 279.001,-2070.44 287.088,-2073.72"/>
<polygon fill="#000000" stroke="#000000" points="286.153,-2077.09 296.747,-2076.94 288.372,-2070.45 286.153,-2077.09"/>
</g>
<!-- sourcefile~start_end.f90 -->
<g id="node13" class="node"><title>sourcefile~start_end.f90</title>
<a xlink:href="../sourcefile/start_end.f90.html" xlink:title="start_end.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="373,-2050 297,-2050 297,-2024 373,-2024 373,-2050"/>
<text text-anchor="middle" x="335" y="-2034.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start_end.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~start_end.f90 -->
<g id="edge218" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~start_end.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.569,-1346.05C196.595,-1435.91 221.914,-1961.05 266,-2015 271.49,-2021.72 279.033,-2026.41 287.123,-2029.69"/>
<polygon fill="#000000" stroke="#000000" points="286.189,-2033.06 296.782,-2032.91 288.407,-2026.43 286.189,-2033.06"/>
</g>
<!-- sourcefile~lower_than.f90 -->
<g id="node14" class="node"><title>sourcefile~lower_than.f90</title>
<a xlink:href="../sourcefile/lower_than.f90.html" xlink:title="lower_than.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="376,-2006 294,-2006 294,-1980 376,-1980 376,-2006"/>
<text text-anchor="middle" x="335" y="-1990.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lower_than.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~lower_than.f90 -->
<g id="edge220" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~lower_than.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.67,-1346.03C197.222,-1432.43 224.671,-1920.8 266,-1971 270.725,-1976.74 276.948,-1981 283.725,-1984.16"/>
<polygon fill="#000000" stroke="#000000" points="282.632,-1987.49 293.221,-1987.82 285.151,-1980.96 282.632,-1987.49"/>
</g>
<!-- sourcefile~fill.f90 -->
<g id="node15" class="node"><title>sourcefile~fill.f90</title>
<a xlink:href="../sourcefile/fill.f90.html" xlink:title="fill.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362,-1962 308,-1962 308,-1936 362,-1936 362,-1962"/>
<text text-anchor="middle" x="335" y="-1946.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fill.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fill.f90 -->
<g id="edge222" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fill.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.797,-1346.19C197.941,-1429.49 227.45,-1880.58 266,-1927 273.97,-1936.6 286.127,-1942.06 298.028,-1945.15"/>
<polygon fill="#000000" stroke="#000000" points="297.36,-1948.59 307.867,-1947.23 298.806,-1941.74 297.36,-1948.59"/>
</g>
<!-- sourcefile~srepeat.f90 -->
<g id="node16" class="node"><title>sourcefile~srepeat.f90</title>
<a xlink:href="../sourcefile/srepeat.f90.html" xlink:title="srepeat.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="368,-1918 302,-1918 302,-1892 368,-1892 368,-1918"/>
<text text-anchor="middle" x="335" y="-1902.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">srepeat.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~srepeat.f90 -->
<g id="edge224" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~srepeat.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.938,-1346.23C198.696,-1425.96 230.205,-1840.32 266,-1883 272.545,-1890.8 281.856,-1895.87 291.527,-1899.15"/>
<polygon fill="#000000" stroke="#000000" points="290.656,-1902.54 301.23,-1901.87 292.547,-1895.8 290.656,-1902.54"/>
</g>
<!-- sourcefile~fury_uom128.f90 -->
<g id="node17" class="node"><title>sourcefile~fury_uom128.f90</title>
<a xlink:href="../sourcefile/fury_uom128.f90.html" xlink:title="fury_uom128.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="723,-2239 627,-2239 627,-2213 723,-2213 723,-2239"/>
<text text-anchor="middle" x="675" y="-2223.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom128.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom128.f90 -->
<g id="edge226" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2220C547.37,-2209.71 585.29,-2210.61 616.087,-2214.37"/>
<polygon fill="#000000" stroke="#000000" points="615.862,-2217.87 626.24,-2215.73 616.798,-2210.93 615.862,-2217.87"/>
</g>
<!-- sourcefile~decode.f90 -->
<g id="node18" class="node"><title>sourcefile~decode.f90</title>
<a xlink:href="../sourcefile/decode.f90.html" xlink:title="decode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="368,-1874 302,-1874 302,-1848 368,-1848 368,-1874"/>
<text text-anchor="middle" x="335" y="-1858.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">decode.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~decode.f90 -->
<g id="edge228" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~decode.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.101,-1346.11C192.912,-1417.76 200.226,-1761.49 266,-1839 272.651,-1846.84 282.09,-1851.91 291.859,-1855.19"/>
<polygon fill="#000000" stroke="#000000" points="291.075,-1858.61 301.646,-1857.91 292.946,-1851.86 291.075,-1858.61"/>
</g>
<!-- sourcefile~fury_uom_reference64.f90 -->
<g id="node19" class="node"><title>sourcefile~fury_uom_reference64.f90</title>
<a xlink:href="../sourcefile/fury_uom_reference64.f90.html" xlink:title="fury_uom_reference64.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="586,-2470 444,-2470 444,-2444 586,-2444 586,-2470"/>
<text text-anchor="middle" x="515" y="-2454.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom_reference64.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_reference64.f90 -->
<g id="edge230" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_reference64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335,-2416C339.365,-2419.58 393.506,-2431.65 441.279,-2441.78"/>
<polygon fill="#000000" stroke="#000000" points="440.849,-2445.26 451.356,-2443.9 442.295,-2438.41 440.849,-2445.26"/>
</g>
<!-- sourcefile~startcase.f90 -->
<g id="node20" class="node"><title>sourcefile~startcase.f90</title>
<a xlink:href="../sourcefile/startcase.f90.html" xlink:title="startcase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="372,-1830 298,-1830 298,-1804 372,-1804 372,-1830"/>
<text text-anchor="middle" x="335" y="-1814.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">startcase.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~startcase.f90 -->
<g id="edge232" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~startcase.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.307,-1346.3C194.141,-1414.55 205.737,-1724.96 266,-1795 271.839,-1801.79 279.768,-1806.5 288.172,-1809.77"/>
<polygon fill="#000000" stroke="#000000" points="287.185,-1813.13 297.777,-1812.88 289.341,-1806.47 287.185,-1813.13"/>
</g>
<!-- sourcefile~sscan.f90 -->
<g id="node21" class="node"><title>sourcefile~sscan.f90</title>
<a xlink:href="../sourcefile/sscan.f90.html" xlink:title="sscan.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="364,-1786 306,-1786 306,-1760 364,-1760 364,-1786"/>
<text text-anchor="middle" x="335" y="-1770.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sscan.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~sscan.f90 -->
<g id="edge234" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~sscan.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.552,-1346.29C195.477,-1410.54 211.17,-1688.32 266,-1751 273.606,-1759.69 284.639,-1764.98 295.661,-1768.19"/>
<polygon fill="#000000" stroke="#000000" points="295.141,-1771.66 305.681,-1770.59 296.769,-1764.85 295.141,-1771.66"/>
</g>
<!-- sourcefile~insert.f90 -->
<g id="node22" class="node"><title>sourcefile~insert.f90</title>
<a xlink:href="../sourcefile/insert.f90.html" xlink:title="insert.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-1742 307,-1742 307,-1716 363,-1716 363,-1742"/>
<text text-anchor="middle" x="335" y="-1726.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">insert.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~insert.f90 -->
<g id="edge236" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~insert.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.838,-1346.08C196.915,-1405.74 216.523,-1651.57 266,-1707 273.901,-1715.85 285.351,-1721.17 296.662,-1724.35"/>
<polygon fill="#000000" stroke="#000000" points="295.939,-1727.77 306.472,-1726.63 297.526,-1720.96 295.939,-1727.77"/>
</g>
<!-- sourcefile~greater_equal_than.f90 -->
<g id="node23" class="node"><title>sourcefile~greater_equal_than.f90</title>
<a xlink:href="../sourcefile/greater_equal_than.f90.html" xlink:title="greater_equal_than.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="397,-1698 273,-1698 273,-1672 397,-1672 397,-1698"/>
<text text-anchor="middle" x="335" y="-1682.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">greater_equal_than.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~greater_equal_than.f90 -->
<g id="edge238" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~greater_equal_than.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M193.24,-1346.37C198.66,-1402.07 221.989,-1614.93 266,-1663 266.907,-1663.99 267.859,-1664.94 268.851,-1665.84"/>
<polygon fill="#000000" stroke="#000000" points="267.01,-1668.83 277.129,-1671.98 271.178,-1663.21 267.01,-1668.83"/>
</g>
<!-- sourcefile~is_real.f90 -->
<g id="node24" class="node"><title>sourcefile~is_real.f90</title>
<a xlink:href="../sourcefile/is_real.f90.html" xlink:title="is_real.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-1654 304,-1654 304,-1628 366,-1628 366,-1654"/>
<text text-anchor="middle" x="335" y="-1638.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_real.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~is_real.f90 -->
<g id="edge240" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~is_real.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M193.725,-1346.29C200.567,-1397.08 227.317,-1578.11 266,-1619 273.465,-1626.89 283.749,-1631.96 294.1,-1635.22"/>
<polygon fill="#000000" stroke="#000000" points="293.393,-1638.65 303.955,-1637.81 295.177,-1631.88 293.393,-1638.65"/>
</g>
<!-- sourcefile~sverify.f90 -->
<g id="node25" class="node"><title>sourcefile~sverify.f90</title>
<a xlink:href="../sourcefile/sverify.f90.html" xlink:title="sverify.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="365,-1610 305,-1610 305,-1584 365,-1584 365,-1610"/>
<text text-anchor="middle" x="335" y="-1594.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sverify.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~sverify.f90 -->
<g id="edge242" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~sverify.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M194.354,-1346.09C202.758,-1391.48 232.571,-1541.17 266,-1575 273.635,-1582.73 283.975,-1587.74 294.324,-1591"/>
<polygon fill="#000000" stroke="#000000" points="293.598,-1594.43 304.162,-1593.61 295.396,-1587.66 293.598,-1594.43"/>
</g>
<!-- sourcefile~greater_than.f90 -->
<g id="node26" class="node"><title>sourcefile~greater_than.f90</title>
<a xlink:href="../sourcefile/greater_than.f90.html" xlink:title="greater_than.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="381,-1566 289,-1566 289,-1540 381,-1540 381,-1566"/>
<text text-anchor="middle" x="335" y="-1550.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">greater_than.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~greater_than.f90 -->
<g id="edge244" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~greater_than.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M193.049,-1346.23C196.557,-1381.49 210.986,-1478.62 266,-1531 269.984,-1534.79 274.621,-1537.93 279.572,-1540.53"/>
<polygon fill="#000000" stroke="#000000" points="278.194,-1543.75 288.75,-1544.65 281.058,-1537.36 278.194,-1543.75"/>
</g>
<!-- sourcefile~not_equal.f90 -->
<g id="node27" class="node"><title>sourcefile~not_equal.f90</title>
<a xlink:href="../sourcefile/not_equal.f90.html" xlink:title="not_equal.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="374,-1522 296,-1522 296,-1496 374,-1496 374,-1522"/>
<text text-anchor="middle" x="335" y="-1506.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">not_equal.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~not_equal.f90 -->
<g id="edge246" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~not_equal.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M194.647,-1346.3C201.249,-1375.97 221.233,-1448.07 266,-1487 271.74,-1491.99 278.621,-1495.85 285.783,-1498.84"/>
<polygon fill="#000000" stroke="#000000" points="285.047,-1502.29 295.642,-1502.39 287.421,-1495.71 285.047,-1502.29"/>
</g>
<!-- sourcefile~fury_system_si64.f90 -->
<g id="node28" class="node"><title>sourcefile~fury_system_si64.f90</title>
<a xlink:href="../sourcefile/fury_system_si64.f90.html" xlink:title="fury_system_si64.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1207,-2350 1089,-2350 1089,-2324 1207,-2324 1207,-2350"/>
<text text-anchor="middle" x="1148" y="-2334.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_system_si64.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_si64.f90 -->
<g id="edge248" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_si64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.31,-1346.14C195.063,-1459.23 216.38,-2266.8 266,-2361 284.278,-2395.7 304.689,-2391.12 335,-2416"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335,-2416C349.96,-2428.28 655.645,-2339.93 675,-2340"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2340C713.774,-2335.6 721.29,-2322.93 760,-2318 803.84,-2312.42 1017.11,-2320.23 1050,-2323 1059.34,-2323.79 1069.15,-2324.88 1078.81,-2326.1"/>
<polygon fill="#000000" stroke="#000000" points="1078.42,-2329.58 1088.79,-2327.42 1079.33,-2322.64 1078.42,-2329.58"/>
</g>
<!-- sourcefile~is_number.f90 -->
<g id="node29" class="node"><title>sourcefile~is_number.f90</title>
<a xlink:href="../sourcefile/is_number.f90.html" xlink:title="is_number.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="375,-1478 295,-1478 295,-1452 375,-1452 375,-1478"/>
<text text-anchor="middle" x="335" y="-1462.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_number.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~is_number.f90 -->
<g id="edge250" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~is_number.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M197.403,-1346.3C207.451,-1369.38 231.203,-1416.89 266,-1443 271.609,-1447.21 278.048,-1450.63 284.69,-1453.4"/>
<polygon fill="#000000" stroke="#000000" points="283.9,-1456.84 294.493,-1457.02 286.324,-1450.27 283.9,-1456.84"/>
</g>
<!-- sourcefile~io_basic.f90 -->
<g id="node30" class="node"><title>sourcefile~io_basic.f90</title>
<a xlink:href="../sourcefile/io_basic.f90.html" xlink:title="io_basic.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="371,-1434 299,-1434 299,-1408 371,-1408 371,-1434"/>
<text text-anchor="middle" x="335" y="-1418.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_basic.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~io_basic.f90 -->
<g id="edge252" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~io_basic.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M203.559,-1346.22C217.147,-1361.01 241.03,-1384.75 266,-1399 273.065,-1403.03 280.966,-1406.43 288.829,-1409.26"/>
<polygon fill="#000000" stroke="#000000" points="287.749,-1412.59 298.343,-1412.43 289.963,-1405.95 287.749,-1412.59"/>
</g>
<!-- sourcefile~encode.f90 -->
<g id="node31" class="node"><title>sourcefile~encode.f90</title>
<a xlink:href="../sourcefile/encode.f90.html" xlink:title="encode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="368,-1390 302,-1390 302,-1364 368,-1364 368,-1390"/>
<text text-anchor="middle" x="335" y="-1374.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">encode.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~encode.f90 -->
<g id="edge254" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~encode.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M230.321,-1344.79C249.43,-1350.67 272.602,-1357.8 292.281,-1363.86"/>
<polygon fill="#000000" stroke="#000000" points="291.334,-1367.23 301.921,-1366.82 293.392,-1360.54 291.334,-1367.23"/>
</g>
<!-- sourcefile~fury.f90 -->
<g id="node32" class="node"><title>sourcefile~fury.f90</title>
<a xlink:href="../sourcefile/fury.f90.html" xlink:title="fury.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1300,-2350 1246,-2350 1246,-2324 1300,-2324 1300,-2350"/>
<text text-anchor="middle" x="1273" y="-2334.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge256" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2884C586.033,-2880.68 604.055,-2879.15 675,-2884"/>
</g>
<!-- sourcefile~split.f90 -->
<g id="node33" class="node"><title>sourcefile~split.f90</title>
<a xlink:href="../sourcefile/split.f90.html" xlink:title="split.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362,-1346 308,-1346 308,-1320 362,-1320 362,-1346"/>
<text text-anchor="middle" x="335" y="-1330.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">split.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~split.f90 -->
<g id="edge258" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~split.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M230.321,-1333C251.27,-1333 277.102,-1333 297.863,-1333"/>
<polygon fill="#000000" stroke="#000000" points="297.903,-1336.5 307.903,-1333 297.903,-1329.5 297.903,-1336.5"/>
</g>
<!-- sourcefile~fury_system_si128.f90 -->
<g id="node34" class="node"><title>sourcefile~fury_system_si128.f90</title>
<a xlink:href="../sourcefile/fury_system_si128.f90.html" xlink:title="fury_system_si128.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1210,-2195 1086,-2195 1086,-2169 1210,-2169 1210,-2195"/>
<text text-anchor="middle" x="1148" y="-2179.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_system_si128.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_si128.f90 -->
<g id="edge260" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_si128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.132,-1346.27C193.331,-1455.46 203.798,-2203.65 266,-2279 286.249,-2303.53 308.004,-2281.18 335,-2298"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335,-2298C361.996,-2314.82 376.939,-2295.72 404,-2279 424.348,-2266.43 419.523,-2251.36 440,-2239 469.439,-2221.23 482.228,-2230.41 515,-2220"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2220C589.493,-2196.33 598.81,-2164.45 675,-2147"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2147C713.384,-2138.21 721.024,-2127.61 760,-2122 809.983,-2114.8 1028.79,-2121.15 1050,-2127 1076.47,-2134.29 1103.45,-2150.19 1122.38,-2163.02"/>
<polygon fill="#000000" stroke="#000000" points="1120.53,-2166 1130.74,-2168.84 1124.53,-2160.25 1120.53,-2166"/>
</g>
<!-- sourcefile~camelcase.f90 -->
<g id="node35" class="node"><title>sourcefile~camelcase.f90</title>
<a xlink:href="../sourcefile/camelcase.f90.html" xlink:title="camelcase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="376,-1302 294,-1302 294,-1276 376,-1276 376,-1302"/>
<text text-anchor="middle" x="335" y="-1286.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">camelcase.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~camelcase.f90 -->
<g id="edge262" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~camelcase.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M230.321,-1321.21C246.865,-1316.12 266.454,-1310.09 284.185,-1304.64"/>
<polygon fill="#000000" stroke="#000000" points="285.285,-1307.96 293.814,-1301.67 283.227,-1301.27 285.285,-1307.96"/>
</g>
<!-- sourcefile~is_integer.f90 -->
<g id="node36" class="node"><title>sourcefile~is_integer.f90</title>
<a xlink:href="../sourcefile/is_integer.f90.html" xlink:title="is_integer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="373,-1258 297,-1258 297,-1232 373,-1232 373,-1258"/>
<text text-anchor="middle" x="335" y="-1242.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_integer.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~is_integer.f90 -->
<g id="edge264" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~is_integer.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M203.559,-1319.78C217.147,-1304.99 241.03,-1281.25 266,-1267 272.382,-1263.36 279.446,-1260.23 286.547,-1257.58"/>
<polygon fill="#000000" stroke="#000000" points="287.886,-1260.82 296.195,-1254.25 285.6,-1254.2 287.886,-1260.82"/>
</g>
<!-- sourcefile~scount.f90 -->
<g id="node37" class="node"><title>sourcefile~scount.f90</title>
<a xlink:href="../sourcefile/scount.f90.html" xlink:title="scount.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-1214 304,-1214 304,-1188 366,-1188 366,-1214"/>
<text text-anchor="middle" x="335" y="-1198.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">scount.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~scount.f90 -->
<g id="edge266" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~scount.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M197.403,-1319.7C207.451,-1296.62 231.203,-1249.11 266,-1223 274.222,-1216.83 284.229,-1212.36 294.043,-1209.13"/>
<polygon fill="#000000" stroke="#000000" points="295.106,-1212.47 303.719,-1206.3 293.138,-1205.75 295.106,-1212.47"/>
</g>
<!-- sourcefile~snakecase.f90 -->
<g id="node38" class="node"><title>sourcefile~snakecase.f90</title>
<a xlink:href="../sourcefile/snakecase.f90.html" xlink:title="snakecase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="376,-1170 294,-1170 294,-1144 376,-1144 376,-1170"/>
<text text-anchor="middle" x="335" y="-1154.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">snakecase.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~snakecase.f90 -->
<g id="edge268" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~snakecase.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M194.647,-1319.7C201.249,-1290.03 221.233,-1217.93 266,-1179 271.291,-1174.4 277.551,-1170.76 284.107,-1167.88"/>
<polygon fill="#000000" stroke="#000000" points="285.739,-1171 293.845,-1164.18 283.254,-1164.46 285.739,-1171"/>
</g>
<!-- sourcefile~fury_uom_reference128.f90 -->
<g id="node39" class="node"><title>sourcefile~fury_uom_reference128.f90</title>
<a xlink:href="../sourcefile/fury_uom_reference128.f90.html" xlink:title="fury_uom_reference128.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="589,-2274 441,-2274 441,-2248 589,-2248 589,-2274"/>
<text text-anchor="middle" x="515" y="-2258.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom_reference128.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_reference128.f90 -->
<g id="edge270" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_reference128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335,-2298C357.136,-2311.79 424.421,-2292.87 470.154,-2277.4"/>
<polygon fill="#000000" stroke="#000000" points="471.53,-2280.63 479.846,-2274.07 469.252,-2274.01 471.53,-2280.63"/>
</g>
<!-- sourcefile~free.f90 -->
<g id="node40" class="node"><title>sourcefile~free.f90</title>
<a xlink:href="../sourcefile/free.f90.html" xlink:title="free.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362,-1126 308,-1126 308,-1100 362,-1100 362,-1126"/>
<text text-anchor="middle" x="335" y="-1110.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">free.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~free.f90 -->
<g id="edge272" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~free.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M193.049,-1319.77C196.557,-1284.51 210.986,-1187.38 266,-1135 274.733,-1126.68 286.607,-1121.51 298.043,-1118.29"/>
<polygon fill="#000000" stroke="#000000" points="298.977,-1121.67 307.889,-1115.94 297.35,-1114.86 298.977,-1121.67"/>
</g>
<!-- sourcefile~fury_mixed_kinds.f90 -->
<g id="node41" class="node"><title>sourcefile~fury_mixed_kinds.f90</title>
<a xlink:href="../sourcefile/fury_mixed_kinds.f90.html" xlink:title="fury_mixed_kinds.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1032,-2580 914,-2580 914,-2554 1032,-2554 1032,-2580"/>
<text text-anchor="middle" x="973" y="-2564.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_mixed_kinds.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge274" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.197,-1346.14C193.968,-1457.79 208.442,-2249.09 266,-2479 284.017,-2550.97 279.742,-2581.5 335,-2631"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335,-2631C414.244,-2701.99 706.057,-2548.29 810,-2571"/>
</g>
<!-- sourcefile~sadjustlr.f90 -->
<g id="node42" class="node"><title>sourcefile~sadjustlr.f90</title>
<a xlink:href="../sourcefile/sadjustlr.f90.html" xlink:title="sadjustlr.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="370,-1082 300,-1082 300,-1056 370,-1056 370,-1082"/>
<text text-anchor="middle" x="335" y="-1066.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sadjustlr.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~sadjustlr.f90 -->
<g id="edge276" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~sadjustlr.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M194.354,-1319.91C202.758,-1274.52 232.571,-1124.83 266,-1091 272.62,-1084.3 281.273,-1079.64 290.204,-1076.39"/>
<polygon fill="#000000" stroke="#000000" points="291.393,-1079.69 299.919,-1073.4 289.332,-1073 291.393,-1079.69"/>
</g>
<!-- sourcefile~slice.f90 -->
<g id="node43" class="node"><title>sourcefile~slice.f90</title>
<a xlink:href="../sourcefile/slice.f90.html" xlink:title="slice.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362,-1038 308,-1038 308,-1012 362,-1012 362,-1038"/>
<text text-anchor="middle" x="335" y="-1022.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">slice.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~slice.f90 -->
<g id="edge278" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~slice.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M193.725,-1319.71C200.567,-1268.92 227.317,-1087.89 266,-1047 274.354,-1038.17 286.239,-1032.87 297.797,-1029.7"/>
<polygon fill="#000000" stroke="#000000" points="298.803,-1033.06 307.772,-1027.42 297.244,-1026.23 298.803,-1033.06"/>
</g>
<!-- sourcefile~fury_system_abstract32.f90 -->
<g id="node44" class="node"><title>sourcefile~fury_system_abstract32.f90</title>
<a xlink:href="../sourcefile/fury_system_abstract32.f90.html" xlink:title="fury_system_abstract32.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1047,-2840 899,-2840 899,-2814 1047,-2814 1047,-2840"/>
<text text-anchor="middle" x="973" y="-2824.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_system_abstract32.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_abstract32.f90 -->
<g id="edge280" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_abstract32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335,-2884C368.408,-2906 475.07,-2886.36 515,-2884"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2884C647.533,-2876.16 677.238,-2836.16 810,-2837"/>
</g>
<!-- sourcefile~write_lines.f90 -->
<g id="node45" class="node"><title>sourcefile~write_lines.f90</title>
<a xlink:href="../sourcefile/write_lines.f90.html" xlink:title="write_lines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="375,-994 295,-994 295,-968 375,-968 375,-994"/>
<text text-anchor="middle" x="335" y="-978.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_lines.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~write_lines.f90 -->
<g id="edge282" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~write_lines.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M193.24,-1319.63C198.66,-1263.93 221.989,-1051.07 266,-1003 271.079,-997.453 277.551,-993.298 284.488,-990.186"/>
<polygon fill="#000000" stroke="#000000" points="286.018,-993.35 294.149,-986.556 283.556,-986.797 286.018,-993.35"/>
</g>
<!-- sourcefile~join.f90 -->
<g id="node46" class="node"><title>sourcefile~join.f90</title>
<a xlink:href="../sourcefile/join.f90.html" xlink:title="join.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362,-950 308,-950 308,-924 362,-924 362,-950"/>
<text text-anchor="middle" x="335" y="-934.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">join.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~join.f90 -->
<g id="edge284" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~join.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.838,-1319.92C196.915,-1260.26 216.523,-1014.43 266,-959 274.16,-949.859 286.106,-944.489 297.774,-941.345"/>
<polygon fill="#000000" stroke="#000000" points="298.845,-944.692 307.853,-939.115 297.333,-937.857 298.845,-944.692"/>
</g>
<!-- sourcefile~fury_system_abstract64.f90 -->
<g id="node47" class="node"><title>sourcefile~fury_system_abstract64.f90</title>
<a xlink:href="../sourcefile/fury_system_abstract64.f90.html" xlink:title="fury_system_abstract64.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1047,-2477 899,-2477 899,-2451 1047,-2451 1047,-2477"/>
<text text-anchor="middle" x="973" y="-2461.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_system_abstract64.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_abstract64.f90 -->
<g id="edge286" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_abstract64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2340C729.611,-2340 873.814,-2411.88 939.523,-2446.19"/>
<polygon fill="#000000" stroke="#000000" points="938.147,-2449.42 948.628,-2450.96 941.398,-2443.22 938.147,-2449.42"/>
</g>
<!-- sourcefile~reverse.f90 -->
<g id="node48" class="node"><title>sourcefile~reverse.f90</title>
<a xlink:href="../sourcefile/reverse.f90.html" xlink:title="reverse.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="368,-906 302,-906 302,-880 368,-880 368,-906"/>
<text text-anchor="middle" x="335" y="-890.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reverse.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~reverse.f90 -->
<g id="edge288" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~reverse.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.552,-1319.71C195.477,-1255.46 211.17,-977.682 266,-915 272.705,-907.334 282.075,-902.317 291.752,-899.04"/>
<polygon fill="#000000" stroke="#000000" points="292.768,-902.39 301.444,-896.309 290.87,-895.652 292.768,-902.39"/>
</g>
<!-- sourcefile~strip.f90 -->
<g id="node49" class="node"><title>sourcefile~strip.f90</title>
<a xlink:href="../sourcefile/strip.f90.html" xlink:title="strip.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362,-862 308,-862 308,-836 362,-836 362,-862"/>
<text text-anchor="middle" x="335" y="-846.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">strip.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~strip.f90 -->
<g id="edge290" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~strip.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.307,-1319.7C194.141,-1251.45 205.737,-941.043 266,-871 273.991,-861.712 285.898,-856.307 297.58,-853.175"/>
<polygon fill="#000000" stroke="#000000" points="298.662,-856.521 307.685,-850.967 297.168,-849.682 298.662,-856.521"/>
</g>
<!-- sourcefile~fury_uom_symbol128.f90 -->
<g id="node50" class="node"><title>sourcefile~fury_uom_symbol128.f90</title>
<a xlink:href="../sourcefile/fury_uom_symbol128.f90.html" xlink:title="fury_uom_symbol128.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="403,-2352 267,-2352 267,-2326 403,-2326 403,-2352"/>
<text text-anchor="middle" x="335" y="-2336.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom_symbol128.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_symbol128.f90 -->
<g id="edge292" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_symbol128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.161,-1346.32C193.613,-1457.62 205.835,-2230.62 266,-2312 268.275,-2315.08 270.953,-2317.8 273.91,-2320.22"/>
<polygon fill="#000000" stroke="#000000" points="272.063,-2323.2 282.302,-2325.92 275.994,-2317.4 272.063,-2323.2"/>
</g>
<!-- sourcefile~fury_uom_symbol64.f90 -->
<g id="node51" class="node"><title>sourcefile~fury_uom_symbol64.f90</title>
<a xlink:href="../sourcefile/fury_uom_symbol64.f90.html" xlink:title="fury_uom_symbol64.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="400,-2470 270,-2470 270,-2444 400,-2444 400,-2470"/>
<text text-anchor="middle" x="335" y="-2454.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom_symbol64.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_symbol64.f90 -->
<g id="edge294" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_symbol64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.045,-1346.02C192.559,-1463.47 198.639,-2338.11 266,-2430 268.263,-2433.09 270.931,-2435.82 273.881,-2438.24"/>
<polygon fill="#000000" stroke="#000000" points="272.024,-2441.21 282.259,-2443.95 275.965,-2435.43 272.024,-2441.21"/>
</g>
<!-- sourcefile~fury_qreal64.f90 -->
<g id="node52" class="node"><title>sourcefile~fury_qreal64.f90</title>
<a xlink:href="../sourcefile/fury_qreal64.f90.html" xlink:title="fury_qreal64.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="857,-2353 763,-2353 763,-2327 857,-2327 857,-2353"/>
<text text-anchor="middle" x="810" y="-2337.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_qreal64.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_qreal64.f90 -->
<g id="edge296" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_qreal64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2340C700.532,-2340 728.781,-2340 752.81,-2340"/>
<polygon fill="#000000" stroke="#000000" points="752.83,-2343.5 762.83,-2340 752.83,-2336.5 752.83,-2343.5"/>
</g>
<!-- sourcefile~replace.f90 -->
<g id="node53" class="node"><title>sourcefile~replace.f90</title>
<a xlink:href="../sourcefile/replace.f90.html" xlink:title="replace.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="368,-818 302,-818 302,-792 368,-792 368,-818"/>
<text text-anchor="middle" x="335" y="-802.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">replace.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~replace.f90 -->
<g id="edge298" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~replace.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.101,-1319.89C192.912,-1248.24 200.226,-904.508 266,-827 272.651,-819.163 282.09,-814.088 291.859,-810.81"/>
<polygon fill="#000000" stroke="#000000" points="292.946,-814.14 301.646,-808.095 291.075,-807.395 292.946,-814.14"/>
</g>
<!-- sourcefile~slen.f90 -->
<g id="node54" class="node"><title>sourcefile~slen.f90</title>
<a xlink:href="../sourcefile/slen.f90.html" xlink:title="slen.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362,-774 308,-774 308,-748 362,-748 362,-774"/>
<text text-anchor="middle" x="335" y="-758.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">slen.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~slen.f90 -->
<g id="edge300" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~slen.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.938,-1319.77C198.696,-1240.04 230.205,-825.676 266,-783 274.017,-773.442 286.184,-767.988 298.081,-764.893"/>
<polygon fill="#000000" stroke="#000000" points="298.856,-768.306 307.913,-762.809 297.404,-761.459 298.856,-768.306"/>
</g>
<!-- sourcefile~fury_qreal128.f90 -->
<g id="node55" class="node"><title>sourcefile~fury_qreal128.f90</title>
<a xlink:href="../sourcefile/fury_qreal128.f90.html" xlink:title="fury_qreal128.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="860,-2157 760,-2157 760,-2131 860,-2131 860,-2157"/>
<text text-anchor="middle" x="810" y="-2141.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_qreal128.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_qreal128.f90 -->
<g id="edge302" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_qreal128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2147C698.987,-2141.51 725.999,-2140.01 749.524,-2140.16"/>
<polygon fill="#000000" stroke="#000000" points="749.661,-2143.67 759.717,-2140.33 749.776,-2136.67 749.661,-2143.67"/>
</g>
<!-- sourcefile~upper_lower.f90 -->
<g id="node56" class="node"><title>sourcefile~upper_lower.f90</title>
<a xlink:href="../sourcefile/upper_lower.f90.html" xlink:title="upper_lower.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="380,-730 290,-730 290,-704 380,-704 380,-730"/>
<text text-anchor="middle" x="335" y="-714.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">upper_lower.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~upper_lower.f90 -->
<g id="edge304" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~upper_lower.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.797,-1319.81C197.941,-1236.51 227.45,-785.42 266,-739 269.911,-734.291 274.83,-730.577 280.232,-727.65"/>
<polygon fill="#000000" stroke="#000000" points="281.982,-730.702 289.688,-723.431 279.129,-724.31 281.982,-730.702"/>
</g>
<!-- sourcefile~fury_uom32.f90 -->
<g id="node57" class="node"><title>sourcefile~fury_uom32.f90</title>
<a xlink:href="../sourcefile/fury_uom32.f90.html" xlink:title="fury_uom32.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="720,-2780 630,-2780 630,-2754 720,-2754 720,-2780"/>
<text text-anchor="middle" x="675" y="-2764.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom32.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom32.f90 -->
<g id="edge306" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2688C549.037,-2696.15 559.044,-2695.67 590,-2712 607.929,-2721.46 609.071,-2728.85 626,-2740 630.614,-2743.04 635.596,-2746.06 640.555,-2748.92"/>
<polygon fill="#000000" stroke="#000000" points="638.939,-2752.03 649.373,-2753.87 642.364,-2745.92 638.939,-2752.03"/>
</g>
<!-- sourcefile~read_lines.f90 -->
<g id="node58" class="node"><title>sourcefile~read_lines.f90</title>
<a xlink:href="../sourcefile/read_lines.f90.html" xlink:title="read_lines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="375,-686 295,-686 295,-660 375,-660 375,-686"/>
<text text-anchor="middle" x="335" y="-670.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_lines.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~read_lines.f90 -->
<g id="edge308" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~read_lines.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.67,-1319.97C197.222,-1233.57 224.671,-745.197 266,-695 271.057,-688.858 277.831,-684.407 285.162,-681.189"/>
<polygon fill="#000000" stroke="#000000" points="286.459,-684.441 294.661,-677.735 284.067,-677.863 286.459,-684.441"/>
</g>
<!-- sourcefile~sindex.f90 -->
<g id="node59" class="node"><title>sourcefile~sindex.f90</title>
<a xlink:href="../sourcefile/sindex.f90.html" xlink:title="sindex.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="365,-642 305,-642 305,-616 365,-616 365,-642"/>
<text text-anchor="middle" x="335" y="-626.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sindex.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~sindex.f90 -->
<g id="edge310" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~sindex.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.569,-1319.95C196.595,-1230.09 221.914,-704.95 266,-651 273.127,-642.279 283.714,-636.967 294.468,-633.747"/>
<polygon fill="#000000" stroke="#000000" points="295.416,-637.118 304.296,-631.34 293.751,-630.319 295.416,-637.118"/>
</g>
<!-- sourcefile~read_file.f90 -->
<g id="node60" class="node"><title>sourcefile~read_file.f90</title>
<a xlink:href="../sourcefile/read_file.f90.html" xlink:title="read_file.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="371,-598 299,-598 299,-572 371,-572 371,-598"/>
<text text-anchor="middle" x="335" y="-582.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_file.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~read_file.f90 -->
<g id="edge312" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~read_file.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.488,-1319.72C196.045,-1225.86 219.189,-664.667 266,-607 271.936,-599.688 280.305,-594.771 289.176,-591.474"/>
<polygon fill="#000000" stroke="#000000" points="290.37,-594.769 298.908,-588.496 288.321,-588.076 290.37,-594.769"/>
</g>
<!-- sourcefile~unique.f90 -->
<g id="node61" class="node"><title>sourcefile~unique.f90</title>
<a xlink:href="../sourcefile/unique.f90.html" xlink:title="unique.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-554 304,-554 304,-528 366,-528 366,-554"/>
<text text-anchor="middle" x="335" y="-538.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unique.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~unique.f90 -->
<g id="edge314" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~unique.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.402,-1319.86C195.469,-1223.2 216.399,-624.466 266,-563 272.821,-554.547 282.897,-549.294 293.253,-546.043"/>
<polygon fill="#000000" stroke="#000000" points="294.353,-549.374 303.171,-543.501 292.615,-542.594 294.353,-549.374"/>
</g>
<!-- sourcefile~write_file.f90 -->
<g id="node62" class="node"><title>sourcefile~write_file.f90</title>
<a xlink:href="../sourcefile/write_file.f90.html" xlink:title="write_file.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="371,-510 299,-510 299,-484 371,-484 371,-510"/>
<text text-anchor="middle" x="335" y="-494.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_file.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~write_file.f90 -->
<g id="edge316" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~write_file.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.333,-1319.75C194.961,-1219.63 213.646,-584.22 266,-519 271.838,-511.727 280.085,-506.822 288.856,-503.523"/>
<polygon fill="#000000" stroke="#000000" points="289.973,-506.841 298.489,-500.538 287.901,-500.155 289.973,-506.841"/>
</g>
<!-- sourcefile~fury_system_abstract128.f90 -->
<g id="node63" class="node"><title>sourcefile~fury_system_abstract128.f90</title>
<a xlink:href="../sourcefile/fury_system_abstract128.f90.html" xlink:title="fury_system_abstract128.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1050,-2195 896,-2195 896,-2169 1050,-2169 1050,-2195"/>
<text text-anchor="middle" x="973" y="-2179.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_system_abstract128.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_abstract128.f90 -->
<g id="edge318" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_abstract128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2147C735.759,-2133.09 747.74,-2182.01 810,-2185"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2185C834.599,-2186.18 861.307,-2186.21 885.848,-2185.74"/>
<polygon fill="#000000" stroke="#000000" points="885.937,-2189.24 895.857,-2185.52 885.781,-2182.24 885.937,-2189.24"/>
</g>
<!-- sourcefile~search.f90 -->
<g id="node64" class="node"><title>sourcefile~search.f90</title>
<a xlink:href="../sourcefile/search.f90.html" xlink:title="search.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-466 304,-466 304,-440 366,-440 366,-466"/>
<text text-anchor="middle" x="335" y="-450.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">search.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~search.f90 -->
<g id="edge320" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~search.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.269,-1319.7C194.473,-1216.37 210.881,-543.991 266,-475 272.839,-466.439 283.019,-461.157 293.471,-457.914"/>
<polygon fill="#000000" stroke="#000000" points="294.637,-461.23 303.476,-455.389 292.923,-454.443 294.637,-461.23"/>
</g>
<!-- sourcefile~assignments.f90 -->
<g id="node65" class="node"><title>sourcefile~assignments.f90</title>
<a xlink:href="../sourcefile/assignments.f90.html" xlink:title="assignments.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="380,-422 290,-422 290,-396 380,-396 380,-422"/>
<text text-anchor="middle" x="335" y="-406.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">assignments.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~assignments.f90 -->
<g id="edge322" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~assignments.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.21,-1319.7C194.003,-1213.39 208.104,-503.778 266,-431 269.811,-426.209 274.668,-422.445 280.036,-419.49"/>
<polygon fill="#000000" stroke="#000000" points="281.778,-422.544 289.456,-415.243 278.901,-416.163 281.778,-422.544"/>
</g>
<!-- sourcefile~unescape.f90 -->
<g id="node66" class="node"><title>sourcefile~unescape.f90</title>
<a xlink:href="../sourcefile/unescape.f90.html" xlink:title="unescape.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="373,-378 297,-378 297,-352 373,-352 373,-378"/>
<text text-anchor="middle" x="335" y="-362.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unescape.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~unescape.f90 -->
<g id="edge324" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~unescape.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.156,-1319.75C193.554,-1210.72 205.315,-463.581 266,-387 271.332,-380.271 278.728,-375.567 286.709,-372.286"/>
<polygon fill="#000000" stroke="#000000" points="287.908,-375.575 296.256,-369.051 285.662,-368.945 287.908,-375.575"/>
</g>
<!-- sourcefile~is_digit.f90 -->
<g id="node67" class="node"><title>sourcefile~is_digit.f90</title>
<a xlink:href="../sourcefile/is_digit.f90.html" xlink:title="is_digit.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="367,-334 303,-334 303,-308 367,-308 367,-334"/>
<text text-anchor="middle" x="335" y="-318.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_digit.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~is_digit.f90 -->
<g id="edge326" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~is_digit.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.107,-1319.85C193.123,-1208.34 202.515,-423.4 266,-343 272.672,-334.55 282.601,-329.291 292.862,-326.035"/>
<polygon fill="#000000" stroke="#000000" points="293.901,-329.381 302.705,-323.487 292.147,-322.604 293.901,-329.381"/>
</g>
<!-- sourcefile~basename_dir.f90 -->
<g id="node68" class="node"><title>sourcefile~basename_dir.f90</title>
<a xlink:href="../sourcefile/basename_dir.f90.html" xlink:title="basename_dir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="384,-290 286,-290 286,-264 384,-264 384,-290"/>
<text text-anchor="middle" x="335" y="-274.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">basename_dir.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~basename_dir.f90 -->
<g id="edge328" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~basename_dir.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.062,-1319.99C192.712,-1206.27 199.702,-383.236 266,-299 268.877,-295.344 272.364,-292.286 276.224,-289.728"/>
<polygon fill="#000000" stroke="#000000" points="278.044,-292.723 285.18,-284.892 274.718,-286.564 278.044,-292.723"/>
</g>
<!-- sourcefile~fury_uom_reference32.f90 -->
<g id="node69" class="node"><title>sourcefile~fury_uom_reference32.f90</title>
<a xlink:href="../sourcefile/fury_uom_reference32.f90.html" xlink:title="fury_uom_reference32.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="586,-2780 444,-2780 444,-2754 586,-2754 586,-2780"/>
<text text-anchor="middle" x="515" y="-2764.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom_reference32.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_reference32.f90 -->
<g id="edge330" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_reference32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.287,-1346.16C195.297,-1481.98 221.874,-2626.27 266,-2770 283.381,-2826.62 285.536,-2851.43 335,-2884"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335,-2884C396.74,-2924.65 470.856,-2832.09 501.114,-2788.32"/>
<polygon fill="#000000" stroke="#000000" points="504.018,-2790.28 506.724,-2780.03 498.221,-2786.35 504.018,-2790.28"/>
</g>
<!-- sourcefile~read_line.f90 -->
<g id="node70" class="node"><title>sourcefile~read_line.f90</title>
<a xlink:href="../sourcefile/read_line.f90.html" xlink:title="read_line.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="372,-246 298,-246 298,-220 372,-220 372,-246"/>
<text text-anchor="middle" x="335" y="-230.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_line.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~read_line.f90 -->
<g id="edge332" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~read_line.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.478,-1319.95C196.907,-1200.44 231.403,-299.09 266,-255 271.527,-247.957 279.317,-243.13 287.684,-239.831"/>
<polygon fill="#000000" stroke="#000000" points="288.852,-243.132 297.286,-236.719 286.694,-236.473 288.852,-243.132"/>
</g>
<!-- sourcefile~capitalize.f90 -->
<g id="node71" class="node"><title>sourcefile~capitalize.f90</title>
<a xlink:href="../sourcefile/capitalize.f90.html" xlink:title="capitalize.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="372,-202 298,-202 298,-176 372,-176 372,-202"/>
<text text-anchor="middle" x="335" y="-186.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">capitalize.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~capitalize.f90 -->
<g id="edge334" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~capitalize.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.447,-1319.81C196.659,-1197 230.021,-256.977 266,-211 271.517,-203.95 279.303,-199.119 287.669,-195.819"/>
<polygon fill="#000000" stroke="#000000" points="288.837,-199.12 297.271,-192.707 286.679,-192.461 288.837,-199.12"/>
</g>
<!-- sourcefile~partition.f90 -->
<g id="node72" class="node"><title>sourcefile~partition.f90</title>
<a xlink:href="../sourcefile/partition.f90.html" xlink:title="partition.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="369,-158 301,-158 301,-132 369,-132 369,-158"/>
<text text-anchor="middle" x="335" y="-142.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">partition.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~partition.f90 -->
<g id="edge336" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~partition.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.417,-1319.69C196.415,-1193.71 228.636,-214.869 266,-167 272.208,-159.046 281.305,-153.917 290.869,-150.623"/>
<polygon fill="#000000" stroke="#000000" points="291.826,-153.99 300.499,-147.905 289.924,-147.253 291.826,-153.99"/>
</g>
<!-- sourcefile~strim.f90 -->
<g id="node73" class="node"><title>sourcefile~strim.f90</title>
<a xlink:href="../sourcefile/strim.f90.html" xlink:title="strim.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362,-114 308,-114 308,-88 362,-88 362,-114"/>
<text text-anchor="middle" x="335" y="-98.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">strim.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~strim.f90 -->
<g id="edge338" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~strim.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.376,-1319.99C196.112,-1192.7 227.208,-172.816 266,-123 273.725,-113.08 285.943,-107.553 297.966,-104.5"/>
<polygon fill="#000000" stroke="#000000" points="298.814,-107.9 307.916,-102.476 297.419,-101.04 298.814,-107.9"/>
</g>
<!-- sourcefile~concatenation.f90 -->
<g id="node74" class="node"><title>sourcefile~concatenation.f90</title>
<a xlink:href="../sourcefile/concatenation.f90.html" xlink:title="concatenation.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="383,-70 287,-70 287,-44 383,-44 383,-70"/>
<text text-anchor="middle" x="335" y="-54.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">concatenation.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~concatenation.f90 -->
<g id="edge340" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~concatenation.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.35,-1319.93C195.881,-1189.81 225.816,-130.718 266,-79 269.069,-75.0503 272.85,-71.7968 277.048,-69.1186"/>
<polygon fill="#000000" stroke="#000000" points="278.894,-72.1043 286.156,-64.3905 275.668,-65.8915 278.894,-72.1043"/>
</g>
<!-- sourcefile~io_listdirected.f90 -->
<g id="node75" class="node"><title>sourcefile~io_listdirected.f90</title>
<a xlink:href="../sourcefile/io_listdirected.f90.html" xlink:title="io_listdirected.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385,-26 285,-26 285,-1.24345e-14 385,-3.55271e-15 385,-26"/>
<text text-anchor="middle" x="335" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_listdirected.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~io_listdirected.f90 -->
<g id="edge342" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~io_listdirected.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.324,-1319.89C195.655,-1187.07 224.421,-88.6238 266,-35 268.806,-31.381 272.21,-28.3465 275.986,-25.8033"/>
<polygon fill="#000000" stroke="#000000" points="277.677,-28.8677 284.756,-20.9848 274.306,-22.7327 277.677,-28.8677"/>
</g>
<!-- sourcefile~fury_qreal32.f90 -->
<g id="node76" class="node"><title>sourcefile~fury_qreal32.f90</title>
<a xlink:href="../sourcefile/fury_qreal32.f90.html" xlink:title="fury_qreal32.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="857,-2742 763,-2742 763,-2716 857,-2716 857,-2742"/>
<text text-anchor="middle" x="810" y="-2726.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_qreal32.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_qreal32.f90 -->
<g id="edge344" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_qreal32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2688C596.527,-2707.51 693.104,-2718.75 752.973,-2724.37"/>
<polygon fill="#000000" stroke="#000000" points="752.706,-2727.86 762.985,-2725.29 753.347,-2720.89 752.706,-2727.86"/>
</g>
<!-- sourcefile~fury_system_si32.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge2" class="edge"><title>sourcefile~fury_system_si32.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1165.74,-2674.99C1179.91,-2663.64 1199.13,-2645.9 1210,-2626 1235.38,-2579.55 1260.74,-2420.48 1269.65,-2360.31"/>
<polygon fill="#000000" stroke="#000000" points="1273.14,-2360.68 1271.12,-2350.27 1266.21,-2359.66 1273.14,-2360.68"/>
</g>
<!-- sourcefile~fury_uom_symbol32.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge4" class="edge"><title>sourcefile~fury_uom_symbol32.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M354.615,-2761.13C405.138,-2793.72 544.899,-2876.3 675,-2884"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2884C734.86,-2888.1 750.36,-2877.44 810,-2884"/>
</g>
<!-- sourcefile~fury_uom_symbol32.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge10" class="edge"><title>sourcefile~fury_uom_symbol32.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M400.645,-2737.88C434.673,-2733.17 476.966,-2728.14 515,-2726"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2726C587.974,-2721.9 603.031,-2700.74 675,-2688"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2688C734.081,-2677.54 756.28,-2714.72 810,-2688"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2688C865.379,-2660.45 921.434,-2613.81 951.211,-2587.2"/>
<polygon fill="#000000" stroke="#000000" points="953.82,-2589.56 958.891,-2580.26 949.125,-2584.36 953.82,-2589.56"/>
</g>
<!-- sourcefile~fury_uom_symbol32.f90&#45;&gt;sourcefile~fury_uom32.f90 -->
<g id="edge6" class="edge"><title>sourcefile~fury_uom_symbol32.f90&#45;&gt;sourcefile~fury_uom32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2726C557.552,-2723.61 604.624,-2737.81 636.626,-2750.15"/>
<polygon fill="#000000" stroke="#000000" points="635.467,-2753.46 646.052,-2753.9 638.053,-2746.95 635.467,-2753.46"/>
</g>
<!-- sourcefile~fury_uom_symbol32.f90&#45;&gt;sourcefile~fury_uom_reference32.f90 -->
<g id="edge8" class="edge"><title>sourcefile~fury_uom_symbol32.f90&#45;&gt;sourcefile~fury_uom_reference32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M400.748,-2754.94C411.359,-2756.06 422.456,-2757.23 433.387,-2758.39"/>
<polygon fill="#000000" stroke="#000000" points="433.047,-2761.87 443.359,-2759.44 433.782,-2754.91 433.047,-2761.87"/>
</g>
<!-- sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury_system_si64.f90 -->
<g id="edge14" class="edge"><title>sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury_system_si64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M720.69,-2378.26C791.396,-2373.82 931.537,-2364.19 1050,-2351 1059.38,-2349.96 1069.25,-2348.72 1078.96,-2347.41"/>
<polygon fill="#000000" stroke="#000000" points="1079.57,-2350.86 1089,-2346.03 1078.61,-2343.93 1079.57,-2350.86"/>
</g>
<!-- sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge16" class="edge"><title>sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2495C909.633,-2539.1 949.752,-2502.32 1050,-2545 1098.54,-2565.67 1100.59,-2635.15 1148,-2612"/>
</g>
<!-- sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge20" class="edge"><title>sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2495C852.355,-2513.75 900.921,-2535.19 933.946,-2549.77"/>
<polygon fill="#000000" stroke="#000000" points="932.688,-2553.04 943.25,-2553.88 935.515,-2546.64 932.688,-2553.04"/>
</g>
<!-- sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury_system_abstract64.f90 -->
<g id="edge18" class="edge"><title>sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury_system_abstract64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M704.784,-2394.01C711.602,-2397.87 718.463,-2402.55 724,-2408 746.98,-2430.63 736.395,-2449.03 760,-2471 778.043,-2487.79 787.46,-2485.02 810,-2495"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2495C852.315,-2513.73 905.708,-2496.75 939.614,-2481.5"/>
<polygon fill="#000000" stroke="#000000" points="941.489,-2484.48 949.055,-2477.07 938.516,-2478.14 941.489,-2484.48"/>
</g>
<!-- sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury_qreal64.f90 -->
<g id="edge12" class="edge"><title>sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury_qreal64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M718.086,-2367.91C730.507,-2364.14 744.203,-2359.98 757.145,-2356.05"/>
<polygon fill="#000000" stroke="#000000" points="758.309,-2359.36 766.86,-2353.1 756.275,-2352.66 758.309,-2359.36"/>
</g>
<!-- sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge22" class="edge"><title>sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-2223C1051.2,-2220.54 1073.26,-2218.88 1148,-2242"/>
</g>
<!-- sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury_system_si128.f90 -->
<g id="edge26" class="edge"><title>sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury_system_si128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2223C882.248,-2217.67 900.591,-2225.27 973,-2223"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-2223C1017.43,-2221.61 1066.59,-2209.07 1101.47,-2198.22"/>
<polygon fill="#000000" stroke="#000000" points="1102.9,-2201.44 1111.36,-2195.07 1100.77,-2194.77 1102.9,-2201.44"/>
</g>
<!-- sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge24" class="edge"><title>sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M681.759,-2239.07C695.025,-2264.16 726.145,-2320.27 760,-2362 820.803,-2436.95 907.208,-2512.4 948.795,-2547.18"/>
<polygon fill="#000000" stroke="#000000" points="946.802,-2550.07 956.729,-2553.77 951.276,-2544.69 946.802,-2550.07"/>
</g>
<!-- sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury_qreal128.f90 -->
<g id="edge28" class="edge"><title>sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury_qreal128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M694.306,-2212.88C711.357,-2201.45 737.013,-2184.61 760,-2171 765.112,-2167.97 770.585,-2164.88 775.967,-2161.91"/>
<polygon fill="#000000" stroke="#000000" points="777.745,-2164.93 784.859,-2157.08 774.402,-2158.78 777.745,-2164.93"/>
</g>
<!-- sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury_system_abstract128.f90 -->
<g id="edge30" class="edge"><title>sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury_system_abstract128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M723.798,-2226.12C749.48,-2225.88 781.477,-2225.1 810,-2223"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2223C850.218,-2220.03 894.518,-2208.32 926.771,-2198.17"/>
<polygon fill="#000000" stroke="#000000" points="927.927,-2201.47 936.376,-2195.08 925.784,-2194.81 927.927,-2201.47"/>
</g>
<!-- sourcefile~fury_uom_reference64.f90&#45;&gt;sourcefile~fury_uom64.f90 -->
<g id="edge36" class="edge"><title>sourcefile~fury_uom_reference64.f90&#45;&gt;sourcefile~fury_uom64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M555.232,-2444C566.637,-2439.92 578.952,-2435.12 590,-2430 609.118,-2421.13 629.609,-2409.39 645.682,-2399.63"/>
<polygon fill="#000000" stroke="#000000" points="647.911,-2402.36 654.591,-2394.14 644.24,-2396.4 647.911,-2402.36"/>
</g>
<!-- sourcefile~fury_uom_reference64.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge32" class="edge"><title>sourcefile~fury_uom_reference64.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M530.247,-2470.06C571.708,-2504.39 691.367,-2595.62 810,-2612"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2612C884.821,-2618.6 1080.72,-2645.4 1148,-2612"/>
</g>
<!-- sourcefile~fury_uom_reference64.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge34" class="edge"><title>sourcefile~fury_uom_reference64.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M569.505,-2470.06C611.9,-2480.38 665.137,-2493.72 675,-2498"/>
</g>
<!-- sourcefile~fury_uom_reference64.f90&#45;&gt;sourcefile~fury_system_abstract64.f90 -->
<g id="edge38" class="edge"><title>sourcefile~fury_uom_reference64.f90&#45;&gt;sourcefile~fury_system_abstract64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M586.725,-2457.87C628.05,-2460.41 680.3,-2467.16 724,-2484 742.177,-2491 741.411,-2503.18 760,-2509 802.413,-2522.28 816.351,-2517.37 860,-2509 887.64,-2503.7 917.128,-2491.72 939.048,-2481.45"/>
<polygon fill="#000000" stroke="#000000" points="940.751,-2484.52 948.252,-2477.04 937.722,-2478.21 940.751,-2484.52"/>
</g>
<!-- sourcefile~fury_system_si64.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge40" class="edge"><title>sourcefile~fury_system_si64.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1207.21,-2337C1216.91,-2337 1226.72,-2337 1235.7,-2337"/>
<polygon fill="#000000" stroke="#000000" points="1235.8,-2340.5 1245.8,-2337 1235.8,-2333.5 1235.8,-2340.5"/>
</g>
<!-- sourcefile~fury_test_qreal_eq.f90 -->
<g id="node97" class="node"><title>sourcefile~fury_test_qreal_eq.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_eq.f90.html" xlink:title="fury_test_qreal_eq.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1502,-3142 1382,-3142 1382,-3116 1502,-3116 1502,-3142"/>
<text text-anchor="middle" x="1442" y="-3126.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_eq.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_eq.f90 -->
<g id="edge42" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_eq.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.14,-2350.19C1274.33,-2447.18 1283.75,-3047.9 1336,-3107 1345.32,-3117.54 1358.24,-3123.8 1371.87,-3127.37"/>
<polygon fill="#000000" stroke="#000000" points="1371.37,-3130.85 1381.88,-3129.53 1372.84,-3124 1371.37,-3130.85"/>
</g>
<!-- sourcefile~fury_test_uom_assign.f90 -->
<g id="node98" class="node"><title>sourcefile~fury_test_uom_assign.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_assign.f90.html" xlink:title="fury_test_uom_assign.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1510,-3098 1374,-3098 1374,-3072 1510,-3072 1510,-3098"/>
<text text-anchor="middle" x="1442" y="-3082.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_assign.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_assign.f90 -->
<g id="edge44" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_assign.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.21,-2350.03C1274.84,-2443.31 1286.69,-3007.49 1336,-3063 1343.58,-3071.53 1353.53,-3077.25 1364.29,-3081.02"/>
<polygon fill="#000000" stroke="#000000" points="1363.34,-3084.39 1373.92,-3083.85 1365.31,-3077.67 1363.34,-3084.39"/>
</g>
<!-- sourcefile~fury_test_qreal_eq_mixed.f90 -->
<g id="node99" class="node"><title>sourcefile~fury_test_qreal_eq_mixed.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_eq_mixed.f90.html" xlink:title="fury_test_qreal_eq_mixed.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1519,-3054 1365,-3054 1365,-3028 1519,-3028 1519,-3054"/>
<text text-anchor="middle" x="1442" y="-3038.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_eq_mixed.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_eq_mixed.f90 -->
<g id="edge46" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_eq_mixed.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.29,-2350.1C1275.4,-2440.27 1289.66,-2967.13 1336,-3019 1341.41,-3025.06 1348.02,-3029.7 1355.27,-3033.23"/>
<polygon fill="#000000" stroke="#000000" points="1354.17,-3036.56 1364.75,-3037.13 1356.83,-3030.09 1354.17,-3036.56"/>
</g>
<!-- sourcefile~fury_test_qreal_mul.f90 -->
<g id="node100" class="node"><title>sourcefile~fury_test_qreal_mul.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_mul.f90.html" xlink:title="fury_test_qreal_mul.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1504,-3010 1380,-3010 1380,-2984 1504,-2984 1504,-3010"/>
<text text-anchor="middle" x="1442" y="-2994.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_mul.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_mul.f90 -->
<g id="edge48" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_mul.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.38,-2350.08C1275.99,-2436.78 1292.61,-2926.73 1336,-2975 1344.81,-2984.8 1356.75,-2990.88 1369.44,-2994.55"/>
<polygon fill="#000000" stroke="#000000" points="1368.71,-2997.97 1379.25,-2996.9 1370.34,-2991.17 1368.71,-2997.97"/>
</g>
<!-- sourcefile~fury_test_qreal_mul_mixed.f90 -->
<g id="node101" class="node"><title>sourcefile~fury_test_qreal_mul_mixed.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_mul_mixed.f90.html" xlink:title="fury_test_qreal_mul_mixed.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1522,-2966 1362,-2966 1362,-2940 1522,-2940 1522,-2966"/>
<text text-anchor="middle" x="1442" y="-2950.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_mul_mixed.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_mul_mixed.f90 -->
<g id="edge50" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_mul_mixed.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.48,-2350.24C1276.65,-2433.82 1295.58,-2886.37 1336,-2931 1340.75,-2936.24 1346.39,-2940.42 1352.56,-2943.73"/>
<polygon fill="#000000" stroke="#000000" points="1351.38,-2947.04 1361.93,-2947.98 1354.27,-2940.66 1351.38,-2947.04"/>
</g>
<!-- sourcefile~fury_test_qreal_not_eq.f90 -->
<g id="node102" class="node"><title>sourcefile~fury_test_qreal_not_eq.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_not_eq.f90.html" xlink:title="fury_test_qreal_not_eq.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1512,-2922 1372,-2922 1372,-2896 1512,-2896 1512,-2922"/>
<text text-anchor="middle" x="1442" y="-2906.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_not_eq.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_not_eq.f90 -->
<g id="edge52" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_not_eq.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.59,-2350.02C1277.3,-2429.37 1298.49,-2845.93 1336,-2887 1343.06,-2894.73 1352.07,-2900.14 1361.84,-2903.87"/>
<polygon fill="#000000" stroke="#000000" points="1360.81,-2907.21 1371.4,-2906.95 1362.96,-2900.55 1360.81,-2907.21"/>
</g>
<!-- sourcefile~fury_test_uom_sub.f90 -->
<g id="node103" class="node"><title>sourcefile~fury_test_uom_sub.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_sub.f90.html" xlink:title="fury_test_uom_sub.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1503,-2878 1381,-2878 1381,-2852 1503,-2852 1503,-2878"/>
<text text-anchor="middle" x="1442" y="-2862.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_sub.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_sub.f90 -->
<g id="edge54" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_sub.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.75,-2350.44C1278.14,-2426.96 1301.49,-2805.58 1336,-2843 1345.19,-2852.96 1357.61,-2859.06 1370.72,-2862.68"/>
<polygon fill="#000000" stroke="#000000" points="1370.31,-2866.17 1380.83,-2864.98 1371.86,-2859.35 1370.31,-2866.17"/>
</g>
<!-- sourcefile~fury_test_qreal_not_eq_mixed.f90 -->
<g id="node104" class="node"><title>sourcefile~fury_test_qreal_not_eq_mixed.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_not_eq_mixed.f90.html" xlink:title="fury_test_qreal_not_eq_mixed.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1529,-2834 1355,-2834 1355,-2808 1529,-2808 1529,-2834"/>
<text text-anchor="middle" x="1442" y="-2818.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_not_eq_mixed.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_not_eq_mixed.f90 -->
<g id="edge56" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_not_eq_mixed.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.9,-2350.2C1278.92,-2422.17 1304.38,-2765.12 1336,-2799 1338.96,-2802.17 1342.24,-2804.95 1345.77,-2807.37"/>
<polygon fill="#000000" stroke="#000000" points="1344.01,-2810.4 1354.41,-2812.43 1347.55,-2804.36 1344.01,-2810.4"/>
</g>
<!-- sourcefile~fury_test_qreal_pow.f90 -->
<g id="node105" class="node"><title>sourcefile~fury_test_qreal_pow.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_pow.f90.html" xlink:title="fury_test_qreal_pow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1505,-2790 1379,-2790 1379,-2764 1505,-2764 1505,-2790"/>
<text text-anchor="middle" x="1442" y="-2774.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_pow.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_pow.f90 -->
<g id="edge58" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_pow.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1274.1,-2350.26C1279.86,-2418.14 1307.31,-2724.68 1336,-2755 1344.72,-2764.21 1356.2,-2770.09 1368.39,-2773.76"/>
<polygon fill="#000000" stroke="#000000" points="1367.72,-2777.2 1378.27,-2776.25 1369.43,-2770.42 1367.72,-2777.2"/>
</g>
<!-- sourcefile~fury_test_uom_assign_failure.f90 -->
<g id="node106" class="node"><title>sourcefile~fury_test_uom_assign_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_assign_failure.f90.html" xlink:title="fury_test_uom_assign_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1527,-2746 1357,-2746 1357,-2720 1527,-2720 1527,-2746"/>
<text text-anchor="middle" x="1442" y="-2730.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_assign_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_assign_failure.f90 -->
<g id="edge60" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_assign_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.3,-2350.18C1274.93,-2410.27 1284.73,-2657.76 1336,-2711 1339.44,-2714.58 1343.31,-2717.65 1347.47,-2720.29"/>
<polygon fill="#000000" stroke="#000000" points="1345.91,-2723.42 1356.37,-2725.1 1349.24,-2717.27 1345.91,-2723.42"/>
</g>
<!-- sourcefile~fury_test_qreal_sub.f90 -->
<g id="node107" class="node"><title>sourcefile~fury_test_qreal_sub.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_sub.f90.html" xlink:title="fury_test_qreal_sub.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1504,-2702 1380,-2702 1380,-2676 1504,-2676 1504,-2702"/>
<text text-anchor="middle" x="1442" y="-2686.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_sub.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_sub.f90 -->
<g id="edge62" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_sub.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.62,-2350.1C1276.5,-2405.61 1290.49,-2620.75 1336,-2667 1345.05,-2676.2 1356.87,-2682.04 1369.32,-2685.67"/>
<polygon fill="#000000" stroke="#000000" points="1368.86,-2689.16 1379.4,-2688.13 1370.52,-2682.36 1368.86,-2689.16"/>
</g>
<!-- sourcefile~fury_test_qreal_sub_failure.f90 -->
<g id="node108" class="node"><title>sourcefile~fury_test_qreal_sub_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_sub_failure.f90.html" xlink:title="fury_test_qreal_sub_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1522,-2658 1362,-2658 1362,-2632 1522,-2632 1522,-2658"/>
<text text-anchor="middle" x="1442" y="-2642.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_sub_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_sub_failure.f90 -->
<g id="edge64" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_sub_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1274.03,-2350.04C1278.28,-2400.73 1296.21,-2583.69 1336,-2623 1340.9,-2627.84 1346.56,-2631.74 1352.67,-2634.88"/>
<polygon fill="#000000" stroke="#000000" points="1351.35,-2638.12 1361.91,-2638.95 1354.17,-2631.71 1351.35,-2638.12"/>
</g>
<!-- sourcefile~fury_test_qreal_sub_mixed.f90 -->
<g id="node109" class="node"><title>sourcefile~fury_test_qreal_sub_mixed.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_sub_mixed.f90.html" xlink:title="fury_test_qreal_sub_mixed.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1522,-2614 1362,-2614 1362,-2588 1522,-2588 1522,-2614"/>
<text text-anchor="middle" x="1442" y="-2598.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_sub_mixed.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_sub_mixed.f90 -->
<g id="edge66" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_sub_mixed.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1274.6,-2350.19C1280.43,-2395.92 1301.95,-2546.61 1336,-2579 1340.94,-2583.7 1346.61,-2587.51 1352.7,-2590.59"/>
<polygon fill="#000000" stroke="#000000" points="1351.33,-2593.81 1361.9,-2594.59 1354.12,-2587.39 1351.33,-2593.81"/>
</g>
<!-- sourcefile~fury_test_qreal_sub_mixed_failure.f90 -->
<g id="node110" class="node"><title>sourcefile~fury_test_qreal_sub_mixed_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_sub_mixed_failure.f90.html" xlink:title="fury_test_qreal_sub_mixed_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1539,-2570 1345,-2570 1345,-2544 1539,-2544 1539,-2570"/>
<text text-anchor="middle" x="1442" y="-2554.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_sub_mixed_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_sub_mixed_failure.f90 -->
<g id="edge68" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_sub_mixed_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1275.43,-2350.27C1283.03,-2390.41 1307.6,-2509.4 1336,-2535 1337.18,-2536.06 1338.39,-2537.08 1339.64,-2538.05"/>
<polygon fill="#000000" stroke="#000000" points="1338.07,-2541.21 1348.34,-2543.84 1341.95,-2535.38 1338.07,-2541.21"/>
</g>
<!-- sourcefile~fury_test_uom_sub_failure.f90 -->
<g id="node111" class="node"><title>sourcefile~fury_test_uom_sub_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_sub_failure.f90.html" xlink:title="fury_test_uom_sub_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1520,-2526 1364,-2526 1364,-2500 1520,-2500 1520,-2526"/>
<text text-anchor="middle" x="1442" y="-2510.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_sub_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_sub_failure.f90 -->
<g id="edge70" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_sub_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1274.29,-2350.13C1277.98,-2380.11 1291.35,-2453.88 1336,-2491 1341.34,-2495.44 1347.35,-2499.06 1353.72,-2501.99"/>
<polygon fill="#000000" stroke="#000000" points="1352.69,-2505.35 1363.28,-2505.83 1355.3,-2498.86 1352.69,-2505.35"/>
</g>
<!-- sourcefile~fury_test_system_si.f90 -->
<g id="node112" class="node"><title>sourcefile~fury_test_system_si.f90</title>
<a xlink:href="../sourcefile/fury_test_system_si.f90.html" xlink:title="fury_test_system_si.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1504,-2482 1380,-2482 1380,-2456 1504,-2456 1504,-2482"/>
<text text-anchor="middle" x="1442" y="-2466.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_system_si.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_system_si.f90 -->
<g id="edge72" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_system_si.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1276.65,-2350.27C1283.85,-2373.75 1302.16,-2422.44 1336,-2447 1345.81,-2454.11 1357.39,-2459.04 1369.24,-2462.43"/>
<polygon fill="#000000" stroke="#000000" points="1368.67,-2465.9 1379.22,-2464.93 1370.37,-2459.1 1368.67,-2465.9"/>
</g>
<!-- sourcefile~fury_test_uom_add.f90 -->
<g id="node113" class="node"><title>sourcefile~fury_test_uom_add.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_add.f90.html" xlink:title="fury_test_uom_add.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1503,-2438 1381,-2438 1381,-2412 1503,-2412 1503,-2438"/>
<text text-anchor="middle" x="1442" y="-2422.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_add.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_add.f90 -->
<g id="edge74" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_add.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1281.77,-2350.19C1292.63,-2365.41 1312.59,-2390.01 1336,-2403 1346.53,-2408.84 1358.42,-2413.14 1370.35,-2416.3"/>
<polygon fill="#000000" stroke="#000000" points="1369.8,-2419.76 1380.34,-2418.69 1371.43,-2412.96 1369.8,-2419.76"/>
</g>
<!-- sourcefile~fury_test_uom_div.f90 -->
<g id="node114" class="node"><title>sourcefile~fury_test_uom_div.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_div.f90.html" xlink:title="fury_test_uom_div.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1501,-2394 1383,-2394 1383,-2368 1501,-2368 1501,-2394"/>
<text text-anchor="middle" x="1442" y="-2378.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_div.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_div.f90 -->
<g id="edge76" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_div.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1300.04,-2347.32C1311.09,-2351.3 1324.05,-2355.69 1336,-2359 1347.86,-2362.29 1360.59,-2365.33 1372.97,-2368.04"/>
<polygon fill="#000000" stroke="#000000" points="1372.29,-2371.48 1382.8,-2370.15 1373.75,-2364.63 1372.29,-2371.48"/>
</g>
<!-- sourcefile~fury_test_uom_add_failure.f90 -->
<g id="node115" class="node"><title>sourcefile~fury_test_uom_add_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_add_failure.f90.html" xlink:title="fury_test_uom_add_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1521,-2350 1363,-2350 1363,-2324 1521,-2324 1521,-2350"/>
<text text-anchor="middle" x="1442" y="-2334.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_add_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_add_failure.f90 -->
<g id="edge78" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_add_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1300.15,-2337C1314.69,-2337 1333.52,-2337 1352.68,-2337"/>
<polygon fill="#000000" stroke="#000000" points="1352.71,-2340.5 1362.71,-2337 1352.71,-2333.5 1352.71,-2340.5"/>
</g>
<!-- sourcefile~fury_test_uom_aliases.f90 -->
<g id="node116" class="node"><title>sourcefile~fury_test_uom_aliases.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_aliases.f90.html" xlink:title="fury_test_uom_aliases.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1511,-2306 1373,-2306 1373,-2280 1511,-2280 1511,-2306"/>
<text text-anchor="middle" x="1442" y="-2290.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_aliases.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_aliases.f90 -->
<g id="edge80" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_aliases.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1300.04,-2326.68C1311.09,-2322.7 1324.05,-2318.31 1336,-2315 1344.71,-2312.59 1353.89,-2310.3 1363.06,-2308.19"/>
<polygon fill="#000000" stroke="#000000" points="1363.99,-2311.56 1372.98,-2305.96 1362.45,-2304.73 1363.99,-2311.56"/>
</g>
<!-- sourcefile~fury_test_bolt32.f90 -->
<g id="node117" class="node"><title>sourcefile~fury_test_bolt32.f90</title>
<a xlink:href="../sourcefile/fury_test_bolt32.f90.html" xlink:title="fury_test_bolt32.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1495,-2262 1389,-2262 1389,-2236 1495,-2236 1495,-2262"/>
<text text-anchor="middle" x="1442" y="-2246.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_bolt32.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_bolt32.f90 -->
<g id="edge82" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_bolt32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1281.77,-2323.81C1292.63,-2308.59 1312.59,-2283.99 1336,-2271 1348.89,-2263.85 1363.82,-2259.01 1378.34,-2255.75"/>
<polygon fill="#000000" stroke="#000000" points="1379.19,-2259.15 1388.3,-2253.73 1377.8,-2252.29 1379.19,-2259.15"/>
</g>
<!-- sourcefile~fury_test_bolt64.f90 -->
<g id="node118" class="node"><title>sourcefile~fury_test_bolt64.f90</title>
<a xlink:href="../sourcefile/fury_test_bolt64.f90.html" xlink:title="fury_test_bolt64.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1495,-2218 1389,-2218 1389,-2192 1495,-2192 1495,-2218"/>
<text text-anchor="middle" x="1442" y="-2202.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_bolt64.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_bolt64.f90 -->
<g id="edge84" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_bolt64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1276.65,-2323.73C1283.85,-2300.25 1302.16,-2251.56 1336,-2227 1348.24,-2218.12 1363.25,-2212.65 1378.08,-2209.32"/>
<polygon fill="#000000" stroke="#000000" points="1379.14,-2212.68 1388.29,-2207.34 1377.81,-2205.81 1379.14,-2212.68"/>
</g>
<!-- sourcefile~fury_test_qreal_add.f90 -->
<g id="node119" class="node"><title>sourcefile~fury_test_qreal_add.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_add.f90.html" xlink:title="fury_test_qreal_add.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1505,-2174 1379,-2174 1379,-2148 1505,-2148 1505,-2174"/>
<text text-anchor="middle" x="1442" y="-2158.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_add.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add.f90 -->
<g id="edge86" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1274.29,-2323.87C1277.98,-2293.89 1291.35,-2220.12 1336,-2183 1345.52,-2175.08 1357.16,-2169.78 1369.2,-2166.28"/>
<polygon fill="#000000" stroke="#000000" points="1370.07,-2169.67 1378.91,-2163.84 1368.36,-2162.88 1370.07,-2169.67"/>
</g>
<!-- sourcefile~fury_test_uom_mul.f90 -->
<g id="node120" class="node"><title>sourcefile~fury_test_uom_mul.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_mul.f90.html" xlink:title="fury_test_uom_mul.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1503,-2130 1381,-2130 1381,-2104 1503,-2104 1503,-2130"/>
<text text-anchor="middle" x="1442" y="-2114.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_mul.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_mul.f90 -->
<g id="edge88" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_mul.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1275.43,-2323.73C1283.03,-2283.59 1307.6,-2164.6 1336,-2139 1345.79,-2130.17 1358.17,-2124.53 1370.99,-2120.99"/>
<polygon fill="#000000" stroke="#000000" points="1371.9,-2124.37 1380.84,-2118.68 1370.3,-2117.56 1371.9,-2124.37"/>
</g>
<!-- sourcefile~fury_test_qreal_add_aliases_failure.f90 -->
<g id="node121" class="node"><title>sourcefile~fury_test_qreal_add_aliases_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_add_aliases_failure.f90.html" xlink:title="fury_test_qreal_add_aliases_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1542,-2086 1342,-2086 1342,-2060 1542,-2060 1542,-2086"/>
<text text-anchor="middle" x="1442" y="-2070.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_add_aliases_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add_aliases_failure.f90 -->
<g id="edge90" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add_aliases_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1274.6,-2323.81C1280.43,-2278.08 1301.95,-2127.39 1336,-2095 1337.11,-2093.95 1338.25,-2092.94 1339.43,-2091.97"/>
<polygon fill="#000000" stroke="#000000" points="1341.46,-2094.82 1347.63,-2086.21 1337.44,-2089.09 1341.46,-2094.82"/>
</g>
<!-- sourcefile~fury_test_uom_pow.f90 -->
<g id="node122" class="node"><title>sourcefile~fury_test_uom_pow.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_pow.f90.html" xlink:title="fury_test_uom_pow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1504,-2042 1380,-2042 1380,-2016 1504,-2016 1504,-2042"/>
<text text-anchor="middle" x="1442" y="-2026.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_pow.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_pow.f90 -->
<g id="edge92" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_pow.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1274.03,-2323.96C1278.28,-2273.27 1296.21,-2090.31 1336,-2051 1345.32,-2041.79 1357.43,-2035.96 1370.12,-2032.36"/>
<polygon fill="#000000" stroke="#000000" points="1370.98,-2035.76 1379.89,-2030.02 1369.35,-2028.95 1370.98,-2035.76"/>
</g>
<!-- sourcefile~fury_test_qreal_add_failure.f90 -->
<g id="node123" class="node"><title>sourcefile~fury_test_qreal_add_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_add_failure.f90.html" xlink:title="fury_test_qreal_add_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1522,-1998 1362,-1998 1362,-1972 1522,-1972 1522,-1998"/>
<text text-anchor="middle" x="1442" y="-1982.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_add_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add_failure.f90 -->
<g id="edge94" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.62,-2323.9C1276.5,-2268.39 1290.49,-2053.25 1336,-2007 1340.67,-2002.25 1346.08,-1998.4 1351.94,-1995.28"/>
<polygon fill="#000000" stroke="#000000" points="1353.79,-1998.28 1361.46,-1990.96 1350.9,-1991.91 1353.79,-1998.28"/>
</g>
<!-- sourcefile~fury_test_qreal_add_mixed.f90 -->
<g id="node124" class="node"><title>sourcefile~fury_test_qreal_add_mixed.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_add_mixed.f90.html" xlink:title="fury_test_qreal_add_mixed.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1522,-1954 1362,-1954 1362,-1928 1522,-1928 1522,-1954"/>
<text text-anchor="middle" x="1442" y="-1938.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_add_mixed.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add_mixed.f90 -->
<g id="edge96" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add_mixed.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.3,-2323.82C1274.93,-2263.73 1284.73,-2016.24 1336,-1963 1340.82,-1958 1346.45,-1953.98 1352.57,-1950.77"/>
<polygon fill="#000000" stroke="#000000" points="1354.14,-1953.9 1361.84,-1946.62 1351.28,-1947.51 1354.14,-1953.9"/>
</g>
<!-- sourcefile~fury_test_qreal_add_mixed_failure.f90 -->
<g id="node125" class="node"><title>sourcefile~fury_test_qreal_add_mixed_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_add_mixed_failure.f90.html" xlink:title="fury_test_qreal_add_mixed_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1540,-1910 1344,-1910 1344,-1884 1540,-1884 1540,-1910"/>
<text text-anchor="middle" x="1442" y="-1894.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_add_mixed_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add_mixed_failure.f90 -->
<g id="edge98" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add_mixed_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1274.1,-2323.74C1279.86,-2255.86 1307.31,-1949.32 1336,-1919 1336.91,-1918.04 1337.85,-1917.12 1338.81,-1916.23"/>
<polygon fill="#000000" stroke="#000000" points="1340.98,-1918.98 1346.72,-1910.08 1336.68,-1913.45 1340.98,-1918.98"/>
</g>
<!-- sourcefile~fury_test_qreal_aliases.f90 -->
<g id="node126" class="node"><title>sourcefile~fury_test_qreal_aliases.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_aliases.f90.html" xlink:title="fury_test_qreal_aliases.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1512,-1866 1372,-1866 1372,-1840 1512,-1840 1512,-1866"/>
<text text-anchor="middle" x="1442" y="-1850.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_aliases.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_aliases.f90 -->
<g id="edge100" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_aliases.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.9,-2323.8C1278.92,-2251.83 1304.38,-1908.88 1336,-1875 1343.02,-1867.48 1351.89,-1862.17 1361.49,-1858.46"/>
<polygon fill="#000000" stroke="#000000" points="1362.86,-1861.7 1371.29,-1855.28 1360.7,-1855.04 1362.86,-1861.7"/>
</g>
<!-- sourcefile~fury_test_uom_parse_failure.f90 -->
<g id="node127" class="node"><title>sourcefile~fury_test_uom_parse_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_parse_failure.f90.html" xlink:title="fury_test_uom_parse_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1525,-1822 1359,-1822 1359,-1796 1525,-1796 1525,-1822"/>
<text text-anchor="middle" x="1442" y="-1806.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_parse_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_parse_failure.f90 -->
<g id="edge102" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_parse_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.75,-2323.56C1278.14,-2247.04 1301.49,-1868.42 1336,-1831 1339.9,-1826.77 1344.39,-1823.24 1349.26,-1820.29"/>
<polygon fill="#000000" stroke="#000000" points="1351.1,-1823.28 1358.41,-1815.61 1347.91,-1817.05 1351.1,-1823.28"/>
</g>
<!-- sourcefile~fury_test_qreal_assign.f90 -->
<g id="node128" class="node"><title>sourcefile~fury_test_qreal_assign.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_assign.f90.html" xlink:title="fury_test_qreal_assign.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1511,-1778 1373,-1778 1373,-1752 1511,-1752 1511,-1778"/>
<text text-anchor="middle" x="1442" y="-1762.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_assign.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_assign.f90 -->
<g id="edge104" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_assign.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.59,-2323.98C1277.3,-2244.63 1298.49,-1828.07 1336,-1787 1343.25,-1779.06 1352.56,-1773.57 1362.64,-1769.83"/>
<polygon fill="#000000" stroke="#000000" points="1363.99,-1773.08 1372.49,-1766.76 1361.9,-1766.39 1363.99,-1773.08"/>
</g>
<!-- sourcefile~fury_test_qreal_conversions_complex.f90 -->
<g id="node129" class="node"><title>sourcefile~fury_test_qreal_conversions_complex.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_conversions_complex.f90.html" xlink:title="fury_test_qreal_conversions_complex.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1547,-1734 1337,-1734 1337,-1708 1547,-1708 1547,-1734"/>
<text text-anchor="middle" x="1442" y="-1718.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_conversions_complex.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_conversions_complex.f90 -->
<g id="edge106" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_conversions_complex.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.48,-2323.76C1276.65,-2240.18 1295.58,-1787.63 1336,-1743 1336.76,-1742.16 1337.54,-1741.36 1338.34,-1740.57"/>
<polygon fill="#000000" stroke="#000000" points="1340.57,-1743.27 1346.08,-1734.22 1336.13,-1737.86 1340.57,-1743.27"/>
</g>
<!-- sourcefile~fury_test_qreal_conversions_si.f90 -->
<g id="node130" class="node"><title>sourcefile~fury_test_qreal_conversions_si.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_conversions_si.f90.html" xlink:title="fury_test_qreal_conversions_si.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1531,-1690 1353,-1690 1353,-1664 1531,-1664 1531,-1690"/>
<text text-anchor="middle" x="1442" y="-1674.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_conversions_si.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_conversions_si.f90 -->
<g id="edge108" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_conversions_si.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.38,-2323.92C1275.99,-2237.22 1292.61,-1747.27 1336,-1699 1338.46,-1696.26 1341.17,-1693.81 1344.07,-1691.63"/>
<polygon fill="#000000" stroke="#000000" points="1346.14,-1694.46 1352.7,-1686.14 1342.38,-1688.55 1346.14,-1694.46"/>
</g>
<!-- sourcefile~fury_test_qreal_conversions_simple.f90 -->
<g id="node131" class="node"><title>sourcefile~fury_test_qreal_conversions_simple.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_conversions_simple.f90.html" xlink:title="fury_test_qreal_conversions_simple.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1543,-1646 1341,-1646 1341,-1620 1543,-1620 1543,-1646"/>
<text text-anchor="middle" x="1442" y="-1630.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_conversions_simple.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_conversions_simple.f90 -->
<g id="edge110" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_conversions_simple.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.29,-2323.9C1275.4,-2233.73 1289.66,-1706.87 1336,-1655 1336.75,-1654.16 1337.53,-1653.35 1338.32,-1652.56"/>
<polygon fill="#000000" stroke="#000000" points="1340.56,-1655.25 1346.02,-1646.17 1336.09,-1649.86 1340.56,-1655.25"/>
</g>
<!-- sourcefile~fury_test_qreal_div.f90 -->
<g id="node132" class="node"><title>sourcefile~fury_test_qreal_div.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_div.f90.html" xlink:title="fury_test_qreal_div.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1502,-1602 1382,-1602 1382,-1576 1502,-1576 1502,-1602"/>
<text text-anchor="middle" x="1442" y="-1586.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_div.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_div.f90 -->
<g id="edge112" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_div.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.21,-2323.97C1274.84,-2230.69 1286.69,-1666.51 1336,-1611 1345.24,-1600.6 1358,-1594.37 1371.47,-1590.78"/>
<polygon fill="#000000" stroke="#000000" points="1372.35,-1594.17 1381.37,-1588.6 1370.85,-1587.33 1372.35,-1594.17"/>
</g>
<!-- sourcefile~fury_test_qreal_div_mixed.f90 -->
<g id="node133" class="node"><title>sourcefile~fury_test_qreal_div_mixed.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_div_mixed.f90.html" xlink:title="fury_test_qreal_div_mixed.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1520,-1558 1364,-1558 1364,-1532 1520,-1532 1520,-1558"/>
<text text-anchor="middle" x="1442" y="-1542.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_div_mixed.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_div_mixed.f90 -->
<g id="edge114" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_div_mixed.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.14,-2323.81C1274.33,-2226.82 1283.75,-1626.1 1336,-1567 1341.13,-1561.19 1347.37,-1556.68 1354.21,-1553.21"/>
<polygon fill="#000000" stroke="#000000" points="1356.05,-1556.23 1363.87,-1549.08 1353.3,-1549.79 1356.05,-1556.23"/>
</g>
<!-- sourcefile~fury_system_si128.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge116" class="edge"><title>sourcefile~fury_system_si128.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1169.85,-2195.01C1182.6,-2203.34 1198.4,-2215 1210,-2228 1233.57,-2254.43 1252.54,-2291.07 1263.29,-2314.4"/>
<polygon fill="#000000" stroke="#000000" points="1260.23,-2316.12 1267.51,-2323.81 1266.61,-2313.26 1260.23,-2316.12"/>
</g>
<!-- sourcefile~fury_uom_reference128.f90&#45;&gt;sourcefile~fury_uom128.f90 -->
<g id="edge122" class="edge"><title>sourcefile~fury_uom_reference128.f90&#45;&gt;sourcefile~fury_uom128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M574.578,-2247.97C588.305,-2244.96 602.892,-2241.77 616.57,-2238.78"/>
<polygon fill="#000000" stroke="#000000" points="617.322,-2242.2 626.343,-2236.64 615.826,-2235.36 617.322,-2242.2"/>
</g>
<!-- sourcefile~fury_uom_reference128.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge118" class="edge"><title>sourcefile~fury_uom_reference128.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.785,-2274.08C593.214,-2286.8 651.711,-2303.95 675,-2302"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2302C713.391,-2298.78 721.929,-2290.91 760,-2285 802.862,-2278.35 1106.56,-2229.18 1148,-2242"/>
</g>
<!-- sourcefile~fury_uom_reference128.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge120" class="edge"><title>sourcefile~fury_uom_reference128.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M570.227,-2274.07C577.558,-2277.65 584.445,-2282.21 590,-2288 627.064,-2326.66 596.126,-2358.55 626,-2403 657.52,-2449.9 682.307,-2445.86 724,-2484 764.116,-2520.7 757.132,-2558.31 810,-2571"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2571C840.304,-2577.62 874.531,-2577.84 903.769,-2575.93"/>
<polygon fill="#000000" stroke="#000000" points="904.178,-2579.41 913.889,-2575.17 903.655,-2572.42 904.178,-2579.41"/>
</g>
<!-- sourcefile~fury_uom_reference128.f90&#45;&gt;sourcefile~fury_system_abstract128.f90 -->
<g id="edge124" class="edge"><title>sourcefile~fury_uom_reference128.f90&#45;&gt;sourcefile~fury_system_abstract128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M559.376,-2247.92C569.739,-2244.08 580.513,-2239.43 590,-2234 608.073,-2223.65 606.807,-2212.09 626,-2204 701.761,-2172.07 727.939,-2180.01 810,-2185"/>
</g>
<!-- sourcefile~fury_mixed_kinds.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge126" class="edge"><title>sourcefile~fury_mixed_kinds.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1004.13,-2580.11C1047.26,-2597.41 1122.77,-2624.32 1148,-2612"/>
</g>
<!-- sourcefile~fury_system_abstract32.f90&#45;&gt;sourcefile~fury_system_si32.f90 -->
<g id="edge130" class="edge"><title>sourcefile~fury_system_abstract32.f90&#45;&gt;sourcefile~fury_system_si32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1022.46,-2813.91C1032.04,-2810.22 1041.67,-2805.63 1050,-2800 1086.22,-2775.51 1117.37,-2734.46 1134.34,-2709.44"/>
<polygon fill="#000000" stroke="#000000" points="1137.32,-2711.28 1139.93,-2701.01 1131.48,-2707.41 1137.32,-2711.28"/>
</g>
<!-- sourcefile~fury_system_abstract32.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge128" class="edge"><title>sourcefile~fury_system_abstract32.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1047.13,-2826.38C1081.84,-2822.29 1121.32,-2811.6 1148,-2786"/>
</g>
<!-- sourcefile~fury_system_abstract64.f90&#45;&gt;sourcefile~fury_system_si64.f90 -->
<g id="edge134" class="edge"><title>sourcefile~fury_system_abstract64.f90&#45;&gt;sourcefile~fury_system_si64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1014.05,-2450.91C1026.12,-2446.17 1039.02,-2440.17 1050,-2433 1082.21,-2411.95 1112.79,-2379.23 1130.98,-2357.96"/>
<polygon fill="#000000" stroke="#000000" points="1133.79,-2360.06 1137.54,-2350.15 1128.43,-2355.56 1133.79,-2360.06"/>
</g>
<!-- sourcefile~fury_system_abstract64.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge132" class="edge"><title>sourcefile~fury_system_abstract64.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1003.31,-2477.17C1018.11,-2484.32 1035.75,-2493.96 1050,-2505 1100.97,-2544.5 1090.05,-2640.3 1148,-2612"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1148,-2612C1244.31,-2564.96 1266.51,-2417.76 1271.55,-2360.3"/>
<polygon fill="#000000" stroke="#000000" points="1275.06,-2360.3 1272.35,-2350.06 1268.08,-2359.76 1275.06,-2360.3"/>
</g>
<!-- sourcefile~fury_uom_symbol128.f90&#45;&gt;sourcefile~fury_uom128.f90 -->
<g id="edge142" class="edge"><title>sourcefile~fury_uom_symbol128.f90&#45;&gt;sourcefile~fury_uom128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M400.932,-2325.95C435.036,-2319.07 477.31,-2310.35 515,-2302"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2302C548.573,-2294.56 558.594,-2297 590,-2283 612.11,-2273.14 634.763,-2257.63 651.117,-2245.28"/>
<polygon fill="#000000" stroke="#000000" points="653.279,-2248.03 659.059,-2239.15 649.003,-2242.49 653.279,-2248.03"/>
</g>
<!-- sourcefile~fury_uom_symbol128.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge136" class="edge"><title>sourcefile~fury_uom_symbol128.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2302C584.429,-2286.62 603.916,-2303.98 675,-2302"/>
</g>
<!-- sourcefile~fury_uom_symbol128.f90&#45;&gt;sourcefile~fury_uom_reference128.f90 -->
<g id="edge140" class="edge"><title>sourcefile~fury_uom_symbol128.f90&#45;&gt;sourcefile~fury_uom_reference128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M372.534,-2326C382.928,-2321.95 394.076,-2317.17 404,-2312 421.052,-2303.11 422.828,-2296.65 440,-2288 447.461,-2284.24 455.575,-2280.75 463.618,-2277.62"/>
<polygon fill="#000000" stroke="#000000" points="464.851,-2280.89 472.984,-2274.1 462.392,-2274.34 464.851,-2280.89"/>
</g>
<!-- sourcefile~fury_uom_symbol128.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge138" class="edge"><title>sourcefile~fury_uom_symbol128.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M380.88,-2352.04C433.252,-2367.86 520.633,-2397.2 590,-2435 631.29,-2457.5 632.168,-2478.59 675,-2498"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2498C697.315,-2507.49 702.566,-2510.66 724,-2522 762.883,-2542.57 767.023,-2561.61 810,-2571"/>
</g>
<!-- sourcefile~fury_uom_symbol64.f90&#45;&gt;sourcefile~fury_uom64.f90 -->
<g id="edge148" class="edge"><title>sourcefile~fury_uom_symbol64.f90&#45;&gt;sourcefile~fury_uom64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M384.73,-2443.99C420.696,-2435 470.576,-2423.37 515,-2416"/>
</g>
<!-- sourcefile~fury_uom_symbol64.f90&#45;&gt;sourcefile~fury_uom_reference64.f90 -->
<g id="edge146" class="edge"><title>sourcefile~fury_uom_symbol64.f90&#45;&gt;sourcefile~fury_uom_reference64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M400.748,-2457C411.251,-2457 422.23,-2457 433.052,-2457"/>
<polygon fill="#000000" stroke="#000000" points="433.359,-2460.5 443.359,-2457 433.359,-2453.5 433.359,-2460.5"/>
</g>
<!-- sourcefile~fury_uom_symbol64.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge144" class="edge"><title>sourcefile~fury_uom_symbol64.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M361.193,-2470.11C411.366,-2494.72 525.025,-2548.04 626,-2578 705.728,-2601.65 727.484,-2601.66 810,-2612"/>
</g>
<!-- sourcefile~fury_uom_symbol64.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge150" class="edge"><title>sourcefile~fury_uom_symbol64.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M390.623,-2470.02C406.501,-2473.36 423.871,-2476.67 440,-2479 491.853,-2486.5 626.943,-2477.13 675,-2498"/>
</g>
<!-- sourcefile~fury_qreal64.f90&#45;&gt;sourcefile~fury_system_si64.f90 -->
<g id="edge154" class="edge"><title>sourcefile~fury_qreal64.f90&#45;&gt;sourcefile~fury_system_si64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-2337C1007.6,-2332.06 1046.45,-2331.56 1078.74,-2332.51"/>
<polygon fill="#000000" stroke="#000000" points="1078.86,-2336.02 1088.97,-2332.86 1079.1,-2329.02 1078.86,-2336.02"/>
</g>
<!-- sourcefile~fury_qreal64.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge158" class="edge"><title>sourcefile~fury_qreal64.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M857.323,-2342.19C889.988,-2342.96 934.333,-2342.52 973,-2337"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-2337C1060.61,-2324.5 1063.45,-2215.85 1148,-2242"/>
</g>
<!-- sourcefile~fury_qreal64.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge152" class="edge"><title>sourcefile~fury_qreal64.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M816.438,-2353.12C829.64,-2379.46 861.457,-2440.2 896,-2486 912.768,-2508.23 934.935,-2530.99 951.178,-2546.7"/>
<polygon fill="#000000" stroke="#000000" points="948.977,-2549.44 958.626,-2553.82 953.811,-2544.38 948.977,-2549.44"/>
</g>
<!-- sourcefile~fury_qreal64.f90&#45;&gt;sourcefile~fury_system_abstract64.f90 -->
<g id="edge156" class="edge"><title>sourcefile~fury_qreal64.f90&#45;&gt;sourcefile~fury_system_abstract64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M836.835,-2353.13C844.517,-2357.25 852.765,-2362.03 860,-2367 894.346,-2390.61 930.244,-2422.95 952.12,-2443.66"/>
<polygon fill="#000000" stroke="#000000" points="949.868,-2446.35 959.516,-2450.73 954.704,-2441.29 949.868,-2446.35"/>
</g>
<!-- sourcefile~fury_qreal128.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge166" class="edge"><title>sourcefile~fury_qreal128.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M860.326,-2141.32C892.555,-2140.04 935.261,-2139.15 973,-2141"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-2141C1078.54,-2146.19 1126.16,-2095.68 1210,-2160 1235.05,-2179.22 1258.24,-2270.59 1268.06,-2314"/>
<polygon fill="#000000" stroke="#000000" points="1264.68,-2314.92 1270.26,-2323.93 1271.51,-2313.41 1264.68,-2314.92"/>
</g>
<!-- sourcefile~fury_qreal128.f90&#45;&gt;sourcefile~fury_system_si128.f90 -->
<g id="edge164" class="edge"><title>sourcefile~fury_qreal128.f90&#45;&gt;sourcefile~fury_system_si128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-2141C1016.97,-2143.16 1065.62,-2155.39 1100.44,-2165.94"/>
<polygon fill="#000000" stroke="#000000" points="1099.75,-2169.38 1110.33,-2169 1101.82,-2162.7 1099.75,-2169.38"/>
</g>
<!-- sourcefile~fury_qreal128.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge160" class="edge"><title>sourcefile~fury_qreal128.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M823.494,-2157.09C835.224,-2169.33 851.614,-2188.74 860,-2209 907.482,-2323.71 842.598,-2373.93 896,-2486 907.619,-2510.39 929.373,-2532.2 946.802,-2547.03"/>
<polygon fill="#000000" stroke="#000000" points="945.001,-2550.08 954.948,-2553.73 949.448,-2544.68 945.001,-2550.08"/>
</g>
<!-- sourcefile~fury_qreal128.f90&#45;&gt;sourcefile~fury_system_abstract128.f90 -->
<g id="edge162" class="edge"><title>sourcefile~fury_qreal128.f90&#45;&gt;sourcefile~fury_system_abstract128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M860.235,-2155.71C874.968,-2159.15 891.308,-2162.96 906.871,-2166.58"/>
<polygon fill="#000000" stroke="#000000" points="906.428,-2170.07 916.962,-2168.94 908.017,-2163.26 906.428,-2170.07"/>
</g>
<!-- sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury_system_si32.f90 -->
<g id="edge168" class="edge"><title>sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury_system_si32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M720.594,-2773.59C746.747,-2777.32 780.204,-2782.03 810,-2786"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2786C881.81,-2795.57 901.229,-2795.86 973,-2786"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-2786C1034.12,-2777.6 1094.46,-2733.89 1125.82,-2707.77"/>
<polygon fill="#000000" stroke="#000000" points="1128.17,-2710.37 1133.52,-2701.22 1123.63,-2705.04 1128.17,-2710.37"/>
</g>
<!-- sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge172" class="edge"><title>sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-2786C1050.05,-2775.42 1091.88,-2839.85 1148,-2786"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1148,-2786C1179.46,-2755.82 1191.99,-2749.7 1210,-2710 1238.78,-2646.56 1263.12,-2432.1 1270.62,-2360.5"/>
<polygon fill="#000000" stroke="#000000" points="1274.13,-2360.58 1271.68,-2350.28 1267.17,-2359.86 1274.13,-2360.58"/>
</g>
<!-- sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge170" class="edge"><title>sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M690.822,-2753.99C707.325,-2740.87 734.325,-2720.66 760,-2707 780.988,-2695.83 788.716,-2698.59 810,-2688"/>
</g>
<!-- sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury_system_abstract32.f90 -->
<g id="edge176" class="edge"><title>sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury_system_abstract32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2786C848.106,-2791.08 890.159,-2801.79 922.006,-2810.99"/>
<polygon fill="#000000" stroke="#000000" points="921.388,-2814.45 931.969,-2813.91 923.36,-2807.74 921.388,-2814.45"/>
</g>
<!-- sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury_qreal32.f90 -->
<g id="edge174" class="edge"><title>sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury_qreal32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M720.705,-2754.13C731.247,-2751.17 742.583,-2747.98 753.522,-2744.9"/>
<polygon fill="#000000" stroke="#000000" points="754.745,-2748.19 763.423,-2742.11 752.848,-2741.45 754.745,-2748.19"/>
</g>
<!-- sourcefile~fury_system_abstract128.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge178" class="edge"><title>sourcefile~fury_system_abstract128.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1010.15,-2195.03C1053.31,-2210.12 1121.92,-2233.93 1148,-2242"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1148,-2242C1191.98,-2255.6 1232.34,-2292.61 1254.71,-2316.22"/>
<polygon fill="#000000" stroke="#000000" points="1252.23,-2318.69 1261.59,-2323.66 1257.37,-2313.94 1252.23,-2318.69"/>
</g>
<!-- sourcefile~fury_system_abstract128.f90&#45;&gt;sourcefile~fury_system_si128.f90 -->
<g id="edge180" class="edge"><title>sourcefile~fury_system_abstract128.f90&#45;&gt;sourcefile~fury_system_si128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1050.01,-2182C1058.55,-2182 1067.23,-2182 1075.71,-2182"/>
<polygon fill="#000000" stroke="#000000" points="1075.93,-2185.5 1085.93,-2182 1075.93,-2178.5 1075.93,-2185.5"/>
</g>
<!-- sourcefile~fury_uom_reference32.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge182" class="edge"><title>sourcefile~fury_uom_reference32.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2808C740.554,-2829.06 741.414,-2877.93 810,-2884"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2884C965.8,-2897.79 1035.14,-2894.29 1148,-2786"/>
</g>
<!-- sourcefile~fury_uom_reference32.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge188" class="edge"><title>sourcefile~fury_uom_reference32.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M556.099,-2753.9C567.284,-2749.88 579.269,-2745.15 590,-2740 629.93,-2720.85 631.392,-2695.72 675,-2688"/>
</g>
<!-- sourcefile~fury_uom_reference32.f90&#45;&gt;sourcefile~fury_system_abstract32.f90 -->
<g id="edge186" class="edge"><title>sourcefile~fury_uom_reference32.f90&#45;&gt;sourcefile~fury_system_abstract32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M572.869,-2780.05C603.483,-2787.41 641.557,-2797.25 675,-2808"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2808C733.427,-2826.77 748.632,-2836.61 810,-2837"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2837C835.541,-2837.16 863.292,-2835.97 888.534,-2834.36"/>
<polygon fill="#000000" stroke="#000000" points="889.068,-2837.83 898.812,-2833.67 888.6,-2830.85 889.068,-2837.83"/>
</g>
<!-- sourcefile~fury_uom_reference32.f90&#45;&gt;sourcefile~fury_uom32.f90 -->
<g id="edge184" class="edge"><title>sourcefile~fury_uom_reference32.f90&#45;&gt;sourcefile~fury_uom32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M586.576,-2767C597.435,-2767 608.502,-2767 618.967,-2767"/>
<polygon fill="#000000" stroke="#000000" points="619.201,-2770.5 629.201,-2767 619.201,-2763.5 619.201,-2770.5"/>
</g>
<!-- sourcefile~fury_qreal32.f90&#45;&gt;sourcefile~fury_system_si32.f90 -->
<g id="edge190" class="edge"><title>sourcefile~fury_qreal32.f90&#45;&gt;sourcefile~fury_system_si32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-2688C1007.17,-2680 1046.12,-2679.21 1078.6,-2680.77"/>
<polygon fill="#000000" stroke="#000000" points="1078.72,-2684.28 1088.9,-2681.35 1079.11,-2677.29 1078.72,-2684.28"/>
</g>
<!-- sourcefile~fury_qreal32.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge196" class="edge"><title>sourcefile~fury_qreal32.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M857.332,-2716.66C889.811,-2708.3 933.935,-2697.15 973,-2688"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-2688C1055.56,-2668.66 1071.81,-2649.21 1148,-2612"/>
</g>
<!-- sourcefile~fury_qreal32.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge192" class="edge"><title>sourcefile~fury_qreal32.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M838.688,-2715.91C845.99,-2711.95 853.58,-2707.24 860,-2702 901.452,-2668.17 939.051,-2617.48 958.685,-2588.81"/>
<polygon fill="#000000" stroke="#000000" points="961.719,-2590.57 964.41,-2580.32 955.916,-2586.65 961.719,-2590.57"/>
</g>
<!-- sourcefile~fury_qreal32.f90&#45;&gt;sourcefile~fury_system_abstract32.f90 -->
<g id="edge194" class="edge"><title>sourcefile~fury_qreal32.f90&#45;&gt;sourcefile~fury_system_abstract32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M825.48,-2742.28C848.097,-2761.61 888.328,-2795.67 896,-2800 902.766,-2803.82 910.168,-2807.24 917.621,-2810.26"/>
<polygon fill="#000000" stroke="#000000" points="916.456,-2813.56 927.046,-2813.87 918.959,-2807.02 916.456,-2813.56"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilestringifor_string_tf90AfferentGraph = svgPanZoom('#sourcefilestringifor_string_tf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="34pt"
 viewBox="0.00 0.00 188.00 34.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(1 1) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 185,-30 185,5 -4,5"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-26 2.84217e-14,-26 0,-1.24345e-14 66,-3.55271e-15 66,-26"/>
<text text-anchor="middle" x="33" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="180,-26 84,-26 84,-1.24345e-14 180,-3.55271e-15 180,-26"/>
<text text-anchor="middle" x="132" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which depends upon it. A file 
    is dependent upon another if the latter must be compiled before the former
    can be.
    </p>
    
                      </div>
                    </div>
                  </div>
                </div>
                
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/stringifor_string_t.html">stringifor_string_t</a>
      
    </div>
  </div>
</div>















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/stringifor_string_t.f90.html#src">stringifor_string_t.F90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!&lt; StringiFor, definition of `string` type.</span>
<a name="ln-2"></a><span class="k">module </span><span class="n">stringifor_string_t</span>
<a name="ln-3"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-4"></a><span class="c">!&lt; StringiFor, definition of `string` type.</span>
<a name="ln-5"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-6"></a><span class="k">use </span><span class="n">befor64</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">b64_decode</span><span class="p">,</span> <span class="n">b64_encode</span>
<a name="ln-7"></a><span class="k">use </span><span class="n">penf</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">I1P</span><span class="p">,</span> <span class="n">I2P</span><span class="p">,</span> <span class="n">I4P</span><span class="p">,</span> <span class="n">I8P</span><span class="p">,</span> <span class="n">R4P</span><span class="p">,</span> <span class="n">R8P</span><span class="p">,</span> <span class="n">R16P</span><span class="p">,</span> <span class="n">str</span>
<a name="ln-8"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-9"></a>
<a name="ln-10"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-11"></a><span class="k">implicit none</span>
<a name="ln-12"></a><span class="k">private</span>
<a name="ln-13"></a><span class="k">save</span>
<a name="ln-14"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">CK</span>
<a name="ln-15"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">sadjustl_character</span><span class="p">,</span> <span class="n">sadjustr_character</span><span class="p">,</span>                                 <span class="p">&amp;</span>
<a name="ln-16"></a>          <span class="n">sindex_string_string</span><span class="p">,</span> <span class="n">sindex_string_character</span><span class="p">,</span> <span class="n">sindex_character_string</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-17"></a>          <span class="n">slen</span><span class="p">,</span> <span class="n">slen_trim</span><span class="p">,</span>                                                        <span class="p">&amp;</span>
<a name="ln-18"></a>          <span class="n">srepeat_string_string</span><span class="p">,</span>                                                  <span class="p">&amp;</span>
<a name="ln-19"></a>          <span class="n">sscan_string_string</span><span class="p">,</span> <span class="n">sscan_string_character</span><span class="p">,</span> <span class="n">sscan_character_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-20"></a>          <span class="n">strim</span>
<a name="ln-21"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">string</span>
<a name="ln-22"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-23"></a>
<a name="ln-24"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-25"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">CK</span> <span class="o">=</span> <span class="nb">selected_char_kind</span><span class="p">(</span><span class="s1">&#39;DEFAULT&#39;</span><span class="p">)</span> <span class="c">!&lt; Default character kind.</span>
<a name="ln-26"></a>
<a name="ln-27"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">string</span>
<a name="ln-28"></a>  <span class="c">!&lt; OOP designed string class.</span>
<a name="ln-29"></a>  <span class="k">private</span>
<a name="ln-30"></a><span class="k">  </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">raw</span> <span class="c">!&lt; Raw data.</span>
<a name="ln-31"></a>  <span class="k">contains</span>
<a name="ln-32"></a>    <span class="c">! public methods</span>
<a name="ln-33"></a>    <span class="c">! builtins replacements</span>
<a name="ln-34"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">adjustl</span>  <span class="o">=&gt;</span> <span class="n">sadjustl</span>                 <span class="c">!&lt; Adjustl replacement.</span>
<a name="ln-35"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">adjustr</span>  <span class="o">=&gt;</span> <span class="n">sadjustr</span>                 <span class="c">!&lt; Adjustr replacement.</span>
<a name="ln-36"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">count</span>    <span class="o">=&gt;</span> <span class="n">scount</span>                   <span class="c">!&lt; Count replacement.</span>
<a name="ln-37"></a>    <span class="k">generic</span>               <span class="kd">::</span> <span class="nb">index</span>    <span class="o">=&gt;</span> <span class="n">sindex_string_string</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-38"></a>                                         <span class="n">sindex_string_character</span>  <span class="c">!&lt; Index replacement.</span>
<a name="ln-39"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">len</span>      <span class="o">=&gt;</span> <span class="n">slen</span>                     <span class="c">!&lt; Len replacement.</span>
<a name="ln-40"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">len_trim</span> <span class="o">=&gt;</span> <span class="n">slen_trim</span>                <span class="c">!&lt; Len_trim replacement.</span>
<a name="ln-41"></a>    <span class="k">generic</span>               <span class="kd">::</span> <span class="nb">repeat</span>   <span class="o">=&gt;</span> <span class="n">srepeat_string_string</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-42"></a>                                         <span class="n">srepeat_character_string</span> <span class="c">!&lt; Repeat replacement.</span>
<a name="ln-43"></a>    <span class="k">generic</span>               <span class="kd">::</span> <span class="nb">scan</span>     <span class="o">=&gt;</span> <span class="n">sscan_string_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-44"></a>                                         <span class="n">sscan_string_character</span>   <span class="c">!&lt; Scan replacement.</span>
<a name="ln-45"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">trim</span>     <span class="o">=&gt;</span> <span class="n">strim</span>                    <span class="c">!&lt; Trim replacement.</span>
<a name="ln-46"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">verify</span>   <span class="o">=&gt;</span> <span class="n">sverify</span>                  <span class="c">!&lt; Verify replacement.</span>
<a name="ln-47"></a>    <span class="c">! auxiliary methods</span>
<a name="ln-48"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">basedir</span>          <span class="c">!&lt; Return the base directory name of a string containing a file name.</span>
<a name="ln-49"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">basename</span>         <span class="c">!&lt; Return the base file name of a string containing a file name.</span>
<a name="ln-50"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">camelcase</span>        <span class="c">!&lt; Return a string with all words capitalized without spaces.</span>
<a name="ln-51"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">capitalize</span>       <span class="c">!&lt; Return a string with its first character capitalized and the rest lowercased.</span>
<a name="ln-52"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">chars</span>            <span class="c">!&lt; Return the raw characters data.</span>
<a name="ln-53"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="k">decode</span>           <span class="c">!&lt; Decode string.</span>
<a name="ln-54"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="k">encode</span>           <span class="c">!&lt; Encode string.</span>
<a name="ln-55"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">escape</span>           <span class="c">!&lt; Escape backslashes (or custom escape character).</span>
<a name="ln-56"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">extension</span>        <span class="c">!&lt; Return the extension of a string containing a file name.</span>
<a name="ln-57"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fill</span>             <span class="c">!&lt; Pad string on the left (or right) with zeros (or other char) to fill width.</span>
<a name="ln-58"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">free</span>             <span class="c">!&lt; Free dynamic memory.</span>
<a name="ln-59"></a>    <span class="k">generic</span>               <span class="kd">::</span> <span class="n">insert</span> <span class="o">=&gt;</span>      <span class="p">&amp;</span>
<a name="ln-60"></a>                             <span class="n">insert_string</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-61"></a>                             <span class="n">insert_character</span> <span class="c">!&lt; Insert substring into string at a specified position.</span>
<a name="ln-62"></a>    <span class="k">generic</span>               <span class="kd">::</span> <span class="n">join</span> <span class="o">=&gt;</span>       <span class="p">&amp;</span>
<a name="ln-63"></a>                             <span class="n">join_strings</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-64"></a>                             <span class="n">join_characters</span>  <span class="c">!&lt; Return a string that is a join of an array of strings or characters.</span>
<a name="ln-65"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lower</span>            <span class="c">!&lt; Return a string with all lowercase characters.</span>
<a name="ln-66"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">partition</span>        <span class="c">!&lt; Split string at separator and return the 3 parts (before, the separator and after).</span>
<a name="ln-67"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">read_file</span>        <span class="c">!&lt; Read a file a single string stream.</span>
<a name="ln-68"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">read_line</span>        <span class="c">!&lt; Read line (record) from a connected unit.</span>
<a name="ln-69"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">read_lines</span>       <span class="c">!&lt; Read (all) lines (records) from a connected unit as a single ascii stream.</span>
<a name="ln-70"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">replace</span>          <span class="c">!&lt; Return a string with all occurrences of substring old replaced by new.</span>
<a name="ln-71"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">reverse</span>          <span class="c">!&lt; Return a reversed string.</span>
<a name="ln-72"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">search</span>           <span class="c">!&lt; Search for *tagged* record into string.</span>
<a name="ln-73"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">slice</span>            <span class="c">!&lt; Return the raw characters data sliced.</span>
<a name="ln-74"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">snakecase</span>        <span class="c">!&lt; Return a string with all words lowercase separated by &quot;_&quot;.</span>
<a name="ln-75"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">split</span>            <span class="c">!&lt; Return a list of substring in the string, using sep as the delimiter string.</span>
<a name="ln-76"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">startcase</span>        <span class="c">!&lt; Return a string with all words capitalized, e.g. title case.</span>
<a name="ln-77"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">strip</span>            <span class="c">!&lt; Return a string with the leading and trailing characters removed.</span>
<a name="ln-78"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">swapcase</span>         <span class="c">!&lt; Return a string with uppercase chars converted to lowercase and vice versa.</span>
<a name="ln-79"></a>    <span class="k">generic</span>               <span class="kd">::</span> <span class="n">to_number</span> <span class="o">=&gt;</span>   <span class="p">&amp;</span>
<a name="ln-80"></a>                             <span class="n">to_integer_I1P</span><span class="p">,&amp;</span>
<a name="ln-81"></a>                             <span class="n">to_integer_I2P</span><span class="p">,&amp;</span>
<a name="ln-82"></a>                             <span class="n">to_integer_I4P</span><span class="p">,&amp;</span>
<a name="ln-83"></a>                             <span class="n">to_integer_I8P</span><span class="p">,&amp;</span>
<a name="ln-84"></a>                             <span class="n">to_real_R4P</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-85"></a><span class="cp">#ifdef r16p</span>
<a name="ln-86"></a>                             <span class="n">to_real_R8P</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-87"></a>                             <span class="n">to_real_R16P</span>     <span class="c">!&lt; Cast string to number.</span>
<a name="ln-88"></a><span class="cp">#else</span>
<a name="ln-89"></a>                             <span class="n">to_real_R8P</span>      <span class="c">!&lt; Cast string to number.</span>
<a name="ln-90"></a><span class="cp">#endif</span>
<a name="ln-91"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">unescape</span>         <span class="c">!&lt; Unescape double backslashes (or custom escaped character).</span>
<a name="ln-92"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">unique</span>           <span class="c">!&lt; Reduce to one (unique) multiple occurrences of a substring into a string.</span>
<a name="ln-93"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">upper</span>            <span class="c">!&lt; Return a string with all uppercase characters.</span>
<a name="ln-94"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">write_file</span>       <span class="c">!&lt; Write a single string stream into file.</span>
<a name="ln-95"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">write_line</span>       <span class="c">!&lt; Write line (record) to a connected unit.</span>
<a name="ln-96"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">write_lines</span>      <span class="c">!&lt; Write lines (records) to a connected unit.</span>
<a name="ln-97"></a>    <span class="c">! inquire methods</span>
<a name="ln-98"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">end_with</span>     <span class="c">!&lt; Return true if a string ends with a specified suffix.</span>
<a name="ln-99"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">is_allocated</span> <span class="c">!&lt; Return true if the string is allocated.</span>
<a name="ln-100"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">is_digit</span>     <span class="c">!&lt; Return true if all characters in the string are digits.</span>
<a name="ln-101"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">is_integer</span>   <span class="c">!&lt; Return true if the string contains an integer.</span>
<a name="ln-102"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">is_lower</span>     <span class="c">!&lt; Return true if all characters in the string are lowercase.</span>
<a name="ln-103"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">is_number</span>    <span class="c">!&lt; Return true if the string contains a number (real or integer).</span>
<a name="ln-104"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">is_real</span>      <span class="c">!&lt; Return true if the string contains an real.</span>
<a name="ln-105"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">is_upper</span>     <span class="c">!&lt; Return true if all characters in the string are uppercase.</span>
<a name="ln-106"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">start_with</span>   <span class="c">!&lt; Return true if a string starts with a specified prefix.</span>
<a name="ln-107"></a>    <span class="c">! operators</span>
<a name="ln-108"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">assignment</span><span class="p">(</span><span class="o">=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">string_assign_string</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-109"></a>                                <span class="n">string_assign_character</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-110"></a>                                <span class="n">string_assign_integer_I1P</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-111"></a>                                <span class="n">string_assign_integer_I2P</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-112"></a>                                <span class="n">string_assign_integer_I4P</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-113"></a>                                <span class="n">string_assign_integer_I8P</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-114"></a>                                <span class="n">string_assign_real_R4P</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-115"></a><span class="cp">#ifdef r16p</span>
<a name="ln-116"></a>                                <span class="n">string_assign_real_R8P</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-117"></a>                                <span class="n">string_assign_real_R16P</span>             <span class="c">!&lt; Assignment operator overloading.</span>
<a name="ln-118"></a><span class="cp">#else</span>
<a name="ln-119"></a>                                <span class="n">string_assign_real_R8P</span>              <span class="c">!&lt; Assignment operator overloading.</span>
<a name="ln-120"></a><span class="cp">#endif</span>
<a name="ln-121"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">//</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">string_concat_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-122"></a>                               <span class="n">string_concat_character</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-123"></a>                               <span class="n">character_concat_string</span>              <span class="c">!&lt; Concatenation operator overloading.</span>
<a name="ln-124"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(.</span><span class="n">cat</span><span class="p">.)</span> <span class="o">=&gt;</span> <span class="n">string_concat_string_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-125"></a>                                  <span class="n">string_concat_character_string</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-126"></a>                                  <span class="n">character_concat_string_string</span>    <span class="c">!&lt; Concatenation operator (string output) overloading.</span>
<a name="ln-127"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">==</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">string_eq_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-128"></a>                               <span class="n">string_eq_character</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-129"></a>                               <span class="n">character_eq_string</span>                  <span class="c">!&lt; Equal operator overloading.</span>
<a name="ln-130"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">/=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">string_ne_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-131"></a>                               <span class="n">string_ne_character</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-132"></a>                               <span class="n">character_ne_string</span>                  <span class="c">!&lt; Not equal operator overloading.</span>
<a name="ln-133"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">&lt;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">string_lt_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-134"></a>                              <span class="n">string_lt_character</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-135"></a>                              <span class="n">character_lt_string</span>                   <span class="c">!&lt; Lower than operator overloading.</span>
<a name="ln-136"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">&lt;=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">string_le_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-137"></a>                               <span class="n">string_le_character</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-138"></a>                               <span class="n">character_le_string</span>                  <span class="c">!&lt; Lower equal than operator overloading.</span>
<a name="ln-139"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">&gt;=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">string_ge_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-140"></a>                               <span class="n">string_ge_character</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-141"></a>                               <span class="n">character_ge_string</span>                  <span class="c">!&lt; Greater equal than operator overloading.</span>
<a name="ln-142"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">string_gt_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-143"></a>                              <span class="n">string_gt_character</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-144"></a>                              <span class="n">character_gt_string</span>                   <span class="c">!&lt; Greater than operator overloading.</span>
<a name="ln-145"></a>    <span class="c">! IO</span>
<a name="ln-146"></a><span class="cp">#ifndef __GFORTRAN__</span>
<a name="ln-147"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="k">read</span><span class="p">(</span><span class="n">formatted</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">read_formatted</span>       <span class="c">!&lt; Formatted input.</span>
<a name="ln-148"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="k">write</span><span class="p">(</span><span class="n">formatted</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">write_formatted</span>     <span class="c">!&lt; Formatted output.</span>
<a name="ln-149"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="k">read</span><span class="p">(</span><span class="n">unformatted</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">read_unformatted</span>   <span class="c">!&lt; Unformatted input.</span>
<a name="ln-150"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="k">write</span><span class="p">(</span><span class="n">unformatted</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">write_unformatted</span> <span class="c">!&lt; Unformatted output.</span>
<a name="ln-151"></a><span class="cp">#endif</span>
<a name="ln-152"></a>    <span class="c">! private methods</span>
<a name="ln-153"></a>    <span class="c">! builtins replacements</span>
<a name="ln-154"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sindex_string_string</span>     <span class="c">!&lt; Index replacement.</span>
<a name="ln-155"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sindex_string_character</span>  <span class="c">!&lt; Index replacement.</span>
<a name="ln-156"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">srepeat_string_string</span>    <span class="c">!&lt; Repeat replacement.</span>
<a name="ln-157"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">srepeat_character_string</span> <span class="c">!&lt; Repeat replacement.</span>
<a name="ln-158"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sscan_string_string</span>      <span class="c">!&lt; Scan replacement.</span>
<a name="ln-159"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sscan_string_character</span>   <span class="c">!&lt; Scan replacement.</span>
<a name="ln-160"></a>    <span class="c">! auxiliary methods</span>
<a name="ln-161"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">insert_string</span>    <span class="c">!&lt; Insert substring into string at a specified position.</span>
<a name="ln-162"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">insert_character</span> <span class="c">!&lt; Insert substring into string at a specified position.</span>
<a name="ln-163"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">join_strings</span>     <span class="c">!&lt; Return join string of an array of strings.</span>
<a name="ln-164"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">join_characters</span>  <span class="c">!&lt; Return join string of an array of characters.</span>
<a name="ln-165"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">to_integer_I1P</span>   <span class="c">!&lt; Cast string to integer.</span>
<a name="ln-166"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">to_integer_I2P</span>   <span class="c">!&lt; Cast string to integer.</span>
<a name="ln-167"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">to_integer_I4P</span>   <span class="c">!&lt; Cast string to integer.</span>
<a name="ln-168"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">to_integer_I8P</span>   <span class="c">!&lt; Cast string to integer.</span>
<a name="ln-169"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">to_real_R4P</span>      <span class="c">!&lt; Cast string to real.</span>
<a name="ln-170"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">to_real_R8P</span>      <span class="c">!&lt; Cast string to real.</span>
<a name="ln-171"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">to_real_R16P</span>     <span class="c">!&lt; Cast string to real.</span>
<a name="ln-172"></a>    <span class="c">! assignments</span>
<a name="ln-173"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_string</span>      <span class="c">!&lt; Assignment operator from string input.</span>
<a name="ln-174"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_character</span>   <span class="c">!&lt; Assignment operator from character input.</span>
<a name="ln-175"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_integer_I1P</span> <span class="c">!&lt; Assignment operator from integer input.</span>
<a name="ln-176"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_integer_I2P</span> <span class="c">!&lt; Assignment operator from integer input.</span>
<a name="ln-177"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_integer_I4P</span> <span class="c">!&lt; Assignment operator from integer input.</span>
<a name="ln-178"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_integer_I8P</span> <span class="c">!&lt; Assignment operator from integer input.</span>
<a name="ln-179"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_real_R4P</span>    <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-180"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_real_R8P</span>    <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-181"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_real_R16P</span>   <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-182"></a>    <span class="c">! concatenation operators</span>
<a name="ln-183"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_concat_string</span>           <span class="c">!&lt; Concatenation with string.</span>
<a name="ln-184"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_concat_character</span>        <span class="c">!&lt; Concatenation with character.</span>
<a name="ln-185"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">character_concat_string</span>        <span class="c">!&lt; Concatenation with character (inverted).</span>
<a name="ln-186"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_concat_string_string</span>    <span class="c">!&lt; Concatenation with string (string output).</span>
<a name="ln-187"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_concat_character_string</span> <span class="c">!&lt; Concatenation with character (string output).</span>
<a name="ln-188"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">character_concat_string_string</span> <span class="c">!&lt; Concatenation with character (inverted, string output).</span>
<a name="ln-189"></a>    <span class="c">! logical operators</span>
<a name="ln-190"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_eq_string</span>    <span class="c">!&lt; Equal to string logical operator.</span>
<a name="ln-191"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_eq_character</span> <span class="c">!&lt; Equal to character logical operator.</span>
<a name="ln-192"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">character_eq_string</span> <span class="c">!&lt; Equal to character (inverted) logical operator.</span>
<a name="ln-193"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_ne_string</span>    <span class="c">!&lt; Not equal to string logical operator.</span>
<a name="ln-194"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_ne_character</span> <span class="c">!&lt; Not equal to character logical operator.</span>
<a name="ln-195"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">character_ne_string</span> <span class="c">!&lt; Not equal to character (inverted) logical operator.</span>
<a name="ln-196"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_lt_string</span>    <span class="c">!&lt; Lower than to string logical operator.</span>
<a name="ln-197"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_lt_character</span> <span class="c">!&lt; Lower than to character logical operator.</span>
<a name="ln-198"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">character_lt_string</span> <span class="c">!&lt; Lower than to character (inverted) logical operator.</span>
<a name="ln-199"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_le_string</span>    <span class="c">!&lt; Lower equal than to string logical operator.</span>
<a name="ln-200"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_le_character</span> <span class="c">!&lt; Lower equal than to character logical operator.</span>
<a name="ln-201"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">character_le_string</span> <span class="c">!&lt; Lower equal than to character (inverted) logical operator.</span>
<a name="ln-202"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_ge_string</span>    <span class="c">!&lt; Greater equal than to string logical operator.</span>
<a name="ln-203"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_ge_character</span> <span class="c">!&lt; Greater equal than to character logical operator.</span>
<a name="ln-204"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">character_ge_string</span> <span class="c">!&lt; Greater equal than to character (inverted) logical operator.</span>
<a name="ln-205"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_gt_string</span>    <span class="c">!&lt; Greater than to string logical operator.</span>
<a name="ln-206"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_gt_character</span> <span class="c">!&lt; Greater than to character logical operator.</span>
<a name="ln-207"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">character_gt_string</span> <span class="c">!&lt; Greater than to character (inverted) logical operator.</span>
<a name="ln-208"></a>    <span class="c">! IO</span>
<a name="ln-209"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">dtv</span><span class="p">)</span> <span class="kd">::</span> <span class="n">read_formatted</span>                <span class="c">!&lt; Formatted input.</span>
<a name="ln-210"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">dtv</span><span class="p">)</span> <span class="kd">::</span> <span class="n">read_delimited</span>                <span class="c">!&lt; Read a delimited input.</span>
<a name="ln-211"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">dtv</span><span class="p">)</span> <span class="kd">::</span> <span class="n">read_undelimited</span>              <span class="c">!&lt; Read an undelimited input.</span>
<a name="ln-212"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">dtv</span><span class="p">)</span> <span class="kd">::</span> <span class="n">read_undelimited_listdirected</span> <span class="c">!&lt; Read an undelimited list directed input.</span>
<a name="ln-213"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">dtv</span><span class="p">)</span> <span class="kd">::</span> <span class="n">write_formatted</span>               <span class="c">!&lt; Formatted output.</span>
<a name="ln-214"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">dtv</span><span class="p">)</span> <span class="kd">::</span> <span class="n">read_unformatted</span>              <span class="c">!&lt; Unformatted input.</span>
<a name="ln-215"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">dtv</span><span class="p">)</span> <span class="kd">::</span> <span class="n">write_unformatted</span>             <span class="c">!&lt; Unformatted output.</span>
<a name="ln-216"></a>    <span class="c">! miscellanea</span>
<a name="ln-217"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">replace_one_occurrence</span> <span class="c">!&lt; Replace the first occurrence of substring old by new.</span>
<a name="ln-218"></a><span class="n">endtype</span> <span class="n">string</span>
<a name="ln-219"></a>
<a name="ln-220"></a><span class="c">! internal parameters</span>
<a name="ln-221"></a><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">26</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">UPPER_ALPHABET</span> <span class="o">=</span> <span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span> <span class="c">!&lt; Upper case alphabet.</span>
<a name="ln-222"></a><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">26</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LOWER_ALPHABET</span> <span class="o">=</span> <span class="s1">&#39;abcdefghijklmnopqrstuvwxyz&#39;</span> <span class="c">!&lt; Lower case alphabet.</span>
<a name="ln-223"></a><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>  <span class="k">parameter</span> <span class="kd">::</span> <span class="n">SPACE</span>          <span class="o">=</span> <span class="s1">&#39; &#39;</span>                          <span class="c">!&lt; Space character.</span>
<a name="ln-224"></a><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>  <span class="k">parameter</span> <span class="kd">::</span> <span class="n">TAB</span>            <span class="o">=</span> <span class="nb">achar</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>                     <span class="c">!&lt; Tab character.</span>
<a name="ln-225"></a><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>  <span class="k">parameter</span> <span class="kd">::</span> <span class="n">UIX_DIR_SEP</span>    <span class="o">=</span> <span class="nb">char</span><span class="p">(</span><span class="mi">47</span><span class="p">)</span>                     <span class="c">!&lt; Unix/Linux directories separator (/).</span>
<a name="ln-226"></a><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>  <span class="k">parameter</span> <span class="kd">::</span> <span class="n">BACKSLASH</span>      <span class="o">=</span> <span class="nb">char</span><span class="p">(</span><span class="mi">92</span><span class="p">)</span>                     <span class="c">!&lt; Backslash character.</span>
<a name="ln-227"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-228"></a><span class="k">contains</span>
<a name="ln-229"></a>  <span class="c">! public methods</span>
<a name="ln-230"></a>
<a name="ln-231"></a>  <span class="c">! builtins replacements</span>
<a name="ln-232"></a>  <span class="k">elemental function </span><span class="n">sadjustl</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">adjusted</span><span class="p">)</span>
<a name="ln-233"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-234"></a>  <span class="c">!&lt; Left adjust a string by removing leading spaces.</span>
<a name="ln-235"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-236"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-237"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">adjusted</span> <span class="c">!&lt; Adjusted string.</span>
<a name="ln-238"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-239"></a>
<a name="ln-240"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-241"></a>  <span class="n">adjusted</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-242"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">adjusted</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">adjusted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">adjustl</span><span class="p">(</span><span class="n">adjusted</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-243"></a>  <span class="k">return</span>
<a name="ln-244"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-245"></a>  <span class="n">endfunction</span> <span class="n">sadjustl</span>
<a name="ln-246"></a>
<a name="ln-247"></a>  <span class="k">pure function </span><span class="n">sadjustl_character</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">adjusted</span><span class="p">)</span>
<a name="ln-248"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-249"></a>  <span class="c">!&lt; Left adjust a string by removing leading spaces (character output).</span>
<a name="ln-250"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-251"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-252"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="kd">::</span> <span class="n">adjusted</span> <span class="c">!&lt; Adjusted string.</span>
<a name="ln-253"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-254"></a>
<a name="ln-255"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-256"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">adjusted</span> <span class="o">=</span> <span class="nb">adjustl</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-257"></a>  <span class="k">return</span>
<a name="ln-258"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-259"></a>  <span class="n">endfunction</span> <span class="n">sadjustl_character</span>
<a name="ln-260"></a>
<a name="ln-261"></a>  <span class="k">elemental function </span><span class="n">sadjustr</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">adjusted</span><span class="p">)</span>
<a name="ln-262"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-263"></a>  <span class="c">!&lt; Right adjust a string by removing leading spaces.</span>
<a name="ln-264"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-265"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-266"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">adjusted</span> <span class="c">!&lt; Adjusted string.</span>
<a name="ln-267"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-268"></a>
<a name="ln-269"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-270"></a>  <span class="n">adjusted</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-271"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">adjusted</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">adjusted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">adjustr</span><span class="p">(</span><span class="n">adjusted</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-272"></a>  <span class="k">return</span>
<a name="ln-273"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-274"></a>  <span class="n">endfunction</span> <span class="n">sadjustr</span>
<a name="ln-275"></a>
<a name="ln-276"></a>  <span class="k">pure function </span><span class="n">sadjustr_character</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">adjusted</span><span class="p">)</span>
<a name="ln-277"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-278"></a>  <span class="c">!&lt; Right adjust a string by removing leading spaces (character output).</span>
<a name="ln-279"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-280"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-281"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="kd">::</span> <span class="n">adjusted</span> <span class="c">!&lt; Adjusted string.</span>
<a name="ln-282"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-283"></a>
<a name="ln-284"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-285"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">adjusted</span> <span class="o">=</span> <span class="nb">adjustr</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-286"></a>  <span class="k">return</span>
<a name="ln-287"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-288"></a>  <span class="n">endfunction</span> <span class="n">sadjustr_character</span>
<a name="ln-289"></a>
<a name="ln-290"></a>  <span class="k">elemental function </span><span class="n">scount</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">substring</span><span class="p">,</span> <span class="n">ignore_isolated</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">No</span><span class="p">)</span>
<a name="ln-291"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-292"></a>  <span class="c">!&lt; Count the number of occurences of a substring into a string.</span>
<a name="ln-293"></a>  <span class="c">!&lt;</span>
<a name="ln-294"></a>  <span class="c">!&lt; @note If `ignore_isolated` is set to true the eventual &quot;isolated&quot; occurences are ignored: an isolated occurrences are those</span>
<a name="ln-295"></a>  <span class="c">!&lt; occurrences happening at the start of string (thus not having a left companion) or at the end of the string (thus not having a</span>
<a name="ln-296"></a>  <span class="c">!&lt; right companion).</span>
<a name="ln-297"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-298"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">self</span>             <span class="c">!&lt; The string.</span>
<a name="ln-299"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">substring</span>        <span class="c">!&lt; Substring.</span>
<a name="ln-300"></a>  <span class="kt">logical</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>    <span class="kd">::</span> <span class="n">ignore_isolated</span>  <span class="c">!&lt; Ignore &quot;isolated&quot; occurrences.</span>
<a name="ln-301"></a>  <span class="kt">integer</span>                                <span class="kd">::</span> <span class="n">No</span>               <span class="c">!&lt; Number of occurrences.</span>
<a name="ln-302"></a>  <span class="kt">logical</span>                                <span class="kd">::</span> <span class="n">ignore_isolated_</span> <span class="c">!&lt; Ignore &quot;isolated&quot; occurrences, local variable.</span>
<a name="ln-303"></a>  <span class="kt">integer</span>                                <span class="kd">::</span> <span class="n">c1</span>               <span class="c">!&lt; Counter.</span>
<a name="ln-304"></a>  <span class="kt">integer</span>                                <span class="kd">::</span> <span class="n">c2</span>               <span class="c">!&lt; Counter.</span>
<a name="ln-305"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-306"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">temporary</span>        <span class="c">!&lt; Temporary storage, workaround for GNU bug.</span>
<a name="ln-307"></a><span class="cp">#endif</span>
<a name="ln-308"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-309"></a>
<a name="ln-310"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-311"></a>  <span class="n">No</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-312"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-313"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">substring</span><span class="p">)</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">return</span>
<a name="ln-314"></a><span class="k">    </span><span class="n">ignore_isolated_</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">ignore_isolated</span><span class="p">))</span> <span class="n">ignore_isolated_</span> <span class="o">=</span> <span class="n">ignore_isolated</span>
<a name="ln-315"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-316"></a>    <span class="n">temporary</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-317"></a><span class="cp">#endif</span>
<a name="ln-318"></a>    <span class="n">c1</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-319"></a>    <span class="k">do</span>
<a name="ln-320"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-321"></a>      <span class="n">c2</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">temporary</span><span class="p">(</span><span class="n">c1</span><span class="p">:),</span> <span class="n">substring</span><span class="o">=</span><span class="n">substring</span><span class="p">)</span>
<a name="ln-322"></a><span class="cp">#else</span>
<a name="ln-323"></a>      <span class="n">c2</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c1</span><span class="p">:),</span> <span class="n">substring</span><span class="o">=</span><span class="n">substring</span><span class="p">)</span>
<a name="ln-324"></a><span class="cp">#endif</span>
<a name="ln-325"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">c2</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-326"></a><span class="k">      if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">ignore_isolated_</span><span class="p">.</span><span class="nb">and</span><span class="p">.(</span><span class="n">c1</span><span class="o">==</span><span class="mf">1.</span><span class="nb">or</span><span class="p">.</span><span class="n">c1</span><span class="o">+</span><span class="n">c2</span><span class="o">-</span><span class="mi">1</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">substring</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span> <span class="k">then</span>
<a name="ln-327"></a><span class="k">        </span><span class="n">No</span> <span class="o">=</span> <span class="n">No</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-328"></a>      <span class="n">endif</span>
<a name="ln-329"></a>      <span class="n">c1</span> <span class="o">=</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">substring</span><span class="p">)</span>
<a name="ln-330"></a>    <span class="n">enddo</span>
<a name="ln-331"></a>  <span class="n">endif</span>
<a name="ln-332"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-333"></a>  <span class="n">endfunction</span> <span class="n">scount</span>
<a name="ln-334"></a>
<a name="ln-335"></a>  <span class="k">elemental function </span><span class="n">sindex_string_string</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">substring</span><span class="p">,</span> <span class="n">back</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-336"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-337"></a>  <span class="c">!&lt; Return the position of the start of the first occurrence of string `substring` as a substring in `string`, counting from one.</span>
<a name="ln-338"></a>  <span class="c">!&lt; If `substring` is not present in `string`, zero is returned. If the back argument is present and true, the return value is</span>
<a name="ln-339"></a>  <span class="c">!&lt; the start of the last occurrence rather than the first.</span>
<a name="ln-340"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-341"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-342"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">substring</span> <span class="c">!&lt; Searched substring.</span>
<a name="ln-343"></a>  <span class="kt">logical</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">back</span>      <span class="c">!&lt; Start of the last occurrence rather than the first.</span>
<a name="ln-344"></a>  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">i</span>         <span class="c">!&lt; Result of the search.</span>
<a name="ln-345"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-346"></a>
<a name="ln-347"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-348"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-349"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">substring</span><span class="o">=</span><span class="n">substring</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="n">back</span><span class="p">)</span>
<a name="ln-350"></a>  <span class="k">else</span>
<a name="ln-351"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-352"></a>  <span class="n">endif</span>
<a name="ln-353"></a>  <span class="k">return</span>
<a name="ln-354"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-355"></a>  <span class="n">endfunction</span> <span class="n">sindex_string_string</span>
<a name="ln-356"></a>
<a name="ln-357"></a>  <span class="k">elemental function </span><span class="n">sindex_string_character</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">substring</span><span class="p">,</span> <span class="n">back</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-358"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-359"></a>  <span class="c">!&lt; Return the position of the start of the first occurrence of string `substring` as a substring in `string`, counting from one.</span>
<a name="ln-360"></a>  <span class="c">!&lt; If `substring` is not present in `string`, zero is returned. If the back argument is present and true, the return value is</span>
<a name="ln-361"></a>  <span class="c">!&lt; the start of the last occurrence rather than the first.</span>
<a name="ln-362"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-363"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-364"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">substring</span> <span class="c">!&lt; Searched substring.</span>
<a name="ln-365"></a>  <span class="kt">logical</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">back</span>      <span class="c">!&lt; Start of the last occurrence rather than the first.</span>
<a name="ln-366"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">i</span>         <span class="c">!&lt; Result of the search.</span>
<a name="ln-367"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-368"></a>
<a name="ln-369"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-370"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-371"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">substring</span><span class="o">=</span><span class="n">substring</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="n">back</span><span class="p">)</span>
<a name="ln-372"></a>  <span class="k">else</span>
<a name="ln-373"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-374"></a>  <span class="n">endif</span>
<a name="ln-375"></a>  <span class="k">return</span>
<a name="ln-376"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-377"></a>  <span class="n">endfunction</span> <span class="n">sindex_string_character</span>
<a name="ln-378"></a>
<a name="ln-379"></a>  <span class="k">elemental function </span><span class="n">sindex_character_string</span><span class="p">(</span><span class="n">string_</span><span class="p">,</span> <span class="n">substring</span><span class="p">,</span> <span class="n">back</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-380"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-381"></a>  <span class="c">!&lt; Return the position of the start of the first occurrence of string `substring` as a substring in `string`, counting from one.</span>
<a name="ln-382"></a>  <span class="c">!&lt; If `substring` is not present in `string`, zero is returned. If the back argument is present and true, the return value is</span>
<a name="ln-383"></a>  <span class="c">!&lt; the start of the last occurrence rather than the first.</span>
<a name="ln-384"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-385"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">string_</span>   <span class="c">!&lt; The string.</span>
<a name="ln-386"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>              <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">substring</span> <span class="c">!&lt; Searched substring.</span>
<a name="ln-387"></a>  <span class="kt">logical</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">back</span>      <span class="c">!&lt; Start of the last occurrence rather than the first.</span>
<a name="ln-388"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">i</span>         <span class="c">!&lt; Result of the search.</span>
<a name="ln-389"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-390"></a>
<a name="ln-391"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-392"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">substring</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-393"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">string_</span><span class="p">,</span> <span class="n">substring</span><span class="o">=</span><span class="n">substring</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="n">back</span><span class="p">)</span>
<a name="ln-394"></a>  <span class="k">else</span>
<a name="ln-395"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-396"></a>  <span class="n">endif</span>
<a name="ln-397"></a>  <span class="k">return</span>
<a name="ln-398"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-399"></a>  <span class="n">endfunction</span> <span class="n">sindex_character_string</span>
<a name="ln-400"></a>
<a name="ln-401"></a>  <span class="k">elemental function </span><span class="n">slen</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<a name="ln-402"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-403"></a>  <span class="c">!&lt; Return the length of a string.</span>
<a name="ln-404"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-405"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span> <span class="c">!&lt; The string.</span>
<a name="ln-406"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">l</span>    <span class="c">!&lt; String length.</span>
<a name="ln-407"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-408"></a>
<a name="ln-409"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-410"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-411"></a><span class="k">    </span><span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-412"></a>  <span class="k">else</span>
<a name="ln-413"></a><span class="k">    </span><span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-414"></a>  <span class="n">endif</span>
<a name="ln-415"></a>  <span class="k">return</span>
<a name="ln-416"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-417"></a>  <span class="n">endfunction</span> <span class="n">slen</span>
<a name="ln-418"></a>
<a name="ln-419"></a>  <span class="k">elemental function </span><span class="n">slen_trim</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<a name="ln-420"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-421"></a>  <span class="c">!&lt; Return the length of a string, ignoring any trailing blanks.</span>
<a name="ln-422"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-423"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span> <span class="c">!&lt; The string.</span>
<a name="ln-424"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">l</span>    <span class="c">!&lt; String length.</span>
<a name="ln-425"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-426"></a>
<a name="ln-427"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-428"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-429"></a><span class="k">    </span><span class="n">l</span> <span class="o">=</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-430"></a>  <span class="k">else</span>
<a name="ln-431"></a><span class="k">    </span><span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-432"></a>  <span class="n">endif</span>
<a name="ln-433"></a>  <span class="k">return</span>
<a name="ln-434"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-435"></a>  <span class="n">endfunction</span> <span class="n">slen_trim</span>
<a name="ln-436"></a>
<a name="ln-437"></a>  <span class="k">elemental function </span><span class="n">srepeat_string_string</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">ncopies</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">repeated</span><span class="p">)</span>
<a name="ln-438"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-439"></a>  <span class="c">!&lt; Concatenates several copies of an input string.</span>
<a name="ln-440"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-441"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; String to be repeated.</span>
<a name="ln-442"></a>  <span class="kt">integer</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ncopies</span>  <span class="c">!&lt; Number of string copies.</span>
<a name="ln-443"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">repeated</span> <span class="c">!&lt; Repeated string.</span>
<a name="ln-444"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-445"></a>
<a name="ln-446"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-447"></a>  <span class="n">repeated</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">ncopies</span><span class="o">=</span><span class="n">ncopies</span><span class="p">)</span>
<a name="ln-448"></a>  <span class="k">return</span>
<a name="ln-449"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-450"></a>  <span class="n">endfunction</span> <span class="n">srepeat_string_string</span>
<a name="ln-451"></a>
<a name="ln-452"></a>  <span class="k">elemental function </span><span class="n">srepeat_character_string</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">rstring</span><span class="p">,</span> <span class="n">ncopies</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">repeated</span><span class="p">)</span>
<a name="ln-453"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-454"></a>  <span class="c">!&lt; Concatenates several copies of an input string.</span>
<a name="ln-455"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-456"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; String to be repeated.</span>
<a name="ln-457"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rstring</span>  <span class="c">!&lt; String to be repeated.</span>
<a name="ln-458"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ncopies</span>  <span class="c">!&lt; Number of string copies.</span>
<a name="ln-459"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">repeated</span> <span class="c">!&lt; Repeated string.</span>
<a name="ln-460"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-461"></a>
<a name="ln-462"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-463"></a>  <span class="n">repeated</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">rstring</span><span class="p">,</span> <span class="n">ncopies</span><span class="o">=</span><span class="n">ncopies</span><span class="p">)</span>
<a name="ln-464"></a>  <span class="k">return</span>
<a name="ln-465"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-466"></a>  <span class="n">endfunction</span> <span class="n">srepeat_character_string</span>
<a name="ln-467"></a>
<a name="ln-468"></a>  <span class="k">elemental function </span><span class="n">sscan_string_string</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">set</span><span class="p">,</span> <span class="n">back</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-469"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-470"></a>  <span class="c">!&lt; Return the leftmost (if `back` is either absent or equals false, otherwise the rightmost) character of string that is in `set`.</span>
<a name="ln-471"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-472"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>  <span class="c">!&lt; The string.</span>
<a name="ln-473"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">set</span>   <span class="c">!&lt; Searched set.</span>
<a name="ln-474"></a>  <span class="kt">logical</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">back</span>  <span class="c">!&lt; Start of the last occurrence rather than the first.</span>
<a name="ln-475"></a>  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">i</span>     <span class="c">!&lt; Result of the search.</span>
<a name="ln-476"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-477"></a>
<a name="ln-478"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-479"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">set</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-480"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="nb">scan</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">set</span><span class="o">=</span><span class="n">set</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="n">back</span><span class="p">)</span>
<a name="ln-481"></a>  <span class="k">else</span>
<a name="ln-482"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-483"></a>  <span class="n">endif</span>
<a name="ln-484"></a>  <span class="k">return</span>
<a name="ln-485"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-486"></a>  <span class="n">endfunction</span> <span class="n">sscan_string_string</span>
<a name="ln-487"></a>
<a name="ln-488"></a>  <span class="k">elemental function </span><span class="n">sscan_string_character</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">set</span><span class="p">,</span> <span class="n">back</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-489"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-490"></a>  <span class="c">!&lt; Return the leftmost (if `back` is either absent or equals false, otherwise the rightmost) character of string that is in `set`.</span>
<a name="ln-491"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-492"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>  <span class="c">!&lt; The string.</span>
<a name="ln-493"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">set</span>   <span class="c">!&lt; Searched set.</span>
<a name="ln-494"></a>  <span class="kt">logical</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">back</span>  <span class="c">!&lt; Start of the last occurrence rather than the first.</span>
<a name="ln-495"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">i</span>     <span class="c">!&lt; Result of the search.</span>
<a name="ln-496"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-497"></a>
<a name="ln-498"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-499"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-500"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="nb">scan</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">set</span><span class="o">=</span><span class="n">set</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="n">back</span><span class="p">)</span>
<a name="ln-501"></a>  <span class="k">else</span>
<a name="ln-502"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-503"></a>  <span class="n">endif</span>
<a name="ln-504"></a>  <span class="k">return</span>
<a name="ln-505"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-506"></a>  <span class="n">endfunction</span> <span class="n">sscan_string_character</span>
<a name="ln-507"></a>
<a name="ln-508"></a>  <span class="k">elemental function </span><span class="n">sscan_character_string</span><span class="p">(</span><span class="n">sstring</span><span class="p">,</span> <span class="n">set</span><span class="p">,</span> <span class="n">back</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-509"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-510"></a>  <span class="c">!&lt; Return the leftmost (if `back` is either absent or equals false, otherwise the rightmost) character of string that is in `set`.</span>
<a name="ln-511"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-512"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">sstring</span> <span class="c">!&lt; The string.</span>
<a name="ln-513"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>              <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">set</span>     <span class="c">!&lt; Searched set.</span>
<a name="ln-514"></a>  <span class="kt">logical</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">back</span>    <span class="c">!&lt; Start of the last occurrence rather than the first.</span>
<a name="ln-515"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">i</span>       <span class="c">!&lt; Result of the search.</span>
<a name="ln-516"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-517"></a>
<a name="ln-518"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-519"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">set</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-520"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="nb">scan</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">sstring</span><span class="p">,</span> <span class="n">set</span><span class="o">=</span><span class="n">set</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="n">back</span><span class="p">)</span>
<a name="ln-521"></a>  <span class="k">else</span>
<a name="ln-522"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-523"></a>  <span class="n">endif</span>
<a name="ln-524"></a>  <span class="k">return</span>
<a name="ln-525"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-526"></a>  <span class="n">endfunction</span> <span class="n">sscan_character_string</span>
<a name="ln-527"></a>
<a name="ln-528"></a>  <span class="k">elemental function </span><span class="n">strim</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">trimmed</span><span class="p">)</span>
<a name="ln-529"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-530"></a>  <span class="c">!&lt; Remove leading spaces.</span>
<a name="ln-531"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-532"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">!&lt; The string.</span>
<a name="ln-533"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">trimmed</span> <span class="c">!&lt; Trimmed string.</span>
<a name="ln-534"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-535"></a>
<a name="ln-536"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-537"></a>  <span class="n">trimmed</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-538"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">trimmed</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">trimmed</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">trimmed</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-539"></a>  <span class="k">return</span>
<a name="ln-540"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-541"></a>  <span class="n">endfunction</span> <span class="n">strim</span>
<a name="ln-542"></a>
<a name="ln-543"></a>  <span class="k">elemental function </span><span class="n">sverify</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">set</span><span class="p">,</span> <span class="n">back</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-544"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-545"></a>  <span class="c">!&lt; Return the leftmost (if `back` is either absent or equals false, otherwise the rightmost) character of string that is not</span>
<a name="ln-546"></a>  <span class="c">!&lt; in `set`. If all characters of `string` are found in `set`, the result is zero.</span>
<a name="ln-547"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-548"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>  <span class="c">!&lt; The string.</span>
<a name="ln-549"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">set</span>   <span class="c">!&lt; Searched set.</span>
<a name="ln-550"></a>  <span class="kt">logical</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">back</span>  <span class="c">!&lt; Start of the last occurrence rather than the first.</span>
<a name="ln-551"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">i</span>     <span class="c">!&lt; Result of the search.</span>
<a name="ln-552"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-553"></a>
<a name="ln-554"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-555"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-556"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="nb">verify</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">set</span><span class="o">=</span><span class="n">set</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="n">back</span><span class="p">)</span>
<a name="ln-557"></a>  <span class="k">else</span>
<a name="ln-558"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-559"></a>  <span class="n">endif</span>
<a name="ln-560"></a>  <span class="k">return</span>
<a name="ln-561"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-562"></a>  <span class="n">endfunction</span> <span class="n">sverify</span>
<a name="ln-563"></a>
<a name="ln-564"></a>  <span class="c">! auxiliary methods</span>
<a name="ln-565"></a>  <span class="k">elemental function </span><span class="n">basedir</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
<a name="ln-566"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-567"></a>  <span class="c">!&lt; Return the base directory name of a string containing a file name.</span>
<a name="ln-568"></a>  <span class="c">!&lt;</span>
<a name="ln-569"></a>  <span class="c">!&lt;### Example</span>
<a name="ln-570"></a>  <span class="c">!&lt;</span>
<a name="ln-571"></a>  <span class="c">!&lt;```fortran</span>
<a name="ln-572"></a>  <span class="c">!&lt; type(string) :: astring</span>
<a name="ln-573"></a>  <span class="c">!&lt; astring = &#39;/bar/foo.tar.bz2&#39;</span>
<a name="ln-574"></a>  <span class="c">!&lt; print &#39;(A)&#39;, astring%basedir()//&#39;&#39; ! print &quot;/bar&quot;</span>
<a name="ln-575"></a>  <span class="c">!&lt;```</span>
<a name="ln-576"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-577"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>    <span class="c">!&lt; The string.</span>
<a name="ln-578"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>     <span class="c">!&lt; Directory separator.</span>
<a name="ln-579"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">basedir</span> <span class="c">!&lt; Base directory name.</span>
<a name="ln-580"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">sep_</span>    <span class="c">!&lt; Separator, default value.</span>
<a name="ln-581"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">pos</span>     <span class="c">!&lt; Character position.</span>
<a name="ln-582"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-583"></a>
<a name="ln-584"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-585"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-586"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="n">UIX_DIR_SEP</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span> <span class="n">sep_</span> <span class="o">=</span> <span class="n">sep</span>
<a name="ln-587"></a>    <span class="n">basedir</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-588"></a>    <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">sep_</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-589"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">basedir</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-590"></a>  <span class="n">endif</span>
<a name="ln-591"></a>  <span class="k">return</span>
<a name="ln-592"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-593"></a>  <span class="n">endfunction</span> <span class="n">basedir</span>
<a name="ln-594"></a>
<a name="ln-595"></a>  <span class="k">elemental function </span><span class="n">basename</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">extension</span><span class="p">,</span> <span class="n">strip_last_extension</span><span class="p">)</span>
<a name="ln-596"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-597"></a>  <span class="c">!&lt; Return the base file name of a string containing a file name.</span>
<a name="ln-598"></a>  <span class="c">!&lt;</span>
<a name="ln-599"></a>  <span class="c">!&lt; Optionally, the extension is also stripped if provided or the last one if required, e.g.</span>
<a name="ln-600"></a>  <span class="c">!&lt;</span>
<a name="ln-601"></a>  <span class="c">!&lt;### Example</span>
<a name="ln-602"></a>  <span class="c">!&lt;</span>
<a name="ln-603"></a>  <span class="c">!&lt;```fortran</span>
<a name="ln-604"></a>  <span class="c">!&lt; type(string) :: astring</span>
<a name="ln-605"></a>  <span class="c">!&lt; astring = &#39;bar/foo.tar.bz2&#39;</span>
<a name="ln-606"></a>  <span class="c">!&lt; print &#39;(A)&#39;, astring%basename(extension=&#39;.tar.bz2&#39;)//&#39;&#39;        ! print &quot;foo&quot;</span>
<a name="ln-607"></a>  <span class="c">!&lt; print &#39;(A)&#39;, astring%basename(strip_last_extension=.true.)//&#39;&#39; ! print &quot;foo.tar&quot;</span>
<a name="ln-608"></a>  <span class="c">!&lt;```</span>
<a name="ln-609"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-610"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>                 <span class="c">!&lt; The string.</span>
<a name="ln-611"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>                  <span class="c">!&lt; Directory separator.</span>
<a name="ln-612"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">extension</span>            <span class="c">!&lt; File extension.</span>
<a name="ln-613"></a>  <span class="kt">logical</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">strip_last_extension</span> <span class="c">!&lt; Flag to enable the stripping of last extension.</span>
<a name="ln-614"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">basename</span>             <span class="c">!&lt; Base file name.</span>
<a name="ln-615"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">sep_</span>                 <span class="c">!&lt; Separator, default value.</span>
<a name="ln-616"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">pos</span>                  <span class="c">!&lt; Character position.</span>
<a name="ln-617"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-618"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">temporary</span>            <span class="c">!&lt; Temporary storage, workaround for GNU bug.</span>
<a name="ln-619"></a><span class="cp">#endif</span>
<a name="ln-620"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-621"></a>
<a name="ln-622"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-623"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-624"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="n">UIX_DIR_SEP</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span> <span class="n">sep_</span> <span class="o">=</span> <span class="n">sep</span>
<a name="ln-625"></a>    <span class="n">basename</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-626"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-627"></a>    <span class="n">temporary</span> <span class="o">=</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-628"></a>    <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">temporary</span><span class="p">,</span> <span class="n">sep_</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-629"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">(</span><span class="n">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-630"></a><span class="cp">#else</span>
<a name="ln-631"></a>    <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">basename</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">sep_</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-632"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-633"></a><span class="cp">#endif</span>
<a name="ln-634"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">extension</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-635"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-636"></a>      <span class="n">temporary</span> <span class="o">=</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-637"></a>      <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">temporary</span><span class="p">,</span> <span class="n">extension</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-638"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-639"></a><span class="cp">#else</span>
<a name="ln-640"></a>      <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">basename</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">extension</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-641"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-642"></a><span class="cp">#endif</span>
<a name="ln-643"></a>    <span class="n">elseif</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">strip_last_extension</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-644"></a><span class="k">      if</span> <span class="p">(</span><span class="n">strip_last_extension</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-645"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-646"></a>        <span class="n">temporary</span> <span class="o">=</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-647"></a>        <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">temporary</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-648"></a>        <span class="n">basename</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-649"></a><span class="cp">#else</span>
<a name="ln-650"></a>        <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">basename</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-651"></a>        <span class="n">basename</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-652"></a><span class="cp">#endif</span>
<a name="ln-653"></a>      <span class="n">endif</span>
<a name="ln-654"></a>    <span class="n">endif</span>
<a name="ln-655"></a>  <span class="n">endif</span>
<a name="ln-656"></a>  <span class="k">return</span>
<a name="ln-657"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-658"></a>  <span class="n">endfunction</span> <span class="n">basename</span>
<a name="ln-659"></a>
<a name="ln-660"></a>  <span class="k">elemental function </span><span class="n">camelcase</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
<a name="ln-661"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-662"></a>  <span class="c">!&lt; Return a string with all words capitalized without spaces.</span>
<a name="ln-663"></a>  <span class="c">!&lt;</span>
<a name="ln-664"></a>  <span class="c">!&lt; @note Multiple subsequent separators are collapsed to one occurence.</span>
<a name="ln-665"></a>  <span class="c">!&lt;</span>
<a name="ln-666"></a>  <span class="c">!&lt;### Example</span>
<a name="ln-667"></a>  <span class="c">!&lt;</span>
<a name="ln-668"></a>  <span class="c">!&lt;```fortran</span>
<a name="ln-669"></a>  <span class="c">!&lt; type(string) :: astring</span>
<a name="ln-670"></a>  <span class="c">!&lt; astring = &#39;caMeL caSe var&#39;</span>
<a name="ln-671"></a>  <span class="c">!&lt; print &#39;(A)&#39;, astring%camelcase()//&#39;&#39; ! print &quot;CamelCaseVar&quot;</span>
<a name="ln-672"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-673"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-674"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>       <span class="c">!&lt; Separator.</span>
<a name="ln-675"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">camelcase</span> <span class="c">!&lt; Camel case string.</span>
<a name="ln-676"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">allocatable</span>                       <span class="kd">::</span> <span class="n">tokens</span><span class="p">(:)</span> <span class="c">!&lt; String tokens.</span>
<a name="ln-677"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-678"></a>
<a name="ln-679"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-680"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-681"></a><span class="k">    call </span><span class="n">self</span><span class="p">%</span><span class="n">split</span><span class="p">(</span><span class="n">tokens</span><span class="o">=</span><span class="n">tokens</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">)</span>
<a name="ln-682"></a>    <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">%</span><span class="n">capitalize</span><span class="p">()</span>
<a name="ln-683"></a>    <span class="n">camelcase</span> <span class="o">=</span> <span class="n">camelcase</span><span class="p">%</span><span class="n">join</span><span class="p">(</span><span class="k">array</span><span class="o">=</span><span class="n">tokens</span><span class="p">)</span>
<a name="ln-684"></a>  <span class="n">endif</span>
<a name="ln-685"></a>  <span class="k">return</span>
<a name="ln-686"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-687"></a>  <span class="n">endfunction</span> <span class="n">camelcase</span>
<a name="ln-688"></a>
<a name="ln-689"></a>  <span class="k">elemental function </span><span class="n">capitalize</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">capitalized</span><span class="p">)</span>
<a name="ln-690"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-691"></a>  <span class="c">!&lt; Return a string with its first character capitalized and the rest lowercased.</span>
<a name="ln-692"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-693"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>        <span class="c">!&lt; The string.</span>
<a name="ln-694"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">capitalized</span> <span class="c">!&lt; Upper case string.</span>
<a name="ln-695"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">c</span>           <span class="c">!&lt; Character counter.</span>
<a name="ln-696"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-697"></a>
<a name="ln-698"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-699"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-700"></a><span class="k">    </span><span class="n">capitalized</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">lower</span><span class="p">()</span>
<a name="ln-701"></a>    <span class="n">c</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">LOWER_ALPHABET</span><span class="p">,</span> <span class="n">capitalized</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-702"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">c</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">capitalized</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">UPPER_ALPHABET</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span>
<a name="ln-703"></a>  <span class="n">endif</span>
<a name="ln-704"></a>  <span class="k">return</span>
<a name="ln-705"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-706"></a>  <span class="n">endfunction</span> <span class="n">capitalize</span>
<a name="ln-707"></a>
<a name="ln-708"></a>  <span class="k">pure function </span><span class="n">chars</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-709"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-710"></a>  <span class="c">!&lt; Return the raw characters data.</span>
<a name="ln-711"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-712"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">self</span> <span class="c">!&lt; The string.</span>
<a name="ln-713"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">raw</span>  <span class="c">!&lt; Raw characters data.</span>
<a name="ln-714"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-715"></a>
<a name="ln-716"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-717"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-718"></a><span class="k">    </span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-719"></a>  <span class="k">else</span>
<a name="ln-720"></a><span class="k">    </span><span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-721"></a>  <span class="n">endif</span>
<a name="ln-722"></a>  <span class="k">return</span>
<a name="ln-723"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-724"></a>  <span class="n">endfunction</span> <span class="n">chars</span>
<a name="ln-725"></a>
<a name="ln-726"></a>  <span class="k">elemental function decode</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">codec</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">decoded</span><span class="p">)</span>
<a name="ln-727"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-728"></a>  <span class="c">!&lt; Return a string decoded accordingly the codec.</span>
<a name="ln-729"></a>  <span class="c">!&lt;</span>
<a name="ln-730"></a>  <span class="c">!&lt; @note Only BASE64 codec is currently available.</span>
<a name="ln-731"></a>  <span class="c">!&lt;</span>
<a name="ln-732"></a>  <span class="c">!&lt;### Example</span>
<a name="ln-733"></a>  <span class="c">!&lt;</span>
<a name="ln-734"></a>  <span class="c">!&lt;```fortran</span>
<a name="ln-735"></a>  <span class="c">!&lt; type(string) :: astring</span>
<a name="ln-736"></a>  <span class="c">!&lt; astring = &#39;SG93IGFyZSB5b3U/&#39;</span>
<a name="ln-737"></a>  <span class="c">!&lt; print &#39;(A)&#39;, astring%decode(codec=&#39;base64&#39;)//&#39;&#39; ! print &quot;How are you?&quot;</span>
<a name="ln-738"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-739"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">!&lt; The string.</span>
<a name="ln-740"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">codec</span>   <span class="c">!&lt; Encoding codec.</span>
<a name="ln-741"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">decoded</span> <span class="c">!&lt; Decoded string.</span>
<a name="ln-742"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">codec_u</span> <span class="c">!&lt; Encoding codec in upper case string.</span>
<a name="ln-743"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-744"></a>
<a name="ln-745"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-746"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-747"></a><span class="k">    </span><span class="n">decoded</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-748"></a>    <span class="n">codec_u</span> <span class="o">=</span> <span class="n">codec</span>
<a name="ln-749"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">codec_u</span><span class="p">%</span><span class="n">upper</span><span class="p">()</span><span class="o">//</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-750"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;BASE64&#39;</span><span class="p">)</span>
<a name="ln-751"></a>      <span class="k">call </span><span class="n">b64_decode</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">decoded</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-752"></a>    <span class="n">endselect</span>
<a name="ln-753"></a>    <span class="n">decoded</span> <span class="o">=</span> <span class="n">decoded</span><span class="p">%</span><span class="n">strip</span><span class="p">(</span><span class="n">remove_nulls</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-754"></a>  <span class="n">endif</span>
<a name="ln-755"></a>  <span class="k">return</span>
<a name="ln-756"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-757"></a>  <span class="n">endfunction</span> <span class="k">decode</span>
<a name="ln-758"></a>
<a name="ln-759"></a><span class="k">  elemental function encode</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">codec</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">encoded</span><span class="p">)</span>
<a name="ln-760"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-761"></a>  <span class="c">!&lt; Return a string encoded accordingly the codec.</span>
<a name="ln-762"></a>  <span class="c">!&lt;</span>
<a name="ln-763"></a>  <span class="c">!&lt; @note Only BASE64 codec is currently available.</span>
<a name="ln-764"></a>  <span class="c">!&lt;</span>
<a name="ln-765"></a>  <span class="c">!&lt;### Example</span>
<a name="ln-766"></a>  <span class="c">!&lt;</span>
<a name="ln-767"></a>  <span class="c">!&lt;```fortran</span>
<a name="ln-768"></a>  <span class="c">!&lt; type(string) :: astring</span>
<a name="ln-769"></a>  <span class="c">!&lt; astring = &#39;How are you?&#39;</span>
<a name="ln-770"></a>  <span class="c">!&lt; print &#39;(A)&#39;, astring%encode(codec=&#39;base64&#39;)//&#39;&#39; ! print &quot;SG93IGFyZSB5b3U/&quot;</span>
<a name="ln-771"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-772"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">!&lt; The string.</span>
<a name="ln-773"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">codec</span>   <span class="c">!&lt; Encoding codec.</span>
<a name="ln-774"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">encoded</span> <span class="c">!&lt; Encoded string.</span>
<a name="ln-775"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-776"></a>
<a name="ln-777"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-778"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-779"></a><span class="k">    </span><span class="n">encoded</span> <span class="o">=</span> <span class="n">codec</span>
<a name="ln-780"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">encoded</span><span class="p">%</span><span class="n">upper</span><span class="p">()</span><span class="o">//</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-781"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;BASE64&#39;</span><span class="p">)</span>
<a name="ln-782"></a>      <span class="k">call </span><span class="n">b64_encode</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="n">encoded</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-783"></a>    <span class="n">endselect</span>
<a name="ln-784"></a>  <span class="n">endif</span>
<a name="ln-785"></a>  <span class="k">return</span>
<a name="ln-786"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-787"></a>  <span class="n">endfunction</span> <span class="k">encode</span>
<a name="ln-788"></a>
<a name="ln-789"></a><span class="k">  elemental function </span><span class="n">escape</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">to_escape</span><span class="p">,</span> <span class="n">esc</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">escaped</span><span class="p">)</span>
<a name="ln-790"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-791"></a>  <span class="c">!&lt; Escape backslashes (or custom escape character).</span>
<a name="ln-792"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-793"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-794"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">to_escape</span> <span class="c">!&lt; Character to be escaped.</span>
<a name="ln-795"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">esc</span>       <span class="c">!&lt; Character used to escape.</span>
<a name="ln-796"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">escaped</span>   <span class="c">!&lt; Escaped string.</span>
<a name="ln-797"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">esc_</span>      <span class="c">!&lt; Character to escape, local variable.</span>
<a name="ln-798"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">c</span>         <span class="c">!&lt; Character counter.</span>
<a name="ln-799"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-800"></a>
<a name="ln-801"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-802"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-803"></a><span class="k">    </span><span class="n">esc_</span> <span class="o">=</span> <span class="n">BACKSLASH</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">esc</span><span class="p">))</span> <span class="n">esc_</span> <span class="o">=</span> <span class="n">esc</span>
<a name="ln-804"></a>    <span class="n">escaped</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-805"></a>    <span class="k">do </span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-806"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span><span class="o">==</span><span class="n">to_escape</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-807"></a><span class="k">        </span><span class="n">escaped</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">escaped</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">esc_</span><span class="o">//</span><span class="n">to_escape</span>
<a name="ln-808"></a>      <span class="k">else</span>
<a name="ln-809"></a><span class="k">        </span><span class="n">escaped</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">escaped</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span>
<a name="ln-810"></a>      <span class="n">endif</span>
<a name="ln-811"></a>    <span class="n">enddo</span>
<a name="ln-812"></a>  <span class="n">endif</span>
<a name="ln-813"></a>  <span class="k">return</span>
<a name="ln-814"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-815"></a>  <span class="n">endfunction</span> <span class="n">escape</span>
<a name="ln-816"></a>
<a name="ln-817"></a>  <span class="k">elemental function </span><span class="n">extension</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-818"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-819"></a>  <span class="c">!&lt; Return the extension of a string containing a file name.</span>
<a name="ln-820"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-821"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-822"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                           <span class="kd">::</span> <span class="n">extension</span> <span class="c">!&lt; Extension file name.</span>
<a name="ln-823"></a>  <span class="kt">integer</span>                                <span class="kd">::</span> <span class="n">pos</span>       <span class="c">!&lt; Character position.</span>
<a name="ln-824"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-825"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">temporary</span> <span class="c">!&lt; Temporary storage, workaround for GNU bug.</span>
<a name="ln-826"></a><span class="cp">#endif</span>
<a name="ln-827"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-828"></a>
<a name="ln-829"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-830"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-831"></a><span class="k">    </span><span class="n">extension</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-832"></a>    <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-833"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-834"></a>    <span class="n">temporary</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-835"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">extension</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">(</span><span class="n">pos</span><span class="p">:)</span>
<a name="ln-836"></a><span class="cp">#else</span>
<a name="ln-837"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">extension</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">pos</span><span class="p">:)</span>
<a name="ln-838"></a><span class="cp">#endif</span>
<a name="ln-839"></a>  <span class="n">endif</span>
<a name="ln-840"></a>  <span class="k">return</span>
<a name="ln-841"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-842"></a>  <span class="n">endfunction</span> <span class="n">extension</span>
<a name="ln-843"></a>
<a name="ln-844"></a>  <span class="k">elemental function </span><span class="n">fill</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">filling_char</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">filled</span><span class="p">)</span>
<a name="ln-845"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-846"></a>  <span class="c">!&lt; Pad string on the left (or right) with zeros (or other char) to fill width.</span>
<a name="ln-847"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-848"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>          <span class="c">!&lt; The string.</span>
<a name="ln-849"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">width</span>         <span class="c">!&lt; Final width of filled string.</span>
<a name="ln-850"></a>  <span class="kt">logical</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">right</span>         <span class="c">!&lt; Fill on the right instead of left.</span>
<a name="ln-851"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">filling_char</span>  <span class="c">!&lt; Filling character (default &quot;0&quot;).</span>
<a name="ln-852"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">filled</span>        <span class="c">!&lt; Filled string.</span>
<a name="ln-853"></a>  <span class="kt">logical</span>                                         <span class="kd">::</span> <span class="n">right_</span>        <span class="c">!&lt; Fill on the right instead of left, local variable.</span>
<a name="ln-854"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">filling_char_</span> <span class="c">!&lt; Filling character (default &quot;0&quot;), local variable.</span>
<a name="ln-855"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-856"></a>
<a name="ln-857"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-858"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-859"></a><span class="k">    if</span> <span class="p">(</span><span class="n">width</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-860"></a><span class="k">      </span><span class="n">right_</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">right</span><span class="p">))</span> <span class="n">right_</span> <span class="o">=</span> <span class="n">right</span>
<a name="ln-861"></a>      <span class="n">filling_char_</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">filling_char</span><span class="p">))</span> <span class="n">filling_char_</span> <span class="o">=</span> <span class="n">filling_char</span>
<a name="ln-862"></a>      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">right_</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-863"></a><span class="k">        </span><span class="n">filled</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="n">filling_char_</span><span class="p">,</span> <span class="n">width</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-864"></a>      <span class="k">else</span>
<a name="ln-865"></a><span class="k">        </span><span class="n">filled</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="nb">repeat</span><span class="p">(</span><span class="n">filling_char_</span><span class="p">,</span> <span class="n">width</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span>
<a name="ln-866"></a>      <span class="n">endif</span>
<a name="ln-867"></a>    <span class="n">endif</span>
<a name="ln-868"></a>  <span class="n">endif</span>
<a name="ln-869"></a>  <span class="k">return</span>
<a name="ln-870"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-871"></a>  <span class="n">endfunction</span> <span class="n">fill</span>
<a name="ln-872"></a>
<a name="ln-873"></a>  <span class="k">elemental subroutine </span><span class="n">free</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-874"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-875"></a>  <span class="c">!&lt; Free dynamic memory.</span>
<a name="ln-876"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-877"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span> <span class="c">!&lt; The string.</span>
<a name="ln-878"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-879"></a>
<a name="ln-880"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-881"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-882"></a>  <span class="k">return</span>
<a name="ln-883"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-884"></a>  <span class="n">endsubroutine</span> <span class="n">free</span>
<a name="ln-885"></a>
<a name="ln-886"></a>  <span class="k">elemental function </span><span class="n">insert_character</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">substring</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">inserted</span><span class="p">)</span>
<a name="ln-887"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-888"></a>  <span class="c">!&lt; Insert substring into string at a specified position.</span>
<a name="ln-889"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-890"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-891"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">substring</span> <span class="c">!&lt; Substring.</span>
<a name="ln-892"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pos</span>       <span class="c">!&lt; Position from which insert substring.</span>
<a name="ln-893"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">inserted</span>  <span class="c">!&lt; Inserted string.</span>
<a name="ln-894"></a>  <span class="kt">integer</span>                      <span class="kd">::</span> <span class="n">safepos</span>   <span class="c">!&lt; Safe position from which insert substring.</span>
<a name="ln-895"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-896"></a>
<a name="ln-897"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-898"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-899"></a><span class="k">    </span><span class="n">inserted</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-900"></a>    <span class="n">safepos</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span>
<a name="ln-901"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">safepos</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-902"></a><span class="k">      </span><span class="n">inserted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">substring</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-903"></a>    <span class="n">elseif</span> <span class="p">(</span><span class="n">safepos</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-904"></a><span class="k">      </span><span class="n">inserted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">substring</span>
<a name="ln-905"></a>    <span class="k">else</span>
<a name="ln-906"></a><span class="k">      </span><span class="n">inserted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">safepos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">substring</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">safepos</span><span class="p">:)</span>
<a name="ln-907"></a>    <span class="n">endif</span>
<a name="ln-908"></a>  <span class="k">else</span>
<a name="ln-909"></a><span class="k">    </span><span class="n">inserted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">substring</span>
<a name="ln-910"></a>  <span class="n">endif</span>
<a name="ln-911"></a>  <span class="k">return</span>
<a name="ln-912"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-913"></a>  <span class="n">endfunction</span> <span class="n">insert_character</span>
<a name="ln-914"></a>
<a name="ln-915"></a>  <span class="k">elemental function </span><span class="n">insert_string</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">substring</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">inserted</span><span class="p">)</span>
<a name="ln-916"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-917"></a>  <span class="c">!&lt; Insert substring into string at a specified position.</span>
<a name="ln-918"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-919"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-920"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">substring</span> <span class="c">!&lt; Substring.</span>
<a name="ln-921"></a>  <span class="kt">integer</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pos</span>       <span class="c">!&lt; Position from which insert substring.</span>
<a name="ln-922"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">inserted</span>  <span class="c">!&lt; Inserted string.</span>
<a name="ln-923"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">safepos</span>   <span class="c">!&lt; Safe position from which insert substring.</span>
<a name="ln-924"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-925"></a>
<a name="ln-926"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-927"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-928"></a><span class="k">    </span><span class="n">inserted</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-929"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">substring</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-930"></a><span class="k">      </span><span class="n">safepos</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span>
<a name="ln-931"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">safepos</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-932"></a><span class="k">        </span><span class="n">inserted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">substring</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-933"></a>      <span class="n">elseif</span> <span class="p">(</span><span class="n">safepos</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-934"></a><span class="k">        </span><span class="n">inserted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">substring</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-935"></a>      <span class="k">else</span>
<a name="ln-936"></a><span class="k">        </span><span class="n">inserted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">safepos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">substring</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">safepos</span><span class="p">:)</span>
<a name="ln-937"></a>      <span class="n">endif</span>
<a name="ln-938"></a>    <span class="n">endif</span>
<a name="ln-939"></a>  <span class="k">else</span>
<a name="ln-940"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">substring</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">inserted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">substring</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-941"></a>  <span class="n">endif</span>
<a name="ln-942"></a>  <span class="k">return</span>
<a name="ln-943"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-944"></a>  <span class="n">endfunction</span> <span class="n">insert_string</span>
<a name="ln-945"></a>
<a name="ln-946"></a>  <span class="k">pure function </span><span class="n">join_strings</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="k">array</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">join</span><span class="p">)</span>
<a name="ln-947"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-948"></a>  <span class="c">!&lt; Return a string that is a join of an array of strings.</span>
<a name="ln-949"></a>  <span class="c">!&lt;</span>
<a name="ln-950"></a>  <span class="c">!&lt; The join-separator is set equals to self if self has a value or it is set to a null string &#39;&#39;. This value can be overridden</span>
<a name="ln-951"></a>  <span class="c">!&lt; passing a custom separator.</span>
<a name="ln-952"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-953"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-954"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>              <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">:)</span> <span class="c">!&lt; Array to be joined.</span>
<a name="ln-955"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>       <span class="c">!&lt; Separator.</span>
<a name="ln-956"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">join</span>      <span class="c">!&lt; The join of array.</span>
<a name="ln-957"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">sep_</span>      <span class="c">!&lt; Separator, default value.</span>
<a name="ln-958"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">a</span>         <span class="c">!&lt; Counter.</span>
<a name="ln-959"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-960"></a>
<a name="ln-961"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-962"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-963"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-964"></a>  <span class="k">else</span>
<a name="ln-965"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-966"></a>  <span class="n">endif</span>
<a name="ln-967"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span> <span class="n">sep_</span> <span class="o">=</span> <span class="n">sep</span>
<a name="ln-968"></a>  <span class="n">join</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-969"></a>  <span class="k">do </span><span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="k">array</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-970"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="n">a</span><span class="p">)%</span><span class="n">raw</span><span class="p">))</span> <span class="n">join</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">join</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">sep_</span><span class="o">//</span><span class="k">array</span><span class="p">(</span><span class="n">a</span><span class="p">)%</span><span class="n">raw</span>
<a name="ln-971"></a>  <span class="n">enddo</span>
<a name="ln-972"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-973"></a><span class="k">    </span><span class="n">join</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">raw</span><span class="o">//</span><span class="n">join</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-974"></a>  <span class="k">else</span>
<a name="ln-975"></a><span class="k">    </span><span class="n">join</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">join</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">join</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span>
<a name="ln-976"></a>  <span class="n">endif</span>
<a name="ln-977"></a>  <span class="k">return</span>
<a name="ln-978"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-979"></a>  <span class="n">endfunction</span> <span class="n">join_strings</span>
<a name="ln-980"></a>
<a name="ln-981"></a>  <span class="k">pure function </span><span class="n">join_characters</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="k">array</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">join</span><span class="p">)</span>
<a name="ln-982"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-983"></a>  <span class="c">!&lt; Return a string that is a join of an array of characters.</span>
<a name="ln-984"></a>  <span class="c">!&lt;</span>
<a name="ln-985"></a>  <span class="c">!&lt; The join-separator is set equals to self if self has a value or it is set to a null string &#39;&#39;. This value can be overridden</span>
<a name="ln-986"></a>  <span class="c">!&lt; passing a custom separator.</span>
<a name="ln-987"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-988"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-989"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">:)</span> <span class="c">!&lt; Array to be joined.</span>
<a name="ln-990"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>       <span class="c">!&lt; Separator.</span>
<a name="ln-991"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">join</span>      <span class="c">!&lt; The join of array.</span>
<a name="ln-992"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">sep_</span>      <span class="c">!&lt; Separator, default value.</span>
<a name="ln-993"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">a</span>         <span class="c">!&lt; Counter.</span>
<a name="ln-994"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-995"></a>
<a name="ln-996"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-997"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-998"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-999"></a>  <span class="k">else</span>
<a name="ln-1000"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1001"></a>  <span class="n">endif</span>
<a name="ln-1002"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span> <span class="n">sep_</span> <span class="o">=</span> <span class="n">sep</span>
<a name="ln-1003"></a>  <span class="n">join</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1004"></a>  <span class="k">do </span><span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="k">array</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1005"></a>    <span class="k">if</span> <span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="n">join</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">join</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">sep_</span><span class="o">//</span><span class="k">array</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a name="ln-1006"></a>  <span class="n">enddo</span>
<a name="ln-1007"></a>  <span class="k">if</span> <span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1008"></a><span class="k">    </span><span class="n">join</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">join</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-1009"></a>  <span class="k">else</span>
<a name="ln-1010"></a><span class="k">    </span><span class="n">join</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">join</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">join</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span>
<a name="ln-1011"></a>  <span class="n">endif</span>
<a name="ln-1012"></a>  <span class="k">return</span>
<a name="ln-1013"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1014"></a>  <span class="n">endfunction</span> <span class="n">join_characters</span>
<a name="ln-1015"></a>
<a name="ln-1016"></a>  <span class="k">elemental function </span><span class="n">lower</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-1017"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1018"></a>  <span class="c">!&lt; Return a string with all lowercase characters.</span>
<a name="ln-1019"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1020"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>  <span class="c">!&lt; The string.</span>
<a name="ln-1021"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">lower</span> <span class="c">!&lt; Upper case string.</span>
<a name="ln-1022"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">n1</span>    <span class="c">!&lt; Characters counter.</span>
<a name="ln-1023"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">n2</span>    <span class="c">!&lt; Characters counter.</span>
<a name="ln-1024"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1025"></a>
<a name="ln-1026"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1027"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1028"></a><span class="k">    </span><span class="n">lower</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-1029"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-1030"></a>      <span class="n">n2</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">UPPER_ALPHABET</span><span class="p">,</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">))</span>
<a name="ln-1031"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">n2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">lower</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="n">LOWER_ALPHABET</span><span class="p">(</span><span class="n">n2</span><span class="p">:</span><span class="n">n2</span><span class="p">)</span>
<a name="ln-1032"></a>    <span class="n">enddo</span>
<a name="ln-1033"></a>  <span class="n">endif</span>
<a name="ln-1034"></a>  <span class="k">return</span>
<a name="ln-1035"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1036"></a>  <span class="n">endfunction</span> <span class="n">lower</span>
<a name="ln-1037"></a>
<a name="ln-1038"></a>  <span class="k">pure function </span><span class="n">partition</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">partitions</span><span class="p">)</span>
<a name="ln-1039"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1040"></a>  <span class="c">!&lt; Split string at separator and return the 3 parts (before, the separator and after).</span>
<a name="ln-1041"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1042"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>            <span class="c">!&lt; The string.</span>
<a name="ln-1043"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>             <span class="c">!&lt; Separator.</span>
<a name="ln-1044"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">partitions</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="c">!&lt; Partions: before the separator, the separator itsels and</span>
<a name="ln-1045"></a>                                                                     <span class="c">!&lt; after the separator.</span>
<a name="ln-1046"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">sep_</span>            <span class="c">!&lt; Separator, default value.</span>
<a name="ln-1047"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">c</span>               <span class="c">!&lt; Character counter.</span>
<a name="ln-1048"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-1049"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">temporary</span>       <span class="c">!&lt; Temporary storage, workaround for GNU bug.</span>
<a name="ln-1050"></a><span class="cp">#endif</span>
<a name="ln-1051"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1052"></a>
<a name="ln-1053"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1054"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1055"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="n">SPACE</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span> <span class="n">sep_</span> <span class="o">=</span> <span class="n">sep</span>
<a name="ln-1056"></a>
<a name="ln-1057"></a>    <span class="n">partitions</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-1058"></a>    <span class="n">partitions</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">sep_</span>
<a name="ln-1059"></a>    <span class="n">partitions</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1060"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span><span class="o">&gt;=</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">return</span>
<a name="ln-1061"></a><span class="k">    </span><span class="n">c</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">sep_</span><span class="p">)</span>
<a name="ln-1062"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">c</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1063"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-1064"></a>      <span class="n">temporary</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-1065"></a>      <span class="n">partitions</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1066"></a>      <span class="n">partitions</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1067"></a>      <span class="n">partitions</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">sep_</span><span class="p">):)</span>
<a name="ln-1068"></a><span class="cp">#else</span>
<a name="ln-1069"></a>      <span class="n">partitions</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1070"></a>      <span class="n">partitions</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1071"></a>      <span class="n">partitions</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">sep_</span><span class="p">):)</span>
<a name="ln-1072"></a><span class="cp">#endif</span>
<a name="ln-1073"></a>    <span class="n">endif</span>
<a name="ln-1074"></a>  <span class="n">endif</span>
<a name="ln-1075"></a>  <span class="k">return</span>
<a name="ln-1076"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1077"></a>  <span class="n">endfunction</span> <span class="n">partition</span>
<a name="ln-1078"></a>
<a name="ln-1079"></a>  <span class="k">subroutine </span><span class="n">read_file</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="k">file</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-1080"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1081"></a>  <span class="c">!&lt; Read a file as a single string stream.</span>
<a name="ln-1082"></a>  <span class="c">!&lt;</span>
<a name="ln-1083"></a>  <span class="c">!&lt; @note All the lines are stored into the string self as a single ascii stream. Each line (record) is separated by a `new_line`</span>
<a name="ln-1084"></a>  <span class="c">!&lt; character.</span>
<a name="ln-1085"></a>  <span class="c">!&lt;</span>
<a name="ln-1086"></a>  <span class="c">!&lt; @note For unformatted read only `access=&#39;stream&#39;` is supported with new_line as line terminator.</span>
<a name="ln-1087"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1088"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>       <span class="c">!&lt; The string.</span>
<a name="ln-1089"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="k">file</span>       <span class="c">!&lt; File name.</span>
<a name="ln-1090"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span>    <span class="k">optional</span> <span class="kd">::</span> <span class="n">form</span>       <span class="c">!&lt; Format of unit.</span>
<a name="ln-1091"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span>   <span class="k">optional</span> <span class="kd">::</span> <span class="n">iostat</span>     <span class="c">!&lt; IO status code.</span>
<a name="ln-1092"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">iomsg</span>      <span class="c">!&lt; IO status message.</span>
<a name="ln-1093"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                              <span class="kd">::</span> <span class="n">form_</span>      <span class="c">!&lt; Format of unit, local variable.</span>
<a name="ln-1094"></a>  <span class="kt">integer</span>                                   <span class="kd">::</span> <span class="n">iostat_</span>    <span class="c">!&lt; IO status code, local variable.</span>
<a name="ln-1095"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>             <span class="kd">::</span> <span class="n">iomsg_</span>     <span class="c">!&lt; IO status message, local variable.</span>
<a name="ln-1096"></a>  <span class="kt">integer</span>                                   <span class="kd">::</span> <span class="n">unit</span>       <span class="c">!&lt; Logical unit.</span>
<a name="ln-1097"></a>  <span class="kt">logical</span>                                   <span class="kd">::</span> <span class="n">does_exist</span> <span class="c">!&lt; Check if file exist.</span>
<a name="ln-1098"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1099"></a>
<a name="ln-1100"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1101"></a>  <span class="n">iomsg_</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg_</span> <span class="o">=</span> <span class="n">iomsg</span>
<a name="ln-1102"></a>  <span class="k">inquire</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="k">file</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">exist</span><span class="o">=</span><span class="n">does_exist</span><span class="p">)</span>
<a name="ln-1103"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">does_exist</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1104"></a><span class="k">    </span><span class="n">form_</span> <span class="o">=</span> <span class="s1">&#39;FORMATTED&#39;</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">form</span><span class="p">))</span> <span class="n">form_</span> <span class="o">=</span> <span class="n">form</span> <span class="p">;</span> <span class="n">form_</span> <span class="o">=</span> <span class="n">form_</span><span class="p">%</span><span class="n">upper</span><span class="p">()</span>
<a name="ln-1105"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">form_</span><span class="p">%</span><span class="n">chars</span><span class="p">())</span>
<a name="ln-1106"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;FORMATTED&#39;</span><span class="p">)</span>
<a name="ln-1107"></a>      <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="k">file</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;OLD&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;READ&#39;</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1108"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">)</span>
<a name="ln-1109"></a>      <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="k">file</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;OLD&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;READ&#39;</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">,</span> <span class="nb">access</span><span class="o">=</span><span class="s1">&#39;STREAM&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1110"></a>           <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1111"></a>    <span class="n">endselect</span>
<a name="ln-1112"></a>    <span class="k">call </span><span class="n">self</span><span class="p">%</span><span class="n">read_lines</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">)</span>
<a name="ln-1113"></a>    <span class="mi">10</span> <span class="k">close</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
<a name="ln-1114"></a>  <span class="n">endif</span>
<a name="ln-1115"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="n">iostat</span> <span class="o">=</span> <span class="n">iostat_</span>
<a name="ln-1116"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg</span> <span class="o">=</span> <span class="n">iomsg_</span>
<a name="ln-1117"></a>  <span class="k">return</span>
<a name="ln-1118"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1119"></a>  <span class="n">endsubroutine</span> <span class="n">read_file</span>
<a name="ln-1120"></a>
<a name="ln-1121"></a>  <span class="k">subroutine </span><span class="n">read_line</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-1122"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1123"></a>  <span class="c">!&lt; Read line (record) from a connected unit.</span>
<a name="ln-1124"></a>  <span class="c">!&lt;</span>
<a name="ln-1125"></a>  <span class="c">!&lt; The line is read as an ascii stream read until the eor is reached.</span>
<a name="ln-1126"></a>  <span class="c">!&lt;</span>
<a name="ln-1127"></a>  <span class="c">!&lt; @note For unformatted read only `access=&#39;stream&#39;` is supported with new_line as line terminator.</span>
<a name="ln-1128"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1129"></a>  <span class="k">use</span><span class="p">,</span> <span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">iostat_eor</span>
<a name="ln-1130"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1131"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>    <span class="c">!&lt; The string.</span>
<a name="ln-1132"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">unit</span>    <span class="c">!&lt; Logical unit.</span>
<a name="ln-1133"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span>    <span class="k">optional</span> <span class="kd">::</span> <span class="n">form</span>    <span class="c">!&lt; Format of unit.</span>
<a name="ln-1134"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span>   <span class="k">optional</span> <span class="kd">::</span> <span class="n">iostat</span>  <span class="c">!&lt; IO status code.</span>
<a name="ln-1135"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">iomsg</span>   <span class="c">!&lt; IO status message.</span>
<a name="ln-1136"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                              <span class="kd">::</span> <span class="n">form_</span>   <span class="c">!&lt; Format of unit, local variable.</span>
<a name="ln-1137"></a>  <span class="kt">integer</span>                                   <span class="kd">::</span> <span class="n">iostat_</span> <span class="c">!&lt; IO status code, local variable.</span>
<a name="ln-1138"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span>          <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">iomsg_</span>  <span class="c">!&lt; IO status message, local variable.</span>
<a name="ln-1139"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">line</span>    <span class="c">!&lt; Line storage.</span>
<a name="ln-1140"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">ch</span>      <span class="c">!&lt; Character storage.</span>
<a name="ln-1141"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1142"></a>
<a name="ln-1143"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1144"></a>  <span class="n">form_</span> <span class="o">=</span> <span class="s1">&#39;FORMATTED&#39;</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">form</span><span class="p">))</span> <span class="n">form_</span> <span class="o">=</span> <span class="n">form</span> <span class="p">;</span> <span class="n">form_</span> <span class="o">=</span> <span class="n">form_</span><span class="p">%</span><span class="n">upper</span><span class="p">()</span>
<a name="ln-1145"></a>  <span class="n">iomsg_</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg_</span> <span class="o">=</span> <span class="n">iomsg</span>
<a name="ln-1146"></a>  <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1147"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">form_</span><span class="p">%</span><span class="n">chars</span><span class="p">())</span>
<a name="ln-1148"></a>  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;FORMATTED&#39;</span><span class="p">)</span>
<a name="ln-1149"></a>    <span class="k">do</span>
<a name="ln-1150"></a><span class="k">      read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="k">end</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">eor</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="n">ch</span>
<a name="ln-1151"></a>      <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">//</span><span class="n">ch</span>
<a name="ln-1152"></a>    <span class="n">enddo</span>
<a name="ln-1153"></a>  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">)</span>
<a name="ln-1154"></a>    <span class="k">do</span>
<a name="ln-1155"></a><span class="k">      read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="k">end</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="n">ch</span>
<a name="ln-1156"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">ch</span><span class="o">==</span><span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1157"></a><span class="k">        </span><span class="n">iostat_</span> <span class="o">=</span> <span class="n">iostat_eor</span>
<a name="ln-1158"></a>        <span class="k">exit</span>
<a name="ln-1159"></a><span class="k">      </span><span class="n">endif</span>
<a name="ln-1160"></a>      <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">//</span><span class="n">ch</span>
<a name="ln-1161"></a>    <span class="n">enddo</span>
<a name="ln-1162"></a>  <span class="n">endselect</span>
<a name="ln-1163"></a>  <span class="mi">10</span> <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">line</span>
<a name="ln-1164"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="n">iostat</span> <span class="o">=</span> <span class="n">iostat_</span>
<a name="ln-1165"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg</span> <span class="o">=</span> <span class="n">iomsg_</span>
<a name="ln-1166"></a>  <span class="k">return</span>
<a name="ln-1167"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1168"></a>  <span class="n">endsubroutine</span> <span class="n">read_line</span>
<a name="ln-1169"></a>
<a name="ln-1170"></a>  <span class="k">subroutine </span><span class="n">read_lines</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-1171"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1172"></a>  <span class="c">!&lt; Read (all) lines (records) from a connected unit as a single ascii stream.</span>
<a name="ln-1173"></a>  <span class="c">!&lt;</span>
<a name="ln-1174"></a>  <span class="c">!&lt; @note All the lines are stored into the string self as a single ascii stream. Each line (record) is separated by a `new_line`</span>
<a name="ln-1175"></a>  <span class="c">!&lt; character. The line is read as an ascii stream read until the eor is reached.</span>
<a name="ln-1176"></a>  <span class="c">!&lt;</span>
<a name="ln-1177"></a>  <span class="c">!&lt; @note The connected unit is rewinded. At a successful exit current record is at eof, at the beginning otherwise.</span>
<a name="ln-1178"></a>  <span class="c">!&lt;</span>
<a name="ln-1179"></a>  <span class="c">!&lt; @note For unformatted read only `access=&#39;stream&#39;` is supported with new_line as line terminator.</span>
<a name="ln-1180"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1181"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>    <span class="c">!&lt; The string.</span>
<a name="ln-1182"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">unit</span>    <span class="c">!&lt; Logical unit.</span>
<a name="ln-1183"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span>    <span class="k">optional</span> <span class="kd">::</span> <span class="n">form</span>    <span class="c">!&lt; Format of unit.</span>
<a name="ln-1184"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span>   <span class="k">optional</span> <span class="kd">::</span> <span class="n">iostat</span>  <span class="c">!&lt; IO status code.</span>
<a name="ln-1185"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">iomsg</span>   <span class="c">!&lt; IO status message.</span>
<a name="ln-1186"></a>  <span class="kt">integer</span>                                   <span class="kd">::</span> <span class="n">iostat_</span> <span class="c">!&lt; IO status code, local variable.</span>
<a name="ln-1187"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>             <span class="kd">::</span> <span class="n">iomsg_</span>  <span class="c">!&lt; IO status message, local variable.</span>
<a name="ln-1188"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                              <span class="kd">::</span> <span class="n">lines</span>   <span class="c">!&lt; Lines storage.</span>
<a name="ln-1189"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                              <span class="kd">::</span> <span class="n">line</span>    <span class="c">!&lt; Line storage.</span>
<a name="ln-1190"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1191"></a>
<a name="ln-1192"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1193"></a>  <span class="n">iomsg_</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg_</span> <span class="o">=</span> <span class="n">iomsg</span>
<a name="ln-1194"></a>  <span class="k">rewind</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
<a name="ln-1195"></a>  <span class="n">iostat_</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1196"></a>  <span class="n">lines</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1197"></a>  <span class="k">do</span>
<a name="ln-1198"></a><span class="k">    </span><span class="n">line</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1199"></a>    <span class="k">call </span><span class="n">line</span><span class="p">%</span><span class="n">read_line</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">)</span>
<a name="ln-1200"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">iostat_</span><span class="o">/=</span><span class="mf">0.</span><span class="nb">and</span><span class="p">..</span><span class="nb">not</span><span class="p">.</span><span class="nb">is_iostat_eor</span><span class="p">(</span><span class="n">iostat_</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1201"></a><span class="k">      exit</span>
<a name="ln-1202"></a><span class="k">    </span><span class="n">elseif</span> <span class="p">(</span><span class="n">line</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1203"></a><span class="k">      </span><span class="n">lines</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">lines</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">line</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<a name="ln-1204"></a>    <span class="n">endif</span>
<a name="ln-1205"></a>  <span class="n">enddo</span>
<a name="ln-1206"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lines</span><span class="p">%</span><span class="n">raw</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">lines</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-1207"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="n">iostat</span> <span class="o">=</span> <span class="n">iostat_</span>
<a name="ln-1208"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg</span> <span class="o">=</span> <span class="n">iomsg_</span>
<a name="ln-1209"></a>  <span class="k">return</span>
<a name="ln-1210"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1211"></a>  <span class="n">endsubroutine</span> <span class="n">read_lines</span>
<a name="ln-1212"></a>
<a name="ln-1213"></a>  <span class="k">elemental function </span><span class="n">replace</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">,</span> <span class="nb">count</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">replaced</span><span class="p">)</span>
<a name="ln-1214"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1215"></a>  <span class="c">!&lt; Return a string with all occurrences of substring old replaced by new.</span>
<a name="ln-1216"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1217"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1218"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">old</span>       <span class="c">!&lt; Old substring.</span>
<a name="ln-1219"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">new</span>       <span class="c">!&lt; New substring.</span>
<a name="ln-1220"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="nb">count</span>     <span class="c">!&lt; Number of old occurences to be replaced.</span>
<a name="ln-1221"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">replaced</span>  <span class="c">!&lt; The string with old replaced by new.</span>
<a name="ln-1222"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">r</span>         <span class="c">!&lt; Counter.</span>
<a name="ln-1223"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1224"></a>
<a name="ln-1225"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1226"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1227"></a><span class="k">    </span><span class="n">replaced</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-1228"></a>    <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1229"></a>    <span class="k">do</span>
<a name="ln-1230"></a><span class="k">      if</span> <span class="p">(</span><span class="nb">index</span><span class="p">(</span><span class="n">replaced</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">old</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1231"></a><span class="k">        </span><span class="n">replaced</span> <span class="o">=</span> <span class="n">replaced</span><span class="p">%</span><span class="n">replace_one_occurrence</span><span class="p">(</span><span class="n">old</span><span class="o">=</span><span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="n">new</span><span class="p">)</span>
<a name="ln-1232"></a>        <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1233"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="nb">count</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1234"></a><span class="k">          if</span> <span class="p">(</span><span class="n">r</span><span class="o">&gt;=</span><span class="nb">count</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-1235"></a><span class="k">        </span><span class="n">endif</span>
<a name="ln-1236"></a>      <span class="k">else</span>
<a name="ln-1237"></a><span class="k">        exit</span>
<a name="ln-1238"></a><span class="k">      </span><span class="n">endif</span>
<a name="ln-1239"></a>    <span class="n">enddo</span>
<a name="ln-1240"></a>  <span class="n">endif</span>
<a name="ln-1241"></a>  <span class="k">return</span>
<a name="ln-1242"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1243"></a>  <span class="n">endfunction</span> <span class="n">replace</span>
<a name="ln-1244"></a>
<a name="ln-1245"></a>  <span class="k">elemental function </span><span class="n">reverse</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">reversed</span><span class="p">)</span>
<a name="ln-1246"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1247"></a>  <span class="c">!&lt; Return a reversed string.</span>
<a name="ln-1248"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1249"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-1250"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">reversed</span> <span class="c">!&lt; The reversed string.</span>
<a name="ln-1251"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">length</span>   <span class="c">!&lt; Length of the string.</span>
<a name="ln-1252"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">c</span>        <span class="c">!&lt; Counter.</span>
<a name="ln-1253"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1254"></a>
<a name="ln-1255"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1256"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1257"></a><span class="k">    </span><span class="n">reversed</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-1258"></a>    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-1259"></a>    <span class="k">do </span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">length</span>
<a name="ln-1260"></a>      <span class="n">reversed</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">length</span><span class="o">-</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="o">-</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1261"></a>    <span class="n">enddo</span>
<a name="ln-1262"></a>  <span class="n">endif</span>
<a name="ln-1263"></a>  <span class="k">return</span>
<a name="ln-1264"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1265"></a>  <span class="n">endfunction</span> <span class="n">reverse</span>
<a name="ln-1266"></a>
<a name="ln-1267"></a>  <span class="k">function </span><span class="n">search</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">tag_start</span><span class="p">,</span> <span class="n">tag_end</span><span class="p">,</span> <span class="n">in_string</span><span class="p">,</span> <span class="n">in_character</span><span class="p">,</span> <span class="n">istart</span><span class="p">,</span> <span class="n">iend</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
<a name="ln-1268"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1269"></a>  <span class="c">!&lt; Search for *tagged* record into string, return the first record found (if any) matching the tags.</span>
<a name="ln-1270"></a>  <span class="c">!&lt;</span>
<a name="ln-1271"></a>  <span class="c">!&lt; Optionally, returns the indexes of tag start/end, thus this is not an `elemental` function.</span>
<a name="ln-1272"></a>  <span class="c">!&lt;</span>
<a name="ln-1273"></a>  <span class="c">!&lt; @note The tagged record is searched into self if allocated otherwise into `in_string` if passed or, eventually, into</span>
<a name="ln-1274"></a>  <span class="c">!&lt; `in_character` is passed. If tag is not found the return string is not allocated and the start/end indexes (if requested) are</span>
<a name="ln-1275"></a>  <span class="c">!&lt; zero.</span>
<a name="ln-1276"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1277"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">self</span>         <span class="c">!&lt; The string.</span>
<a name="ln-1278"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">tag_start</span>    <span class="c">!&lt; Start tag.</span>
<a name="ln-1279"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">tag_end</span>      <span class="c">!&lt; End tag.</span>
<a name="ln-1280"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>              <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span>  <span class="k">optional</span> <span class="kd">::</span> <span class="n">in_string</span>    <span class="c">!&lt; Search into this string.</span>
<a name="ln-1281"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span>  <span class="k">optional</span> <span class="kd">::</span> <span class="n">in_character</span> <span class="c">!&lt; Search into this character string.</span>
<a name="ln-1282"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">istart</span>       <span class="c">!&lt; Starting index of tag inside the string.</span>
<a name="ln-1283"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">iend</span>         <span class="c">!&lt; Ending index of tag inside the string.</span>
<a name="ln-1284"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                     <span class="kd">::</span> <span class="n">tag</span>          <span class="c">!&lt; First tag found.</span>
<a name="ln-1285"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>           <span class="kd">::</span> <span class="n">raw</span>          <span class="c">!&lt; Raw string into which search the tag.</span>
<a name="ln-1286"></a>  <span class="kt">integer</span>                                          <span class="kd">::</span> <span class="n">istart_</span>      <span class="c">!&lt; Starting index of tag inside the string, local variable.</span>
<a name="ln-1287"></a>  <span class="kt">integer</span>                                          <span class="kd">::</span> <span class="n">iend_</span>        <span class="c">!&lt; Ending index of tag inside the string, local variable.</span>
<a name="ln-1288"></a>  <span class="kt">logical</span>                                          <span class="kd">::</span> <span class="n">found</span>        <span class="c">!&lt; Flag for inquiring search result.</span>
<a name="ln-1289"></a>  <span class="kt">integer</span>                                          <span class="kd">::</span> <span class="n">nested_tags</span>  <span class="c">!&lt; Number of nested tags inside tag.</span>
<a name="ln-1290"></a>  <span class="kt">integer</span>                                          <span class="kd">::</span> <span class="n">t</span>            <span class="c">!&lt; Counter.</span>
<a name="ln-1291"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1292"></a>
<a name="ln-1293"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1294"></a>  <span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1295"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">in_string</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1296"></a><span class="k">    </span><span class="n">raw</span> <span class="o">=</span> <span class="n">in_string</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-1297"></a>  <span class="n">elseif</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">in_character</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1298"></a><span class="k">    </span><span class="n">raw</span> <span class="o">=</span> <span class="n">in_character</span>
<a name="ln-1299"></a>  <span class="k">else</span>
<a name="ln-1300"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1301"></a><span class="k">      </span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-1302"></a>    <span class="n">endif</span>
<a name="ln-1303"></a>  <span class="n">endif</span>
<a name="ln-1304"></a>  <span class="n">istart_</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1305"></a>  <span class="n">iend_</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1306"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">raw</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1307"></a><span class="k">    </span><span class="n">found</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1308"></a>    <span class="n">istart_</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">tag_start</span><span class="p">)</span>
<a name="ln-1309"></a>    <span class="n">iend_</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">tag_end</span><span class="p">)</span>
<a name="ln-1310"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">istart_</span><span class="o">&gt;</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">iend_</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1311"></a><span class="k">      </span><span class="n">iend_</span> <span class="o">=</span> <span class="n">iend_</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">tag_end</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-1312"></a>      <span class="n">tag</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">raw</span><span class="p">(</span><span class="n">istart_</span><span class="p">:</span><span class="n">iend_</span><span class="p">)</span>
<a name="ln-1313"></a>      <span class="n">nested_tags</span> <span class="o">=</span> <span class="n">tag</span><span class="p">%</span><span class="nb">count</span><span class="p">(</span><span class="n">tag_start</span><span class="p">)</span>
<a name="ln-1314"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">nested_tags</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1315"></a><span class="k">        do </span><span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nested_tags</span>
<a name="ln-1316"></a>          <span class="n">iend_</span> <span class="o">=</span> <span class="n">iend_</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">tag_end</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">index</span><span class="p">(</span><span class="n">raw</span><span class="p">(</span><span class="n">iend_</span><span class="o">+</span><span class="mi">1</span><span class="p">:),</span> <span class="n">tag_end</span><span class="p">)</span>
<a name="ln-1317"></a>        <span class="n">enddo</span>
<a name="ln-1318"></a>        <span class="n">tag</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">raw</span><span class="p">(</span><span class="n">istart_</span><span class="p">:</span><span class="n">iend_</span><span class="p">)</span>
<a name="ln-1319"></a>      <span class="n">endif</span>
<a name="ln-1320"></a>    <span class="n">endif</span>
<a name="ln-1321"></a>  <span class="n">endif</span>
<a name="ln-1322"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">istart</span><span class="p">))</span> <span class="n">istart</span> <span class="o">=</span> <span class="n">istart_</span>
<a name="ln-1323"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iend</span><span class="p">))</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">iend_</span>
<a name="ln-1324"></a>  <span class="k">return</span>
<a name="ln-1325"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1326"></a>  <span class="n">endfunction</span> <span class="n">search</span>
<a name="ln-1327"></a>
<a name="ln-1328"></a>  <span class="k">pure function </span><span class="n">slice</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">istart</span><span class="p">,</span> <span class="n">iend</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-1329"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1330"></a>  <span class="c">!&lt; Return the raw characters data sliced.</span>
<a name="ln-1331"></a>  <span class="c">!&lt;</span>
<a name="ln-1332"></a>  <span class="c">!&lt;### Example</span>
<a name="ln-1333"></a>  <span class="c">!&lt;</span>
<a name="ln-1334"></a>  <span class="c">!&lt;```fortran</span>
<a name="ln-1335"></a>  <span class="c">!&lt; type(string) :: astring        !&lt; A string.</span>
<a name="ln-1336"></a>  <span class="c">!&lt; astring = &#39;the Quick Brown fox Jumps over the Lazy Dog.&#39;</span>
<a name="ln-1337"></a>  <span class="c">!&lt; print &quot;(A)&quot;, astring%slice(11,25) ! print &quot;Brown fox Jumps&quot;</span>
<a name="ln-1338"></a>  <span class="c">!&lt;```</span>
<a name="ln-1339"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1340"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">self</span>   <span class="c">!&lt; The string.</span>
<a name="ln-1341"></a>  <span class="kt">integer</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">istart</span> <span class="c">!&lt; Slice start index.</span>
<a name="ln-1342"></a>  <span class="kt">integer</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">iend</span>   <span class="c">!&lt; Slice end   index.</span>
<a name="ln-1343"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">raw</span>    <span class="c">!&lt; Raw characters data.</span>
<a name="ln-1344"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1345"></a>
<a name="ln-1346"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1347"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1348"></a><span class="k">    </span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">istart</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-1349"></a>  <span class="k">else</span>
<a name="ln-1350"></a><span class="k">    </span><span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1351"></a>  <span class="n">endif</span>
<a name="ln-1352"></a>  <span class="k">return</span>
<a name="ln-1353"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1354"></a>  <span class="n">endfunction</span> <span class="n">slice</span>
<a name="ln-1355"></a>
<a name="ln-1356"></a>  <span class="k">elemental function </span><span class="n">snakecase</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
<a name="ln-1357"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1358"></a>  <span class="c">!&lt; Return a string with all words lowercase separated by &quot;_&quot;.</span>
<a name="ln-1359"></a>  <span class="c">!&lt;</span>
<a name="ln-1360"></a>  <span class="c">!&lt; @note Multiple subsequent separators are collapsed to one occurence.</span>
<a name="ln-1361"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1362"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1363"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>       <span class="c">!&lt; Separator.</span>
<a name="ln-1364"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">snakecase</span> <span class="c">!&lt; Snake case string.</span>
<a name="ln-1365"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">allocatable</span>                       <span class="kd">::</span> <span class="n">tokens</span><span class="p">(:)</span> <span class="c">!&lt; String tokens.</span>
<a name="ln-1366"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1367"></a>
<a name="ln-1368"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1369"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1370"></a><span class="k">    call </span><span class="n">self</span><span class="p">%</span><span class="n">split</span><span class="p">(</span><span class="n">tokens</span><span class="o">=</span><span class="n">tokens</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">)</span>
<a name="ln-1371"></a>    <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">%</span><span class="n">lower</span><span class="p">()</span>
<a name="ln-1372"></a>    <span class="n">snakecase</span> <span class="o">=</span> <span class="n">snakecase</span><span class="p">%</span><span class="n">join</span><span class="p">(</span><span class="k">array</span><span class="o">=</span><span class="n">tokens</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
<a name="ln-1373"></a>  <span class="n">endif</span>
<a name="ln-1374"></a>  <span class="k">return</span>
<a name="ln-1375"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1376"></a>  <span class="n">endfunction</span> <span class="n">snakecase</span>
<a name="ln-1377"></a>
<a name="ln-1378"></a>  <span class="k">pure subroutine </span><span class="n">split</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">tokens</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
<a name="ln-1379"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1380"></a>  <span class="c">!&lt; Return a list of substring in the string, using sep as the delimiter string.</span>
<a name="ln-1381"></a>  <span class="c">!&lt;</span>
<a name="ln-1382"></a>  <span class="c">!&lt; @note Multiple subsequent separators are collapsed to one occurence.</span>
<a name="ln-1383"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1384"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>           <span class="c">!&lt; The string.</span>
<a name="ln-1385"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>            <span class="c">!&lt; Separator.</span>
<a name="ln-1386"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">tokens</span><span class="p">(:)</span>      <span class="c">!&lt; Tokens substring.</span>
<a name="ln-1387"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">sep_</span>           <span class="c">!&lt; Separator, default value.</span>
<a name="ln-1388"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">No</span>             <span class="c">!&lt; Number of occurrences of sep.</span>
<a name="ln-1389"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">t</span>              <span class="c">!&lt; Character counter.</span>
<a name="ln-1390"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">temporary</span>      <span class="c">!&lt; Temporary storage.</span>
<a name="ln-1391"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">allocatable</span>                       <span class="kd">::</span> <span class="n">temp_toks</span><span class="p">(:,:)</span> <span class="c">!&lt; Temporary tokens substring.</span>
<a name="ln-1392"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1393"></a>
<a name="ln-1394"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1395"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1396"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="n">SPACE</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span> <span class="n">sep_</span> <span class="o">=</span> <span class="n">sep</span>
<a name="ln-1397"></a>
<a name="ln-1398"></a>    <span class="n">temporary</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">unique</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span>
<a name="ln-1399"></a>    <span class="n">No</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">%</span><span class="nb">count</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span>
<a name="ln-1400"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">No</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1401"></a><span class="k">      allocate</span><span class="p">(</span><span class="n">temp_toks</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">No</span><span class="p">))</span>
<a name="ln-1402"></a>      <span class="n">temp_toks</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">%</span><span class="n">partition</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span>
<a name="ln-1403"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">No</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1404"></a><span class="k">        do </span><span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">No</span>
<a name="ln-1405"></a>          <span class="n">temp_toks</span><span class="p">(:,</span> <span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)%</span><span class="n">partition</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span>
<a name="ln-1406"></a>        <span class="n">enddo</span>
<a name="ln-1407"></a>      <span class="n">endif</span>
<a name="ln-1408"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">temp_toks</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)%</span><span class="n">raw</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">temp_toks</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">No</span><span class="p">)%</span><span class="n">raw</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1409"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">tokens</span><span class="p">(</span><span class="n">No</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1410"></a>        <span class="k">do </span><span class="n">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">No</span>
<a name="ln-1411"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="o">==</span><span class="n">No</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1412"></a><span class="k">            </span><span class="n">tokens</span><span class="p">(</span><span class="n">t</span>  <span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-1413"></a>            <span class="n">tokens</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-1414"></a>          <span class="k">else</span>
<a name="ln-1415"></a><span class="k">            </span><span class="n">tokens</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-1416"></a>          <span class="n">endif</span>
<a name="ln-1417"></a>        <span class="n">enddo</span>
<a name="ln-1418"></a>      <span class="n">elseif</span> <span class="p">(</span><span class="n">temp_toks</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)%</span><span class="n">raw</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1419"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">tokens</span><span class="p">(</span><span class="n">No</span><span class="p">))</span>
<a name="ln-1420"></a>        <span class="k">do </span><span class="n">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">No</span>
<a name="ln-1421"></a>          <span class="n">tokens</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-1422"></a>        <span class="n">enddo</span>
<a name="ln-1423"></a>      <span class="n">elseif</span> <span class="p">(</span><span class="n">temp_toks</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">No</span><span class="p">)%</span><span class="n">raw</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1424"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">tokens</span><span class="p">(</span><span class="n">No</span><span class="p">))</span>
<a name="ln-1425"></a>        <span class="k">do </span><span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">No</span>
<a name="ln-1426"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="o">==</span><span class="n">No</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1427"></a><span class="k">            </span><span class="n">tokens</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-1428"></a>            <span class="n">tokens</span><span class="p">(</span><span class="n">t</span>  <span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-1429"></a>          <span class="k">else</span>
<a name="ln-1430"></a><span class="k">            </span><span class="n">tokens</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-1431"></a>          <span class="n">endif</span>
<a name="ln-1432"></a>        <span class="n">enddo</span>
<a name="ln-1433"></a>      <span class="k">else</span>
<a name="ln-1434"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">tokens</span><span class="p">(</span><span class="n">No</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1435"></a>        <span class="k">do </span><span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">No</span>
<a name="ln-1436"></a>          <span class="n">tokens</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-1437"></a>        <span class="n">enddo</span>
<a name="ln-1438"></a>      <span class="n">endif</span>
<a name="ln-1439"></a>    <span class="k">else</span>
<a name="ln-1440"></a><span class="k">      allocate</span><span class="p">(</span><span class="n">tokens</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1441"></a>      <span class="n">tokens</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-1442"></a>    <span class="n">endif</span>
<a name="ln-1443"></a>  <span class="n">endif</span>
<a name="ln-1444"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1445"></a>  <span class="n">endsubroutine</span> <span class="n">split</span>
<a name="ln-1446"></a>
<a name="ln-1447"></a>  <span class="k">elemental function </span><span class="n">startcase</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
<a name="ln-1448"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1449"></a>  <span class="c">!&lt; Return a string with all words capitalized, e.g. title case.</span>
<a name="ln-1450"></a>  <span class="c">!&lt;</span>
<a name="ln-1451"></a>  <span class="c">!&lt; @note Multiple subsequent separators are collapsed to one occurence.</span>
<a name="ln-1452"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1453"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1454"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>       <span class="c">!&lt; Separator.</span>
<a name="ln-1455"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">startcase</span> <span class="c">!&lt; Start case string.</span>
<a name="ln-1456"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">sep_</span>      <span class="c">!&lt; Separator, default value.</span>
<a name="ln-1457"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">allocatable</span>                       <span class="kd">::</span> <span class="n">tokens</span><span class="p">(:)</span> <span class="c">!&lt; String tokens.</span>
<a name="ln-1458"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1459"></a>
<a name="ln-1460"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1461"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1462"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="n">SPACE</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span> <span class="n">sep_</span> <span class="o">=</span> <span class="n">sep</span>
<a name="ln-1463"></a>    <span class="k">call </span><span class="n">self</span><span class="p">%</span><span class="n">split</span><span class="p">(</span><span class="n">tokens</span><span class="o">=</span><span class="n">tokens</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep_</span><span class="p">)</span>
<a name="ln-1464"></a>    <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">%</span><span class="n">capitalize</span><span class="p">()</span>
<a name="ln-1465"></a>    <span class="n">startcase</span> <span class="o">=</span> <span class="n">startcase</span><span class="p">%</span><span class="n">join</span><span class="p">(</span><span class="k">array</span><span class="o">=</span><span class="n">tokens</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep_</span><span class="p">)</span>
<a name="ln-1466"></a>  <span class="n">endif</span>
<a name="ln-1467"></a>  <span class="k">return</span>
<a name="ln-1468"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1469"></a>  <span class="n">endfunction</span> <span class="n">startcase</span>
<a name="ln-1470"></a>
<a name="ln-1471"></a>  <span class="k">elemental function </span><span class="n">strip</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">remove_nulls</span><span class="p">)</span>
<a name="ln-1472"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1473"></a>  <span class="c">!&lt; Return a copy of the string with the leading and trailing characters removed.</span>
<a name="ln-1474"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1475"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>         <span class="c">!&lt; The string.</span>
<a name="ln-1476"></a>  <span class="kt">logical</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">remove_nulls</span> <span class="c">!&lt; Remove null characters at the end.</span>
<a name="ln-1477"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">strip</span>        <span class="c">!&lt; The stripped string.</span>
<a name="ln-1478"></a>  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">c</span>            <span class="c">!&lt; Counter.</span>
<a name="ln-1479"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1480"></a>
<a name="ln-1481"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1482"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1483"></a><span class="k">    </span><span class="n">strip</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="nb">adjustl</span><span class="p">()</span>
<a name="ln-1484"></a>    <span class="n">strip</span> <span class="o">=</span> <span class="n">strip</span><span class="p">%</span><span class="nb">trim</span><span class="p">()</span>
<a name="ln-1485"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">remove_nulls</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1486"></a><span class="k">      if</span> <span class="p">(</span><span class="n">remove_nulls</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1487"></a><span class="k">        </span><span class="n">c</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="nb">char</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-1488"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">c</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">strip</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">strip</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1489"></a>      <span class="n">endif</span>
<a name="ln-1490"></a>    <span class="n">endif</span>
<a name="ln-1491"></a>  <span class="n">endif</span>
<a name="ln-1492"></a>  <span class="k">return</span>
<a name="ln-1493"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1494"></a>  <span class="n">endfunction</span> <span class="n">strip</span>
<a name="ln-1495"></a>
<a name="ln-1496"></a>  <span class="k">elemental function </span><span class="n">swapcase</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-1497"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1498"></a>  <span class="c">!&lt; Return a copy of the string with uppercase characters converted to lowercase and vice versa.</span>
<a name="ln-1499"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1500"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-1501"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">swapcase</span> <span class="c">!&lt; Upper case string.</span>
<a name="ln-1502"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">n1</span>       <span class="c">!&lt; Characters counter.</span>
<a name="ln-1503"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">n2</span>       <span class="c">!&lt; Characters counter.</span>
<a name="ln-1504"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1505"></a>
<a name="ln-1506"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1507"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1508"></a><span class="k">    </span><span class="n">swapcase</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-1509"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-1510"></a>      <span class="n">n2</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">UPPER_ALPHABET</span><span class="p">,</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">))</span>
<a name="ln-1511"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">n2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1512"></a><span class="k">        </span><span class="n">swapcase</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="n">LOWER_ALPHABET</span><span class="p">(</span><span class="n">n2</span><span class="p">:</span><span class="n">n2</span><span class="p">)</span>
<a name="ln-1513"></a>      <span class="k">else</span>
<a name="ln-1514"></a><span class="k">        </span><span class="n">n2</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">LOWER_ALPHABET</span><span class="p">,</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">))</span>
<a name="ln-1515"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">n2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">swapcase</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="n">UPPER_ALPHABET</span><span class="p">(</span><span class="n">n2</span><span class="p">:</span><span class="n">n2</span><span class="p">)</span>
<a name="ln-1516"></a>      <span class="n">endif</span>
<a name="ln-1517"></a>    <span class="n">enddo</span>
<a name="ln-1518"></a>  <span class="n">endif</span>
<a name="ln-1519"></a>  <span class="k">return</span>
<a name="ln-1520"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1521"></a>  <span class="n">endfunction</span> <span class="n">swapcase</span>
<a name="ln-1522"></a>
<a name="ln-1523"></a>  <span class="k">elemental function </span><span class="n">to_integer_I1P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nb">kind</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">to_number</span><span class="p">)</span>
<a name="ln-1524"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1525"></a>  <span class="c">!&lt; Cast string to integer (I1P).</span>
<a name="ln-1526"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1527"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1528"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">kind</span>      <span class="c">!&lt; Mold parameter for kind detection.</span>
<a name="ln-1529"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">to_number</span> <span class="c">!&lt; The number into the string.</span>
<a name="ln-1530"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1531"></a>
<a name="ln-1532"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1533"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1534"></a><span class="k">    if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">is_integer</span><span class="p">())</span> <span class="k">read</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">to_number</span>
<a name="ln-1535"></a>  <span class="n">endif</span>
<a name="ln-1536"></a>  <span class="k">return</span>
<a name="ln-1537"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1538"></a>  <span class="n">endfunction</span> <span class="n">to_integer_I1P</span>
<a name="ln-1539"></a>
<a name="ln-1540"></a>  <span class="k">elemental function </span><span class="n">to_integer_I2P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nb">kind</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">to_number</span><span class="p">)</span>
<a name="ln-1541"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1542"></a>  <span class="c">!&lt; Cast string to integer (I2P).</span>
<a name="ln-1543"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1544"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1545"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">kind</span>      <span class="c">!&lt; Mold parameter for kind detection.</span>
<a name="ln-1546"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">to_number</span> <span class="c">!&lt; The number into the string.</span>
<a name="ln-1547"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1548"></a>
<a name="ln-1549"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1550"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1551"></a><span class="k">    if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">is_integer</span><span class="p">())</span> <span class="k">read</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">to_number</span>
<a name="ln-1552"></a>  <span class="n">endif</span>
<a name="ln-1553"></a>  <span class="k">return</span>
<a name="ln-1554"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1555"></a>  <span class="n">endfunction</span> <span class="n">to_integer_I2P</span>
<a name="ln-1556"></a>
<a name="ln-1557"></a>  <span class="k">elemental function </span><span class="n">to_integer_I4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nb">kind</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">to_number</span><span class="p">)</span>
<a name="ln-1558"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1559"></a>  <span class="c">!&lt; Cast string to integer (I4P).</span>
<a name="ln-1560"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1561"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1562"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">kind</span>      <span class="c">!&lt; Mold parameter for kind detection.</span>
<a name="ln-1563"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">to_number</span> <span class="c">!&lt; The number into the string.</span>
<a name="ln-1564"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1565"></a>
<a name="ln-1566"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1567"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1568"></a><span class="k">    if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">is_integer</span><span class="p">())</span> <span class="k">read</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">to_number</span>
<a name="ln-1569"></a>  <span class="n">endif</span>
<a name="ln-1570"></a>  <span class="k">return</span>
<a name="ln-1571"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1572"></a>  <span class="n">endfunction</span> <span class="n">to_integer_I4P</span>
<a name="ln-1573"></a>
<a name="ln-1574"></a>  <span class="k">elemental function </span><span class="n">to_integer_I8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nb">kind</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">to_number</span><span class="p">)</span>
<a name="ln-1575"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1576"></a>  <span class="c">!&lt; Cast string to integer (I8P).</span>
<a name="ln-1577"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1578"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1579"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">kind</span>      <span class="c">!&lt; Mold parameter for kind detection.</span>
<a name="ln-1580"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">to_number</span> <span class="c">!&lt; The number into the string.</span>
<a name="ln-1581"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1582"></a>
<a name="ln-1583"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1584"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1585"></a><span class="k">    if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">is_integer</span><span class="p">())</span> <span class="k">read</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">to_number</span>
<a name="ln-1586"></a>  <span class="n">endif</span>
<a name="ln-1587"></a>  <span class="k">return</span>
<a name="ln-1588"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1589"></a>  <span class="n">endfunction</span> <span class="n">to_integer_I8P</span>
<a name="ln-1590"></a>
<a name="ln-1591"></a>  <span class="k">elemental function </span><span class="n">to_real_R4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nb">kind</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">to_number</span><span class="p">)</span>
<a name="ln-1592"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1593"></a>  <span class="c">!&lt; Cast string to real (R4P).</span>
<a name="ln-1594"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1595"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1596"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">kind</span>      <span class="c">!&lt; Mold parameter for kind detection.</span>
<a name="ln-1597"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">to_number</span> <span class="c">!&lt; The number into the string.</span>
<a name="ln-1598"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1599"></a>
<a name="ln-1600"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1601"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1602"></a><span class="k">    if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">is_real</span><span class="p">())</span> <span class="k">read</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">to_number</span>
<a name="ln-1603"></a>  <span class="n">endif</span>
<a name="ln-1604"></a>  <span class="k">return</span>
<a name="ln-1605"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1606"></a>  <span class="n">endfunction</span> <span class="n">to_real_R4P</span>
<a name="ln-1607"></a>
<a name="ln-1608"></a>  <span class="k">elemental function </span><span class="n">to_real_R8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nb">kind</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">to_number</span><span class="p">)</span>
<a name="ln-1609"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1610"></a>  <span class="c">!&lt; Cast string to real (R8P).</span>
<a name="ln-1611"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1612"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1613"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">kind</span>      <span class="c">!&lt; Mold parameter for kind detection.</span>
<a name="ln-1614"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">to_number</span> <span class="c">!&lt; The number into the string.</span>
<a name="ln-1615"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1616"></a>
<a name="ln-1617"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1618"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1619"></a><span class="k">    if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">is_real</span><span class="p">())</span> <span class="k">read</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">to_number</span>
<a name="ln-1620"></a>  <span class="n">endif</span>
<a name="ln-1621"></a>  <span class="k">return</span>
<a name="ln-1622"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1623"></a>  <span class="n">endfunction</span> <span class="n">to_real_R8P</span>
<a name="ln-1624"></a>
<a name="ln-1625"></a>  <span class="k">elemental function </span><span class="n">to_real_R16P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nb">kind</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">to_number</span><span class="p">)</span>
<a name="ln-1626"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1627"></a>  <span class="c">!&lt; Cast string to real (R16P).</span>
<a name="ln-1628"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1629"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1630"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">kind</span>      <span class="c">!&lt; Mold parameter for kind detection.</span>
<a name="ln-1631"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">to_number</span> <span class="c">!&lt; The number into the string.</span>
<a name="ln-1632"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1633"></a>
<a name="ln-1634"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1635"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1636"></a><span class="k">    if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">is_real</span><span class="p">())</span> <span class="k">read</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">to_number</span>
<a name="ln-1637"></a>  <span class="n">endif</span>
<a name="ln-1638"></a>  <span class="k">return</span>
<a name="ln-1639"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1640"></a>  <span class="n">endfunction</span> <span class="n">to_real_R16P</span>
<a name="ln-1641"></a>
<a name="ln-1642"></a>  <span class="k">elemental function </span><span class="n">unescape</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">to_unescape</span><span class="p">,</span> <span class="n">unesc</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">unescaped</span><span class="p">)</span>
<a name="ln-1643"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1644"></a>  <span class="c">!&lt; Unescape double backslashes (or custom escaped character).</span>
<a name="ln-1645"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1646"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>        <span class="c">!&lt; The string.</span>
<a name="ln-1647"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">to_unescape</span> <span class="c">!&lt; Character to be unescaped.</span>
<a name="ln-1648"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">unesc</span>       <span class="c">!&lt; Character used to unescape.</span>
<a name="ln-1649"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">unescaped</span>   <span class="c">!&lt; Escaped string.</span>
<a name="ln-1650"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">unesc_</span>      <span class="c">!&lt; Character to unescape, local variable.</span>
<a name="ln-1651"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">c</span>           <span class="c">!&lt; Character counter.</span>
<a name="ln-1652"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1653"></a>
<a name="ln-1654"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1655"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1656"></a><span class="k">    </span><span class="n">unesc_</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">unesc</span><span class="p">))</span> <span class="n">unesc_</span> <span class="o">=</span> <span class="n">unesc</span>
<a name="ln-1657"></a>    <span class="n">unescaped</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1658"></a>    <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1659"></a>    <span class="k">do</span>
<a name="ln-1660"></a><span class="k">      if</span> <span class="p">(</span><span class="n">c</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">exit</span>
<a name="ln-1661"></a><span class="k">      if</span> <span class="p">(</span><span class="n">c</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1662"></a><span class="k">        </span><span class="n">unescaped</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">unescaped</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span>
<a name="ln-1663"></a>        <span class="k">exit</span>
<a name="ln-1664"></a><span class="k">      else</span>
<a name="ln-1665"></a><span class="k">        if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="n">BACKSLASH</span><span class="o">//</span><span class="n">to_unescape</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1666"></a><span class="k">          </span><span class="n">unescaped</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">unescaped</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">to_unescape</span>
<a name="ln-1667"></a>          <span class="n">c</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1668"></a>        <span class="k">else</span>
<a name="ln-1669"></a><span class="k">          </span><span class="n">unescaped</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">unescaped</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span>
<a name="ln-1670"></a>          <span class="n">c</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1671"></a>        <span class="n">endif</span>
<a name="ln-1672"></a>      <span class="n">endif</span>
<a name="ln-1673"></a>    <span class="n">enddo</span>
<a name="ln-1674"></a>  <span class="n">endif</span>
<a name="ln-1675"></a>  <span class="k">return</span>
<a name="ln-1676"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1677"></a>  <span class="n">endfunction</span> <span class="n">unescape</span>
<a name="ln-1678"></a>
<a name="ln-1679"></a>  <span class="k">elemental function </span><span class="n">unique</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">substring</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">uniq</span><span class="p">)</span>
<a name="ln-1680"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1681"></a>  <span class="c">!&lt; Reduce to one (unique) multiple (sequential) occurrences of a substring into a string.</span>
<a name="ln-1682"></a>  <span class="c">!&lt;</span>
<a name="ln-1683"></a>  <span class="c">!&lt; For example the string &#39; ab-cre-cre-ab&#39; is reduce to &#39;ab-cre-ab&#39; if the substring is &#39;-cre&#39;.</span>
<a name="ln-1684"></a>  <span class="c">!&lt; @note Eventual multiple trailing white space are not reduced to one occurrence.</span>
<a name="ln-1685"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1686"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>       <span class="c">!&lt; The string.</span>
<a name="ln-1687"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">substring</span>  <span class="c">!&lt; Substring which multiple occurences must be reduced to one.</span>
<a name="ln-1688"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">substring_</span> <span class="c">!&lt; Substring, default value.</span>
<a name="ln-1689"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">uniq</span>       <span class="c">!&lt; String parsed.</span>
<a name="ln-1690"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1691"></a>
<a name="ln-1692"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1693"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1694"></a><span class="k">    </span><span class="n">substring_</span> <span class="o">=</span> <span class="n">SPACE</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">substring</span><span class="p">))</span> <span class="n">substring_</span> <span class="o">=</span> <span class="n">substring</span>
<a name="ln-1695"></a>
<a name="ln-1696"></a>    <span class="n">uniq</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-1697"></a>    <span class="k">do</span>
<a name="ln-1698"></a><span class="k">      if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">uniq</span><span class="p">%</span><span class="nb">index</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="n">substring_</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-1699"></a><span class="k">      </span><span class="n">uniq</span> <span class="o">=</span> <span class="n">uniq</span><span class="p">%</span><span class="n">replace</span><span class="p">(</span><span class="n">old</span><span class="o">=</span><span class="nb">repeat</span><span class="p">(</span><span class="n">substring_</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">new</span><span class="o">=</span><span class="n">substring_</span><span class="p">)</span>
<a name="ln-1700"></a>    <span class="n">enddo</span>
<a name="ln-1701"></a>  <span class="n">endif</span>
<a name="ln-1702"></a>  <span class="k">return</span>
<a name="ln-1703"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1704"></a>  <span class="n">endfunction</span> <span class="n">unique</span>
<a name="ln-1705"></a>
<a name="ln-1706"></a>  <span class="k">elemental function </span><span class="n">upper</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-1707"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1708"></a>  <span class="c">!&lt; Return a string with all uppercase characters.</span>
<a name="ln-1709"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1710"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>  <span class="c">!&lt; The string.</span>
<a name="ln-1711"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">upper</span> <span class="c">!&lt; Upper case string.</span>
<a name="ln-1712"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">n1</span>    <span class="c">!&lt; Characters counter.</span>
<a name="ln-1713"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">n2</span>    <span class="c">!&lt; Characters counter.</span>
<a name="ln-1714"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1715"></a>
<a name="ln-1716"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1717"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1718"></a><span class="k">    </span><span class="n">upper</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-1719"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-1720"></a>      <span class="n">n2</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">LOWER_ALPHABET</span><span class="p">,</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">))</span>
<a name="ln-1721"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">n2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">upper</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="n">UPPER_ALPHABET</span><span class="p">(</span><span class="n">n2</span><span class="p">:</span><span class="n">n2</span><span class="p">)</span>
<a name="ln-1722"></a>    <span class="n">enddo</span>
<a name="ln-1723"></a>  <span class="n">endif</span>
<a name="ln-1724"></a>  <span class="k">return</span>
<a name="ln-1725"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1726"></a>  <span class="n">endfunction</span> <span class="n">upper</span>
<a name="ln-1727"></a>
<a name="ln-1728"></a>  <span class="k">subroutine </span><span class="n">write_file</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="k">file</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-1729"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1730"></a>  <span class="c">!&lt; Write a single string stream into file.</span>
<a name="ln-1731"></a>  <span class="c">!&lt;</span>
<a name="ln-1732"></a>  <span class="c">!&lt; @note For unformatted read only `access=&#39;stream&#39;` is supported with new_line as line terminator.</span>
<a name="ln-1733"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1734"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">self</span>    <span class="c">!&lt; The string.</span>
<a name="ln-1735"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="k">file</span>    <span class="c">!&lt; File name.</span>
<a name="ln-1736"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span>    <span class="k">optional</span> <span class="kd">::</span> <span class="n">form</span>    <span class="c">!&lt; Format of unit.</span>
<a name="ln-1737"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span>   <span class="k">optional</span> <span class="kd">::</span> <span class="n">iostat</span>  <span class="c">!&lt; IO status code.</span>
<a name="ln-1738"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">iomsg</span>   <span class="c">!&lt; IO status message.</span>
<a name="ln-1739"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                              <span class="kd">::</span> <span class="n">form_</span>   <span class="c">!&lt; Format of unit, local variable.</span>
<a name="ln-1740"></a>  <span class="kt">integer</span>                                   <span class="kd">::</span> <span class="n">iostat_</span> <span class="c">!&lt; IO status code, local variable.</span>
<a name="ln-1741"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>             <span class="kd">::</span> <span class="n">iomsg_</span>  <span class="c">!&lt; IO status message, local variable.</span>
<a name="ln-1742"></a>  <span class="kt">integer</span>                                   <span class="kd">::</span> <span class="n">unit</span>    <span class="c">!&lt; Logical unit.</span>
<a name="ln-1743"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1744"></a>
<a name="ln-1745"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1746"></a>  <span class="n">iomsg_</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg_</span> <span class="o">=</span> <span class="n">iomsg</span>
<a name="ln-1747"></a>  <span class="n">form_</span> <span class="o">=</span> <span class="s1">&#39;FORMATTED&#39;</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">form</span><span class="p">))</span> <span class="n">form_</span> <span class="o">=</span> <span class="n">form</span> <span class="p">;</span> <span class="n">form_</span> <span class="o">=</span> <span class="n">form_</span><span class="p">%</span><span class="n">upper</span><span class="p">()</span>
<a name="ln-1748"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">form_</span><span class="p">%</span><span class="n">chars</span><span class="p">())</span>
<a name="ln-1749"></a>  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;FORMATTED&#39;</span><span class="p">)</span>
<a name="ln-1750"></a>    <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="k">file</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;WRITE&#39;</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1751"></a>  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">)</span>
<a name="ln-1752"></a>    <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="k">file</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;WRITE&#39;</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">,</span> <span class="nb">access</span><span class="o">=</span><span class="s1">&#39;STREAM&#39;</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1753"></a>  <span class="n">endselect</span>
<a name="ln-1754"></a>  <span class="k">call </span><span class="n">self</span><span class="p">%</span><span class="n">write_lines</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">)</span>
<a name="ln-1755"></a>  <span class="mi">10</span> <span class="k">close</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
<a name="ln-1756"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="n">iostat</span> <span class="o">=</span> <span class="n">iostat_</span>
<a name="ln-1757"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg</span> <span class="o">=</span> <span class="n">iomsg_</span>
<a name="ln-1758"></a>  <span class="k">return</span>
<a name="ln-1759"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1760"></a>  <span class="n">endsubroutine</span> <span class="n">write_file</span>
<a name="ln-1761"></a>
<a name="ln-1762"></a>  <span class="k">subroutine </span><span class="n">write_line</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-1763"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1764"></a>  <span class="c">!&lt; Write line (record) to a connected unit.</span>
<a name="ln-1765"></a>  <span class="c">!&lt;</span>
<a name="ln-1766"></a>  <span class="c">!&lt; @note If the connected unit is unformatted a `new_line()` character is added at the end (if necessary) to mark the end of line.</span>
<a name="ln-1767"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1768"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">self</span>    <span class="c">!&lt; The string.</span>
<a name="ln-1769"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">unit</span>    <span class="c">!&lt; Logical unit.</span>
<a name="ln-1770"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span>    <span class="k">optional</span> <span class="kd">::</span> <span class="n">form</span>    <span class="c">!&lt; Format of unit.</span>
<a name="ln-1771"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span>   <span class="k">optional</span> <span class="kd">::</span> <span class="n">iostat</span>  <span class="c">!&lt; IO status code.</span>
<a name="ln-1772"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">iomsg</span>   <span class="c">!&lt; IO status message.</span>
<a name="ln-1773"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                              <span class="kd">::</span> <span class="n">form_</span>   <span class="c">!&lt; Format of unit, local variable.</span>
<a name="ln-1774"></a>  <span class="kt">integer</span>                                   <span class="kd">::</span> <span class="n">iostat_</span> <span class="c">!&lt; IO status code, local variable.</span>
<a name="ln-1775"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>             <span class="kd">::</span> <span class="n">iomsg_</span>  <span class="c">!&lt; IO status message, local variable.</span>
<a name="ln-1776"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1777"></a>
<a name="ln-1778"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1779"></a>  <span class="n">iostat_</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1780"></a>  <span class="n">iomsg_</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg_</span> <span class="o">=</span> <span class="n">iomsg</span>
<a name="ln-1781"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1782"></a><span class="k">    </span><span class="n">form_</span> <span class="o">=</span> <span class="s1">&#39;FORMATTED&#39;</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">form</span><span class="p">))</span> <span class="n">form_</span> <span class="o">=</span> <span class="n">form</span> <span class="p">;</span> <span class="n">form_</span> <span class="o">=</span> <span class="n">form_</span><span class="p">%</span><span class="n">upper</span><span class="p">()</span>
<a name="ln-1783"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">form_</span><span class="p">%</span><span class="n">chars</span><span class="p">())</span>
<a name="ln-1784"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;FORMATTED&#39;</span><span class="p">)</span>
<a name="ln-1785"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">)</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-1786"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">)</span>
<a name="ln-1787"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">end_with</span><span class="p">(</span><span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)))</span> <span class="k">then</span>
<a name="ln-1788"></a><span class="k">        write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">)</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-1789"></a>      <span class="k">else</span>
<a name="ln-1790"></a><span class="k">        write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">)</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<a name="ln-1791"></a>      <span class="n">endif</span>
<a name="ln-1792"></a>    <span class="n">endselect</span>
<a name="ln-1793"></a>  <span class="n">endif</span>
<a name="ln-1794"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="n">iostat</span> <span class="o">=</span> <span class="n">iostat_</span>
<a name="ln-1795"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg</span> <span class="o">=</span> <span class="n">iomsg_</span>
<a name="ln-1796"></a>  <span class="k">return</span>
<a name="ln-1797"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1798"></a>  <span class="n">endsubroutine</span> <span class="n">write_line</span>
<a name="ln-1799"></a>
<a name="ln-1800"></a>  <span class="k">subroutine </span><span class="n">write_lines</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-1801"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1802"></a>  <span class="c">!&lt; Write lines (records) to a connected unit.</span>
<a name="ln-1803"></a>  <span class="c">!&lt;</span>
<a name="ln-1804"></a>  <span class="c">!&lt; This method checks if self contains more than one line (records) and writes them as lines (records).</span>
<a name="ln-1805"></a>  <span class="c">!&lt;</span>
<a name="ln-1806"></a>  <span class="c">!&lt; @note If the connected unit is unformatted a `new_line()` character is added at the end (if necessary) to mark the end of line.</span>
<a name="ln-1807"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1808"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-1809"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">unit</span>     <span class="c">!&lt; Logical unit.</span>
<a name="ln-1810"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span>    <span class="k">optional</span> <span class="kd">::</span> <span class="n">form</span>     <span class="c">!&lt; Format of unit.</span>
<a name="ln-1811"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span>   <span class="k">optional</span> <span class="kd">::</span> <span class="n">iostat</span>   <span class="c">!&lt; IO status code.</span>
<a name="ln-1812"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">iomsg</span>    <span class="c">!&lt; IO status message.</span>
<a name="ln-1813"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">lines</span><span class="p">(:)</span> <span class="c">!&lt; Lines.</span>
<a name="ln-1814"></a>  <span class="kt">integer</span>                                   <span class="kd">::</span> <span class="n">l</span>        <span class="c">!&lt; Counter.</span>
<a name="ln-1815"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1816"></a>
<a name="ln-1817"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1818"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1819"></a><span class="k">    call </span><span class="n">self</span><span class="p">%</span><span class="n">split</span><span class="p">(</span><span class="n">tokens</span><span class="o">=</span><span class="n">lines</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<a name="ln-1820"></a>    <span class="k">do </span><span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1821"></a>       <span class="k">call </span><span class="n">lines</span><span class="p">(</span><span class="n">l</span><span class="p">)%</span><span class="n">write_line</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span>
<a name="ln-1822"></a>    <span class="n">enddo</span>
<a name="ln-1823"></a>  <span class="n">endif</span>
<a name="ln-1824"></a>  <span class="k">return</span>
<a name="ln-1825"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1826"></a>  <span class="n">endsubroutine</span> <span class="n">write_lines</span>
<a name="ln-1827"></a>
<a name="ln-1828"></a>  <span class="c">! inquire</span>
<a name="ln-1829"></a>  <span class="k">elemental function </span><span class="n">end_with</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">suffix</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="k">end</span><span class="p">)</span>
<a name="ln-1830"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1831"></a>  <span class="c">!&lt; Return true if a string ends with a specified suffix.</span>
<a name="ln-1832"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1833"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-1834"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">suffix</span>   <span class="c">!&lt; Searched suffix.</span>
<a name="ln-1835"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">start</span>    <span class="c">!&lt; Start position into the string.</span>
<a name="ln-1836"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="k">end</span>      <span class="c">!&lt; End position into the string.</span>
<a name="ln-1837"></a>  <span class="kt">logical</span>                                         <span class="kd">::</span> <span class="n">end_with</span> <span class="c">!&lt; Result of the test.</span>
<a name="ln-1838"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">start_</span>   <span class="c">!&lt; Start position into the string, local variable.</span>
<a name="ln-1839"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">end_</span>     <span class="c">!&lt; End position into the string, local variable.</span>
<a name="ln-1840"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1841"></a>
<a name="ln-1842"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1843"></a>  <span class="n">end_with</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1844"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1845"></a><span class="k">    </span><span class="n">start_</span> <span class="o">=</span> <span class="mi">1</span>             <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">start</span><span class="p">))</span> <span class="n">start_</span> <span class="o">=</span> <span class="n">start</span>
<a name="ln-1846"></a>    <span class="n">end_</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="k">end</span><span class="p">))</span>   <span class="n">end_</span>   <span class="o">=</span> <span class="k">end</span>
<a name="ln-1847"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span><span class="o">&lt;=</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">start_</span><span class="p">:</span><span class="n">end_</span><span class="p">)))</span> <span class="k">then</span>
<a name="ln-1848"></a><span class="k">      </span><span class="n">end_with</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">start_</span><span class="p">:</span><span class="n">end_</span><span class="p">),</span> <span class="n">suffix</span><span class="p">)</span><span class="o">==</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">start_</span><span class="p">:</span><span class="n">end_</span><span class="p">))</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1849"></a>    <span class="n">endif</span>
<a name="ln-1850"></a>  <span class="n">endif</span>
<a name="ln-1851"></a>  <span class="k">return</span>
<a name="ln-1852"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1853"></a>  <span class="n">endfunction</span> <span class="n">end_with</span>
<a name="ln-1854"></a>
<a name="ln-1855"></a>  <span class="k">elemental function </span><span class="n">is_allocated</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-1856"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1857"></a>  <span class="c">!&lt; Return true if the string is allocated.</span>
<a name="ln-1858"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1859"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-1860"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_allocated</span> <span class="c">!&lt; Result of the test.</span>
<a name="ln-1861"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1862"></a>
<a name="ln-1863"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1864"></a>  <span class="n">is_allocated</span> <span class="o">=</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-1865"></a>  <span class="k">return</span>
<a name="ln-1866"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1867"></a>  <span class="n">endfunction</span> <span class="n">is_allocated</span>
<a name="ln-1868"></a>
<a name="ln-1869"></a>  <span class="k">elemental function </span><span class="n">is_digit</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-1870"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1871"></a>  <span class="c">!&lt; Return true if all characters in the string are digits.</span>
<a name="ln-1872"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1873"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-1874"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_digit</span> <span class="c">!&lt; Result of the test.</span>
<a name="ln-1875"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">c</span>        <span class="c">!&lt; Character counter.</span>
<a name="ln-1876"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1877"></a>
<a name="ln-1878"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1879"></a>  <span class="n">is_digit</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1880"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1881"></a><span class="k">    do </span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-1882"></a>      <span class="k">select case</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">))</span>
<a name="ln-1883"></a>      <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">:</span><span class="s1">&#39;9&#39;</span><span class="p">)</span>
<a name="ln-1884"></a>        <span class="n">is_digit</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1885"></a>      <span class="k">case </span><span class="n">default</span>
<a name="ln-1886"></a>        <span class="n">is_digit</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1887"></a>        <span class="k">exit</span>
<a name="ln-1888"></a><span class="k">      end select</span>
<a name="ln-1889"></a><span class="k">    </span><span class="n">enddo</span>
<a name="ln-1890"></a>  <span class="n">endif</span>
<a name="ln-1891"></a>  <span class="k">return</span>
<a name="ln-1892"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1893"></a>  <span class="n">endfunction</span> <span class="n">is_digit</span>
<a name="ln-1894"></a>
<a name="ln-1895"></a>  <span class="k">elemental function </span><span class="n">is_integer</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">allow_spaces</span><span class="p">)</span>
<a name="ln-1896"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1897"></a>  <span class="c">!&lt; Return true if the string contains an integer.</span>
<a name="ln-1898"></a>  <span class="c">!&lt;</span>
<a name="ln-1899"></a>  <span class="c">!&lt; The regular expression is `\s*[\+\-]?\d+([eE]\+?\d+)?\s*`. The parse algorithm is done in stages:</span>
<a name="ln-1900"></a>  <span class="c">!&lt;</span>
<a name="ln-1901"></a>  <span class="c">!&lt; | S0  | S1      | S2  | S3   | S4  | S5  | S6  |</span>
<a name="ln-1902"></a>  <span class="c">!&lt; |-----|---------|-----|------|-----|-----|-----|</span>
<a name="ln-1903"></a>  <span class="c">!&lt; |`\s*`|`[\+\-]?`|`\d+`|`[eE]`|`\+?`|`\d+`|`\s*`|</span>
<a name="ln-1904"></a>  <span class="c">!&lt;</span>
<a name="ln-1905"></a>  <span class="c">!&lt; Exit on stages-parsing results in:</span>
<a name="ln-1906"></a>  <span class="c">!&lt;</span>
<a name="ln-1907"></a>  <span class="c">!&lt; | S0 | S1 | S2 | S3 | S4 | S5 | S6 |</span>
<a name="ln-1908"></a>  <span class="c">!&lt; |----|----|----|----|----|----|----|</span>
<a name="ln-1909"></a>  <span class="c">!&lt; |  F |  F |  T |  F |  F |  T |  T |</span>
<a name="ln-1910"></a>  <span class="c">!&lt;</span>
<a name="ln-1911"></a>  <span class="c">!&lt; @note This implementation is courtesy of</span>
<a name="ln-1912"></a>  <span class="c">!&lt; [tomedunn](https://github.com/tomedunn/fortran-string-utility-module/blob/master/src/string_utility_module.f90#L294)</span>
<a name="ln-1913"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1914"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>          <span class="c">!&lt; The string.</span>
<a name="ln-1915"></a>  <span class="kt">logical</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">allow_spaces</span>  <span class="c">!&lt; Allow leading-trailing spaces.</span>
<a name="ln-1916"></a>  <span class="kt">logical</span>                             <span class="kd">::</span> <span class="n">is_integer</span>    <span class="c">!&lt; Result of the test.</span>
<a name="ln-1917"></a>  <span class="kt">logical</span>                             <span class="kd">::</span> <span class="n">allow_spaces_</span> <span class="c">!&lt; Allow leading-trailing spaces, local variable.</span>
<a name="ln-1918"></a>  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">stage</span>         <span class="c">!&lt; Stages counter.</span>
<a name="ln-1919"></a>  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">c</span>             <span class="c">!&lt; Character counter.</span>
<a name="ln-1920"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1921"></a>
<a name="ln-1922"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1923"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1924"></a><span class="k">    </span><span class="n">allow_spaces_</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">allow_spaces</span><span class="p">))</span> <span class="n">allow_spaces_</span> <span class="o">=</span> <span class="n">allow_spaces</span>
<a name="ln-1925"></a>    <span class="n">stage</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1926"></a>    <span class="n">is_integer</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1927"></a>    <span class="k">do </span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-1928"></a>      <span class="k">select case</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">))</span>
<a name="ln-1929"></a>      <span class="k">case</span><span class="p">(</span><span class="n">SPACE</span><span class="p">,</span> <span class="n">TAB</span><span class="p">)</span>
<a name="ln-1930"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-1931"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a name="ln-1932"></a>          <span class="n">is_integer</span> <span class="o">=</span> <span class="n">allow_spaces_</span>
<a name="ln-1933"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a name="ln-1934"></a>          <span class="n">is_integer</span> <span class="o">=</span> <span class="n">allow_spaces_</span>
<a name="ln-1935"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">6</span>
<a name="ln-1936"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-1937"></a>          <span class="n">is_integer</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1938"></a>        <span class="n">endselect</span>
<a name="ln-1939"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<a name="ln-1940"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-1941"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-1942"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1943"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-1944"></a>          <span class="n">is_integer</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1945"></a>        <span class="k">end select</span>
<a name="ln-1946"></a><span class="k">      case</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
<a name="ln-1947"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-1948"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-1949"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1950"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1951"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-1952"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-1953"></a>          <span class="n">is_integer</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1954"></a>        <span class="n">endselect</span>
<a name="ln-1955"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">:</span><span class="s1">&#39;9&#39;</span><span class="p">)</span>
<a name="ln-1956"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-1957"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1958"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-1959"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1960"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-1961"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-1962"></a>          <span class="k">continue</span>
<a name="ln-1963"></a><span class="k">        </span><span class="n">endselect</span>
<a name="ln-1964"></a>      <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
<a name="ln-1965"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-1966"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1967"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-1968"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-1969"></a>          <span class="n">is_integer</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1970"></a>        <span class="n">endselect</span>
<a name="ln-1971"></a>      <span class="k">case </span><span class="n">default</span>
<a name="ln-1972"></a>        <span class="n">is_integer</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1973"></a>      <span class="n">endselect</span>
<a name="ln-1974"></a>      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">is_integer</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-1975"></a><span class="k">    </span><span class="n">enddo</span>
<a name="ln-1976"></a>  <span class="n">endif</span>
<a name="ln-1977"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">is_integer</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1978"></a><span class="k">    select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-1979"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a name="ln-1980"></a>      <span class="n">is_integer</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1981"></a>    <span class="k">case </span><span class="n">default</span>
<a name="ln-1982"></a>      <span class="n">is_integer</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1983"></a>    <span class="k">end select</span>
<a name="ln-1984"></a><span class="k">  </span><span class="n">endif</span>
<a name="ln-1985"></a>  <span class="k">return</span>
<a name="ln-1986"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1987"></a>  <span class="n">endfunction</span> <span class="n">is_integer</span>
<a name="ln-1988"></a>
<a name="ln-1989"></a>  <span class="k">elemental function </span><span class="n">is_lower</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-1990"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1991"></a>  <span class="c">!&lt; Return true if all characters in the string are lowercase.</span>
<a name="ln-1992"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1993"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-1994"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_lower</span> <span class="c">!&lt; Result of the test.</span>
<a name="ln-1995"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">c</span>        <span class="c">!&lt; Character counter.</span>
<a name="ln-1996"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1997"></a>
<a name="ln-1998"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1999"></a>  <span class="n">is_lower</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2000"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2001"></a><span class="k">    </span><span class="n">is_lower</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2002"></a>    <span class="k">do </span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-2003"></a>      <span class="k">if</span> <span class="p">(</span><span class="nb">index</span><span class="p">(</span><span class="n">UPPER_ALPHABET</span><span class="p">,</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2004"></a><span class="k">        </span><span class="n">is_lower</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2005"></a>        <span class="k">exit</span>
<a name="ln-2006"></a><span class="k">      </span><span class="n">endif</span>
<a name="ln-2007"></a>    <span class="n">enddo</span>
<a name="ln-2008"></a>  <span class="n">endif</span>
<a name="ln-2009"></a>  <span class="k">return</span>
<a name="ln-2010"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2011"></a>  <span class="n">endfunction</span> <span class="n">is_lower</span>
<a name="ln-2012"></a>
<a name="ln-2013"></a>  <span class="k">elemental function </span><span class="n">is_number</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">allow_spaces</span><span class="p">)</span>
<a name="ln-2014"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2015"></a>  <span class="c">!&lt; Return true if the string contains a number (real or integer).</span>
<a name="ln-2016"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2017"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>         <span class="c">!&lt; The string.</span>
<a name="ln-2018"></a>  <span class="kt">logical</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">allow_spaces</span> <span class="c">!&lt; Allow leading-trailing spaces.</span>
<a name="ln-2019"></a>  <span class="kt">logical</span>                             <span class="kd">::</span> <span class="n">is_number</span>    <span class="c">!&lt; Result of the test.</span>
<a name="ln-2020"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2021"></a>
<a name="ln-2022"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2023"></a>  <span class="n">is_number</span> <span class="o">=</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">is_integer</span><span class="p">(</span><span class="n">allow_spaces</span><span class="o">=</span><span class="n">allow_spaces</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span><span class="n">self</span><span class="p">%</span><span class="n">is_real</span><span class="p">(</span><span class="n">allow_spaces</span><span class="o">=</span><span class="n">allow_spaces</span><span class="p">))</span>
<a name="ln-2024"></a>  <span class="k">return</span>
<a name="ln-2025"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2026"></a>  <span class="n">endfunction</span> <span class="n">is_number</span>
<a name="ln-2027"></a>
<a name="ln-2028"></a>  <span class="k">elemental function </span><span class="n">is_real</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">allow_spaces</span><span class="p">)</span>
<a name="ln-2029"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2030"></a>  <span class="c">!&lt; Return true if the string contains a real.</span>
<a name="ln-2031"></a>  <span class="c">!&lt;</span>
<a name="ln-2032"></a>  <span class="c">!&lt; The regular expression is `\s*[\+\-]?\d*(|\.?\d*([deDE][\+\-]?\d+)?)\s*`. The parse algorithm is done in stages:</span>
<a name="ln-2033"></a>  <span class="c">!&lt;</span>
<a name="ln-2034"></a>  <span class="c">!&lt; | S0  | S1      | S2  | S3  | S4  | S5     | S6      | S7  | S8  |</span>
<a name="ln-2035"></a>  <span class="c">!&lt; |-----|---------|-----|-----|-----|--------|---------|-----|-----|</span>
<a name="ln-2036"></a>  <span class="c">!&lt; |`\s*`|`[\+\-]?`|`\d*`|`\.?`|`\d*`|`[deDE]`|`[\+\-]?`|`\d*`|`\s*`|</span>
<a name="ln-2037"></a>  <span class="c">!&lt;</span>
<a name="ln-2038"></a>  <span class="c">!&lt; Exit on stages-parsing results in:</span>
<a name="ln-2039"></a>  <span class="c">!&lt;</span>
<a name="ln-2040"></a>  <span class="c">!&lt; | S0 | S1 | S2 | S3 | S4 | S5 | S6 | S7 | S8 |</span>
<a name="ln-2041"></a>  <span class="c">!&lt; |----|----|----|----|----|----|----|----|----|</span>
<a name="ln-2042"></a>  <span class="c">!  |  F |  F |  T |  T |  T |  F |  F |  T |  T |</span>
<a name="ln-2043"></a>  <span class="c">!&lt;</span>
<a name="ln-2044"></a>  <span class="c">!&lt; @note This implementation is courtesy of</span>
<a name="ln-2045"></a>  <span class="c">!&lt; [tomedunn](https://github.com/tomedunn/fortran-string-utility-module/blob/master/src/string_utility_module.f90#L614)</span>
<a name="ln-2046"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2047"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>              <span class="c">!&lt; The string.</span>
<a name="ln-2048"></a>  <span class="kt">logical</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">allow_spaces</span>      <span class="c">!&lt; Allow leading-trailing spaces.</span>
<a name="ln-2049"></a>  <span class="kt">logical</span>                             <span class="kd">::</span> <span class="n">is_real</span>           <span class="c">!&lt; Result of the test.</span>
<a name="ln-2050"></a>  <span class="kt">logical</span>                             <span class="kd">::</span> <span class="n">allow_spaces_</span>     <span class="c">!&lt; Allow leading-trailing spaces, local variable.</span>
<a name="ln-2051"></a>  <span class="kt">logical</span>                             <span class="kd">::</span> <span class="n">has_leading_digit</span> <span class="c">!&lt; Check the presence of leading digits.</span>
<a name="ln-2052"></a>  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">stage</span>             <span class="c">!&lt; Stages counter.</span>
<a name="ln-2053"></a>  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">c</span>                 <span class="c">!&lt; Character counter.</span>
<a name="ln-2054"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2055"></a>
<a name="ln-2056"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2057"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2058"></a><span class="k">    </span><span class="n">allow_spaces_</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">allow_spaces</span><span class="p">))</span> <span class="n">allow_spaces_</span> <span class="o">=</span> <span class="n">allow_spaces</span>
<a name="ln-2059"></a>    <span class="n">stage</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2060"></a>    <span class="n">is_real</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2061"></a>    <span class="n">has_leading_digit</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2062"></a>    <span class="k">do </span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-2063"></a>      <span class="k">select case</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">))</span>
<a name="ln-2064"></a>      <span class="k">case</span><span class="p">(</span><span class="n">SPACE</span><span class="p">,</span> <span class="n">TAB</span><span class="p">)</span>
<a name="ln-2065"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-2066"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<a name="ln-2067"></a>          <span class="n">is_real</span> <span class="o">=</span> <span class="n">allow_spaces_</span>
<a name="ln-2068"></a>          <span class="k">continue</span>
<a name="ln-2069"></a><span class="k">        case</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-2070"></a>          <span class="n">is_real</span> <span class="o">=</span> <span class="n">allow_spaces_</span>
<a name="ln-2071"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">8</span>
<a name="ln-2072"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-2073"></a>          <span class="n">is_real</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2074"></a>        <span class="n">endselect</span>
<a name="ln-2075"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<a name="ln-2076"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-2077"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-2078"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2079"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-2080"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">6</span>
<a name="ln-2081"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-2082"></a>          <span class="n">is_real</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2083"></a>        <span class="n">endselect</span>
<a name="ln-2084"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">:</span><span class="s1">&#39;9&#39;</span><span class="p">)</span>
<a name="ln-2085"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-2086"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2087"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-2088"></a>          <span class="n">has_leading_digit</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2089"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2090"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-2091"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">5</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-2092"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">7</span>
<a name="ln-2093"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-2094"></a>          <span class="k">continue</span>
<a name="ln-2095"></a><span class="k">        </span><span class="n">endselect</span>
<a name="ln-2096"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-2097"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-2098"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2099"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-2100"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-2101"></a>          <span class="n">is_real</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2102"></a>        <span class="n">endselect</span>
<a name="ln-2103"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<a name="ln-2104"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-2105"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-2106"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-2107"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-2108"></a>          <span class="n">is_real</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2109"></a>        <span class="n">endselect</span>
<a name="ln-2110"></a>      <span class="k">case </span><span class="n">default</span>
<a name="ln-2111"></a>        <span class="n">is_real</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2112"></a>      <span class="n">endselect</span>
<a name="ln-2113"></a>      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">is_real</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-2114"></a><span class="k">    </span><span class="n">enddo</span>
<a name="ln-2115"></a>  <span class="n">endif</span>
<a name="ln-2116"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">is_real</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2117"></a><span class="k">    select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-2118"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<a name="ln-2119"></a>      <span class="n">is_real</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2120"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2121"></a>      <span class="n">is_real</span> <span class="o">=</span> <span class="n">has_leading_digit</span>
<a name="ln-2122"></a>    <span class="k">case </span><span class="n">default</span>
<a name="ln-2123"></a>      <span class="n">is_real</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2124"></a>    <span class="n">endselect</span>
<a name="ln-2125"></a>  <span class="n">endif</span>
<a name="ln-2126"></a>  <span class="k">return</span>
<a name="ln-2127"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2128"></a>  <span class="n">endfunction</span> <span class="n">is_real</span>
<a name="ln-2129"></a>
<a name="ln-2130"></a>  <span class="k">elemental function </span><span class="n">is_upper</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-2131"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2132"></a>  <span class="c">!&lt; Return true if all characters in the string are uppercase.</span>
<a name="ln-2133"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2134"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-2135"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_upper</span> <span class="c">!&lt; Result of the test.</span>
<a name="ln-2136"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">c</span>        <span class="c">!&lt; Character counter.</span>
<a name="ln-2137"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2138"></a>
<a name="ln-2139"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2140"></a>  <span class="n">is_upper</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2141"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2142"></a><span class="k">    </span><span class="n">is_upper</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2143"></a>    <span class="k">do </span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-2144"></a>      <span class="k">if</span> <span class="p">(</span><span class="nb">index</span><span class="p">(</span><span class="n">LOWER_ALPHABET</span><span class="p">,</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2145"></a><span class="k">        </span><span class="n">is_upper</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2146"></a>        <span class="k">exit</span>
<a name="ln-2147"></a><span class="k">      </span><span class="n">endif</span>
<a name="ln-2148"></a>    <span class="n">enddo</span>
<a name="ln-2149"></a>  <span class="n">endif</span>
<a name="ln-2150"></a>  <span class="k">return</span>
<a name="ln-2151"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2152"></a>  <span class="n">endfunction</span> <span class="n">is_upper</span>
<a name="ln-2153"></a>
<a name="ln-2154"></a>  <span class="k">elemental function </span><span class="n">start_with</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="k">end</span><span class="p">)</span>
<a name="ln-2155"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2156"></a>  <span class="c">!&lt; Return true if a string starts with a specified prefix.</span>
<a name="ln-2157"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2158"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>       <span class="c">!&lt; The string.</span>
<a name="ln-2159"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">prefix</span>     <span class="c">!&lt; Searched prefix.</span>
<a name="ln-2160"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">start</span>      <span class="c">!&lt; Start position into the string.</span>
<a name="ln-2161"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="k">end</span>        <span class="c">!&lt; End position into the string.</span>
<a name="ln-2162"></a>  <span class="kt">logical</span>                                         <span class="kd">::</span> <span class="n">start_with</span> <span class="c">!&lt; Result of the test.</span>
<a name="ln-2163"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">start_</span>     <span class="c">!&lt; Start position into the string, local variable.</span>
<a name="ln-2164"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">end_</span>       <span class="c">!&lt; End position into the string, local variable.</span>
<a name="ln-2165"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2166"></a>
<a name="ln-2167"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2168"></a>  <span class="n">start_with</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2169"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2170"></a><span class="k">    </span><span class="n">start_</span> <span class="o">=</span> <span class="mi">1</span>             <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">start</span><span class="p">))</span> <span class="n">start_</span> <span class="o">=</span> <span class="n">start</span>
<a name="ln-2171"></a>    <span class="n">end_</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="k">end</span><span class="p">))</span>   <span class="n">end_</span>   <span class="o">=</span> <span class="k">end</span>
<a name="ln-2172"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span><span class="o">&lt;=</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">start_</span><span class="p">:</span><span class="n">end_</span><span class="p">)))</span> <span class="k">then</span>
<a name="ln-2173"></a><span class="k">      </span><span class="n">start_with</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">start_</span><span class="p">:</span><span class="n">end_</span><span class="p">),</span> <span class="n">prefix</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span>
<a name="ln-2174"></a>    <span class="n">endif</span>
<a name="ln-2175"></a>  <span class="n">endif</span>
<a name="ln-2176"></a>  <span class="k">return</span>
<a name="ln-2177"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2178"></a>  <span class="n">endfunction</span> <span class="n">start_with</span>
<a name="ln-2179"></a>
<a name="ln-2180"></a>  <span class="c">! private methods</span>
<a name="ln-2181"></a>
<a name="ln-2182"></a>  <span class="c">! assignments</span>
<a name="ln-2183"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2184"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2185"></a>  <span class="c">!&lt; Assignment operator from string input.</span>
<a name="ln-2186"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2187"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2188"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2189"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2190"></a>
<a name="ln-2191"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2192"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2193"></a>  <span class="k">return</span>
<a name="ln-2194"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2195"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_string</span>
<a name="ln-2196"></a>
<a name="ln-2197"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_character</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2198"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2199"></a>  <span class="c">!&lt; Assignment operator from character input.</span>
<a name="ln-2200"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2201"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2202"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2203"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2204"></a>
<a name="ln-2205"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2206"></a>  <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">rhs</span>
<a name="ln-2207"></a>  <span class="k">return</span>
<a name="ln-2208"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2209"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_character</span>
<a name="ln-2210"></a>
<a name="ln-2211"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_integer_I1P</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2212"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2213"></a>  <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-2214"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2215"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2216"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2217"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2218"></a>
<a name="ln-2219"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2220"></a>  <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">rhs</span><span class="p">))</span>
<a name="ln-2221"></a>  <span class="k">return</span>
<a name="ln-2222"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2223"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_integer_I1P</span>
<a name="ln-2224"></a>
<a name="ln-2225"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_integer_I2P</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2226"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2227"></a>  <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-2228"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2229"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2230"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2231"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2232"></a>
<a name="ln-2233"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2234"></a>  <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">rhs</span><span class="p">))</span>
<a name="ln-2235"></a>  <span class="k">return</span>
<a name="ln-2236"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2237"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_integer_I2P</span>
<a name="ln-2238"></a>
<a name="ln-2239"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_integer_I4P</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2240"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2241"></a>  <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-2242"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2243"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2244"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2245"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2246"></a>
<a name="ln-2247"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2248"></a>  <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">rhs</span><span class="p">))</span>
<a name="ln-2249"></a>  <span class="k">return</span>
<a name="ln-2250"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2251"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_integer_I4P</span>
<a name="ln-2252"></a>
<a name="ln-2253"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_integer_I8P</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2254"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2255"></a>  <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-2256"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2257"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2258"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2259"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2260"></a>
<a name="ln-2261"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2262"></a>  <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">rhs</span><span class="p">))</span>
<a name="ln-2263"></a>  <span class="k">return</span>
<a name="ln-2264"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2265"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_integer_I8P</span>
<a name="ln-2266"></a>
<a name="ln-2267"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_real_R4P</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2268"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2269"></a>  <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-2270"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2271"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2272"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2273"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2274"></a>
<a name="ln-2275"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2276"></a>  <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">rhs</span><span class="p">))</span>
<a name="ln-2277"></a>  <span class="k">return</span>
<a name="ln-2278"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2279"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_real_R4P</span>
<a name="ln-2280"></a>
<a name="ln-2281"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_real_R8P</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2282"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2283"></a>  <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-2284"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2285"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2286"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2287"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2288"></a>
<a name="ln-2289"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2290"></a>  <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">rhs</span><span class="p">))</span>
<a name="ln-2291"></a>  <span class="k">return</span>
<a name="ln-2292"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2293"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_real_R8P</span>
<a name="ln-2294"></a>
<a name="ln-2295"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_real_R16P</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2296"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2297"></a>  <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-2298"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2299"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2300"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2301"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2302"></a>
<a name="ln-2303"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2304"></a>  <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">rhs</span><span class="p">))</span>
<a name="ln-2305"></a>  <span class="k">return</span>
<a name="ln-2306"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2307"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_real_R16P</span>
<a name="ln-2308"></a>
<a name="ln-2309"></a>  <span class="c">! contatenation operators</span>
<a name="ln-2310"></a>  <span class="k">pure function </span><span class="n">string_concat_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">concat</span><span class="p">)</span>
<a name="ln-2311"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2312"></a>  <span class="c">!&lt; Concatenation with string.</span>
<a name="ln-2313"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2314"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">lhs</span>    <span class="c">!&lt; Left hand side.</span>
<a name="ln-2315"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">rhs</span>    <span class="c">!&lt; Right hand side.</span>
<a name="ln-2316"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">concat</span> <span class="c">!&lt; Concatenated string.</span>
<a name="ln-2317"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2318"></a>
<a name="ln-2319"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2320"></a>  <span class="n">concat</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-2321"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">lhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">concat</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2322"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">concat</span> <span class="o">=</span> <span class="n">concat</span><span class="o">//</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2323"></a>  <span class="k">return</span>
<a name="ln-2324"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2325"></a>  <span class="n">endfunction</span> <span class="n">string_concat_string</span>
<a name="ln-2326"></a>
<a name="ln-2327"></a>  <span class="k">pure function </span><span class="n">string_concat_character</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">concat</span><span class="p">)</span>
<a name="ln-2328"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2329"></a>  <span class="c">!&lt; Concatenation with character.</span>
<a name="ln-2330"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2331"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">lhs</span>    <span class="c">!&lt; Left hand side.</span>
<a name="ln-2332"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">rhs</span>    <span class="c">!&lt; Right hand side.</span>
<a name="ln-2333"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">concat</span> <span class="c">!&lt; Concatenated string.</span>
<a name="ln-2334"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2335"></a>
<a name="ln-2336"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2337"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">lhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2338"></a><span class="k">    </span><span class="n">concat</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">rhs</span>
<a name="ln-2339"></a>  <span class="k">else</span>
<a name="ln-2340"></a><span class="k">    </span><span class="n">concat</span> <span class="o">=</span> <span class="n">rhs</span>
<a name="ln-2341"></a>  <span class="n">endif</span>
<a name="ln-2342"></a>  <span class="k">return</span>
<a name="ln-2343"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2344"></a>  <span class="n">endfunction</span> <span class="n">string_concat_character</span>
<a name="ln-2345"></a>
<a name="ln-2346"></a>  <span class="k">pure function </span><span class="n">character_concat_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">concat</span><span class="p">)</span>
<a name="ln-2347"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2348"></a>  <span class="c">!&lt; Concatenation with character (inverted).</span>
<a name="ln-2349"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2350"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">lhs</span>    <span class="c">!&lt; Left hand side.</span>
<a name="ln-2351"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">rhs</span>    <span class="c">!&lt; Right hand side.</span>
<a name="ln-2352"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">concat</span> <span class="c">!&lt; Concatenated string.</span>
<a name="ln-2353"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2354"></a>
<a name="ln-2355"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2356"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2357"></a><span class="k">    </span><span class="n">concat</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">//</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2358"></a>  <span class="k">else</span>
<a name="ln-2359"></a><span class="k">    </span><span class="n">concat</span> <span class="o">=</span> <span class="n">lhs</span>
<a name="ln-2360"></a>  <span class="n">endif</span>
<a name="ln-2361"></a>  <span class="k">return</span>
<a name="ln-2362"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2363"></a>  <span class="n">endfunction</span> <span class="n">character_concat_string</span>
<a name="ln-2364"></a>
<a name="ln-2365"></a>  <span class="k">elemental function </span><span class="n">string_concat_string_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">concat</span><span class="p">)</span>
<a name="ln-2366"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2367"></a>  <span class="c">!&lt; Concatenation with string.</span>
<a name="ln-2368"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2369"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">lhs</span>       <span class="c">!&lt; Left hand side.</span>
<a name="ln-2370"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">rhs</span>       <span class="c">!&lt; Right hand side.</span>
<a name="ln-2371"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                           <span class="kd">::</span> <span class="n">concat</span>    <span class="c">!&lt; Concatenated string.</span>
<a name="ln-2372"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">temporary</span> <span class="c">!&lt; Temporary concatenated string.</span>
<a name="ln-2373"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2374"></a>
<a name="ln-2375"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2376"></a>  <span class="n">temporary</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-2377"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">lhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">temporary</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2378"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">temporary</span> <span class="o">=</span> <span class="n">temporary</span><span class="o">//</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2379"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">temporary</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="n">concat</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span>
<a name="ln-2380"></a>  <span class="k">return</span>
<a name="ln-2381"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2382"></a>  <span class="n">endfunction</span> <span class="n">string_concat_string_string</span>
<a name="ln-2383"></a>
<a name="ln-2384"></a>  <span class="k">elemental function </span><span class="n">string_concat_character_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">concat</span><span class="p">)</span>
<a name="ln-2385"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2386"></a>  <span class="c">!&lt; Concatenation with character.</span>
<a name="ln-2387"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2388"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">lhs</span>    <span class="c">!&lt; Left hand side.</span>
<a name="ln-2389"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">rhs</span>    <span class="c">!&lt; Right hand side.</span>
<a name="ln-2390"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                           <span class="kd">::</span> <span class="n">concat</span> <span class="c">!&lt; Concatenated string.</span>
<a name="ln-2391"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2392"></a>
<a name="ln-2393"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2394"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">lhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2395"></a><span class="k">    </span><span class="n">concat</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">rhs</span>
<a name="ln-2396"></a>  <span class="k">else</span>
<a name="ln-2397"></a><span class="k">    </span><span class="n">concat</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">rhs</span>
<a name="ln-2398"></a>  <span class="n">endif</span>
<a name="ln-2399"></a>  <span class="k">return</span>
<a name="ln-2400"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2401"></a>  <span class="n">endfunction</span> <span class="n">string_concat_character_string</span>
<a name="ln-2402"></a>
<a name="ln-2403"></a>  <span class="k">elemental function </span><span class="n">character_concat_string_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">concat</span><span class="p">)</span>
<a name="ln-2404"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2405"></a>  <span class="c">!&lt; Concatenation with character (inverted).</span>
<a name="ln-2406"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2407"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">lhs</span>    <span class="c">!&lt; Left hand side.</span>
<a name="ln-2408"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">rhs</span>    <span class="c">!&lt; Right hand side.</span>
<a name="ln-2409"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                           <span class="kd">::</span> <span class="n">concat</span> <span class="c">!&lt; Concatenated string.</span>
<a name="ln-2410"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2411"></a>
<a name="ln-2412"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2413"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2414"></a><span class="k">    </span><span class="n">concat</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">//</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2415"></a>  <span class="k">else</span>
<a name="ln-2416"></a><span class="k">    </span><span class="n">concat</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">lhs</span>
<a name="ln-2417"></a>  <span class="n">endif</span>
<a name="ln-2418"></a>  <span class="k">return</span>
<a name="ln-2419"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2420"></a>  <span class="n">endfunction</span> <span class="n">character_concat_string_string</span>
<a name="ln-2421"></a>
<a name="ln-2422"></a>  <span class="c">! logical operators</span>
<a name="ln-2423"></a>  <span class="k">elemental function </span><span class="n">string_eq_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2424"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2425"></a>  <span class="c">!&lt; Equal to string logical operator.</span>
<a name="ln-2426"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2427"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2428"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2429"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2430"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2431"></a>
<a name="ln-2432"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2433"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">==</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2434"></a>  <span class="k">return</span>
<a name="ln-2435"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2436"></a>  <span class="n">endfunction</span> <span class="n">string_eq_string</span>
<a name="ln-2437"></a>
<a name="ln-2438"></a>  <span class="k">elemental function </span><span class="n">string_eq_character</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2439"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2440"></a>  <span class="c">!&lt; Equal to character logical operator.</span>
<a name="ln-2441"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2442"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2443"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2444"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2445"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2446"></a>
<a name="ln-2447"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2448"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">==</span> <span class="n">rhs</span>
<a name="ln-2449"></a>  <span class="k">return</span>
<a name="ln-2450"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2451"></a>  <span class="n">endfunction</span> <span class="n">string_eq_character</span>
<a name="ln-2452"></a>
<a name="ln-2453"></a>  <span class="k">elemental function </span><span class="n">character_eq_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2454"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2455"></a>  <span class="c">!&lt; Equal to character (inverted) logical operator.</span>
<a name="ln-2456"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2457"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2458"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2459"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2460"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2461"></a>
<a name="ln-2462"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2463"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">==</span> <span class="n">lhs</span>
<a name="ln-2464"></a>  <span class="k">return</span>
<a name="ln-2465"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2466"></a>  <span class="n">endfunction</span> <span class="n">character_eq_string</span>
<a name="ln-2467"></a>
<a name="ln-2468"></a>  <span class="k">elemental function </span><span class="n">string_ne_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2469"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2470"></a>  <span class="c">!&lt; Not equal to string logical operator.</span>
<a name="ln-2471"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2472"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2473"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2474"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2475"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2476"></a>
<a name="ln-2477"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2478"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">/=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2479"></a>  <span class="k">return</span>
<a name="ln-2480"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2481"></a>  <span class="n">endfunction</span> <span class="n">string_ne_string</span>
<a name="ln-2482"></a>
<a name="ln-2483"></a>  <span class="k">elemental function </span><span class="n">string_ne_character</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2484"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2485"></a>  <span class="c">!&lt; Not equal to character logical operator.</span>
<a name="ln-2486"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2487"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2488"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2489"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2490"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2491"></a>
<a name="ln-2492"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2493"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">/=</span> <span class="n">rhs</span>
<a name="ln-2494"></a>  <span class="k">return</span>
<a name="ln-2495"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2496"></a>  <span class="n">endfunction</span> <span class="n">string_ne_character</span>
<a name="ln-2497"></a>
<a name="ln-2498"></a>  <span class="k">elemental function </span><span class="n">character_ne_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2499"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2500"></a>  <span class="c">!&lt; Not equal to character (inverted) logical operator.</span>
<a name="ln-2501"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2502"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2503"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2504"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2505"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2506"></a>
<a name="ln-2507"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2508"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">/=</span> <span class="n">lhs</span>
<a name="ln-2509"></a>  <span class="k">return</span>
<a name="ln-2510"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2511"></a>  <span class="n">endfunction</span> <span class="n">character_ne_string</span>
<a name="ln-2512"></a>
<a name="ln-2513"></a>  <span class="k">elemental function </span><span class="n">string_lt_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2514"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2515"></a>  <span class="c">!&lt; Lower than to string logical operator.</span>
<a name="ln-2516"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2517"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2518"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2519"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2520"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2521"></a>
<a name="ln-2522"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2523"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">&lt;</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2524"></a>  <span class="k">return</span>
<a name="ln-2525"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2526"></a>  <span class="n">endfunction</span> <span class="n">string_lt_string</span>
<a name="ln-2527"></a>
<a name="ln-2528"></a>  <span class="k">elemental function </span><span class="n">string_lt_character</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2529"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2530"></a>  <span class="c">!&lt; Lower than to character logical operator.</span>
<a name="ln-2531"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2532"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2533"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2534"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2535"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2536"></a>
<a name="ln-2537"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2538"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">&lt;</span> <span class="n">rhs</span>
<a name="ln-2539"></a>  <span class="k">return</span>
<a name="ln-2540"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2541"></a>  <span class="n">endfunction</span> <span class="n">string_lt_character</span>
<a name="ln-2542"></a>
<a name="ln-2543"></a>  <span class="k">elemental function </span><span class="n">character_lt_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2544"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2545"></a>  <span class="c">!&lt; Lower than to character (inverted) logical operator.</span>
<a name="ln-2546"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2547"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2548"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2549"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2550"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2551"></a>
<a name="ln-2552"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2553"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span> <span class="o">&lt;</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2554"></a>  <span class="k">return</span>
<a name="ln-2555"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2556"></a>  <span class="n">endfunction</span> <span class="n">character_lt_string</span>
<a name="ln-2557"></a>
<a name="ln-2558"></a>  <span class="k">elemental function </span><span class="n">string_le_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2559"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2560"></a>  <span class="c">!&lt; Lower equal than to string logical operator.</span>
<a name="ln-2561"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2562"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2563"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2564"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2565"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2566"></a>
<a name="ln-2567"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2568"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">&lt;=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2569"></a>  <span class="k">return</span>
<a name="ln-2570"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2571"></a>  <span class="n">endfunction</span> <span class="n">string_le_string</span>
<a name="ln-2572"></a>
<a name="ln-2573"></a>  <span class="k">elemental function </span><span class="n">string_le_character</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2574"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2575"></a>  <span class="c">!&lt; Lower equal than to character logical operator.</span>
<a name="ln-2576"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2577"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2578"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2579"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2580"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2581"></a>
<a name="ln-2582"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2583"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">&lt;=</span> <span class="n">rhs</span>
<a name="ln-2584"></a>  <span class="k">return</span>
<a name="ln-2585"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2586"></a>  <span class="n">endfunction</span> <span class="n">string_le_character</span>
<a name="ln-2587"></a>
<a name="ln-2588"></a>  <span class="k">elemental function </span><span class="n">character_le_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2589"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2590"></a>  <span class="c">!&lt; Lower equal than to character (inverted) logical operator.</span>
<a name="ln-2591"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2592"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2593"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2594"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2595"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2596"></a>
<a name="ln-2597"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2598"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span> <span class="o">&lt;=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2599"></a>  <span class="k">return</span>
<a name="ln-2600"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2601"></a>  <span class="n">endfunction</span> <span class="n">character_le_string</span>
<a name="ln-2602"></a>
<a name="ln-2603"></a>  <span class="k">elemental function </span><span class="n">string_ge_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2604"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2605"></a>  <span class="c">!&lt; Greater equal than to string logical operator.</span>
<a name="ln-2606"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2607"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2608"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2609"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2610"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2611"></a>
<a name="ln-2612"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2613"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">&gt;=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2614"></a>  <span class="k">return</span>
<a name="ln-2615"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2616"></a>  <span class="n">endfunction</span> <span class="n">string_ge_string</span>
<a name="ln-2617"></a>
<a name="ln-2618"></a>  <span class="k">elemental function </span><span class="n">string_ge_character</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2619"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2620"></a>  <span class="c">!&lt; Greater equal than to character logical operator.</span>
<a name="ln-2621"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2622"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2623"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2624"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2625"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2626"></a>
<a name="ln-2627"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2628"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">&gt;=</span> <span class="n">rhs</span>
<a name="ln-2629"></a>  <span class="k">return</span>
<a name="ln-2630"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2631"></a>  <span class="n">endfunction</span> <span class="n">string_ge_character</span>
<a name="ln-2632"></a>
<a name="ln-2633"></a>  <span class="k">elemental function </span><span class="n">character_ge_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2634"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2635"></a>  <span class="c">!&lt; Greater equal than to character (inverted) logical operator.</span>
<a name="ln-2636"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2637"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2638"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2639"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2640"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2641"></a>
<a name="ln-2642"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2643"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span> <span class="o">&gt;=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2644"></a>  <span class="k">return</span>
<a name="ln-2645"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2646"></a>  <span class="n">endfunction</span> <span class="n">character_ge_string</span>
<a name="ln-2647"></a>
<a name="ln-2648"></a>  <span class="k">elemental function </span><span class="n">string_gt_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2649"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2650"></a>  <span class="c">!&lt; Greater than to string logical operator.</span>
<a name="ln-2651"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2652"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2653"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2654"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2655"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2656"></a>
<a name="ln-2657"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2658"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">&gt;</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2659"></a>  <span class="k">return</span>
<a name="ln-2660"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2661"></a>  <span class="n">endfunction</span> <span class="n">string_gt_string</span>
<a name="ln-2662"></a>
<a name="ln-2663"></a>  <span class="k">elemental function </span><span class="n">string_gt_character</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2664"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2665"></a>  <span class="c">!&lt; Greater than to character logical operator.</span>
<a name="ln-2666"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2667"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2668"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2669"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2670"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2671"></a>
<a name="ln-2672"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2673"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">&gt;</span> <span class="n">rhs</span>
<a name="ln-2674"></a>  <span class="k">return</span>
<a name="ln-2675"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2676"></a>  <span class="n">endfunction</span> <span class="n">string_gt_character</span>
<a name="ln-2677"></a>
<a name="ln-2678"></a>  <span class="k">elemental function </span><span class="n">character_gt_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2679"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2680"></a>  <span class="c">!&lt; Greater than to character (inverted) logical operator.</span>
<a name="ln-2681"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2682"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2683"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2684"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2685"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2686"></a>
<a name="ln-2687"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2688"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span> <span class="o">&gt;</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2689"></a>  <span class="k">return</span>
<a name="ln-2690"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2691"></a>  <span class="n">endfunction</span> <span class="n">character_gt_string</span>
<a name="ln-2692"></a>
<a name="ln-2693"></a>  <span class="c">! IO</span>
<a name="ln-2694"></a>  <span class="k">subroutine </span><span class="n">read_formatted</span><span class="p">(</span><span class="n">dtv</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">iotype</span><span class="p">,</span> <span class="n">v_list</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2695"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2696"></a>  <span class="c">!&lt; Formatted input.</span>
<a name="ln-2697"></a>  <span class="c">!&lt;</span>
<a name="ln-2698"></a>  <span class="c">!&lt; @bug Change temporary acks: find a more precise length of the input string and avoid the trimming!</span>
<a name="ln-2699"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2700"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dtv</span>         <span class="c">!&lt; The string.</span>
<a name="ln-2701"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>        <span class="c">!&lt; Logical unit.</span>
<a name="ln-2702"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>          <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">iotype</span>      <span class="c">!&lt; Edit descriptor.</span>
<a name="ln-2703"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">v_list</span><span class="p">(:)</span>   <span class="c">!&lt; Edit descriptor list.</span>
<a name="ln-2704"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>      <span class="c">!&lt; IO status code.</span>
<a name="ln-2705"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>          <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>       <span class="c">!&lt; IO status message.</span>
<a name="ln-2706"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span>                <span class="kd">::</span> <span class="n">local_iomsg</span> <span class="c">!&lt; Local variant of iomsg, so it doesn&#39;t get inappropriately redefined.</span>
<a name="ln-2707"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">delim</span>       <span class="c">!&lt; String delimiter, if any.</span>
<a name="ln-2708"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">temporary</span>   <span class="c">!&lt; Temporary storage string.</span>
<a name="ln-2709"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2710"></a>
<a name="ln-2711"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2712"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">iotype</span> <span class="o">==</span> <span class="s1">&#39;LISTDIRECTED&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2713"></a><span class="k">    call </span><span class="n">get_next_non_blank_character_any_record</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">ch</span><span class="o">=</span><span class="n">delim</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2714"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">iostat</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2715"></a><span class="k">    if</span> <span class="p">(</span><span class="n">delim</span><span class="o">==</span><span class="s1">&#39;&quot;&#39;</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">delim</span><span class="o">==</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2716"></a><span class="k">      call </span><span class="n">dtv</span><span class="p">%</span><span class="n">read_delimited</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">delim</span><span class="o">=</span><span class="n">delim</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">local_iomsg</span><span class="p">)</span>
<a name="ln-2717"></a>    <span class="k">else</span>
<a name="ln-2718"></a>      <span class="c">! step back before the non-blank</span>
<a name="ln-2719"></a>      <span class="k">read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(TL1)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2720"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2721"></a><span class="k">      call </span><span class="n">dtv</span><span class="p">%</span><span class="n">read_undelimited_listdirected</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">local_iomsg</span><span class="p">)</span>
<a name="ln-2722"></a>    <span class="n">endif</span>
<a name="ln-2723"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">is_iostat_eor</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2724"></a>      <span class="c">! suppress IOSTAT_EOR</span>
<a name="ln-2725"></a>      <span class="n">iostat</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2726"></a>    <span class="n">elseif</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2727"></a><span class="k">      </span><span class="n">iomsg</span> <span class="o">=</span> <span class="n">local_iomsg</span>
<a name="ln-2728"></a>    <span class="n">endif</span>
<a name="ln-2729"></a>    <span class="k">return</span>
<a name="ln-2730"></a><span class="k">  else</span>
<a name="ln-2731"></a><span class="k">    read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span><span class="n">temporary</span>
<a name="ln-2732"></a>    <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">temporary</span><span class="p">)</span>
<a name="ln-2733"></a>  <span class="n">endif</span>
<a name="ln-2734"></a>  <span class="k">return</span>
<a name="ln-2735"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2736"></a>  <span class="n">endsubroutine</span> <span class="n">read_formatted</span>
<a name="ln-2737"></a>
<a name="ln-2738"></a>  <span class="k">subroutine </span><span class="n">read_delimited</span><span class="p">(</span><span class="n">dtv</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">delim</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2739"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2740"></a>  <span class="c">!&lt; Read a delimited string from a unit connected for formatted input.</span>
<a name="ln-2741"></a>  <span class="c">!&lt;</span>
<a name="ln-2742"></a>  <span class="c">!&lt; If the closing delimiter is followed by end of record, then we return end of record.</span>
<a name="ln-2743"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2744"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">dtv</span>       <span class="c">!&lt; The string.</span>
<a name="ln-2745"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>      <span class="c">!&lt; Logical unit.</span>
<a name="ln-2746"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">delim</span>     <span class="c">!&lt; String delimiter.</span>
<a name="ln-2747"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>    <span class="c">!&lt; IO status code.</span>
<a name="ln-2748"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>     <span class="c">!&lt; IO status message.</span>
<a name="ln-2749"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">ch</span>        <span class="c">!&lt; A character read.</span>
<a name="ln-2750"></a>  <span class="kt">logical</span>                                  <span class="kd">::</span> <span class="n">was_delim</span> <span class="c">!&lt; Indicates that the last character read was a delimiter.</span>
<a name="ln-2751"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2752"></a>
<a name="ln-2753"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2754"></a>  <span class="n">was_delim</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2755"></a>  <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-2756"></a>  <span class="k">do</span>
<a name="ln-2757"></a><span class="k">    read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span> <span class="n">ch</span>
<a name="ln-2758"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">is_iostat_eor</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2759"></a><span class="k">      if</span> <span class="p">(</span><span class="n">was_delim</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2760"></a>        <span class="c">! end of delimited string followed by end of record is end of the string. Pass back the end of record condition to the</span>
<a name="ln-2761"></a>        <span class="c">! caller</span>
<a name="ln-2762"></a>        <span class="k">return</span>
<a name="ln-2763"></a><span class="k">      else</span>
<a name="ln-2764"></a>        <span class="c">! end of record without terminating delimiter - move along</span>
<a name="ln-2765"></a>        <span class="k">cycle</span>
<a name="ln-2766"></a><span class="k">      </span><span class="n">endif</span>
<a name="ln-2767"></a>    <span class="n">elseif</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2768"></a><span class="k">      return</span>
<a name="ln-2769"></a><span class="k">    </span><span class="n">endif</span>
<a name="ln-2770"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="n">delim</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2771"></a><span class="k">      if</span> <span class="p">(</span><span class="n">was_delim</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2772"></a>        <span class="c">! doubled delimiter is one delimiter in the value</span>
<a name="ln-2773"></a>        <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">//</span> <span class="n">ch</span>
<a name="ln-2774"></a>        <span class="n">was_delim</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2775"></a>      <span class="k">else</span>
<a name="ln-2776"></a>        <span class="c">! need to test next character to see what is happening</span>
<a name="ln-2777"></a>        <span class="n">was_delim</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2778"></a>      <span class="n">endif</span>
<a name="ln-2779"></a>    <span class="n">elseif</span> <span class="p">(</span><span class="n">was_delim</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2780"></a>      <span class="c">! the previous character was actually the delimiter for the end of the string. Put back this character</span>
<a name="ln-2781"></a>      <span class="k">read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(TL1)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2782"></a>      <span class="k">return</span>
<a name="ln-2783"></a><span class="k">    else</span>
<a name="ln-2784"></a><span class="k">      </span><span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">//</span> <span class="n">ch</span>
<a name="ln-2785"></a>    <span class="n">endif</span>
<a name="ln-2786"></a>  <span class="n">enddo</span>
<a name="ln-2787"></a>  <span class="k">return</span>
<a name="ln-2788"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2789"></a>  <span class="n">endsubroutine</span> <span class="n">read_delimited</span>
<a name="ln-2790"></a>
<a name="ln-2791"></a>  <span class="k">subroutine </span><span class="n">read_undelimited_listdirected</span><span class="p">(</span><span class="n">dtv</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2792"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2793"></a>  <span class="c">!&lt; Read an undelimited (no leading apostrophe or double quote) character value according to the rules for list directed input.</span>
<a name="ln-2794"></a>  <span class="c">!&lt;</span>
<a name="ln-2795"></a>  <span class="c">!&lt; A blank, comma/semicolon (depending on the decimal mode), slash or end of record terminates the string.</span>
<a name="ln-2796"></a>  <span class="c">!&lt;</span>
<a name="ln-2797"></a>  <span class="c">!&lt; If input is terminated by end of record, then this procedure returns an end-of-record condition.</span>
<a name="ln-2798"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2799"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dtv</span>           <span class="c">!&lt; The string.</span>
<a name="ln-2800"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>          <span class="c">!&lt; Logical unit.</span>
<a name="ln-2801"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>        <span class="c">!&lt; IO status code.</span>
<a name="ln-2802"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>         <span class="c">!&lt; IO status message.</span>
<a name="ln-2803"></a>  <span class="kt">logical</span>                         <span class="kd">::</span> <span class="n">decimal_point</span> <span class="c">!&lt;True if DECIMAL=POINT in effect.</span>
<a name="ln-2804"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2805"></a>
<a name="ln-2806"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2807"></a>  <span class="k">call </span><span class="n">get_decimal_mode</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">decimal_point</span><span class="o">=</span><span class="n">decimal_point</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2808"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2809"></a><span class="k">  call </span><span class="n">dtv</span><span class="p">%</span><span class="n">read_undelimited</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">terminators</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="nb">merge</span><span class="p">(</span><span class="n">CK_</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">CK_</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">decimal_point</span><span class="p">),</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2810"></a>  <span class="k">return</span>
<a name="ln-2811"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2812"></a>  <span class="n">endsubroutine</span> <span class="n">read_undelimited_listdirected</span>
<a name="ln-2813"></a>
<a name="ln-2814"></a>  <span class="k">subroutine </span><span class="n">read_undelimited</span><span class="p">(</span><span class="n">dtv</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">terminators</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2815"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2816"></a>  <span class="c">!&lt; Read an undelimited string up until end of record or a character from a set of terminators is encountered.</span>
<a name="ln-2817"></a>  <span class="c">!&lt;</span>
<a name="ln-2818"></a>  <span class="c">!&lt; If a terminator is encountered, the file position will be at that terminating character. If end of record is encountered, the</span>
<a name="ln-2819"></a>  <span class="c">!&lt; file remains at end of record.</span>
<a name="ln-2820"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2821"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dtv</span>         <span class="c">!&lt; The string.</span>
<a name="ln-2822"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>        <span class="c">!&lt; Logical unit.</span>
<a name="ln-2823"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">terminators</span> <span class="c">!&lt; Characters that are considered to terminate the string.</span>
<a name="ln-2824"></a>                                                          <span class="c">!&lt; Blanks in this string are meaningful.</span>
<a name="ln-2825"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>      <span class="c">!&lt; IO status code.</span>
<a name="ln-2826"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>          <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>       <span class="c">!&lt; IO status message.</span>
<a name="ln-2827"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">ch</span>          <span class="c">!&lt; A character read.</span>
<a name="ln-2828"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2829"></a>
<a name="ln-2830"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2831"></a>  <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-2832"></a>  <span class="k">do</span>
<a name="ln-2833"></a><span class="k">    read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span> <span class="n">ch</span>
<a name="ln-2834"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">is_iostat_eor</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2835"></a>      <span class="c">! end of record just means end of string. We pass on the condition</span>
<a name="ln-2836"></a>      <span class="k">return</span>
<a name="ln-2837"></a><span class="k">    </span><span class="n">elseif</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2838"></a>      <span class="c">! something odd happened</span>
<a name="ln-2839"></a>      <span class="k">return</span>
<a name="ln-2840"></a><span class="k">    </span><span class="n">endif</span>
<a name="ln-2841"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">scan</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="n">terminators</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2842"></a>      <span class="c">! change the file position so that the next read sees the terminator</span>
<a name="ln-2843"></a>      <span class="k">read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(TL1)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2844"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2845"></a><span class="k">      </span><span class="n">iostat</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2846"></a>      <span class="k">return</span>
<a name="ln-2847"></a><span class="k">    </span><span class="n">endif</span>
<a name="ln-2848"></a>    <span class="c">! we got a character - append it</span>
<a name="ln-2849"></a>    <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">//</span> <span class="n">ch</span>
<a name="ln-2850"></a>  <span class="n">enddo</span>
<a name="ln-2851"></a>  <span class="k">return</span>
<a name="ln-2852"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2853"></a>  <span class="n">endsubroutine</span> <span class="n">read_undelimited</span>
<a name="ln-2854"></a>
<a name="ln-2855"></a>  <span class="k">subroutine </span><span class="n">write_formatted</span><span class="p">(</span><span class="n">dtv</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">iotype</span><span class="p">,</span> <span class="n">v_list</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2856"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2857"></a>  <span class="c">!&lt; Formatted output.</span>
<a name="ln-2858"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2859"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">dtv</span>       <span class="c">!&lt; The string.</span>
<a name="ln-2860"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>      <span class="c">!&lt; Logical unit.</span>
<a name="ln-2861"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">iotype</span>    <span class="c">!&lt; Edit descriptor.</span>
<a name="ln-2862"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">v_list</span><span class="p">(:)</span> <span class="c">!&lt; Edit descriptor list.</span>
<a name="ln-2863"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>    <span class="c">!&lt; IO status code.</span>
<a name="ln-2864"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>     <span class="c">!&lt; IO status message.</span>
<a name="ln-2865"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2866"></a>
<a name="ln-2867"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2868"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">dtv</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2869"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span><span class="n">dtv</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2870"></a>  <span class="k">else</span>
<a name="ln-2871"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span><span class="s1">&#39;&#39;</span>
<a name="ln-2872"></a>  <span class="n">endif</span>
<a name="ln-2873"></a>  <span class="k">return</span>
<a name="ln-2874"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2875"></a>  <span class="n">endsubroutine</span> <span class="n">write_formatted</span>
<a name="ln-2876"></a>
<a name="ln-2877"></a>  <span class="k">subroutine </span><span class="n">read_unformatted</span><span class="p">(</span><span class="n">dtv</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2878"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2879"></a>  <span class="c">!&lt; Unformatted input.</span>
<a name="ln-2880"></a>  <span class="c">!&lt;</span>
<a name="ln-2881"></a>  <span class="c">!&lt; @bug Change temporary acks: find a more precise length of the input string and avoid the trimming!</span>
<a name="ln-2882"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2883"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dtv</span>       <span class="c">!&lt; The string.</span>
<a name="ln-2884"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>      <span class="c">!&lt; Logical unit.</span>
<a name="ln-2885"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>    <span class="c">!&lt; IO status code.</span>
<a name="ln-2886"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>     <span class="c">!&lt; IO status message.</span>
<a name="ln-2887"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">temporary</span> <span class="c">!&lt; Temporary storage string.</span>
<a name="ln-2888"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2889"></a>
<a name="ln-2890"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2891"></a>  <span class="k">read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span><span class="n">temporary</span>
<a name="ln-2892"></a>  <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">temporary</span><span class="p">)</span>
<a name="ln-2893"></a>  <span class="k">return</span>
<a name="ln-2894"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2895"></a>  <span class="n">endsubroutine</span> <span class="n">read_unformatted</span>
<a name="ln-2896"></a>
<a name="ln-2897"></a>  <span class="k">subroutine </span><span class="n">write_unformatted</span><span class="p">(</span><span class="n">dtv</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2898"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2899"></a>  <span class="c">!&lt; Unformatted output.</span>
<a name="ln-2900"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2901"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">dtv</span>    <span class="c">!&lt; The string.</span>
<a name="ln-2902"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>   <span class="c">!&lt; Logical unit.</span>
<a name="ln-2903"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span> <span class="c">!&lt; IO status code.</span>
<a name="ln-2904"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>  <span class="c">!&lt; IO status message.</span>
<a name="ln-2905"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2906"></a>
<a name="ln-2907"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2908"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">dtv</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2909"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span><span class="n">dtv</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2910"></a>  <span class="k">else</span>
<a name="ln-2911"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span><span class="s1">&#39;&#39;</span>
<a name="ln-2912"></a>  <span class="n">endif</span>
<a name="ln-2913"></a>  <span class="k">return</span>
<a name="ln-2914"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2915"></a>  <span class="n">endsubroutine</span> <span class="n">write_unformatted</span>
<a name="ln-2916"></a>
<a name="ln-2917"></a>  <span class="c">! miscellanea</span>
<a name="ln-2918"></a>  <span class="k">elemental function </span><span class="n">replace_one_occurrence</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">replaced</span><span class="p">)</span>
<a name="ln-2919"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2920"></a>  <span class="c">!&lt; Return a string with the first occurrence of substring old replaced by new.</span>
<a name="ln-2921"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2922"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-2923"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">old</span>       <span class="c">!&lt; Old substring.</span>
<a name="ln-2924"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">new</span>       <span class="c">!&lt; New substring.</span>
<a name="ln-2925"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                           <span class="kd">::</span> <span class="n">replaced</span>  <span class="c">!&lt; The string with old replaced by new.</span>
<a name="ln-2926"></a>  <span class="kt">integer</span>                                <span class="kd">::</span> <span class="n">pos</span>       <span class="c">!&lt; Position from which replace old.</span>
<a name="ln-2927"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-2928"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">temporary</span> <span class="c">!&lt; Temporary storage, workaround for GNU bug.</span>
<a name="ln-2929"></a><span class="cp">#endif</span>
<a name="ln-2930"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2931"></a>
<a name="ln-2932"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2933"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2934"></a><span class="k">    </span><span class="n">replaced</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-2935"></a>    <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">substring</span><span class="o">=</span><span class="n">old</span><span class="p">)</span>
<a name="ln-2936"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2937"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-2938"></a>      <span class="n">temporary</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2939"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2940"></a><span class="k">        </span><span class="n">replaced</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">new</span><span class="o">//</span><span class="n">temporary</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">old</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-2941"></a>      <span class="k">else</span>
<a name="ln-2942"></a><span class="k">        </span><span class="n">replaced</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">new</span><span class="o">//</span><span class="n">temporary</span><span class="p">(</span><span class="n">pos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">old</span><span class="p">):)</span>
<a name="ln-2943"></a>      <span class="n">endif</span>
<a name="ln-2944"></a><span class="cp">#else</span>
<a name="ln-2945"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2946"></a><span class="k">        </span><span class="n">replaced</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">new</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">old</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-2947"></a>      <span class="k">else</span>
<a name="ln-2948"></a><span class="k">        </span><span class="n">replaced</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">new</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">pos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">old</span><span class="p">):)</span>
<a name="ln-2949"></a>      <span class="n">endif</span>
<a name="ln-2950"></a><span class="cp">#endif</span>
<a name="ln-2951"></a>    <span class="n">endif</span>
<a name="ln-2952"></a>  <span class="n">endif</span>
<a name="ln-2953"></a>  <span class="k">return</span>
<a name="ln-2954"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2955"></a>  <span class="n">endfunction</span> <span class="n">replace_one_occurrence</span>
<a name="ln-2956"></a>
<a name="ln-2957"></a>  <span class="c">! non type-bound-procedures</span>
<a name="ln-2958"></a>  <span class="k">subroutine </span><span class="n">get_delimiter_mode</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">delim</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2959"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2960"></a>  <span class="c">!&lt; Get the DELIM changeable connection mode for the given unit.</span>
<a name="ln-2961"></a>  <span class="c">!&lt;</span>
<a name="ln-2962"></a>  <span class="c">!&lt; If the unit is connected to an internal file, then the default value of NONE is always returned.</span>
<a name="ln-2963"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2964"></a>  <span class="k">use</span><span class="p">,</span> <span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">iostat_inquire_internal_unit</span>
<a name="ln-2965"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2966"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>         <span class="c">!&lt; The unit for the connection.</span>
<a name="ln-2967"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">delim</span>        <span class="c">!&lt; Represents the value of the DELIM mode.</span>
<a name="ln-2968"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>       <span class="c">!&lt; IOSTAT error code, non-zero on error.</span>
<a name="ln-2969"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span>              <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>        <span class="c">!&lt; IOMSG explanatory message - only defined if iostat is non-zero.</span>
<a name="ln-2970"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>                            <span class="kd">::</span> <span class="n">delim_buffer</span> <span class="c">!&lt; Buffer for INQUIRE about DELIM, sized for APOSTROHPE.</span>
<a name="ln-2971"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span>                    <span class="kd">::</span> <span class="n">local_iomsg</span>  <span class="c">!&lt; Local variant of iomsg, so it doesn&#39;t get inappropriately redefined.</span>
<a name="ln-2972"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2973"></a>
<a name="ln-2974"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2975"></a>  <span class="c">! get the string representation of the changeable mode</span>
<a name="ln-2976"></a>  <span class="k">inquire</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">delim</span><span class="o">=</span><span class="n">delim_buffer</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">local_iomsg</span><span class="p">)</span>
<a name="ln-2977"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">==</span> <span class="n">iostat_inquire_internal_unit</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2978"></a>    <span class="c">! no way of determining the DELIM mode for an internal file</span>
<a name="ln-2979"></a>    <span class="n">iostat</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2980"></a>    <span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-2981"></a>    <span class="k">return</span>
<a name="ln-2982"></a><span class="k">  </span><span class="n">elseif</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2983"></a><span class="k">    </span><span class="n">iomsg</span> <span class="o">=</span> <span class="n">local_iomsg</span>
<a name="ln-2984"></a>    <span class="k">return</span>
<a name="ln-2985"></a><span class="k">  </span><span class="n">endif</span>
<a name="ln-2986"></a>  <span class="c">! interpret the DELIM string</span>
<a name="ln-2987"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">delim_buffer</span> <span class="o">==</span> <span class="s1">&#39;QUOTE&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2988"></a><span class="k">    </span><span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span>
<a name="ln-2989"></a>  <span class="n">elseif</span> <span class="p">(</span><span class="n">delim_buffer</span> <span class="o">==</span> <span class="s1">&#39;APOSTROPHE&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2990"></a><span class="k">    </span><span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;&#39;</span>
<a name="ln-2991"></a>  <span class="k">else</span>
<a name="ln-2992"></a><span class="k">    </span><span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span>
<a name="ln-2993"></a>  <span class="n">endif</span>
<a name="ln-2994"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2995"></a>  <span class="n">endsubroutine</span> <span class="n">get_delimiter_mode</span>
<a name="ln-2996"></a>
<a name="ln-2997"></a>  <span class="k">subroutine </span><span class="n">get_next_non_blank_character_this_record</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">ch</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2998"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2999"></a>  <span class="c">!&lt; Get the next non-blank character in the current record.</span>
<a name="ln-3000"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3001"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>   <span class="c">!&lt; Logical unit.</span>
<a name="ln-3002"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ch</span>     <span class="c">!&lt; The non-blank character read. Not valid if IOSTAT is non-zero.</span>
<a name="ln-3003"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span> <span class="c">!&lt; IO status code.</span>
<a name="ln-3004"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>  <span class="c">!&lt; IO status message.</span>
<a name="ln-3005"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3006"></a>
<a name="ln-3007"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3008"></a>  <span class="k">do</span>
<a name="ln-3009"></a>    <span class="c">! we spcify non-advancing, just in case we want this callable outside the context of a child input statement</span>
<a name="ln-3010"></a>    <span class="c">! the PAD specifier simply saves the need for the READ statement to define ch if EOR is hit</span>
<a name="ln-3011"></a>    <span class="c">! read(unit, &quot;(A)&quot;, iostat=iostat, iomsg=iomsg, advance=&#39;NO&#39;) ch</span>
<a name="ln-3012"></a>    <span class="c">! ...but that causes ifort to blow up at runtime</span>
<a name="ln-3013"></a>    <span class="k">read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="s1">&#39;NO&#39;</span><span class="p">)</span> <span class="n">ch</span>
<a name="ln-3014"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-3015"></a><span class="k">    if</span> <span class="p">(</span><span class="n">ch</span> <span class="o">/=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-3016"></a><span class="k">  </span><span class="n">enddo</span>
<a name="ln-3017"></a>  <span class="k">return</span>
<a name="ln-3018"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3019"></a>  <span class="n">endsubroutine</span> <span class="n">get_next_non_blank_character_this_record</span>
<a name="ln-3020"></a>
<a name="ln-3021"></a>  <span class="k">subroutine </span><span class="n">get_next_non_blank_character_any_record</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">ch</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-3022"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3023"></a>  <span class="c">!&lt; Get the next non-blank character, advancing records if necessary.</span>
<a name="ln-3024"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3025"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>        <span class="c">!&lt; Logical unit.</span>
<a name="ln-3026"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ch</span>          <span class="c">!&lt; The non-blank character read. Not valid if IOSTAT is non-zero.</span>
<a name="ln-3027"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>      <span class="c">!&lt; IO status code.</span>
<a name="ln-3028"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>       <span class="c">!&lt; IO status message.</span>
<a name="ln-3029"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span>                    <span class="kd">::</span> <span class="n">local_iomsg</span> <span class="c">!&lt; Local variant of iomsg, so it doesn&#39;t get inappropriately redefined.</span>
<a name="ln-3030"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3031"></a>
<a name="ln-3032"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3033"></a>  <span class="k">do</span>
<a name="ln-3034"></a><span class="k">    call </span><span class="n">get_next_non_blank_character_this_record</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">ch</span><span class="o">=</span><span class="n">ch</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">local_iomsg</span><span class="p">)</span>
<a name="ln-3035"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">is_iostat_eor</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-3036"></a>      <span class="c">! try again on the next record</span>
<a name="ln-3037"></a>      <span class="k">read</span> <span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(/)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span>
<a name="ln-3038"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-3039"></a><span class="k">    </span><span class="n">elseif</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3040"></a>      <span class="c">! some sort of problem</span>
<a name="ln-3041"></a>      <span class="n">iomsg</span> <span class="o">=</span> <span class="n">local_iomsg</span>
<a name="ln-3042"></a>      <span class="k">return</span>
<a name="ln-3043"></a><span class="k">    else</span>
<a name="ln-3044"></a>      <span class="c">! got it</span>
<a name="ln-3045"></a>      <span class="k">exit</span>
<a name="ln-3046"></a><span class="k">    </span><span class="n">endif</span>
<a name="ln-3047"></a>  <span class="n">enddo</span>
<a name="ln-3048"></a>  <span class="k">return</span>
<a name="ln-3049"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3050"></a>  <span class="n">endsubroutine</span> <span class="n">get_next_non_blank_character_any_record</span>
<a name="ln-3051"></a>
<a name="ln-3052"></a>  <span class="k">subroutine </span><span class="n">get_decimal_mode</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">decimal_point</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-3053"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3054"></a>  <span class="c">!&lt; Get the DECIMAL changeable connection mode for the given unit.</span>
<a name="ln-3055"></a>  <span class="c">!&lt;</span>
<a name="ln-3056"></a>  <span class="c">!&lt; If the unit is connected to an internal file, then the default value of DECIMAL is always returned. This may not be the</span>
<a name="ln-3057"></a>  <span class="c">!&lt; actual value in force at the time of the call to this procedure.</span>
<a name="ln-3058"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3059"></a>  <span class="k">use</span><span class="p">,</span> <span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">iostat_inquire_internal_unit</span>
<a name="ln-3060"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3061"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>           <span class="c">!&lt; Logical unit.</span>
<a name="ln-3062"></a>  <span class="kt">logical</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">decimal_point</span>  <span class="c">!&lt; True if the decimal mode is POINT, false otherwise.</span>
<a name="ln-3063"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>         <span class="c">!&lt; IO status code.</span>
<a name="ln-3064"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>          <span class="c">!&lt; IO status message.</span>
<a name="ln-3065"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>                             <span class="kd">::</span> <span class="n">decimal_buffer</span> <span class="c">!&lt; Buffer for INQUIRE about DECIMAL, sized for POINT or COMMA.</span>
<a name="ln-3066"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span>                    <span class="kd">::</span> <span class="n">local_iomsg</span>    <span class="c">!&lt; Local variant of iomsg, so it doesn&#39;t get inappropriately redefined.</span>
<a name="ln-3067"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3068"></a>
<a name="ln-3069"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3070"></a>  <span class="k">inquire</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="n">decimal_buffer</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">local_iomsg</span><span class="p">)</span>
<a name="ln-3071"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">==</span> <span class="n">iostat_inquire_internal_unit</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3072"></a>    <span class="c">! no way of determining the decimal mode for an internal file</span>
<a name="ln-3073"></a>    <span class="n">iostat</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3074"></a>    <span class="n">decimal_point</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3075"></a>    <span class="k">return</span>
<a name="ln-3076"></a><span class="k">  else if</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3077"></a><span class="k">    </span><span class="n">iomsg</span> <span class="o">=</span> <span class="n">local_iomsg</span>
<a name="ln-3078"></a>    <span class="k">return</span>
<a name="ln-3079"></a><span class="k">  </span><span class="n">endif</span>
<a name="ln-3080"></a>  <span class="n">decimal_point</span> <span class="o">=</span> <span class="n">decimal_buffer</span> <span class="o">==</span> <span class="s1">&#39;POINT&#39;</span>
<a name="ln-3081"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3082"></a>  <span class="n">endsubroutine</span> <span class="n">get_decimal_mode</span>
<a name="ln-3083"></a><span class="n">endmodule</span> <span class="n">stringifor_string_t</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>
    

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../sourcefile/assignments.f90.html">assignments.f90</a>
      
      <a class="list-group-item" href="../sourcefile/basename_dir.f90.html">basename_dir.f90</a>
      
      <a class="list-group-item" href="../sourcefile/befor64.f90.html">befor64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/befor64.f90%7E2.html">befor64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/befor64_pack_data_m.f90.html">befor64_pack_data_m.F90</a>
      
      <a class="list-group-item" href="../sourcefile/befor64_pack_data_m.f90%7E2.html">befor64_pack_data_m.F90</a>
      
      <a class="list-group-item" href="../sourcefile/camelcase.f90.html">camelcase.f90</a>
      
      <a class="list-group-item" href="../sourcefile/capitalize.f90.html">capitalize.f90</a>
      
      <a class="list-group-item" href="../sourcefile/compact_real.f90.html">compact_real.f90</a>
      
      <a class="list-group-item" href="../sourcefile/compact_real.f90%7E2.html">compact_real.f90</a>
      
      <a class="list-group-item" href="../sourcefile/compact_real.f90%7E3.html">compact_real.f90</a>
      
      <a class="list-group-item" href="../sourcefile/concatenation.f90.html">concatenation.f90</a>
      
      <a class="list-group-item" href="../sourcefile/csv_naive_parser.f90.html">csv_naive_parser.f90</a>
      
      <a class="list-group-item" href="../sourcefile/decode.f90.html">decode.f90</a>
      
      <a class="list-group-item" href="../sourcefile/encode.f90.html">encode.f90</a>
      
      <a class="list-group-item" href="../sourcefile/equal.f90.html">equal.f90</a>
      
      <a class="list-group-item" href="../sourcefile/escape.f90.html">escape.f90</a>
      
      <a class="list-group-item" href="../sourcefile/extension.f90.html">extension.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fill.f90.html">fill.f90</a>
      
      <a class="list-group-item" href="../sourcefile/free.f90.html">free.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury.f90.html">fury.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_mixed_kinds.f90.html">fury_mixed_kinds.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_qreal128.f90.html">fury_qreal128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_qreal32.f90.html">fury_qreal32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_qreal64.f90.html">fury_qreal64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_abstract128.f90.html">fury_system_abstract128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_abstract32.f90.html">fury_system_abstract32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_abstract64.f90.html">fury_system_abstract64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_si128.f90.html">fury_system_si128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_si32.f90.html">fury_system_si32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_si64.f90.html">fury_system_si64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_bolt32.f90.html">fury_test_bolt32.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_bolt64.f90.html">fury_test_bolt64.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add.f90.html">fury_test_qreal_add.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add_aliases_failure.f90.html">fury_test_qreal_add_aliases_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add_failure.f90.html">fury_test_qreal_add_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add_mixed.f90.html">fury_test_qreal_add_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add_mixed_failure.f90.html">fury_test_qreal_add_mixed_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_aliases.f90.html">fury_test_qreal_aliases.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_assign.f90.html">fury_test_qreal_assign.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_conversions_complex.f90.html">fury_test_qreal_conversions_complex.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_conversions_si.f90.html">fury_test_qreal_conversions_si.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_conversions_simple.f90.html">fury_test_qreal_conversions_simple.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_div.f90.html">fury_test_qreal_div.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_div_mixed.f90.html">fury_test_qreal_div_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_eq.f90.html">fury_test_qreal_eq.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_eq_mixed.f90.html">fury_test_qreal_eq_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_mul.f90.html">fury_test_qreal_mul.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_mul_mixed.f90.html">fury_test_qreal_mul_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_not_eq.f90.html">fury_test_qreal_not_eq.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_not_eq_mixed.f90.html">fury_test_qreal_not_eq_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_pow.f90.html">fury_test_qreal_pow.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_sub.f90.html">fury_test_qreal_sub.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_sub_failure.f90.html">fury_test_qreal_sub_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_sub_mixed.f90.html">fury_test_qreal_sub_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_sub_mixed_failure.f90.html">fury_test_qreal_sub_mixed_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_system_si.f90.html">fury_test_system_si.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_add.f90.html">fury_test_uom_add.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_add_failure.f90.html">fury_test_uom_add_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_aliases.f90.html">fury_test_uom_aliases.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_assign.f90.html">fury_test_uom_assign.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_assign_failure.f90.html">fury_test_uom_assign_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_div.f90.html">fury_test_uom_div.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_mul.f90.html">fury_test_uom_mul.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_parse_failure.f90.html">fury_test_uom_parse_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_pow.f90.html">fury_test_uom_pow.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_sub.f90.html">fury_test_uom_sub.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_sub_failure.f90.html">fury_test_uom_sub_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom128.f90.html">fury_uom128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom32.f90.html">fury_uom32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom64.f90.html">fury_uom64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_converter.f90.html">fury_uom_converter.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_reference128.f90.html">fury_uom_reference128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_reference32.f90.html">fury_uom_reference32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_reference64.f90.html">fury_uom_reference64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_symbol128.f90.html">fury_uom_symbol128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_symbol32.f90.html">fury_uom_symbol32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_symbol64.f90.html">fury_uom_symbol64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/greater_equal_than.f90.html">greater_equal_than.f90</a>
      
      <a class="list-group-item" href="../sourcefile/greater_than.f90.html">greater_than.f90</a>
      
      <a class="list-group-item" href="../sourcefile/insert.f90.html">insert.f90</a>
      
      <a class="list-group-item" href="../sourcefile/io_basic.f90.html">io_basic.F90</a>
      
      <a class="list-group-item" href="../sourcefile/io_listdirected.f90.html">io_listdirected.F90</a>
      
      <a class="list-group-item" href="../sourcefile/is_digit.f90.html">is_digit.f90</a>
      
      <a class="list-group-item" href="../sourcefile/is_integer.f90.html">is_integer.f90</a>
      
      <a class="list-group-item" href="../sourcefile/is_number.f90.html">is_number.f90</a>
      
      <a class="list-group-item" href="../sourcefile/is_real.f90.html">is_real.f90</a>
      
      <a class="list-group-item" href="../sourcefile/join.f90.html">join.f90</a>
      
      <a class="list-group-item" href="../sourcefile/lower_equal_than.f90.html">lower_equal_than.f90</a>
      
      <a class="list-group-item" href="../sourcefile/lower_than.f90.html">lower_than.f90</a>
      
      <a class="list-group-item" href="../sourcefile/not_equal.f90.html">not_equal.f90</a>
      
      <a class="list-group-item" href="../sourcefile/partition.f90.html">partition.f90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90%7E2.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90%7E3.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90%7E4.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90%7E5.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf_b_size.f90.html">penf_b_size.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf_global_parameters_variables.f90.html">penf_global_parameters_variables.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf_stringify.f90.html">penf_stringify.F90</a>
      
      <a class="list-group-item" href="../sourcefile/read_file.f90.html">read_file.f90</a>
      
      <a class="list-group-item" href="../sourcefile/read_line.f90.html">read_line.f90</a>
      
      <a class="list-group-item" href="../sourcefile/read_lines.f90.html">read_lines.f90</a>
      
      <a class="list-group-item" href="../sourcefile/replace.f90.html">replace.f90</a>
      
      <a class="list-group-item" href="../sourcefile/reverse.f90.html">reverse.f90</a>
      
      <a class="list-group-item" href="../sourcefile/sadjustlr.f90.html">sadjustlr.f90</a>
      
      <a class="list-group-item" href="../sourcefile/scount.f90.html">scount.f90</a>
      
      <a class="list-group-item" href="../sourcefile/search.f90.html">search.f90</a>
      
      <a class="list-group-item" href="../sourcefile/sindex.f90.html">sindex.f90</a>
      
      <a class="list-group-item" href="../sourcefile/slen.f90.html">slen.f90</a>
      
      <a class="list-group-item" href="../sourcefile/slice.f90.html">slice.f90</a>
      
      <a class="list-group-item" href="../sourcefile/snakecase.f90.html">snakecase.f90</a>
      
      <a class="list-group-item" href="../sourcefile/split.f90.html">split.f90</a>
      
      <a class="list-group-item" href="../sourcefile/srepeat.f90.html">srepeat.f90</a>
      
      <a class="list-group-item" href="../sourcefile/sscan.f90.html">sscan.f90</a>
      
      <a class="list-group-item" href="../sourcefile/start_end.f90.html">start_end.f90</a>
      
      <a class="list-group-item" href="../sourcefile/startcase.f90.html">startcase.f90</a>
      
      <a class="list-group-item" href="../sourcefile/strim.f90.html">strim.f90</a>
      
      <a class="list-group-item" href="../sourcefile/stringifor.f90.html">stringifor.F90</a>
      
      <a class="list-group-item" href="../sourcefile/stringifor_string_t.f90.html">stringifor_string_t.F90</a>
      
      <a class="list-group-item" href="../sourcefile/strip.f90.html">strip.f90</a>
      
      <a class="list-group-item" href="../sourcefile/sverify.f90.html">sverify.f90</a>
      
      <a class="list-group-item" href="../sourcefile/swapcase.f90.html">swapcase.f90</a>
      
      <a class="list-group-item" href="../sourcefile/test_all.f90.html">test_all.F90</a>
      
      <a class="list-group-item" href="../sourcefile/test_all.f90.html">test_all.f90</a>
      
      <a class="list-group-item" href="../sourcefile/test_all.f90%7E2.html">test_all.f90</a>
      
      <a class="list-group-item" href="../sourcefile/test_driver.f90.html">Test_Driver.f90</a>
      
      <a class="list-group-item" href="../sourcefile/to_number.f90.html">to_number.f90</a>
      
      <a class="list-group-item" href="../sourcefile/unescape.f90.html">unescape.f90</a>
      
      <a class="list-group-item" href="../sourcefile/unique.f90.html">unique.f90</a>
      
      <a class="list-group-item" href="../sourcefile/upper_lower.f90.html">upper_lower.f90</a>
      
      <a class="list-group-item" href="../sourcefile/write_file.f90.html">write_file.f90</a>
      
      <a class="list-group-item" href="../sourcefile/write_lines.f90.html">write_lines.f90</a>
      
    </div>
  </div>
</div>


  </section>
  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2016 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FURY was developed by Stefano Zaghi</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>