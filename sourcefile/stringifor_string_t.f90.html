<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="Fortran Units (environment) for Reliable phYsical math">
    
    <meta name="author" content="Stefano Zaghi" >
    <link rel="icon" href="../favicon.png">

    <title>stringifor_string_t.F90 &ndash; FURY</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FURY </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">
              
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
				
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>stringifor_string_t.F90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 9.2% of total for source files.">1872 statements</a>
     </li> 
     
     
    <li><i class="fa fa-code"></i><a href="../src/stringifor_string_t.F90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li class="active">stringifor_string_t.F90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/stringifor_string_t.html">stringifor_string_t</a>
      
    </div>
  </div>
</div>















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/stringifor_string_t.f90.html#src">stringifor_string_t.F90</a>
  </div>
</div>


  <hr>
  

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../sourcefile/assignments.f90.html">assignments.f90</a>
      
      <a class="list-group-item" href="../sourcefile/basename_dir.f90.html">basename_dir.f90</a>
      
      <a class="list-group-item" href="../sourcefile/befor64.f90.html">befor64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/befor64.f90%7E2.html">befor64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/befor64_pack_data_m.f90.html">befor64_pack_data_m.F90</a>
      
      <a class="list-group-item" href="../sourcefile/befor64_pack_data_m.f90%7E2.html">befor64_pack_data_m.F90</a>
      
      <a class="list-group-item" href="../sourcefile/camelcase.f90.html">camelcase.f90</a>
      
      <a class="list-group-item" href="../sourcefile/capitalize.f90.html">capitalize.f90</a>
      
      <a class="list-group-item" href="../sourcefile/compact_real.f90.html">compact_real.f90</a>
      
      <a class="list-group-item" href="../sourcefile/compact_real.f90%7E2.html">compact_real.f90</a>
      
      <a class="list-group-item" href="../sourcefile/compact_real.f90%7E3.html">compact_real.f90</a>
      
      <a class="list-group-item" href="../sourcefile/concatenation.f90.html">concatenation.f90</a>
      
      <a class="list-group-item" href="../sourcefile/csv_naive_parser.f90.html">csv_naive_parser.f90</a>
      
      <a class="list-group-item" href="../sourcefile/decode.f90.html">decode.f90</a>
      
      <a class="list-group-item" href="../sourcefile/encode.f90.html">encode.f90</a>
      
      <a class="list-group-item" href="../sourcefile/equal.f90.html">equal.f90</a>
      
      <a class="list-group-item" href="../sourcefile/escape.f90.html">escape.f90</a>
      
      <a class="list-group-item" href="../sourcefile/extension.f90.html">extension.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fill.f90.html">fill.f90</a>
      
      <a class="list-group-item" href="../sourcefile/free.f90.html">free.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury.f90.html">fury.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_mixed_kinds.f90.html">fury_mixed_kinds.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_qreal128.f90.html">fury_qreal128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_qreal32.f90.html">fury_qreal32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_qreal64.f90.html">fury_qreal64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_abstract128.f90.html">fury_system_abstract128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_abstract32.f90.html">fury_system_abstract32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_abstract64.f90.html">fury_system_abstract64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_si128.f90.html">fury_system_si128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_si32.f90.html">fury_system_si32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_si64.f90.html">fury_system_si64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_bolt32.f90.html">fury_test_bolt32.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_bolt64.f90.html">fury_test_bolt64.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add.f90.html">fury_test_qreal_add.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add_aliases_failure.f90.html">fury_test_qreal_add_aliases_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add_failure.f90.html">fury_test_qreal_add_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add_mixed.f90.html">fury_test_qreal_add_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add_mixed_failure.f90.html">fury_test_qreal_add_mixed_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_aliases.f90.html">fury_test_qreal_aliases.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_assign.f90.html">fury_test_qreal_assign.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_conversions_complex.f90.html">fury_test_qreal_conversions_complex.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_conversions_si.f90.html">fury_test_qreal_conversions_si.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_conversions_simple.f90.html">fury_test_qreal_conversions_simple.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_div.f90.html">fury_test_qreal_div.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_div_mixed.f90.html">fury_test_qreal_div_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_eq.f90.html">fury_test_qreal_eq.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_eq_mixed.f90.html">fury_test_qreal_eq_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_mul.f90.html">fury_test_qreal_mul.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_mul_mixed.f90.html">fury_test_qreal_mul_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_not_eq.f90.html">fury_test_qreal_not_eq.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_not_eq_mixed.f90.html">fury_test_qreal_not_eq_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_pow.f90.html">fury_test_qreal_pow.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_sub.f90.html">fury_test_qreal_sub.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_sub_failure.f90.html">fury_test_qreal_sub_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_sub_mixed.f90.html">fury_test_qreal_sub_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_sub_mixed_failure.f90.html">fury_test_qreal_sub_mixed_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_system_si.f90.html">fury_test_system_si.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_add.f90.html">fury_test_uom_add.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_add_failure.f90.html">fury_test_uom_add_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_aliases.f90.html">fury_test_uom_aliases.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_assign.f90.html">fury_test_uom_assign.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_assign_failure.f90.html">fury_test_uom_assign_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_div.f90.html">fury_test_uom_div.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_mul.f90.html">fury_test_uom_mul.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_parse_failure.f90.html">fury_test_uom_parse_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_pow.f90.html">fury_test_uom_pow.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_sub.f90.html">fury_test_uom_sub.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_sub_failure.f90.html">fury_test_uom_sub_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom128.f90.html">fury_uom128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom32.f90.html">fury_uom32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom64.f90.html">fury_uom64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_converter.f90.html">fury_uom_converter.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_reference128.f90.html">fury_uom_reference128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_reference32.f90.html">fury_uom_reference32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_reference64.f90.html">fury_uom_reference64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_symbol128.f90.html">fury_uom_symbol128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_symbol32.f90.html">fury_uom_symbol32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_symbol64.f90.html">fury_uom_symbol64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/greater_equal_than.f90.html">greater_equal_than.f90</a>
      
      <a class="list-group-item" href="../sourcefile/greater_than.f90.html">greater_than.f90</a>
      
      <a class="list-group-item" href="../sourcefile/insert.f90.html">insert.f90</a>
      
      <a class="list-group-item" href="../sourcefile/io_basic.f90.html">io_basic.F90</a>
      
      <a class="list-group-item" href="../sourcefile/io_listdirected.f90.html">io_listdirected.F90</a>
      
      <a class="list-group-item" href="../sourcefile/is_digit.f90.html">is_digit.f90</a>
      
      <a class="list-group-item" href="../sourcefile/is_integer.f90.html">is_integer.f90</a>
      
      <a class="list-group-item" href="../sourcefile/is_number.f90.html">is_number.f90</a>
      
      <a class="list-group-item" href="../sourcefile/is_real.f90.html">is_real.f90</a>
      
      <a class="list-group-item" href="../sourcefile/join.f90.html">join.f90</a>
      
      <a class="list-group-item" href="../sourcefile/lower_equal_than.f90.html">lower_equal_than.f90</a>
      
      <a class="list-group-item" href="../sourcefile/lower_than.f90.html">lower_than.f90</a>
      
      <a class="list-group-item" href="../sourcefile/not_equal.f90.html">not_equal.f90</a>
      
      <a class="list-group-item" href="../sourcefile/partition.f90.html">partition.f90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90%7E2.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90%7E3.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90%7E4.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90%7E5.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf_b_size.f90.html">penf_b_size.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf_global_parameters_variables.f90.html">penf_global_parameters_variables.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf_stringify.f90.html">penf_stringify.F90</a>
      
      <a class="list-group-item" href="../sourcefile/read_file.f90.html">read_file.f90</a>
      
      <a class="list-group-item" href="../sourcefile/read_line.f90.html">read_line.f90</a>
      
      <a class="list-group-item" href="../sourcefile/read_lines.f90.html">read_lines.f90</a>
      
      <a class="list-group-item" href="../sourcefile/replace.f90.html">replace.f90</a>
      
      <a class="list-group-item" href="../sourcefile/reverse.f90.html">reverse.f90</a>
      
      <a class="list-group-item" href="../sourcefile/sadjustlr.f90.html">sadjustlr.f90</a>
      
      <a class="list-group-item" href="../sourcefile/scount.f90.html">scount.f90</a>
      
      <a class="list-group-item" href="../sourcefile/search.f90.html">search.f90</a>
      
      <a class="list-group-item" href="../sourcefile/sindex.f90.html">sindex.f90</a>
      
      <a class="list-group-item" href="../sourcefile/slen.f90.html">slen.f90</a>
      
      <a class="list-group-item" href="../sourcefile/slice.f90.html">slice.f90</a>
      
      <a class="list-group-item" href="../sourcefile/snakecase.f90.html">snakecase.f90</a>
      
      <a class="list-group-item" href="../sourcefile/split.f90.html">split.f90</a>
      
      <a class="list-group-item" href="../sourcefile/srepeat.f90.html">srepeat.f90</a>
      
      <a class="list-group-item" href="../sourcefile/sscan.f90.html">sscan.f90</a>
      
      <a class="list-group-item" href="../sourcefile/start_end.f90.html">start_end.f90</a>
      
      <a class="list-group-item" href="../sourcefile/startcase.f90.html">startcase.f90</a>
      
      <a class="list-group-item" href="../sourcefile/strim.f90.html">strim.f90</a>
      
      <a class="list-group-item" href="../sourcefile/stringifor.f90.html">stringifor.F90</a>
      
      <a class="list-group-item" href="../sourcefile/stringifor_string_t.f90.html">stringifor_string_t.F90</a>
      
      <a class="list-group-item" href="../sourcefile/strip.f90.html">strip.f90</a>
      
      <a class="list-group-item" href="../sourcefile/sverify.f90.html">sverify.f90</a>
      
      <a class="list-group-item" href="../sourcefile/swapcase.f90.html">swapcase.f90</a>
      
      <a class="list-group-item" href="../sourcefile/test_all.f90.html">test_all.F90</a>
      
      <a class="list-group-item" href="../sourcefile/test_all.f90.html">test_all.f90</a>
      
      <a class="list-group-item" href="../sourcefile/test_all.f90%7E2.html">test_all.f90</a>
      
      <a class="list-group-item" href="../sourcefile/test_driver.f90.html">Test_Driver.f90</a>
      
      <a class="list-group-item" href="../sourcefile/to_number.f90.html">to_number.f90</a>
      
      <a class="list-group-item" href="../sourcefile/unescape.f90.html">unescape.f90</a>
      
      <a class="list-group-item" href="../sourcefile/unique.f90.html">unique.f90</a>
      
      <a class="list-group-item" href="../sourcefile/upper_lower.f90.html">upper_lower.f90</a>
      
      <a class="list-group-item" href="../sourcefile/write_file.f90.html">write_file.f90</a>
      
      <a class="list-group-item" href="../sourcefile/write_lines.f90.html">write_lines.f90</a>
      
    </div>
  </div>
</div>


</div>  

    </div>
    <div class="col-md-9" id='text'>
    <p>StringiFor, definition of <code>string</code> type.</p>
    
    <h3>This File Depends On</h3>
    
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: sourcefile~~stringifor_string_t.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilestringifor_string_tf90EfferentGraph" width="641pt" height="48pt"
 viewBox="0.00 0.00 641.00 47.52" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~stringifor_string_t.f90~~EfferentGraph" class="graph" transform="scale(0.639721 0.639721) rotate(0) translate(4 70.2871)">
<title>sourcefile~~stringifor_string_t.f90~~EfferentGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-70.2871 999,-70.2871 999,5 -4,5"/>
<!-- sourcefile~stringifor_string_t.f90 -->
<g id="node1" class="node"><title>sourcefile~stringifor_string_t.f90</title>
<polygon fill="none" stroke="black" points="993,-57.9707 877,-57.9707 877,-31.9707 993,-31.9707 993,-57.9707"/>
<text text-anchor="middle" x="935" y="-42.5207" font-family="Helvetica,sans-Serif" font-size="10.50">stringifor_string_t.F90</text>
</g>
<!-- sourcefile~befor64.f90 -->
<g id="node2" class="node"><title>sourcefile~befor64.f90</title>
<a xlink:href="../sourcefile/befor64.f90.html" xlink:title="befor64.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="839,-37.9707 769,-37.9707 769,-11.9707 839,-11.9707 839,-37.9707"/>
<text text-anchor="middle" x="804" y="-22.5207" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">befor64.F90</text>
</a>
</g>
<!-- sourcefile~befor64.f90&#45;&gt;sourcefile~stringifor_string_t.f90 -->
<g id="edge20" class="edge"><title>sourcefile~befor64.f90&#45;&gt;sourcefile~stringifor_string_t.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M839.796,-30.4358C848.086,-31.7013 857.18,-33.0898 866.357,-34.4909"/>
<polygon fill="#000000" stroke="#000000" points="865.9,-37.9615 876.313,-36.0109 866.956,-31.0417 865.9,-37.9615"/>
</g>
<!-- sourcefile~penf.f90 -->
<g id="node3" class="node"><title>sourcefile~penf.f90</title>
<a xlink:href="../sourcefile/penf.f90.html" xlink:title="penf.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="553,-57.9707 499,-57.9707 499,-31.9707 553,-31.9707 553,-57.9707"/>
<text text-anchor="middle" x="526" y="-42.5207" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">penf.F90</text>
</a>
</g>
<!-- sourcefile~penf.f90&#45;&gt;sourcefile~stringifor_string_t.f90 -->
<g id="edge22" class="edge"><title>sourcefile~penf.f90&#45;&gt;sourcefile~stringifor_string_t.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M661,-65.9707C731.064,-66.3887 810.913,-59.4161 866.263,-53.3948"/>
<polygon fill="#000000" stroke="#000000" points="866.751,-56.8623 876.305,-52.2836 865.981,-49.9048 866.751,-56.8623"/>
</g>
<!-- sourcefile~penf.f90&#45;&gt;sourcefile~befor64.f90 -->
<g id="edge4" class="edge"><title>sourcefile~penf.f90&#45;&gt;sourcefile~befor64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.728,-51.7486C580.883,-57.8002 623.524,-65.7471 661,-65.9707"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M661,-65.9707C697.964,-66.1912 738.294,-53.3497 766.672,-41.9827"/>
<polygon fill="#000000" stroke="#000000" points="768.284,-45.1039 776.187,-38.0474 765.608,-38.6354 768.284,-45.1039"/>
</g>
<!-- sourcefile~befor64_pack_data_m.f90 -->
<g id="node4" class="node"><title>sourcefile~befor64_pack_data_m.f90</title>
<a xlink:href="../sourcefile/befor64_pack_data_m.f90.html" xlink:title="befor64_pack_data_m.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="732,-37.9707 590,-37.9707 590,-11.9707 732,-11.9707 732,-37.9707"/>
<text text-anchor="middle" x="661" y="-22.5207" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">befor64_pack_data_m.F90</text>
</a>
</g>
<!-- sourcefile~penf.f90&#45;&gt;sourcefile~befor64_pack_data_m.f90 -->
<g id="edge2" class="edge"><title>sourcefile~penf.f90&#45;&gt;sourcefile~befor64_pack_data_m.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.645,-40.8751C561.546,-39.7046 570.582,-38.366 579.982,-36.9733"/>
<polygon fill="#000000" stroke="#000000" points="580.5,-40.435 589.879,-35.5072 579.474,-33.5106 580.5,-40.435"/>
</g>
<!-- sourcefile~befor64_pack_data_m.f90&#45;&gt;sourcefile~befor64.f90 -->
<g id="edge6" class="edge"><title>sourcefile~befor64_pack_data_m.f90&#45;&gt;sourcefile~befor64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M732.081,-24.9707C740.953,-24.9707 749.833,-24.9707 758.175,-24.9707"/>
<polygon fill="#000000" stroke="#000000" points="758.413,-28.4708 768.413,-24.9707 758.413,-21.4708 758.413,-28.4708"/>
</g>
<!-- sourcefile~penf_b_size.f90 -->
<g id="node8" class="node"><title>sourcefile~penf_b_size.f90</title>
<a xlink:href="../sourcefile/penf_b_size.f90.html" xlink:title="penf_b_size.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="328,-37.9707 236,-37.9707 236,-11.9707 328,-11.9707 328,-37.9707"/>
<text text-anchor="middle" x="282" y="-22.5207" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">penf_b_size.F90</text>
</a>
</g>
<!-- sourcefile~penf_b_size.f90&#45;&gt;sourcefile~penf.f90 -->
<g id="edge14" class="edge"><title>sourcefile~penf_b_size.f90&#45;&gt;sourcefile~penf.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M307.365,-38.1727C333.234,-50.3628 374.874,-66.5143 413,-65.9707"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M413,-65.9707C438.492,-65.6072 466.685,-60.3758 488.534,-55.2259"/>
<polygon fill="#000000" stroke="#000000" points="489.523,-58.5871 498.401,-52.805 487.855,-51.7887 489.523,-58.5871"/>
</g>
<!-- sourcefile~penf_stringify.f90 -->
<g id="node10" class="node"><title>sourcefile~penf_stringify.f90</title>
<a xlink:href="../sourcefile/penf_stringify.f90.html" xlink:title="penf_stringify.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="462,-37.9707 364,-37.9707 364,-11.9707 462,-11.9707 462,-37.9707"/>
<text text-anchor="middle" x="413" y="-22.5207" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">penf_stringify.F90</text>
</a>
</g>
<!-- sourcefile~penf_b_size.f90&#45;&gt;sourcefile~penf_stringify.f90 -->
<g id="edge10" class="edge"><title>sourcefile~penf_b_size.f90&#45;&gt;sourcefile~penf_stringify.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M328.186,-24.9707C336.355,-24.9707 344.965,-24.9707 353.442,-24.9707"/>
<polygon fill="#000000" stroke="#000000" points="353.676,-28.4708 363.676,-24.9707 353.676,-21.4708 353.676,-28.4708"/>
</g>
<!-- sourcefile~penf_global_parameters_variables.f90 -->
<g id="node9" class="node"><title>sourcefile~penf_global_parameters_variables.f90</title>
<a xlink:href="../sourcefile/penf_global_parameters_variables.f90.html" xlink:title="penf_global_parameters_variables.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="199,-37.9707 1,-37.9707 1,-11.9707 199,-11.9707 199,-37.9707"/>
<text text-anchor="middle" x="100" y="-22.5207" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">penf_global_parameters_variables.F90</text>
</a>
</g>
<!-- sourcefile~penf_global_parameters_variables.f90&#45;&gt;sourcefile~penf.f90 -->
<g id="edge16" class="edge"><title>sourcefile~penf_global_parameters_variables.f90&#45;&gt;sourcefile~penf.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M159.704,-38.0068C222.465,-50.4817 324.226,-67.2365 413,-65.9707"/>
</g>
<!-- sourcefile~penf_global_parameters_variables.f90&#45;&gt;sourcefile~penf_b_size.f90 -->
<g id="edge8" class="edge"><title>sourcefile~penf_global_parameters_variables.f90&#45;&gt;sourcefile~penf_b_size.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M199.52,-24.9707C208.389,-24.9707 217.15,-24.9707 225.46,-24.9707"/>
<polygon fill="#000000" stroke="#000000" points="225.721,-28.4708 235.721,-24.9707 225.721,-21.4708 225.721,-28.4708"/>
</g>
<!-- sourcefile~penf_global_parameters_variables.f90&#45;&gt;sourcefile~penf_stringify.f90 -->
<g id="edge12" class="edge"><title>sourcefile~penf_global_parameters_variables.f90&#45;&gt;sourcefile~penf_stringify.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M159.638,-11.9557C205.702,-3.65823 270.997,4.28664 328,-2.9707 338.883,-4.3562 350.364,-6.70142 361.248,-9.35725"/>
<polygon fill="#000000" stroke="#000000" points="360.485,-12.7748 371.041,-11.865 362.221,-5.99357 360.485,-12.7748"/>
</g>
<!-- sourcefile~penf_stringify.f90&#45;&gt;sourcefile~penf.f90 -->
<g id="edge18" class="edge"><title>sourcefile~penf_stringify.f90&#45;&gt;sourcefile~penf.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M462.235,-33.6848C471.03,-35.2414 480.063,-36.8403 488.464,-38.3272"/>
<polygon fill="#000000" stroke="#000000" points="487.882,-41.7785 498.339,-40.075 489.102,-34.8856 487.882,-41.7785"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilestringifor_string_tf90EfferentGraph = svgPanZoom('#sourcefilestringifor_string_tf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="34pt"
 viewBox="0.00 0.00 188.00 34.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(1 1) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 185,-30 185,5 -4,5"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-26 2.84217e-14,-26 0,-1.24345e-14 66,-3.55271e-15 66,-26"/>
<text text-anchor="middle" x="33" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="180,-26 84,-26 84,-1.24345e-14 180,-3.55271e-15 180,-26"/>
<text text-anchor="middle" x="132" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which depends upon it. A file 
    is dependent upon another if the latter must be compiled before the former
    can be.
    </p>
    
                      </div>
                    </div>
                  </div>
                </div>
                
    
      
      <h3>Files Dependent On This One</h3>
      
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: sourcefile~~stringifor_string_t.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilestringifor_string_tf90AfferentGraph" width="641pt" height="1394pt"
 viewBox="0.00 0.00 641.00 1394.05" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~stringifor_string_t.f90~~AfferentGraph" class="graph" transform="scale(0.411954 0.411954) rotate(0) translate(4 3380)">
<title>sourcefile~~stringifor_string_t.f90~~AfferentGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-3380 1553,-3380 1553,5 -4,5"/>
<!-- sourcefile~stringifor_string_t.f90 -->
<g id="node1" class="node"><title>sourcefile~stringifor_string_t.f90</title>
<polygon fill="none" stroke="black" points="117,-1346 1,-1346 1,-1320 117,-1320 117,-1346"/>
<text text-anchor="middle" x="59" y="-1330.55" font-family="Helvetica,sans-Serif" font-size="10.50">stringifor_string_t.F90</text>
</g>
<!-- sourcefile~stringifor.f90 -->
<g id="node2" class="node"><title>sourcefile~stringifor.f90</title>
<a xlink:href="../sourcefile/stringifor.f90.html" xlink:title="stringifor.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="230,-1346 154,-1346 154,-1320 230,-1320 230,-1346"/>
<text text-anchor="middle" x="192" y="-1330.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stringifor.F90</text>
</a>
</g>
<!-- sourcefile~stringifor_string_t.f90&#45;&gt;sourcefile~stringifor.f90 -->
<g id="edge346" class="edge"><title>sourcefile~stringifor_string_t.f90&#45;&gt;sourcefile~stringifor.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M117.723,-1333C126.43,-1333 135.318,-1333 143.777,-1333"/>
<polygon fill="#000000" stroke="#000000" points="143.843,-1336.5 153.843,-1333 143.843,-1329.5 143.843,-1336.5"/>
</g>
<!-- sourcefile~fury_system_abstract128.f90 -->
<g id="node3" class="node"><title>sourcefile~fury_system_abstract128.f90</title>
<a xlink:href="../sourcefile/fury_system_abstract128.f90.html" xlink:title="fury_system_abstract128.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1050,-3111 896,-3111 896,-3085 1050,-3085 1050,-3111"/>
<text text-anchor="middle" x="973" y="-3095.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_system_abstract128.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_abstract128.f90 -->
<g id="edge198" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_abstract128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-3139C734.393,-3130.49 750.117,-3142.75 810,-3139"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-3139C850.645,-3136.45 895.418,-3124.5 927.738,-3114.15"/>
<polygon fill="#000000" stroke="#000000" points="928.936,-3117.44 937.35,-3111 926.758,-3110.79 928.936,-3117.44"/>
</g>
<!-- sourcefile~read_line.f90 -->
<g id="node4" class="node"><title>sourcefile~read_line.f90</title>
<a xlink:href="../sourcefile/read_line.f90.html" xlink:title="read_line.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="372,-2358 298,-2358 298,-2332 372,-2332 372,-2358"/>
<text text-anchor="middle" x="335" y="-2342.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_line.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~read_line.f90 -->
<g id="edge200" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~read_line.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.107,-1346.15C193.123,-1457.66 202.515,-2242.6 266,-2323 271.548,-2330.03 279.348,-2334.85 287.717,-2338.14"/>
<polygon fill="#000000" stroke="#000000" points="286.727,-2341.5 297.319,-2341.25 288.885,-2334.84 286.727,-2341.5"/>
</g>
<!-- sourcefile~fury_uom64.f90 -->
<g id="node5" class="node"><title>sourcefile~fury_uom64.f90</title>
<a xlink:href="../sourcefile/fury_uom64.f90.html" xlink:title="fury_uom64.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="720,-2614 630,-2614 630,-2588 720,-2588 720,-2614"/>
<text text-anchor="middle" x="675" y="-2598.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom64.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom64.f90 -->
<g id="edge202" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2601C549.619,-2598.79 588.538,-2598.74 619.323,-2599.26"/>
<polygon fill="#000000" stroke="#000000" points="619.366,-2602.76 629.433,-2599.46 619.503,-2595.76 619.366,-2602.76"/>
</g>
<!-- sourcefile~slice.f90 -->
<g id="node6" class="node"><title>sourcefile~slice.f90</title>
<a xlink:href="../sourcefile/slice.f90.html" xlink:title="slice.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362,-2314 308,-2314 308,-2288 362,-2288 362,-2314"/>
<text text-anchor="middle" x="335" y="-2298.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">slice.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~slice.f90 -->
<g id="edge204" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~slice.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.156,-1346.25C193.554,-1455.28 205.315,-2202.42 266,-2279 273.809,-2288.85 286.046,-2294.37 298.059,-2297.43"/>
<polygon fill="#000000" stroke="#000000" points="297.498,-2300.88 307.997,-2299.46 298.902,-2294.03 297.498,-2300.88"/>
</g>
<!-- sourcefile~start_end.f90 -->
<g id="node7" class="node"><title>sourcefile~start_end.f90</title>
<a xlink:href="../sourcefile/start_end.f90.html" xlink:title="start_end.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="373,-2270 297,-2270 297,-2244 373,-2244 373,-2270"/>
<text text-anchor="middle" x="335" y="-2254.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start_end.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~start_end.f90 -->
<g id="edge206" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~start_end.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.21,-1346.3C194.003,-1452.61 208.104,-2162.22 266,-2235 271.457,-2241.86 279.06,-2246.62 287.234,-2249.9"/>
<polygon fill="#000000" stroke="#000000" points="286.406,-2253.32 296.999,-2253.13 288.6,-2246.67 286.406,-2253.32"/>
</g>
<!-- sourcefile~basename_dir.f90 -->
<g id="node8" class="node"><title>sourcefile~basename_dir.f90</title>
<a xlink:href="../sourcefile/basename_dir.f90.html" xlink:title="basename_dir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="384,-2226 286,-2226 286,-2200 384,-2200 384,-2226"/>
<text text-anchor="middle" x="335" y="-2210.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">basename_dir.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~basename_dir.f90 -->
<g id="edge208" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~basename_dir.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.269,-1346.3C194.473,-1449.63 210.881,-2122.01 266,-2191 268.904,-2194.63 272.41,-2197.68 276.283,-2200.23"/>
<polygon fill="#000000" stroke="#000000" points="274.791,-2203.4 285.257,-2205.05 278.104,-2197.23 274.791,-2203.4"/>
</g>
<!-- sourcefile~fury_uom_reference32.f90 -->
<g id="node9" class="node"><title>sourcefile~fury_uom_reference32.f90</title>
<a xlink:href="../sourcefile/fury_uom_reference32.f90.html" xlink:title="fury_uom_reference32.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="586,-2459 444,-2459 444,-2433 586,-2433 586,-2459"/>
<text text-anchor="middle" x="515" y="-2443.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom_reference32.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_reference32.f90 -->
<g id="edge210" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_reference32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.223,-1346.14C194.187,-1456.15 209.809,-2225.37 266,-2449 284.08,-2520.95 279.541,-2551.72 335,-2601"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335,-2601C398.397,-2657.33 476.098,-2523.13 504.208,-2468.16"/>
<polygon fill="#000000" stroke="#000000" points="507.361,-2469.69 508.721,-2459.18 501.105,-2466.54 507.361,-2469.69"/>
</g>
<!-- sourcefile~to_number.f90 -->
<g id="node10" class="node"><title>sourcefile~to_number.f90</title>
<a xlink:href="../sourcefile/to_number.f90.html" xlink:title="to_number.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="376,-2182 294,-2182 294,-2156 376,-2156 376,-2182"/>
<text text-anchor="middle" x="335" y="-2166.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_number.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~to_number.f90 -->
<g id="edge212" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~to_number.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.333,-1346.25C194.961,-1446.37 213.646,-2081.78 266,-2147 270.762,-2152.93 277.127,-2157.29 284.071,-2160.48"/>
<polygon fill="#000000" stroke="#000000" points="283.212,-2163.9 293.803,-2164.16 285.685,-2157.35 283.212,-2163.9"/>
</g>
<!-- sourcefile~fury_qreal32.f90 -->
<g id="node11" class="node"><title>sourcefile~fury_qreal32.f90</title>
<a xlink:href="../sourcefile/fury_qreal32.f90.html" xlink:title="fury_qreal32.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="857,-2339 763,-2339 763,-2313 857,-2313 857,-2339"/>
<text text-anchor="middle" x="810" y="-2323.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_qreal32.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_qreal32.f90 -->
<g id="edge214" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_qreal32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2285C602.421,-2250.87 714.166,-2285.74 771.802,-2308.93"/>
<polygon fill="#000000" stroke="#000000" points="770.667,-2312.25 781.246,-2312.82 773.334,-2305.78 770.667,-2312.25"/>
</g>
<!-- sourcefile~capitalize.f90 -->
<g id="node12" class="node"><title>sourcefile~capitalize.f90</title>
<a xlink:href="../sourcefile/capitalize.f90.html" xlink:title="capitalize.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="372,-2138 298,-2138 298,-2112 372,-2112 372,-2138"/>
<text text-anchor="middle" x="335" y="-2122.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">capitalize.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~capitalize.f90 -->
<g id="edge216" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~capitalize.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.402,-1346.14C195.469,-1442.8 216.399,-2041.53 266,-2103 271.622,-2109.97 279.455,-2114.76 287.833,-2118.05"/>
<polygon fill="#000000" stroke="#000000" points="286.844,-2121.41 297.436,-2121.16 289.002,-2114.75 286.844,-2121.41"/>
</g>
<!-- sourcefile~is_real.f90 -->
<g id="node13" class="node"><title>sourcefile~is_real.f90</title>
<a xlink:href="../sourcefile/is_real.f90.html" xlink:title="is_real.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-2094 304,-2094 304,-2068 366,-2068 366,-2094"/>
<text text-anchor="middle" x="335" y="-2078.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_real.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~is_real.f90 -->
<g id="edge218" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~is_real.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.488,-1346.28C196.045,-1440.14 219.189,-2001.33 266,-2059 273.038,-2067.67 283.497,-2072.97 294.157,-2076.2"/>
<polygon fill="#000000" stroke="#000000" points="293.362,-2079.61 303.91,-2078.62 295.046,-2072.81 293.362,-2079.61"/>
</g>
<!-- sourcefile~concatenation.f90 -->
<g id="node14" class="node"><title>sourcefile~concatenation.f90</title>
<a xlink:href="../sourcefile/concatenation.f90.html" xlink:title="concatenation.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="383,-2050 287,-2050 287,-2024 383,-2024 383,-2050"/>
<text text-anchor="middle" x="335" y="-2034.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">concatenation.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~concatenation.f90 -->
<g id="edge220" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~concatenation.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.569,-1346.05C196.595,-1435.91 221.914,-1961.05 266,-2015 269.165,-2018.87 273.012,-2022.07 277.254,-2024.72"/>
<polygon fill="#000000" stroke="#000000" points="275.923,-2027.97 286.421,-2029.4 279.107,-2021.73 275.923,-2027.97"/>
</g>
<!-- sourcefile~slen.f90 -->
<g id="node15" class="node"><title>sourcefile~slen.f90</title>
<a xlink:href="../sourcefile/slen.f90.html" xlink:title="slen.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362,-2006 308,-2006 308,-1980 362,-1980 362,-2006"/>
<text text-anchor="middle" x="335" y="-1990.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">slen.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~slen.f90 -->
<g id="edge222" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~slen.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.67,-1346.03C197.222,-1432.43 224.671,-1920.8 266,-1971 273.929,-1980.63 286.077,-1986.1 297.982,-1989.19"/>
<polygon fill="#000000" stroke="#000000" points="297.321,-1992.63 307.827,-1991.26 298.763,-1985.78 297.321,-1992.63"/>
</g>
<!-- sourcefile~scount.f90 -->
<g id="node16" class="node"><title>sourcefile~scount.f90</title>
<a xlink:href="../sourcefile/scount.f90.html" xlink:title="scount.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-1962 304,-1962 304,-1936 366,-1936 366,-1962"/>
<text text-anchor="middle" x="335" y="-1946.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">scount.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~scount.f90 -->
<g id="edge224" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~scount.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.797,-1346.19C197.941,-1429.49 227.45,-1880.58 266,-1927 273.001,-1935.43 283.231,-1940.67 293.681,-1943.91"/>
<polygon fill="#000000" stroke="#000000" points="293.115,-1947.38 303.669,-1946.45 294.84,-1940.6 293.115,-1947.38"/>
</g>
<!-- sourcefile~csv_naive_parser.f90 -->
<g id="node17" class="node"><title>sourcefile~csv_naive_parser.f90</title>
<a xlink:href="../sourcefile/csv_naive_parser.f90.html" xlink:title="csv_naive_parser.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="392,-1918 278,-1918 278,-1892 392,-1892 392,-1918"/>
<text text-anchor="middle" x="335" y="-1902.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">csv_naive_parser.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~csv_naive_parser.f90 -->
<g id="edge226" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~csv_naive_parser.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.938,-1346.23C198.696,-1425.96 230.205,-1840.32 266,-1883 267.01,-1884.2 268.086,-1885.34 269.219,-1886.42"/>
<polygon fill="#000000" stroke="#000000" points="267.354,-1889.4 277.43,-1892.67 271.594,-1883.83 267.354,-1889.4"/>
</g>
<!-- sourcefile~is_number.f90 -->
<g id="node18" class="node"><title>sourcefile~is_number.f90</title>
<a xlink:href="../sourcefile/is_number.f90.html" xlink:title="is_number.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="375,-1874 295,-1874 295,-1848 375,-1848 375,-1874"/>
<text text-anchor="middle" x="335" y="-1858.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_number.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~is_number.f90 -->
<g id="edge228" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~is_number.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.101,-1346.11C192.912,-1417.76 200.226,-1761.49 266,-1839 271.091,-1845 277.816,-1849.38 285.072,-1852.58"/>
<polygon fill="#000000" stroke="#000000" points="283.87,-1855.86 294.464,-1856.02 286.281,-1849.29 283.87,-1855.86"/>
</g>
<!-- sourcefile~upper_lower.f90 -->
<g id="node19" class="node"><title>sourcefile~upper_lower.f90</title>
<a xlink:href="../sourcefile/upper_lower.f90.html" xlink:title="upper_lower.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="380,-1830 290,-1830 290,-1804 380,-1804 380,-1830"/>
<text text-anchor="middle" x="335" y="-1814.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">upper_lower.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~upper_lower.f90 -->
<g id="edge230" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~upper_lower.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.307,-1346.3C194.141,-1414.55 205.737,-1724.96 266,-1795 269.993,-1799.64 274.962,-1803.31 280.393,-1806.21"/>
<polygon fill="#000000" stroke="#000000" points="279.315,-1809.56 289.877,-1810.41 282.147,-1803.16 279.315,-1809.56"/>
</g>
<!-- sourcefile~fury_system_si32.f90 -->
<g id="node20" class="node"><title>sourcefile~fury_system_si32.f90</title>
<a xlink:href="../sourcefile/fury_system_si32.f90.html" xlink:title="fury_system_si32.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1207,-2359 1089,-2359 1089,-2333 1207,-2333 1207,-2359"/>
<text text-anchor="middle" x="1148" y="-2343.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_system_si32.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_si32.f90 -->
<g id="edge232" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_si32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.038,-1346.03C192.481,-1459.92 198.033,-2284.11 266,-2367 286.168,-2391.6 309.247,-2367.33 335,-2386"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335,-2386C360.753,-2404.67 379.193,-2386.91 404,-2367 430.669,-2345.6 412.454,-2319.26 440,-2299 467.315,-2278.91 483.468,-2297.47 515,-2285"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2285C724.604,-2202.09 1002.49,-2290.22 1106.43,-2329.31"/>
<polygon fill="#000000" stroke="#000000" points="1105.35,-2332.64 1115.94,-2332.93 1107.84,-2326.1 1105.35,-2332.64"/>
</g>
<!-- sourcefile~sindex.f90 -->
<g id="node21" class="node"><title>sourcefile~sindex.f90</title>
<a xlink:href="../sourcefile/sindex.f90.html" xlink:title="sindex.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="365,-1786 305,-1786 305,-1760 365,-1760 365,-1786"/>
<text text-anchor="middle" x="335" y="-1770.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sindex.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~sindex.f90 -->
<g id="edge234" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~sindex.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.552,-1346.29C195.477,-1410.54 211.17,-1688.32 266,-1751 273.352,-1759.4 283.907,-1764.63 294.559,-1767.86"/>
<polygon fill="#000000" stroke="#000000" points="293.726,-1771.26 304.278,-1770.31 295.435,-1764.47 293.726,-1771.26"/>
</g>
<!-- sourcefile~assignments.f90 -->
<g id="node22" class="node"><title>sourcefile~assignments.f90</title>
<a xlink:href="../sourcefile/assignments.f90.html" xlink:title="assignments.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="380,-1742 290,-1742 290,-1716 380,-1716 380,-1742"/>
<text text-anchor="middle" x="335" y="-1726.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">assignments.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~assignments.f90 -->
<g id="edge236" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~assignments.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.838,-1346.08C196.915,-1405.74 216.523,-1651.57 266,-1707 269.969,-1711.45 274.835,-1715 280.128,-1717.84"/>
<polygon fill="#000000" stroke="#000000" points="278.801,-1721.08 289.358,-1721.98 281.664,-1714.69 278.801,-1721.08"/>
</g>
<!-- sourcefile~fury_uom_symbol32.f90 -->
<g id="node23" class="node"><title>sourcefile~fury_uom_symbol32.f90</title>
<a xlink:href="../sourcefile/fury_uom_symbol32.f90.html" xlink:title="fury_uom_symbol32.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="400,-2440 270,-2440 270,-2414 400,-2414 400,-2440"/>
<text text-anchor="middle" x="335" y="-2424.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom_symbol32.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_symbol32.f90 -->
<g id="edge238" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_symbol32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.071,-1346.03C192.81,-1461.69 200.457,-2310.77 266,-2400 268.266,-2403.08 270.936,-2405.82 273.888,-2408.24"/>
<polygon fill="#000000" stroke="#000000" points="272.033,-2411.21 282.269,-2413.94 275.972,-2405.42 272.033,-2411.21"/>
</g>
<!-- sourcefile~equal.f90 -->
<g id="node24" class="node"><title>sourcefile~equal.f90</title>
<a xlink:href="../sourcefile/equal.f90.html" xlink:title="equal.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-1698 307,-1698 307,-1672 363,-1672 363,-1698"/>
<text text-anchor="middle" x="335" y="-1682.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">equal.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~equal.f90 -->
<g id="edge240" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~equal.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M193.24,-1346.37C198.66,-1402.07 221.989,-1614.93 266,-1663 273.866,-1671.59 285.075,-1676.85 296.177,-1680.05"/>
<polygon fill="#000000" stroke="#000000" points="295.704,-1683.54 306.244,-1682.46 297.332,-1676.73 295.704,-1683.54"/>
</g>
<!-- sourcefile~lower_than.f90 -->
<g id="node25" class="node"><title>sourcefile~lower_than.f90</title>
<a xlink:href="../sourcefile/lower_than.f90.html" xlink:title="lower_than.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="376,-1654 294,-1654 294,-1628 376,-1628 376,-1654"/>
<text text-anchor="middle" x="335" y="-1638.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lower_than.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~lower_than.f90 -->
<g id="edge242" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~lower_than.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M193.725,-1346.29C200.567,-1397.08 227.317,-1578.11 266,-1619 270.877,-1624.15 276.957,-1628.11 283.472,-1631.13"/>
<polygon fill="#000000" stroke="#000000" points="282.653,-1634.57 293.241,-1634.94 285.195,-1628.05 282.653,-1634.57"/>
</g>
<!-- sourcefile~escape.f90 -->
<g id="node26" class="node"><title>sourcefile~escape.f90</title>
<a xlink:href="../sourcefile/escape.f90.html" xlink:title="escape.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="367,-1610 303,-1610 303,-1584 367,-1584 367,-1610"/>
<text text-anchor="middle" x="335" y="-1594.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">escape.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~escape.f90 -->
<g id="edge244" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~escape.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M194.354,-1346.09C202.758,-1391.48 232.571,-1541.17 266,-1575 273.225,-1582.31 282.872,-1587.2 292.657,-1590.46"/>
<polygon fill="#000000" stroke="#000000" points="291.829,-1593.86 302.404,-1593.21 293.731,-1587.13 291.829,-1593.86"/>
</g>
<!-- sourcefile~extension.f90 -->
<g id="node27" class="node"><title>sourcefile~extension.f90</title>
<a xlink:href="../sourcefile/extension.f90.html" xlink:title="extension.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="373,-1566 297,-1566 297,-1540 373,-1540 373,-1566"/>
<text text-anchor="middle" x="335" y="-1550.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">extension.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~extension.f90 -->
<g id="edge246" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~extension.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M193.049,-1346.23C196.557,-1381.49 210.986,-1478.62 266,-1531 271.956,-1536.67 279.372,-1540.88 287.115,-1544"/>
<polygon fill="#000000" stroke="#000000" points="286.049,-1547.34 296.643,-1547.3 288.338,-1540.72 286.049,-1547.34"/>
</g>
<!-- sourcefile~strim.f90 -->
<g id="node28" class="node"><title>sourcefile~strim.f90</title>
<a xlink:href="../sourcefile/strim.f90.html" xlink:title="strim.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362,-1522 308,-1522 308,-1496 362,-1496 362,-1522"/>
<text text-anchor="middle" x="335" y="-1506.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">strim.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~strim.f90 -->
<g id="edge248" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~strim.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M194.647,-1346.3C201.249,-1375.97 221.233,-1448.07 266,-1487 275.026,-1494.85 286.872,-1499.9 298.196,-1503.15"/>
<polygon fill="#000000" stroke="#000000" points="297.38,-1506.56 307.929,-1505.57 299.069,-1499.76 297.38,-1506.56"/>
</g>
<!-- sourcefile~decode.f90 -->
<g id="node29" class="node"><title>sourcefile~decode.f90</title>
<a xlink:href="../sourcefile/decode.f90.html" xlink:title="decode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="368,-1478 302,-1478 302,-1452 368,-1452 368,-1478"/>
<text text-anchor="middle" x="335" y="-1462.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">decode.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~decode.f90 -->
<g id="edge250" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~decode.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M197.403,-1346.3C207.451,-1369.38 231.203,-1416.89 266,-1443 273.763,-1448.82 283.118,-1453.14 292.399,-1456.32"/>
<polygon fill="#000000" stroke="#000000" points="291.387,-1459.67 301.973,-1459.24 293.431,-1452.97 291.387,-1459.67"/>
</g>
<!-- sourcefile~fill.f90 -->
<g id="node30" class="node"><title>sourcefile~fill.f90</title>
<a xlink:href="../sourcefile/fill.f90.html" xlink:title="fill.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362,-1434 308,-1434 308,-1408 362,-1408 362,-1434"/>
<text text-anchor="middle" x="335" y="-1418.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fill.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fill.f90 -->
<g id="edge252" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fill.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M203.559,-1346.22C217.147,-1361.01 241.03,-1384.75 266,-1399 275.766,-1404.57 287.128,-1408.94 297.78,-1412.25"/>
<polygon fill="#000000" stroke="#000000" points="297.121,-1415.71 307.699,-1415.12 299.065,-1408.98 297.121,-1415.71"/>
</g>
<!-- sourcefile~io_listdirected.f90 -->
<g id="node31" class="node"><title>sourcefile~io_listdirected.f90</title>
<a xlink:href="../sourcefile/io_listdirected.f90.html" xlink:title="io_listdirected.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385,-1390 285,-1390 285,-1364 385,-1364 385,-1390"/>
<text text-anchor="middle" x="335" y="-1374.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_listdirected.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~io_listdirected.f90 -->
<g id="edge254" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~io_listdirected.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M230.321,-1344.79C246.366,-1349.73 265.275,-1355.55 282.576,-1360.87"/>
<polygon fill="#000000" stroke="#000000" points="281.956,-1364.34 292.543,-1363.94 284.014,-1357.65 281.956,-1364.34"/>
</g>
<!-- sourcefile~fury_uom128.f90 -->
<g id="node32" class="node"><title>sourcefile~fury_uom128.f90</title>
<a xlink:href="../sourcefile/fury_uom128.f90.html" xlink:title="fury_uom128.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="723,-3038 627,-3038 627,-3012 723,-3012 723,-3038"/>
<text text-anchor="middle" x="675" y="-3022.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom128.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom128.f90 -->
<g id="edge256" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335,-3139C403.509,-3180.31 436.168,-3152.62 515,-3139"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-3139C575.828,-3128.49 630.618,-3075.86 657.505,-3045.92"/>
<polygon fill="#000000" stroke="#000000" points="660.372,-3047.96 664.33,-3038.13 655.107,-3043.35 660.372,-3047.96"/>
</g>
<!-- sourcefile~insert.f90 -->
<g id="node33" class="node"><title>sourcefile~insert.f90</title>
<a xlink:href="../sourcefile/insert.f90.html" xlink:title="insert.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-1346 307,-1346 307,-1320 363,-1320 363,-1346"/>
<text text-anchor="middle" x="335" y="-1330.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">insert.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~insert.f90 -->
<g id="edge258" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~insert.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M230.321,-1333C250.611,-1333 275.481,-1333 295.888,-1333"/>
<polygon fill="#000000" stroke="#000000" points="296.105,-1336.5 306.105,-1333 296.105,-1329.5 296.105,-1336.5"/>
</g>
<!-- sourcefile~unescape.f90 -->
<g id="node34" class="node"><title>sourcefile~unescape.f90</title>
<a xlink:href="../sourcefile/unescape.f90.html" xlink:title="unescape.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="373,-1302 297,-1302 297,-1276 373,-1276 373,-1302"/>
<text text-anchor="middle" x="335" y="-1286.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unescape.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~unescape.f90 -->
<g id="edge260" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~unescape.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M230.321,-1321.21C247.573,-1315.9 268.135,-1309.57 286.45,-1303.94"/>
<polygon fill="#000000" stroke="#000000" points="287.547,-1307.26 296.075,-1300.98 285.488,-1300.57 287.547,-1307.26"/>
</g>
<!-- sourcefile~fury_uom_reference64.f90 -->
<g id="node35" class="node"><title>sourcefile~fury_uom_reference64.f90</title>
<a xlink:href="../sourcefile/fury_uom_reference64.f90.html" xlink:title="fury_uom_reference64.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="586,-2766 444,-2766 444,-2740 586,-2740 586,-2766"/>
<text text-anchor="middle" x="515" y="-2750.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom_reference64.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_reference64.f90 -->
<g id="edge262" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_reference64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335,-2601C389.681,-2649.59 455.811,-2704.47 490.705,-2733.14"/>
<polygon fill="#000000" stroke="#000000" points="488.926,-2736.21 498.878,-2739.85 493.366,-2730.8 488.926,-2736.21"/>
</g>
<!-- sourcefile~sscan.f90 -->
<g id="node36" class="node"><title>sourcefile~sscan.f90</title>
<a xlink:href="../sourcefile/sscan.f90.html" xlink:title="sscan.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="364,-1258 306,-1258 306,-1232 364,-1232 364,-1258"/>
<text text-anchor="middle" x="335" y="-1242.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sscan.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~sscan.f90 -->
<g id="edge264" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~sscan.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M203.559,-1319.78C217.147,-1304.99 241.03,-1281.25 266,-1267 275.174,-1261.77 285.756,-1257.6 295.835,-1254.36"/>
<polygon fill="#000000" stroke="#000000" points="297.091,-1257.64 305.675,-1251.43 295.092,-1250.93 297.091,-1257.64"/>
</g>
<!-- sourcefile~not_equal.f90 -->
<g id="node37" class="node"><title>sourcefile~not_equal.f90</title>
<a xlink:href="../sourcefile/not_equal.f90.html" xlink:title="not_equal.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="374,-1214 296,-1214 296,-1188 374,-1188 374,-1214"/>
<text text-anchor="middle" x="335" y="-1198.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">not_equal.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~not_equal.f90 -->
<g id="edge266" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~not_equal.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M197.403,-1319.7C207.451,-1296.62 231.203,-1249.11 266,-1223 272.016,-1218.49 278.987,-1214.88 286.139,-1212.01"/>
<polygon fill="#000000" stroke="#000000" points="287.683,-1215.17 295.931,-1208.52 285.336,-1208.58 287.683,-1215.17"/>
</g>
<!-- sourcefile~greater_equal_than.f90 -->
<g id="node38" class="node"><title>sourcefile~greater_equal_than.f90</title>
<a xlink:href="../sourcefile/greater_equal_than.f90.html" xlink:title="greater_equal_than.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="397,-1170 273,-1170 273,-1144 397,-1144 397,-1170"/>
<text text-anchor="middle" x="335" y="-1154.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">greater_equal_than.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~greater_equal_than.f90 -->
<g id="edge268" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~greater_equal_than.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M194.647,-1319.7C201.249,-1290.03 221.233,-1217.93 266,-1179 267.494,-1177.7 269.066,-1176.48 270.7,-1175.33"/>
<polygon fill="#000000" stroke="#000000" points="272.545,-1178.3 279.316,-1170.15 268.941,-1172.3 272.545,-1178.3"/>
</g>
<!-- sourcefile~unique.f90 -->
<g id="node39" class="node"><title>sourcefile~unique.f90</title>
<a xlink:href="../sourcefile/unique.f90.html" xlink:title="unique.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-1126 304,-1126 304,-1100 366,-1100 366,-1126"/>
<text text-anchor="middle" x="335" y="-1110.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unique.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~unique.f90 -->
<g id="edge270" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~unique.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M193.049,-1319.77C196.557,-1284.51 210.986,-1187.38 266,-1135 273.581,-1127.78 283.528,-1122.93 293.501,-1119.67"/>
<polygon fill="#000000" stroke="#000000" points="294.702,-1122.97 303.395,-1116.92 292.823,-1116.23 294.702,-1122.97"/>
</g>
<!-- sourcefile~greater_than.f90 -->
<g id="node40" class="node"><title>sourcefile~greater_than.f90</title>
<a xlink:href="../sourcefile/greater_than.f90.html" xlink:title="greater_than.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="381,-1082 289,-1082 289,-1056 381,-1056 381,-1082"/>
<text text-anchor="middle" x="335" y="-1066.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">greater_than.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~greater_than.f90 -->
<g id="edge272" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~greater_than.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M194.354,-1319.91C202.758,-1274.52 232.571,-1124.83 266,-1091 269.922,-1087.03 274.557,-1083.78 279.541,-1081.11"/>
<polygon fill="#000000" stroke="#000000" points="281.143,-1084.23 288.809,-1076.91 278.256,-1077.85 281.143,-1084.23"/>
</g>
<!-- sourcefile~encode.f90 -->
<g id="node41" class="node"><title>sourcefile~encode.f90</title>
<a xlink:href="../sourcefile/encode.f90.html" xlink:title="encode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="368,-1038 302,-1038 302,-1012 368,-1012 368,-1038"/>
<text text-anchor="middle" x="335" y="-1022.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">encode.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~encode.f90 -->
<g id="edge274" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~encode.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M193.725,-1319.71C200.567,-1268.92 227.317,-1087.89 266,-1047 272.999,-1039.6 282.477,-1034.68 292.164,-1031.41"/>
<polygon fill="#000000" stroke="#000000" points="293.174,-1034.77 301.837,-1028.67 291.261,-1028.03 293.174,-1034.77"/>
</g>
<!-- sourcefile~fury_system_si64.f90 -->
<g id="node42" class="node"><title>sourcefile~fury_system_si64.f90</title>
<a xlink:href="../sourcefile/fury_system_si64.f90.html" xlink:title="fury_system_si64.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1207,-2584 1089,-2584 1089,-2558 1207,-2558 1207,-2584"/>
<text text-anchor="middle" x="1148" y="-2568.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_system_si64.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_si64.f90 -->
<g id="edge276" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_si64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335,-2601C394.802,-2654.14 435.162,-2606.09 515,-2601"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2601C588.26,-2596.33 603.331,-2575.89 675,-2560"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2560C720.145,-2549.99 715.925,-2513.99 760,-2500 802.362,-2486.55 816.227,-2492.3 860,-2500 912.619,-2509.25 920.104,-2533.5 973,-2541"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-2541C1007.9,-2545.45 1046.47,-2551.89 1078.5,-2557.67"/>
<polygon fill="#000000" stroke="#000000" points="1078.19,-2561.17 1088.66,-2559.52 1079.45,-2554.28 1078.19,-2561.17"/>
</g>
<!-- sourcefile~write_lines.f90 -->
<g id="node43" class="node"><title>sourcefile~write_lines.f90</title>
<a xlink:href="../sourcefile/write_lines.f90.html" xlink:title="write_lines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="375,-994 295,-994 295,-968 375,-968 375,-994"/>
<text text-anchor="middle" x="335" y="-978.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_lines.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~write_lines.f90 -->
<g id="edge278" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~write_lines.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M193.24,-1319.63C198.66,-1263.93 221.989,-1051.07 266,-1003 271.079,-997.453 277.551,-993.298 284.488,-990.186"/>
<polygon fill="#000000" stroke="#000000" points="286.018,-993.35 294.149,-986.556 283.556,-986.797 286.018,-993.35"/>
</g>
<!-- sourcefile~io_basic.f90 -->
<g id="node44" class="node"><title>sourcefile~io_basic.f90</title>
<a xlink:href="../sourcefile/io_basic.f90.html" xlink:title="io_basic.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="371,-950 299,-950 299,-924 371,-924 371,-950"/>
<text text-anchor="middle" x="335" y="-934.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_basic.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~io_basic.f90 -->
<g id="edge280" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~io_basic.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.838,-1319.92C196.915,-1260.26 216.523,-1014.43 266,-959 272.023,-952.253 280.108,-947.561 288.622,-944.301"/>
<polygon fill="#000000" stroke="#000000" points="289.871,-947.576 298.329,-941.196 287.738,-940.909 289.871,-947.576"/>
</g>
<!-- sourcefile~camelcase.f90 -->
<g id="node45" class="node"><title>sourcefile~camelcase.f90</title>
<a xlink:href="../sourcefile/camelcase.f90.html" xlink:title="camelcase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="376,-906 294,-906 294,-880 376,-880 376,-906"/>
<text text-anchor="middle" x="335" y="-890.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">camelcase.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~camelcase.f90 -->
<g id="edge282" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~camelcase.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.552,-1319.71C195.477,-1255.46 211.17,-977.682 266,-915 270.951,-909.34 277.356,-905.123 284.264,-901.985"/>
<polygon fill="#000000" stroke="#000000" points="285.79,-905.15 293.907,-898.34 283.315,-898.602 285.79,-905.15"/>
</g>
<!-- sourcefile~fury_uom_symbol64.f90 -->
<g id="node46" class="node"><title>sourcefile~fury_uom_symbol64.f90</title>
<a xlink:href="../sourcefile/fury_uom_symbol64.f90.html" xlink:title="fury_uom_symbol64.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="400,-2746 270,-2746 270,-2720 400,-2720 400,-2746"/>
<text text-anchor="middle" x="335" y="-2730.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom_symbol64.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_symbol64.f90 -->
<g id="edge284" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_symbol64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.39,-1346.29C196.19,-1474.35 227.356,-2487.09 266,-2615 277.088,-2651.7 301.661,-2689.07 318.283,-2711.65"/>
<polygon fill="#000000" stroke="#000000" points="315.623,-2713.94 324.432,-2719.83 321.217,-2709.73 315.623,-2713.94"/>
</g>
<!-- sourcefile~search.f90 -->
<g id="node47" class="node"><title>sourcefile~search.f90</title>
<a xlink:href="../sourcefile/search.f90.html" xlink:title="search.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-862 304,-862 304,-836 366,-836 366,-862"/>
<text text-anchor="middle" x="335" y="-846.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">search.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~search.f90 -->
<g id="edge286" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~search.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.307,-1319.7C194.141,-1251.45 205.737,-941.043 266,-871 273.084,-862.766 283.245,-857.584 293.599,-854.332"/>
<polygon fill="#000000" stroke="#000000" points="294.689,-857.665 303.491,-851.768 292.933,-850.889 294.689,-857.665"/>
</g>
<!-- sourcefile~fury_system_si128.f90 -->
<g id="node48" class="node"><title>sourcefile~fury_system_si128.f90</title>
<a xlink:href="../sourcefile/fury_system_si128.f90.html" xlink:title="fury_system_si128.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1210,-3072 1086,-3072 1086,-3046 1210,-3046 1210,-3072"/>
<text text-anchor="middle" x="1148" y="-3056.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_system_si128.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_si128.f90 -->
<g id="edge288" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_si128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-3139C882.303,-3134.47 901.012,-3147.12 973,-3139"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-3139C1008.03,-3135.05 1017.52,-3133.71 1050,-3120 1076.26,-3108.92 1103.59,-3091.32 1122.69,-3077.87"/>
<polygon fill="#000000" stroke="#000000" points="1124.77,-3080.69 1130.86,-3072.02 1120.69,-3075 1124.77,-3080.69"/>
</g>
<!-- sourcefile~startcase.f90 -->
<g id="node49" class="node"><title>sourcefile~startcase.f90</title>
<a xlink:href="../sourcefile/startcase.f90.html" xlink:title="startcase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="372,-818 298,-818 298,-792 372,-792 372,-818"/>
<text text-anchor="middle" x="335" y="-802.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">startcase.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~startcase.f90 -->
<g id="edge290" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~startcase.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.101,-1319.89C192.912,-1248.24 200.226,-904.508 266,-827 271.793,-820.174 279.701,-815.443 288.1,-812.17"/>
<polygon fill="#000000" stroke="#000000" points="289.268,-815.471 297.704,-809.06 287.112,-808.811 289.268,-815.471"/>
</g>
<!-- sourcefile~free.f90 -->
<g id="node50" class="node"><title>sourcefile~free.f90</title>
<a xlink:href="../sourcefile/free.f90.html" xlink:title="free.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362,-774 308,-774 308,-748 362,-748 362,-774"/>
<text text-anchor="middle" x="335" y="-758.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">free.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~free.f90 -->
<g id="edge292" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~free.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.938,-1319.77C198.696,-1240.04 230.205,-825.676 266,-783 274.017,-773.442 286.184,-767.988 298.081,-764.893"/>
<polygon fill="#000000" stroke="#000000" points="298.856,-768.306 307.913,-762.809 297.404,-761.459 298.856,-768.306"/>
</g>
<!-- sourcefile~is_integer.f90 -->
<g id="node51" class="node"><title>sourcefile~is_integer.f90</title>
<a xlink:href="../sourcefile/is_integer.f90.html" xlink:title="is_integer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="373,-730 297,-730 297,-704 373,-704 373,-730"/>
<text text-anchor="middle" x="335" y="-714.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_integer.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~is_integer.f90 -->
<g id="edge294" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~is_integer.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.797,-1319.81C197.941,-1236.51 227.45,-785.42 266,-739 271.368,-732.536 278.636,-727.947 286.445,-724.696"/>
<polygon fill="#000000" stroke="#000000" points="287.832,-727.92 296.148,-721.357 285.554,-721.301 287.832,-727.92"/>
</g>
<!-- sourcefile~fury_uom_reference128.f90 -->
<g id="node52" class="node"><title>sourcefile~fury_uom_reference128.f90</title>
<a xlink:href="../sourcefile/fury_uom_reference128.f90.html" xlink:title="fury_uom_reference128.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="589,-2997 441,-2997 441,-2971 589,-2971 589,-2997"/>
<text text-anchor="middle" x="515" y="-2981.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom_reference128.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_reference128.f90 -->
<g id="edge296" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_reference128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.288,-1346.23C195.523,-1493.1 225.709,-2817.12 266,-2986 283.311,-3058.56 271.119,-3100.48 335,-3139"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335,-3139C406.83,-3182.31 478.143,-3058.96 504.42,-3006.43"/>
<polygon fill="#000000" stroke="#000000" points="507.675,-3007.75 508.927,-2997.22 501.388,-3004.67 507.675,-3007.75"/>
</g>
<!-- sourcefile~sverify.f90 -->
<g id="node53" class="node"><title>sourcefile~sverify.f90</title>
<a xlink:href="../sourcefile/sverify.f90.html" xlink:title="sverify.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="365,-686 305,-686 305,-660 365,-660 365,-686"/>
<text text-anchor="middle" x="335" y="-670.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sverify.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~sverify.f90 -->
<g id="edge298" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~sverify.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.67,-1319.97C197.222,-1233.57 224.671,-745.197 266,-695 273.159,-686.305 283.756,-681.001 294.509,-677.78"/>
<polygon fill="#000000" stroke="#000000" points="295.456,-681.152 304.334,-675.37 293.788,-674.353 295.456,-681.152"/>
</g>
<!-- sourcefile~join.f90 -->
<g id="node54" class="node"><title>sourcefile~join.f90</title>
<a xlink:href="../sourcefile/join.f90.html" xlink:title="join.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362,-642 308,-642 308,-616 362,-616 362,-642"/>
<text text-anchor="middle" x="335" y="-626.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">join.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~join.f90 -->
<g id="edge300" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~join.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.569,-1319.95C196.595,-1230.09 221.914,-704.95 266,-651 273.894,-641.34 286.033,-635.863 297.942,-632.778"/>
<polygon fill="#000000" stroke="#000000" points="298.725,-636.19 307.793,-630.71 297.287,-629.339 298.725,-636.19"/>
</g>
<!-- sourcefile~fury_mixed_kinds.f90 -->
<g id="node55" class="node"><title>sourcefile~fury_mixed_kinds.f90</title>
<a xlink:href="../sourcefile/fury_mixed_kinds.f90.html" xlink:title="fury_mixed_kinds.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1032,-2731 914,-2731 914,-2705 1032,-2705 1032,-2731"/>
<text text-anchor="middle" x="973" y="-2715.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_mixed_kinds.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge302" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.314,-1346.43C195.655,-1487.45 225.357,-2692.6 266,-2755 313.295,-2827.62 355.703,-2822.9 440,-2843 504.848,-2858.47 526.942,-2864.64 590,-2843 609.173,-2836.42 608.807,-2825.74 626,-2815 646.568,-2802.15 651.104,-2795.13 675,-2791"/>
</g>
<!-- sourcefile~partition.f90 -->
<g id="node56" class="node"><title>sourcefile~partition.f90</title>
<a xlink:href="../sourcefile/partition.f90.html" xlink:title="partition.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="369,-598 301,-598 301,-572 369,-572 369,-598"/>
<text text-anchor="middle" x="335" y="-582.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">partition.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~partition.f90 -->
<g id="edge304" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~partition.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.488,-1319.72C196.045,-1225.86 219.189,-664.667 266,-607 272.234,-599.32 281.153,-594.283 290.518,-590.989"/>
<polygon fill="#000000" stroke="#000000" points="291.709,-594.288 300.344,-588.15 289.766,-587.563 291.709,-594.288"/>
</g>
<!-- sourcefile~sadjustlr.f90 -->
<g id="node57" class="node"><title>sourcefile~sadjustlr.f90</title>
<a xlink:href="../sourcefile/sadjustlr.f90.html" xlink:title="sadjustlr.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="370,-554 300,-554 300,-528 370,-528 370,-554"/>
<text text-anchor="middle" x="335" y="-538.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sadjustlr.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~sadjustlr.f90 -->
<g id="edge306" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~sadjustlr.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.402,-1319.86C195.469,-1223.2 216.399,-624.466 266,-563 272.153,-555.375 280.954,-550.353 290.221,-547.057"/>
<polygon fill="#000000" stroke="#000000" points="291.34,-550.376 299.955,-544.209 289.374,-543.658 291.34,-550.376"/>
</g>
<!-- sourcefile~fury_system_abstract32.f90 -->
<g id="node58" class="node"><title>sourcefile~fury_system_abstract32.f90</title>
<a xlink:href="../sourcefile/fury_system_abstract32.f90.html" xlink:title="fury_system_abstract32.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1047,-2417 899,-2417 899,-2391 1047,-2391 1047,-2417"/>
<text text-anchor="middle" x="973" y="-2401.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_system_abstract32.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_abstract32.f90 -->
<g id="edge308" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_abstract32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335,-2386C378.775,-2417.61 725.759,-2411.52 888.846,-2406.81"/>
<polygon fill="#000000" stroke="#000000" points="888.951,-2410.31 898.844,-2406.52 888.745,-2403.32 888.951,-2410.31"/>
</g>
<!-- sourcefile~swapcase.f90 -->
<g id="node59" class="node"><title>sourcefile~swapcase.f90</title>
<a xlink:href="../sourcefile/swapcase.f90.html" xlink:title="swapcase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="374,-510 296,-510 296,-484 374,-484 374,-510"/>
<text text-anchor="middle" x="335" y="-494.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swapcase.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~swapcase.f90 -->
<g id="edge310" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~swapcase.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.333,-1319.75C194.961,-1219.63 213.646,-584.22 266,-519 271.26,-512.447 278.476,-507.817 286.268,-504.551"/>
<polygon fill="#000000" stroke="#000000" points="287.653,-507.776 295.965,-501.207 285.371,-501.158 287.653,-507.776"/>
</g>
<!-- sourcefile~fury.f90 -->
<g id="node60" class="node"><title>sourcefile~fury.f90</title>
<a xlink:href="../sourcefile/fury.f90.html" xlink:title="fury.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1300,-2584 1246,-2584 1246,-2558 1300,-2558 1300,-2584"/>
<text text-anchor="middle" x="1273" y="-2568.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge312" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-3139C1050.29,-3130.28 1084.64,-3184.11 1148,-3139"/>
</g>
<!-- sourcefile~fury_system_abstract64.f90 -->
<g id="node61" class="node"><title>sourcefile~fury_system_abstract64.f90</title>
<a xlink:href="../sourcefile/fury_system_abstract64.f90.html" xlink:title="fury_system_abstract64.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1047,-2614 899,-2614 899,-2588 1047,-2588 1047,-2614"/>
<text text-anchor="middle" x="973" y="-2598.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_system_abstract64.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_abstract64.f90 -->
<g id="edge314" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_system_abstract64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2560C736.22,-2546.43 747.472,-2596.28 810,-2601"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2601C835.421,-2602.92 863.136,-2603.49 888.383,-2603.42"/>
<polygon fill="#000000" stroke="#000000" points="888.686,-2606.92 898.665,-2603.36 888.643,-2599.92 888.686,-2606.92"/>
</g>
<!-- sourcefile~reverse.f90 -->
<g id="node62" class="node"><title>sourcefile~reverse.f90</title>
<a xlink:href="../sourcefile/reverse.f90.html" xlink:title="reverse.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="368,-466 302,-466 302,-440 368,-440 368,-466"/>
<text text-anchor="middle" x="335" y="-450.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reverse.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~reverse.f90 -->
<g id="edge316" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~reverse.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.269,-1319.7C194.473,-1216.37 210.881,-543.991 266,-475 272.416,-466.97 281.77,-461.824 291.532,-458.541"/>
<polygon fill="#000000" stroke="#000000" points="292.625,-461.87 301.337,-455.84 290.766,-455.122 292.625,-461.87"/>
</g>
<!-- sourcefile~fury_uom_symbol128.f90 -->
<g id="node63" class="node"><title>sourcefile~fury_uom_symbol128.f90</title>
<a xlink:href="../sourcefile/fury_uom_symbol128.f90.html" xlink:title="fury_uom_symbol128.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="403,-2977 267,-2977 267,-2951 403,-2951 403,-2977"/>
<text text-anchor="middle" x="335" y="-2961.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom_symbol128.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_symbol128.f90 -->
<g id="edge318" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom_symbol128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.123,-1346.32C193.508,-1488.81 207.219,-2729.75 266,-2881 275.625,-2905.77 295.756,-2928.56 311.803,-2943.97"/>
<polygon fill="#000000" stroke="#000000" points="309.577,-2946.68 319.288,-2950.92 314.339,-2941.55 309.577,-2946.68"/>
</g>
<!-- sourcefile~srepeat.f90 -->
<g id="node64" class="node"><title>sourcefile~srepeat.f90</title>
<a xlink:href="../sourcefile/srepeat.f90.html" xlink:title="srepeat.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="368,-422 302,-422 302,-396 368,-396 368,-422"/>
<text text-anchor="middle" x="335" y="-406.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">srepeat.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~srepeat.f90 -->
<g id="edge320" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~srepeat.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.21,-1319.7C194.003,-1213.39 208.104,-503.778 266,-431 272.399,-422.956 281.747,-417.806 291.509,-414.522"/>
<polygon fill="#000000" stroke="#000000" points="292.603,-417.851 301.315,-411.822 290.744,-411.103 292.603,-417.851"/>
</g>
<!-- sourcefile~split.f90 -->
<g id="node65" class="node"><title>sourcefile~split.f90</title>
<a xlink:href="../sourcefile/split.f90.html" xlink:title="split.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362,-378 308,-378 308,-352 362,-352 362,-378"/>
<text text-anchor="middle" x="335" y="-362.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">split.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~split.f90 -->
<g id="edge322" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~split.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.156,-1319.75C193.554,-1210.72 205.315,-463.581 266,-387 273.809,-377.146 286.046,-371.633 298.059,-368.574"/>
<polygon fill="#000000" stroke="#000000" points="298.902,-371.974 307.997,-366.54 297.498,-365.116 298.902,-371.974"/>
</g>
<!-- sourcefile~fury_qreal64.f90 -->
<g id="node66" class="node"><title>sourcefile~fury_qreal64.f90</title>
<a xlink:href="../sourcefile/fury_qreal64.f90.html" xlink:title="fury_qreal64.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="857,-2535 763,-2535 763,-2509 857,-2509 857,-2535"/>
<text text-anchor="middle" x="810" y="-2519.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_qreal64.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_qreal64.f90 -->
<g id="edge324" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_qreal64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2560C702.911,-2553.81 733.617,-2545.31 758.684,-2537.91"/>
<polygon fill="#000000" stroke="#000000" points="759.764,-2541.24 768.348,-2535.03 757.765,-2534.53 759.764,-2541.24"/>
</g>
<!-- sourcefile~replace.f90 -->
<g id="node67" class="node"><title>sourcefile~replace.f90</title>
<a xlink:href="../sourcefile/replace.f90.html" xlink:title="replace.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="368,-334 302,-334 302,-308 368,-308 368,-334"/>
<text text-anchor="middle" x="335" y="-318.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">replace.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~replace.f90 -->
<g id="edge326" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~replace.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.107,-1319.85C193.123,-1208.34 202.515,-423.4 266,-343 272.554,-334.699 282.251,-329.478 292.317,-326.209"/>
<polygon fill="#000000" stroke="#000000" points="293.227,-329.589 301.992,-323.636 291.428,-322.824 293.227,-329.589"/>
</g>
<!-- sourcefile~fury_qreal128.f90 -->
<g id="node68" class="node"><title>sourcefile~fury_qreal128.f90</title>
<a xlink:href="../sourcefile/fury_qreal128.f90.html" xlink:title="fury_qreal128.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="860,-3073 760,-3073 760,-3047 860,-3047 860,-3073"/>
<text text-anchor="middle" x="810" y="-3057.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_qreal128.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_qreal128.f90 -->
<g id="edge328" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_qreal128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-3139C585.073,-3126.89 604.608,-3149.09 675,-3139"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-3139C718.839,-3132.72 721.613,-3109.08 760,-3087 765.204,-3084.01 770.76,-3080.91 776.206,-3077.93"/>
<polygon fill="#000000" stroke="#000000" points="778.063,-3080.9 785.185,-3073.06 774.726,-3074.75 778.063,-3080.9"/>
</g>
<!-- sourcefile~strip.f90 -->
<g id="node69" class="node"><title>sourcefile~strip.f90</title>
<a xlink:href="../sourcefile/strip.f90.html" xlink:title="strip.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362,-290 308,-290 308,-264 362,-264 362,-290"/>
<text text-anchor="middle" x="335" y="-274.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">strip.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~strip.f90 -->
<g id="edge330" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~strip.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.062,-1319.99C192.712,-1206.27 199.702,-383.236 266,-299 273.776,-289.12 286.006,-283.602 298.023,-280.545"/>
<polygon fill="#000000" stroke="#000000" points="298.868,-283.945 307.965,-278.515 297.467,-277.086 298.868,-283.945"/>
</g>
<!-- sourcefile~write_file.f90 -->
<g id="node70" class="node"><title>sourcefile~write_file.f90</title>
<a xlink:href="../sourcefile/write_file.f90.html" xlink:title="write_file.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="371,-246 299,-246 299,-220 371,-220 371,-246"/>
<text text-anchor="middle" x="335" y="-230.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_file.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~write_file.f90 -->
<g id="edge332" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~write_file.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.478,-1319.95C196.907,-1200.44 231.403,-299.09 266,-255 271.757,-247.663 279.97,-242.731 288.733,-239.426"/>
<polygon fill="#000000" stroke="#000000" points="289.851,-242.744 298.368,-236.442 287.78,-236.058 289.851,-242.744"/>
</g>
<!-- sourcefile~fury_uom32.f90 -->
<g id="node71" class="node"><title>sourcefile~fury_uom32.f90</title>
<a xlink:href="../sourcefile/fury_uom32.f90.html" xlink:title="fury_uom32.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="720,-2377 630,-2377 630,-2351 720,-2351 720,-2377"/>
<text text-anchor="middle" x="675" y="-2361.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_uom32.F90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom32.f90 -->
<g id="edge334" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~fury_uom32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335,-2386C400.216,-2433.1 435.109,-2376.42 515,-2367"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2367C549.457,-2362.94 588.372,-2362.12 619.195,-2362.36"/>
<polygon fill="#000000" stroke="#000000" points="619.28,-2365.86 629.32,-2362.47 619.361,-2358.86 619.28,-2365.86"/>
</g>
<!-- sourcefile~lower_equal_than.f90 -->
<g id="node72" class="node"><title>sourcefile~lower_equal_than.f90</title>
<a xlink:href="../sourcefile/lower_equal_than.f90.html" xlink:title="lower_equal_than.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="392,-202 278,-202 278,-176 392,-176 392,-202"/>
<text text-anchor="middle" x="335" y="-186.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lower_equal_than.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~lower_equal_than.f90 -->
<g id="edge336" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~lower_equal_than.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.447,-1319.81C196.659,-1197 230.021,-256.977 266,-211 267.092,-209.604 268.273,-208.296 269.53,-207.069"/>
<polygon fill="#000000" stroke="#000000" points="271.72,-209.799 277.465,-200.897 267.423,-204.274 271.72,-209.799"/>
</g>
<!-- sourcefile~read_lines.f90 -->
<g id="node73" class="node"><title>sourcefile~read_lines.f90</title>
<a xlink:href="../sourcefile/read_lines.f90.html" xlink:title="read_lines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="375,-158 295,-158 295,-132 375,-132 375,-158"/>
<text text-anchor="middle" x="335" y="-142.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_lines.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~read_lines.f90 -->
<g id="edge338" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~read_lines.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.417,-1319.69C196.415,-1193.71 228.636,-214.869 266,-167 270.95,-160.658 277.736,-156.112 285.131,-152.86"/>
<polygon fill="#000000" stroke="#000000" points="286.513,-156.083 294.731,-149.396 284.137,-149.498 286.513,-156.083"/>
</g>
<!-- sourcefile~read_file.f90 -->
<g id="node74" class="node"><title>sourcefile~read_file.f90</title>
<a xlink:href="../sourcefile/read_file.f90.html" xlink:title="read_file.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="371,-114 299,-114 299,-88 371,-88 371,-114"/>
<text text-anchor="middle" x="335" y="-98.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_file.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~read_file.f90 -->
<g id="edge340" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~read_file.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.376,-1319.99C196.112,-1192.7 227.208,-172.816 266,-123 271.786,-115.569 280.094,-110.603 288.952,-107.296"/>
<polygon fill="#000000" stroke="#000000" points="290.147,-110.591 298.687,-104.32 288.101,-103.896 290.147,-110.591"/>
</g>
<!-- sourcefile~snakecase.f90 -->
<g id="node75" class="node"><title>sourcefile~snakecase.f90</title>
<a xlink:href="../sourcefile/snakecase.f90.html" xlink:title="snakecase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="376,-70 294,-70 294,-44 376,-44 376,-70"/>
<text text-anchor="middle" x="335" y="-54.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">snakecase.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~snakecase.f90 -->
<g id="edge342" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~snakecase.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.35,-1319.93C195.881,-1189.81 225.816,-130.718 266,-79 270.72,-72.9249 277.126,-68.4971 284.142,-65.2761"/>
<polygon fill="#000000" stroke="#000000" points="285.848,-68.3747 293.986,-61.5906 283.393,-61.8191 285.848,-68.3747"/>
</g>
<!-- sourcefile~is_digit.f90 -->
<g id="node76" class="node"><title>sourcefile~is_digit.f90</title>
<a xlink:href="../sourcefile/is_digit.f90.html" xlink:title="is_digit.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="367,-26 303,-26 303,-1.24345e-14 367,-3.55271e-15 367,-26"/>
<text text-anchor="middle" x="335" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_digit.f90</text>
</a>
</g>
<!-- sourcefile~stringifor.f90&#45;&gt;sourcefile~is_digit.f90 -->
<g id="edge344" class="edge"><title>sourcefile~stringifor.f90&#45;&gt;sourcefile~is_digit.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.324,-1319.89C195.655,-1187.07 224.421,-88.6238 266,-35 272.656,-26.416 282.677,-21.1201 293.035,-17.8707"/>
<polygon fill="#000000" stroke="#000000" points="294.142,-21.2007 302.969,-15.3419 292.415,-14.417 294.142,-21.2007"/>
</g>
<!-- sourcefile~fury_system_abstract128.f90&#45;&gt;sourcefile~fury_system_si128.f90 -->
<g id="edge4" class="edge"><title>sourcefile~fury_system_abstract128.f90&#45;&gt;sourcefile~fury_system_si128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1031.76,-3084.91C1046.99,-3081.51 1063.53,-3077.82 1079.23,-3074.33"/>
<polygon fill="#000000" stroke="#000000" points="1080.4,-3077.65 1089.4,-3072.06 1078.87,-3070.82 1080.4,-3077.65"/>
</g>
<!-- sourcefile~fury_system_abstract128.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge2" class="edge"><title>sourcefile~fury_system_abstract128.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1014.47,-3111.12C1062.7,-3125.84 1137.13,-3146.74 1148,-3139"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1148,-3139C1178.74,-3117.11 1192.88,-3114.63 1210,-3081 1254.34,-2993.89 1268.93,-2682.24 1272.22,-2594.27"/>
<polygon fill="#000000" stroke="#000000" points="1275.71,-2594.37 1272.58,-2584.25 1268.72,-2594.11 1275.71,-2594.37"/>
</g>
<!-- sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury_system_si64.f90 -->
<g id="edge8" class="edge"><title>sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury_system_si64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M720.476,-2587.95C791.297,-2568.29 924.812,-2534.07 973,-2541"/>
</g>
<!-- sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge14" class="edge"><title>sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2677C840.363,-2687.03 874.598,-2695.98 903.827,-2702.94"/>
<polygon fill="#000000" stroke="#000000" points="903.407,-2706.44 913.942,-2705.32 905.009,-2699.63 903.407,-2706.44"/>
</g>
<!-- sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge12" class="edge"><title>sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M714.966,-2614.1C718.099,-2615.6 721.149,-2617.23 724,-2619 742.711,-2630.59 741.863,-2640.53 760,-2653 780.314,-2666.96 786.593,-2669.27 810,-2677"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2677C818.933,-2679.95 1139.86,-2702.72 1148,-2698"/>
</g>
<!-- sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury_system_abstract64.f90 -->
<g id="edge10" class="edge"><title>sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury_system_abstract64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M720.681,-2599.29C746.862,-2598.74 780.319,-2598.76 810,-2601"/>
</g>
<!-- sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury_qreal64.f90 -->
<g id="edge6" class="edge"><title>sourcefile~fury_uom64.f90&#45;&gt;sourcefile~fury_qreal64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M699.963,-2587.89C707.759,-2583.63 716.324,-2578.76 724,-2574 740.553,-2563.73 743.404,-2559.2 760,-2549 765.008,-2545.92 770.392,-2542.82 775.708,-2539.86"/>
<polygon fill="#000000" stroke="#000000" points="777.406,-2542.92 784.508,-2535.06 774.054,-2536.77 777.406,-2542.92"/>
</g>
<!-- sourcefile~fury_uom_reference32.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge22" class="edge"><title>sourcefile~fury_uom_reference32.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M520.312,-2459.23C533.692,-2491.14 571.632,-2573.34 626,-2623 702.799,-2693.14 826.51,-2712.23 903.607,-2717"/>
<polygon fill="#000000" stroke="#000000" points="903.523,-2720.5 913.701,-2717.56 903.91,-2713.51 903.523,-2720.5"/>
</g>
<!-- sourcefile~fury_uom_reference32.f90&#45;&gt;sourcefile~fury_system_abstract32.f90 -->
<g id="edge18" class="edge"><title>sourcefile~fury_uom_reference32.f90&#45;&gt;sourcefile~fury_system_abstract32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M586.595,-2447.12C646.373,-2447.62 733.807,-2447.31 810,-2443"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2443C849.464,-2440.33 892.977,-2429.5 925.112,-2419.93"/>
<polygon fill="#000000" stroke="#000000" points="926.155,-2423.27 934.703,-2417.01 924.117,-2416.57 926.155,-2423.27"/>
</g>
<!-- sourcefile~fury_uom_reference32.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge20" class="edge"><title>sourcefile~fury_uom_reference32.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2443C882.284,-2438.1 901.013,-2453.17 973,-2445"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-2445C1050.28,-2436.22 1078.07,-2410.96 1148,-2445"/>
</g>
<!-- sourcefile~fury_uom_reference32.f90&#45;&gt;sourcefile~fury_uom32.f90 -->
<g id="edge16" class="edge"><title>sourcefile~fury_uom_reference32.f90&#45;&gt;sourcefile~fury_uom32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.707,-2432.83C567.728,-2418.98 610.397,-2397.11 640.371,-2381.75"/>
<polygon fill="#000000" stroke="#000000" points="642.318,-2384.68 649.621,-2377.01 639.126,-2378.45 642.318,-2384.68"/>
</g>
<!-- sourcefile~fury_qreal32.f90&#45;&gt;sourcefile~fury_system_si32.f90 -->
<g id="edge24" class="edge"><title>sourcefile~fury_qreal32.f90&#45;&gt;sourcefile~fury_system_si32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-2325C1007.92,-2324.05 1046.49,-2328.12 1078.51,-2332.92"/>
<polygon fill="#000000" stroke="#000000" points="1078.25,-2336.42 1088.67,-2334.5 1079.32,-2329.51 1078.25,-2336.42"/>
</g>
<!-- sourcefile~fury_qreal32.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge26" class="edge"><title>sourcefile~fury_qreal32.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M844.617,-2339.05C850.562,-2342.72 856.077,-2347.32 860,-2353 928.767,-2452.64 848.095,-2511.82 896,-2623 908.644,-2652.34 933.033,-2680.02 950.989,-2697.85"/>
<polygon fill="#000000" stroke="#000000" points="948.617,-2700.42 958.237,-2704.86 953.484,-2695.39 948.617,-2700.42"/>
</g>
<!-- sourcefile~fury_qreal32.f90&#45;&gt;sourcefile~fury_system_abstract32.f90 -->
<g id="edge28" class="edge"><title>sourcefile~fury_qreal32.f90&#45;&gt;sourcefile~fury_system_abstract32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M837.283,-2339.06C864.433,-2352.05 906.275,-2372.07 936.321,-2386.45"/>
<polygon fill="#000000" stroke="#000000" points="935.097,-2389.74 945.628,-2390.9 938.119,-2383.43 935.097,-2389.74"/>
</g>
<!-- sourcefile~fury_qreal32.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge30" class="edge"><title>sourcefile~fury_qreal32.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M857.086,-2326.24C889.646,-2326.27 933.962,-2326.07 973,-2325"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-2325C1012.78,-2323.91 1115.48,-2264.07 1148,-2287"/>
</g>
<!-- sourcefile~fury_system_si32.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge32" class="edge"><title>sourcefile~fury_system_si32.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1159.01,-2359.24C1172.18,-2375.48 1194.4,-2404.15 1210,-2431 1233.02,-2470.61 1253.53,-2520.15 1264.52,-2548.42"/>
<polygon fill="#000000" stroke="#000000" points="1261.28,-2549.73 1268.13,-2557.82 1267.81,-2547.23 1261.28,-2549.73"/>
</g>
<!-- sourcefile~fury_uom_symbol32.f90&#45;&gt;sourcefile~fury_uom_reference32.f90 -->
<g id="edge36" class="edge"><title>sourcefile~fury_uom_symbol32.f90&#45;&gt;sourcefile~fury_uom_reference32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M400.748,-2433.94C411.359,-2435.06 422.456,-2436.23 433.387,-2437.39"/>
<polygon fill="#000000" stroke="#000000" points="433.047,-2440.87 443.359,-2438.44 433.782,-2433.91 433.047,-2440.87"/>
</g>
<!-- sourcefile~fury_uom_symbol32.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge40" class="edge"><title>sourcefile~fury_uom_symbol32.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M339.082,-2440.28C350.048,-2473.93 383.228,-2563.52 440,-2615 542.028,-2707.52 601.692,-2675.67 724,-2739 763.665,-2759.54 765.923,-2798.23 810,-2791"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2791C860.09,-2782.55 912.825,-2755.02 944.305,-2736.29"/>
<polygon fill="#000000" stroke="#000000" points="946.247,-2739.2 952.983,-2731.03 942.618,-2733.22 946.247,-2739.2"/>
</g>
<!-- sourcefile~fury_uom_symbol32.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge38" class="edge"><title>sourcefile~fury_uom_symbol32.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M378.865,-2413.99C387.662,-2410.27 396.497,-2405.65 404,-2400 425.025,-2384.18 418.176,-2367.7 440,-2353 483.549,-2323.67 843.932,-2235.77 896,-2229 963.872,-2220.17 983.984,-2210.93 1050,-2229 1098.82,-2242.36 1107.88,-2256.15 1148,-2287"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1148,-2287C1173.65,-2306.28 1190.8,-2298.29 1210,-2324 1236.81,-2359.92 1260.63,-2493.62 1269.41,-2547.89"/>
<polygon fill="#000000" stroke="#000000" points="1265.98,-2548.59 1271.01,-2557.92 1272.89,-2547.49 1265.98,-2548.59"/>
</g>
<!-- sourcefile~fury_uom_symbol32.f90&#45;&gt;sourcefile~fury_uom32.f90 -->
<g id="edge34" class="edge"><title>sourcefile~fury_uom_symbol32.f90&#45;&gt;sourcefile~fury_uom32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M368.687,-2413.94C412.351,-2397.33 486.294,-2370.39 515,-2367"/>
</g>
<!-- sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury_system_abstract128.f90 -->
<g id="edge50" class="edge"><title>sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury_system_abstract128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M689.381,-3038.15C712.649,-3058.19 760.916,-3094.68 810,-3101"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-3101C834.426,-3104.14 861.078,-3104.8 885.621,-3104.31"/>
<polygon fill="#000000" stroke="#000000" points="885.732,-3107.8 895.635,-3104.04 885.544,-3100.81 885.732,-3107.8"/>
</g>
<!-- sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury_system_si128.f90 -->
<g id="edge44" class="edge"><title>sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury_system_si128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-3019C882.211,-3013.19 900.645,-3015.39 973,-3019"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-3019C1016.35,-3021.16 1064.32,-3032.81 1099.05,-3042.98"/>
<polygon fill="#000000" stroke="#000000" points="1098.35,-3046.42 1108.94,-3045.94 1100.36,-3039.72 1098.35,-3046.42"/>
</g>
<!-- sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge42" class="edge"><title>sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M695.805,-3011.87C731.889,-2988.46 807.269,-2936.73 860,-2881 902.865,-2835.7 941.639,-2772.91 960.655,-2740.05"/>
<polygon fill="#000000" stroke="#000000" points="963.766,-2741.66 965.693,-2731.24 957.69,-2738.18 963.766,-2741.66"/>
</g>
<!-- sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge48" class="edge"><title>sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M723.792,-3023.67C749.473,-3022.76 781.47,-3021.29 810,-3019"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-3019C847.074,-3016.02 939.362,-2996.87 973,-2981"/>
</g>
<!-- sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury_qreal128.f90 -->
<g id="edge46" class="edge"><title>sourcefile~fury_uom128.f90&#45;&gt;sourcefile~fury_qreal128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M723.738,-3037.64C732.298,-3039.86 741.296,-3042.19 750.118,-3044.48"/>
<polygon fill="#000000" stroke="#000000" points="749.412,-3047.91 759.971,-3047.03 751.169,-3041.13 749.412,-3047.91"/>
</g>
<!-- sourcefile~fury_uom_reference64.f90&#45;&gt;sourcefile~fury_uom64.f90 -->
<g id="edge54" class="edge"><title>sourcefile~fury_uom_reference64.f90&#45;&gt;sourcefile~fury_uom64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M565.296,-2739.87C574.044,-2736.24 582.673,-2731.68 590,-2726 625.648,-2698.36 651.746,-2651.48 665.047,-2623.66"/>
<polygon fill="#000000" stroke="#000000" points="668.335,-2624.89 669.362,-2614.35 661.983,-2621.95 668.335,-2624.89"/>
</g>
<!-- sourcefile~fury_uom_reference64.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge52" class="edge"><title>sourcefile~fury_uom_reference64.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2753C737.179,-2757.35 748.625,-2801.88 810,-2791"/>
</g>
<!-- sourcefile~fury_uom_reference64.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge56" class="edge"><title>sourcefile~fury_uom_reference64.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.513,-2766.09C560.731,-2786.04 618.8,-2822.42 675,-2829"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2829C761.128,-2839.09 783.815,-2849.58 860,-2891 916.407,-2921.67 914.933,-3008.39 973,-2981"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973,-2981C1105.22,-2914.76 1020.69,-2773.25 1148,-2698"/>
</g>
<!-- sourcefile~fury_uom_reference64.f90&#45;&gt;sourcefile~fury_system_abstract64.f90 -->
<g id="edge58" class="edge"><title>sourcefile~fury_uom_reference64.f90&#45;&gt;sourcefile~fury_system_abstract64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M586.758,-2750.87C614.372,-2750.6 646.182,-2750.98 675,-2753"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2753C790.559,-2761.09 906.949,-2664.3 952.724,-2621.15"/>
<polygon fill="#000000" stroke="#000000" points="955.146,-2623.68 959.945,-2614.23 950.303,-2618.62 955.146,-2623.68"/>
</g>
<!-- sourcefile~fury_system_si64.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge60" class="edge"><title>sourcefile~fury_system_si64.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1207.21,-2571C1216.91,-2571 1226.72,-2571 1235.7,-2571"/>
<polygon fill="#000000" stroke="#000000" points="1235.8,-2574.5 1245.8,-2571 1235.8,-2567.5 1235.8,-2574.5"/>
</g>
<!-- sourcefile~fury_uom_symbol64.f90&#45;&gt;sourcefile~fury_uom64.f90 -->
<g id="edge64" class="edge"><title>sourcefile~fury_uom_symbol64.f90&#45;&gt;sourcefile~fury_uom64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M368.531,-2719.98C430.487,-2695.93 562.828,-2644.55 631.555,-2617.87"/>
<polygon fill="#000000" stroke="#000000" points="633.162,-2621 641.218,-2614.12 630.629,-2614.47 633.162,-2621"/>
</g>
<!-- sourcefile~fury_uom_symbol64.f90&#45;&gt;sourcefile~fury_uom_reference64.f90 -->
<g id="edge62" class="edge"><title>sourcefile~fury_uom_symbol64.f90&#45;&gt;sourcefile~fury_uom_reference64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M400.748,-2740.31C411.359,-2741.48 422.456,-2742.72 433.387,-2743.93"/>
<polygon fill="#000000" stroke="#000000" points="433.034,-2747.41 443.359,-2745.04 433.807,-2740.46 433.034,-2747.41"/>
</g>
<!-- sourcefile~fury_uom_symbol64.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge68" class="edge"><title>sourcefile~fury_uom_symbol64.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M351.062,-2746.01C381.042,-2769.21 448.519,-2816.5 515,-2829"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2829C586.83,-2842.51 602.978,-2803.45 675,-2791"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675,-2791C734.124,-2780.78 750.921,-2801.47 810,-2791"/>
</g>
<!-- sourcefile~fury_uom_symbol64.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge66" class="edge"><title>sourcefile~fury_uom_symbol64.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2829C584.886,-2842.14 606.228,-2810.91 675,-2829"/>
</g>
<!-- sourcefile~fury_system_si128.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge70" class="edge"><title>sourcefile~fury_system_si128.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1151.34,-3045.95C1168.32,-2979.66 1245.04,-2680.14 1267.07,-2594.15"/>
<polygon fill="#000000" stroke="#000000" points="1270.5,-2594.88 1269.59,-2584.32 1263.72,-2593.14 1270.5,-2594.88"/>
</g>
<!-- sourcefile~fury_uom_reference128.f90&#45;&gt;sourcefile~fury_system_abstract128.f90 -->
<g id="edge78" class="edge"><title>sourcefile~fury_uom_reference128.f90&#45;&gt;sourcefile~fury_system_abstract128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M534.74,-2997.07C556.397,-3010.95 592.541,-3032.82 626,-3047 704.471,-3080.26 725.47,-3090.12 810,-3101"/>
</g>
<!-- sourcefile~fury_uom_reference128.f90&#45;&gt;sourcefile~fury_uom128.f90 -->
<g id="edge74" class="edge"><title>sourcefile~fury_uom_reference128.f90&#45;&gt;sourcefile~fury_uom128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M566.065,-2997.09C582.045,-3001.18 599.806,-3005.73 616.27,-3009.95"/>
<polygon fill="#000000" stroke="#000000" points="615.771,-3013.44 626.327,-3012.53 617.509,-3006.65 615.771,-3013.44"/>
</g>
<!-- sourcefile~fury_uom_reference128.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge72" class="edge"><title>sourcefile~fury_uom_reference128.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M555.199,-2970.92C566.603,-2966.84 578.926,-2962.07 590,-2957 715.222,-2899.7 745.147,-2880.98 860,-2805 892.226,-2783.68 927.156,-2756.02 949.516,-2737.68"/>
<polygon fill="#000000" stroke="#000000" points="951.957,-2740.2 957.439,-2731.13 947.5,-2734.8 951.957,-2740.2"/>
</g>
<!-- sourcefile~fury_uom_reference128.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge76" class="edge"><title>sourcefile~fury_uom_reference128.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M589.618,-2991.36C701.862,-3001.12 907.95,-3013.59 973,-2981"/>
</g>
<!-- sourcefile~fury_mixed_kinds.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge80" class="edge"><title>sourcefile~fury_mixed_kinds.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1032.23,-2722.73C1068,-2722.91 1113.22,-2718.18 1148,-2698"/>
</g>
<!-- sourcefile~fury_system_abstract32.f90&#45;&gt;sourcefile~fury_system_si32.f90 -->
<g id="edge84" class="edge"><title>sourcefile~fury_system_abstract32.f90&#45;&gt;sourcefile~fury_system_si32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1012.27,-2390.98C1037.85,-2382.51 1071.43,-2371.38 1098.78,-2362.31"/>
<polygon fill="#000000" stroke="#000000" points="1100.16,-2365.54 1108.56,-2359.07 1097.96,-2358.9 1100.16,-2365.54"/>
</g>
<!-- sourcefile~fury_system_abstract32.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge82" class="edge"><title>sourcefile~fury_system_abstract32.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1047.42,-2413.89C1079.49,-2420.03 1116.72,-2429.77 1148,-2445"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1148,-2445C1197.21,-2468.95 1238.31,-2520.33 1258.86,-2549.54"/>
<polygon fill="#000000" stroke="#000000" points="1256.02,-2551.58 1264.57,-2557.84 1261.79,-2547.61 1256.02,-2551.58"/>
</g>
<!-- sourcefile~fury_test_qreal_assign.f90 -->
<g id="node119" class="node"><title>sourcefile~fury_test_qreal_assign.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_assign.f90.html" xlink:title="fury_test_qreal_assign.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1511,-3376 1373,-3376 1373,-3350 1511,-3350 1511,-3376"/>
<text text-anchor="middle" x="1442" y="-3360.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_assign.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_assign.f90 -->
<g id="edge86" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_assign.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.14,-2584.19C1274.33,-2681.18 1283.75,-3281.9 1336,-3341 1343.12,-3349.06 1352.36,-3354.61 1362.4,-3358.38"/>
<polygon fill="#000000" stroke="#000000" points="1361.65,-3361.81 1372.24,-3361.47 1363.75,-3355.13 1361.65,-3361.81"/>
</g>
<!-- sourcefile~fury_test_qreal_conversions_complex.f90 -->
<g id="node120" class="node"><title>sourcefile~fury_test_qreal_conversions_complex.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_conversions_complex.f90.html" xlink:title="fury_test_qreal_conversions_complex.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1547,-3332 1337,-3332 1337,-3306 1547,-3306 1547,-3332"/>
<text text-anchor="middle" x="1442" y="-3316.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_conversions_complex.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_conversions_complex.f90 -->
<g id="edge88" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_conversions_complex.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.21,-2584.03C1274.84,-2677.31 1286.69,-3241.49 1336,-3297 1336.75,-3297.84 1337.52,-3298.66 1338.31,-3299.45"/>
<polygon fill="#000000" stroke="#000000" points="1336.08,-3302.14 1346,-3305.85 1340.56,-3296.76 1336.08,-3302.14"/>
</g>
<!-- sourcefile~fury_test_qreal_conversions_si.f90 -->
<g id="node121" class="node"><title>sourcefile~fury_test_qreal_conversions_si.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_conversions_si.f90.html" xlink:title="fury_test_qreal_conversions_si.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1531,-3288 1353,-3288 1353,-3262 1531,-3262 1531,-3288"/>
<text text-anchor="middle" x="1442" y="-3272.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_conversions_si.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_conversions_si.f90 -->
<g id="edge90" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_conversions_si.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.29,-2584.1C1275.4,-2674.27 1289.66,-3201.13 1336,-3253 1338.45,-3255.75 1341.15,-3258.2 1344.04,-3260.39"/>
<polygon fill="#000000" stroke="#000000" points="1342.35,-3263.47 1352.66,-3265.9 1346.12,-3257.57 1342.35,-3263.47"/>
</g>
<!-- sourcefile~fury_test_qreal_conversions_simple.f90 -->
<g id="node122" class="node"><title>sourcefile~fury_test_qreal_conversions_simple.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_conversions_simple.f90.html" xlink:title="fury_test_qreal_conversions_simple.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1543,-3244 1341,-3244 1341,-3218 1543,-3218 1543,-3244"/>
<text text-anchor="middle" x="1442" y="-3228.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_conversions_simple.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_conversions_simple.f90 -->
<g id="edge92" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_conversions_simple.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.38,-2584.08C1275.99,-2670.78 1292.61,-3160.73 1336,-3209 1336.75,-3209.84 1337.53,-3210.65 1338.33,-3211.43"/>
<polygon fill="#000000" stroke="#000000" points="1336.11,-3214.14 1346.05,-3217.81 1340.57,-3208.74 1336.11,-3214.14"/>
</g>
<!-- sourcefile~fury_test_qreal_div.f90 -->
<g id="node123" class="node"><title>sourcefile~fury_test_qreal_div.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_div.f90.html" xlink:title="fury_test_qreal_div.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1502,-3200 1382,-3200 1382,-3174 1502,-3174 1502,-3200"/>
<text text-anchor="middle" x="1442" y="-3184.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_div.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_div.f90 -->
<g id="edge94" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_div.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.48,-2584.24C1276.65,-2667.82 1295.58,-3120.37 1336,-3165 1345.29,-3175.26 1358,-3181.43 1371.4,-3185.03"/>
<polygon fill="#000000" stroke="#000000" points="1370.72,-3188.46 1381.24,-3187.21 1372.24,-3181.63 1370.72,-3188.46"/>
</g>
<!-- sourcefile~fury_test_uom_assign.f90 -->
<g id="node124" class="node"><title>sourcefile~fury_test_uom_assign.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_assign.f90.html" xlink:title="fury_test_uom_assign.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1510,-3156 1374,-3156 1374,-3130 1510,-3130 1510,-3156"/>
<text text-anchor="middle" x="1442" y="-3140.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_assign.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_assign.f90 -->
<g id="edge96" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_assign.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.59,-2584.02C1277.3,-2663.37 1298.49,-3079.93 1336,-3121 1343.57,-3129.29 1353.38,-3134.91 1363.96,-3138.65"/>
<polygon fill="#000000" stroke="#000000" points="1363.28,-3142.1 1373.86,-3141.58 1365.27,-3135.39 1363.28,-3142.1"/>
</g>
<!-- sourcefile~fury_test_qreal_div_mixed.f90 -->
<g id="node125" class="node"><title>sourcefile~fury_test_qreal_div_mixed.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_div_mixed.f90.html" xlink:title="fury_test_qreal_div_mixed.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1520,-3112 1364,-3112 1364,-3086 1520,-3086 1520,-3112"/>
<text text-anchor="middle" x="1442" y="-3096.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_div_mixed.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_div_mixed.f90 -->
<g id="edge98" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_div_mixed.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.75,-2584.44C1278.14,-2660.96 1301.49,-3039.58 1336,-3077 1341.21,-3082.65 1347.47,-3087.06 1354.29,-3090.47"/>
<polygon fill="#000000" stroke="#000000" points="1353.34,-3093.87 1363.92,-3094.54 1356.07,-3087.43 1353.34,-3093.87"/>
</g>
<!-- sourcefile~fury_test_qreal_eq.f90 -->
<g id="node126" class="node"><title>sourcefile~fury_test_qreal_eq.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_eq.f90.html" xlink:title="fury_test_qreal_eq.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1502,-3068 1382,-3068 1382,-3042 1502,-3042 1502,-3068"/>
<text text-anchor="middle" x="1442" y="-3052.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_eq.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_eq.f90 -->
<g id="edge100" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_eq.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.9,-2584.2C1278.92,-2656.17 1304.38,-2999.12 1336,-3033 1345.49,-3043.17 1358.36,-3049.3 1371.86,-3052.88"/>
<polygon fill="#000000" stroke="#000000" points="1371.24,-3056.32 1381.75,-3055.05 1372.74,-3049.49 1371.24,-3056.32"/>
</g>
<!-- sourcefile~fury_test_qreal_eq_mixed.f90 -->
<g id="node127" class="node"><title>sourcefile~fury_test_qreal_eq_mixed.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_eq_mixed.f90.html" xlink:title="fury_test_qreal_eq_mixed.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1519,-3024 1365,-3024 1365,-2998 1519,-2998 1519,-3024"/>
<text text-anchor="middle" x="1442" y="-3008.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_eq_mixed.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_eq_mixed.f90 -->
<g id="edge102" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_eq_mixed.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1274.1,-2584.26C1279.86,-2652.14 1307.31,-2958.68 1336,-2989 1341.54,-2994.85 1348.2,-2999.37 1355.45,-3002.82"/>
<polygon fill="#000000" stroke="#000000" points="1354.32,-3006.14 1364.9,-3006.65 1356.95,-2999.65 1354.32,-3006.14"/>
</g>
<!-- sourcefile~fury_test_qreal_mul.f90 -->
<g id="node128" class="node"><title>sourcefile~fury_test_qreal_mul.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_mul.f90.html" xlink:title="fury_test_qreal_mul.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1504,-2980 1380,-2980 1380,-2954 1504,-2954 1504,-2980"/>
<text text-anchor="middle" x="1442" y="-2964.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_mul.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_mul.f90 -->
<g id="edge104" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_mul.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.3,-2584.18C1274.93,-2644.27 1284.73,-2891.76 1336,-2945 1344.95,-2954.29 1356.72,-2960.19 1369.16,-2963.83"/>
<polygon fill="#000000" stroke="#000000" points="1368.69,-2967.32 1379.23,-2966.3 1370.35,-2960.52 1368.69,-2967.32"/>
</g>
<!-- sourcefile~fury_test_uom_sub.f90 -->
<g id="node129" class="node"><title>sourcefile~fury_test_uom_sub.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_sub.f90.html" xlink:title="fury_test_uom_sub.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1503,-2936 1381,-2936 1381,-2910 1503,-2910 1503,-2936"/>
<text text-anchor="middle" x="1442" y="-2920.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_sub.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_sub.f90 -->
<g id="edge106" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_sub.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.62,-2584.1C1276.5,-2639.61 1290.49,-2854.75 1336,-2901 1345.4,-2910.55 1357.79,-2916.49 1370.78,-2920.09"/>
<polygon fill="#000000" stroke="#000000" points="1370.25,-2923.56 1380.78,-2922.4 1371.83,-2916.74 1370.25,-2923.56"/>
</g>
<!-- sourcefile~fury_test_qreal_mul_mixed.f90 -->
<g id="node130" class="node"><title>sourcefile~fury_test_qreal_mul_mixed.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_mul_mixed.f90.html" xlink:title="fury_test_qreal_mul_mixed.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1522,-2892 1362,-2892 1362,-2866 1522,-2866 1522,-2892"/>
<text text-anchor="middle" x="1442" y="-2876.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_mul_mixed.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_mul_mixed.f90 -->
<g id="edge108" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_mul_mixed.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1274.03,-2584.04C1278.28,-2634.73 1296.21,-2817.69 1336,-2857 1340.9,-2861.84 1346.56,-2865.74 1352.67,-2868.88"/>
<polygon fill="#000000" stroke="#000000" points="1351.35,-2872.12 1361.91,-2872.95 1354.17,-2865.71 1351.35,-2872.12"/>
</g>
<!-- sourcefile~fury_test_qreal_not_eq.f90 -->
<g id="node131" class="node"><title>sourcefile~fury_test_qreal_not_eq.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_not_eq.f90.html" xlink:title="fury_test_qreal_not_eq.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1512,-2848 1372,-2848 1372,-2822 1512,-2822 1512,-2848"/>
<text text-anchor="middle" x="1442" y="-2832.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_not_eq.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_not_eq.f90 -->
<g id="edge110" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_not_eq.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1274.6,-2584.19C1280.43,-2629.92 1301.95,-2780.61 1336,-2813 1343.3,-2819.95 1352.2,-2824.95 1361.7,-2828.51"/>
<polygon fill="#000000" stroke="#000000" points="1360.77,-2831.89 1371.36,-2831.62 1362.91,-2825.23 1360.77,-2831.89"/>
</g>
<!-- sourcefile~fury_test_uom_assign_failure.f90 -->
<g id="node132" class="node"><title>sourcefile~fury_test_uom_assign_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_assign_failure.f90.html" xlink:title="fury_test_uom_assign_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1527,-2804 1357,-2804 1357,-2778 1527,-2778 1527,-2804"/>
<text text-anchor="middle" x="1442" y="-2788.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_assign_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_assign_failure.f90 -->
<g id="edge112" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_assign_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1275.43,-2584.27C1283.03,-2624.41 1307.6,-2743.4 1336,-2769 1339.47,-2772.13 1343.27,-2774.86 1347.29,-2777.23"/>
<polygon fill="#000000" stroke="#000000" points="1345.93,-2780.47 1356.43,-2781.89 1349.11,-2774.23 1345.93,-2780.47"/>
</g>
<!-- sourcefile~fury_test_qreal_not_eq_mixed.f90 -->
<g id="node133" class="node"><title>sourcefile~fury_test_qreal_not_eq_mixed.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_not_eq_mixed.f90.html" xlink:title="fury_test_qreal_not_eq_mixed.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1529,-2760 1355,-2760 1355,-2734 1529,-2734 1529,-2760"/>
<text text-anchor="middle" x="1442" y="-2744.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_not_eq_mixed.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_not_eq_mixed.f90 -->
<g id="edge114" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_not_eq_mixed.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1274.29,-2584.13C1277.98,-2614.11 1291.35,-2687.88 1336,-2725 1338.92,-2727.43 1342.03,-2729.61 1345.3,-2731.56"/>
<polygon fill="#000000" stroke="#000000" points="1343.78,-2734.72 1354.26,-2736.24 1347.02,-2728.51 1343.78,-2734.72"/>
</g>
<!-- sourcefile~fury_test_qreal_pow.f90 -->
<g id="node134" class="node"><title>sourcefile~fury_test_qreal_pow.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_pow.f90.html" xlink:title="fury_test_qreal_pow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1505,-2716 1379,-2716 1379,-2690 1505,-2690 1505,-2716"/>
<text text-anchor="middle" x="1442" y="-2700.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_pow.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_pow.f90 -->
<g id="edge116" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_pow.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1276.65,-2584.27C1283.85,-2607.75 1302.16,-2656.44 1336,-2681 1345.63,-2687.98 1356.97,-2692.86 1368.6,-2696.24"/>
<polygon fill="#000000" stroke="#000000" points="1367.84,-2699.66 1378.4,-2698.75 1369.57,-2692.88 1367.84,-2699.66"/>
</g>
<!-- sourcefile~fury_test_qreal_sub.f90 -->
<g id="node135" class="node"><title>sourcefile~fury_test_qreal_sub.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_sub.f90.html" xlink:title="fury_test_qreal_sub.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1504,-2672 1380,-2672 1380,-2646 1504,-2646 1504,-2672"/>
<text text-anchor="middle" x="1442" y="-2656.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_sub.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_sub.f90 -->
<g id="edge118" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_sub.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1281.77,-2584.19C1292.63,-2599.41 1312.59,-2624.01 1336,-2637 1346.27,-2642.7 1357.85,-2646.93 1369.47,-2650.06"/>
<polygon fill="#000000" stroke="#000000" points="1368.68,-2653.47 1379.23,-2652.45 1370.34,-2646.67 1368.68,-2653.47"/>
</g>
<!-- sourcefile~fury_test_qreal_sub_failure.f90 -->
<g id="node136" class="node"><title>sourcefile~fury_test_qreal_sub_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_sub_failure.f90.html" xlink:title="fury_test_qreal_sub_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1522,-2628 1362,-2628 1362,-2602 1522,-2602 1522,-2628"/>
<text text-anchor="middle" x="1442" y="-2612.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_sub_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_sub_failure.f90 -->
<g id="edge120" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_sub_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1300.04,-2581.32C1311.09,-2585.3 1324.05,-2589.69 1336,-2593 1344.65,-2595.4 1353.75,-2597.66 1362.85,-2599.77"/>
<polygon fill="#000000" stroke="#000000" points="1362.17,-2603.2 1372.69,-2601.98 1363.7,-2596.37 1362.17,-2603.2"/>
</g>
<!-- sourcefile~fury_test_uom_sub_failure.f90 -->
<g id="node137" class="node"><title>sourcefile~fury_test_uom_sub_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_sub_failure.f90.html" xlink:title="fury_test_uom_sub_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1520,-2584 1364,-2584 1364,-2558 1520,-2558 1520,-2584"/>
<text text-anchor="middle" x="1442" y="-2568.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_sub_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_sub_failure.f90 -->
<g id="edge122" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_sub_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1300.15,-2571C1314.85,-2571 1333.93,-2571 1353.31,-2571"/>
<polygon fill="#000000" stroke="#000000" points="1353.45,-2574.5 1363.45,-2571 1353.45,-2567.5 1353.45,-2574.5"/>
</g>
<!-- sourcefile~fury_test_qreal_sub_mixed.f90 -->
<g id="node138" class="node"><title>sourcefile~fury_test_qreal_sub_mixed.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_sub_mixed.f90.html" xlink:title="fury_test_qreal_sub_mixed.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1522,-2540 1362,-2540 1362,-2514 1522,-2514 1522,-2540"/>
<text text-anchor="middle" x="1442" y="-2524.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_sub_mixed.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_sub_mixed.f90 -->
<g id="edge124" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_sub_mixed.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1300.04,-2560.68C1311.09,-2556.7 1324.05,-2552.31 1336,-2549 1344.65,-2546.6 1353.75,-2544.34 1362.85,-2542.23"/>
<polygon fill="#000000" stroke="#000000" points="1363.7,-2545.63 1372.69,-2540.02 1362.17,-2538.8 1363.7,-2545.63"/>
</g>
<!-- sourcefile~fury_test_qreal_sub_mixed_failure.f90 -->
<g id="node139" class="node"><title>sourcefile~fury_test_qreal_sub_mixed_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_sub_mixed_failure.f90.html" xlink:title="fury_test_qreal_sub_mixed_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1539,-2496 1345,-2496 1345,-2470 1539,-2470 1539,-2496"/>
<text text-anchor="middle" x="1442" y="-2480.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_sub_mixed_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_sub_mixed_failure.f90 -->
<g id="edge126" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_sub_mixed_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1281.77,-2557.81C1292.63,-2542.59 1312.59,-2517.99 1336,-2505 1339.46,-2503.08 1343.07,-2501.33 1346.78,-2499.73"/>
<polygon fill="#000000" stroke="#000000" points="1348.13,-2502.95 1356.17,-2496.05 1345.58,-2496.43 1348.13,-2502.95"/>
</g>
<!-- sourcefile~fury_test_uom_div.f90 -->
<g id="node140" class="node"><title>sourcefile~fury_test_uom_div.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_div.f90.html" xlink:title="fury_test_uom_div.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1501,-2452 1383,-2452 1383,-2426 1501,-2426 1501,-2452"/>
<text text-anchor="middle" x="1442" y="-2436.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_div.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_div.f90 -->
<g id="edge128" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_div.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1276.65,-2557.73C1283.85,-2534.25 1302.16,-2485.56 1336,-2461 1346.79,-2453.17 1359.74,-2447.99 1372.82,-2444.6"/>
<polygon fill="#000000" stroke="#000000" points="1373.83,-2447.95 1382.81,-2442.33 1372.29,-2441.13 1373.83,-2447.95"/>
</g>
<!-- sourcefile~fury_test_system_si.f90 -->
<g id="node141" class="node"><title>sourcefile~fury_test_system_si.f90</title>
<a xlink:href="../sourcefile/fury_test_system_si.f90.html" xlink:title="fury_test_system_si.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1504,-2408 1380,-2408 1380,-2382 1504,-2382 1504,-2408"/>
<text text-anchor="middle" x="1442" y="-2392.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_system_si.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_system_si.f90 -->
<g id="edge130" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_system_si.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1274.29,-2557.87C1277.98,-2527.89 1291.35,-2454.12 1336,-2417 1345.64,-2408.99 1357.44,-2403.66 1369.64,-2400.16"/>
<polygon fill="#000000" stroke="#000000" points="1370.6,-2403.52 1379.47,-2397.72 1368.92,-2396.73 1370.6,-2403.52"/>
</g>
<!-- sourcefile~fury_test_uom_add.f90 -->
<g id="node142" class="node"><title>sourcefile~fury_test_uom_add.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_add.f90.html" xlink:title="fury_test_uom_add.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1503,-2364 1381,-2364 1381,-2338 1503,-2338 1503,-2364"/>
<text text-anchor="middle" x="1442" y="-2348.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_add.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_add.f90 -->
<g id="edge132" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_add.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1275.43,-2557.73C1283.03,-2517.59 1307.6,-2398.6 1336,-2373 1345.68,-2364.27 1357.89,-2358.66 1370.55,-2355.12"/>
<polygon fill="#000000" stroke="#000000" points="1371.37,-2358.52 1380.28,-2352.79 1369.74,-2351.71 1371.37,-2358.52"/>
</g>
<!-- sourcefile~fury_test_uom_add_failure.f90 -->
<g id="node143" class="node"><title>sourcefile~fury_test_uom_add_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_add_failure.f90.html" xlink:title="fury_test_uom_add_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1521,-2320 1363,-2320 1363,-2294 1521,-2294 1521,-2320"/>
<text text-anchor="middle" x="1442" y="-2304.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_add_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_add_failure.f90 -->
<g id="edge134" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_add_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1274.6,-2557.81C1280.43,-2512.08 1301.95,-2361.39 1336,-2329 1341.12,-2324.13 1347.03,-2320.21 1353.38,-2317.07"/>
<polygon fill="#000000" stroke="#000000" points="1355.12,-2320.14 1362.96,-2313.02 1352.39,-2313.69 1355.12,-2320.14"/>
</g>
<!-- sourcefile~fury_test_uom_aliases.f90 -->
<g id="node144" class="node"><title>sourcefile~fury_test_uom_aliases.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_aliases.f90.html" xlink:title="fury_test_uom_aliases.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1511,-2276 1373,-2276 1373,-2250 1511,-2250 1511,-2276"/>
<text text-anchor="middle" x="1442" y="-2260.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_aliases.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_aliases.f90 -->
<g id="edge136" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_aliases.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1274.03,-2557.96C1278.28,-2507.27 1296.21,-2324.31 1336,-2285 1343.55,-2277.54 1352.92,-2272.3 1362.95,-2268.67"/>
<polygon fill="#000000" stroke="#000000" points="1364.2,-2271.95 1372.73,-2265.66 1362.14,-2265.26 1364.2,-2271.95"/>
</g>
<!-- sourcefile~fury_test_bolt32.f90 -->
<g id="node145" class="node"><title>sourcefile~fury_test_bolt32.f90</title>
<a xlink:href="../sourcefile/fury_test_bolt32.f90.html" xlink:title="fury_test_bolt32.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1495,-2232 1389,-2232 1389,-2206 1495,-2206 1495,-2232"/>
<text text-anchor="middle" x="1442" y="-2216.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_bolt32.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_bolt32.f90 -->
<g id="edge138" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_bolt32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.62,-2557.9C1276.5,-2502.39 1290.49,-2287.25 1336,-2241 1347.19,-2229.63 1362.62,-2223.38 1378.24,-2220.1"/>
<polygon fill="#000000" stroke="#000000" points="1379.22,-2223.49 1388.49,-2218.36 1378.05,-2216.59 1379.22,-2223.49"/>
</g>
<!-- sourcefile~fury_test_bolt64.f90 -->
<g id="node146" class="node"><title>sourcefile~fury_test_bolt64.f90</title>
<a xlink:href="../sourcefile/fury_test_bolt64.f90.html" xlink:title="fury_test_bolt64.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1495,-2188 1389,-2188 1389,-2162 1495,-2162 1495,-2188"/>
<text text-anchor="middle" x="1442" y="-2172.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_bolt64.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_bolt64.f90 -->
<g id="edge140" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_bolt64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.3,-2557.82C1274.93,-2497.73 1284.73,-2250.24 1336,-2197 1347.07,-2185.51 1362.45,-2179.22 1378.08,-2175.94"/>
<polygon fill="#000000" stroke="#000000" points="1379.06,-2179.33 1388.33,-2174.2 1377.89,-2172.42 1379.06,-2179.33"/>
</g>
<!-- sourcefile~fury_test_qreal_add.f90 -->
<g id="node147" class="node"><title>sourcefile~fury_test_qreal_add.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_add.f90.html" xlink:title="fury_test_qreal_add.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1505,-2144 1379,-2144 1379,-2118 1505,-2118 1505,-2144"/>
<text text-anchor="middle" x="1442" y="-2128.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_add.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add.f90 -->
<g id="edge142" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1274.1,-2557.74C1279.86,-2489.86 1307.31,-2183.32 1336,-2153 1344.82,-2143.68 1356.47,-2137.77 1368.82,-2134.11"/>
<polygon fill="#000000" stroke="#000000" points="1369.96,-2137.43 1378.82,-2131.63 1368.28,-2130.64 1369.96,-2137.43"/>
</g>
<!-- sourcefile~fury_test_uom_mul.f90 -->
<g id="node148" class="node"><title>sourcefile~fury_test_uom_mul.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_mul.f90.html" xlink:title="fury_test_uom_mul.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1503,-2100 1381,-2100 1381,-2074 1503,-2074 1503,-2100"/>
<text text-anchor="middle" x="1442" y="-2084.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_mul.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_mul.f90 -->
<g id="edge144" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_mul.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.9,-2557.8C1278.92,-2485.83 1304.38,-2142.88 1336,-2109 1345.25,-2099.09 1357.7,-2093.02 1370.81,-2089.41"/>
<polygon fill="#000000" stroke="#000000" points="1371.95,-2092.74 1380.93,-2087.1 1370.4,-2085.91 1371.95,-2092.74"/>
</g>
<!-- sourcefile~fury_test_qreal_add_aliases_failure.f90 -->
<g id="node149" class="node"><title>sourcefile~fury_test_qreal_add_aliases_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_add_aliases_failure.f90.html" xlink:title="fury_test_qreal_add_aliases_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1542,-2056 1342,-2056 1342,-2030 1542,-2030 1542,-2056"/>
<text text-anchor="middle" x="1442" y="-2040.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_add_aliases_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add_aliases_failure.f90 -->
<g id="edge146" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add_aliases_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.75,-2557.56C1278.14,-2481.04 1301.49,-2102.42 1336,-2065 1336.76,-2064.17 1337.55,-2063.37 1338.36,-2062.59"/>
<polygon fill="#000000" stroke="#000000" points="1340.58,-2065.3 1346.16,-2056.29 1336.18,-2059.85 1340.58,-2065.3"/>
</g>
<!-- sourcefile~fury_test_uom_pow.f90 -->
<g id="node150" class="node"><title>sourcefile~fury_test_uom_pow.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_pow.f90.html" xlink:title="fury_test_uom_pow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1504,-2012 1380,-2012 1380,-1986 1504,-1986 1504,-2012"/>
<text text-anchor="middle" x="1442" y="-1996.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_pow.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_pow.f90 -->
<g id="edge148" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_pow.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.59,-2557.98C1277.3,-2478.63 1298.49,-2062.07 1336,-2021 1344.99,-2011.16 1357.13,-2005.08 1369.99,-2001.44"/>
<polygon fill="#000000" stroke="#000000" points="1370.99,-2004.8 1379.93,-1999.1 1369.39,-1997.98 1370.99,-2004.8"/>
</g>
<!-- sourcefile~fury_test_qreal_add_failure.f90 -->
<g id="node151" class="node"><title>sourcefile~fury_test_qreal_add_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_add_failure.f90.html" xlink:title="fury_test_qreal_add_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1522,-1968 1362,-1968 1362,-1942 1522,-1942 1522,-1968"/>
<text text-anchor="middle" x="1442" y="-1952.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_add_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add_failure.f90 -->
<g id="edge150" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.48,-2557.76C1276.65,-2474.18 1295.58,-2021.63 1336,-1977 1340.66,-1971.85 1346.19,-1967.73 1352.23,-1964.45"/>
<polygon fill="#000000" stroke="#000000" points="1353.79,-1967.58 1361.41,-1960.22 1350.86,-1961.23 1353.79,-1967.58"/>
</g>
<!-- sourcefile~fury_test_qreal_add_mixed.f90 -->
<g id="node152" class="node"><title>sourcefile~fury_test_qreal_add_mixed.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_add_mixed.f90.html" xlink:title="fury_test_qreal_add_mixed.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1522,-1924 1362,-1924 1362,-1898 1522,-1898 1522,-1924"/>
<text text-anchor="middle" x="1442" y="-1908.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_add_mixed.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add_mixed.f90 -->
<g id="edge152" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add_mixed.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.38,-2557.92C1275.99,-2471.22 1292.61,-1981.27 1336,-1933 1340.73,-1927.74 1346.36,-1923.55 1352.52,-1920.23"/>
<polygon fill="#000000" stroke="#000000" points="1354.23,-1923.3 1361.88,-1915.97 1351.33,-1916.93 1354.23,-1923.3"/>
</g>
<!-- sourcefile~fury_test_uom_parse_failure.f90 -->
<g id="node153" class="node"><title>sourcefile~fury_test_uom_parse_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_uom_parse_failure.f90.html" xlink:title="fury_test_uom_parse_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1525,-1880 1359,-1880 1359,-1854 1525,-1854 1525,-1880"/>
<text text-anchor="middle" x="1442" y="-1864.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_uom_parse_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_parse_failure.f90 -->
<g id="edge154" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_uom_parse_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.29,-2557.9C1275.4,-2467.73 1289.66,-1940.87 1336,-1889 1339.87,-1884.66 1344.36,-1881.05 1349.25,-1878.06"/>
<polygon fill="#000000" stroke="#000000" points="1351.18,-1881.01 1358.46,-1873.31 1347.96,-1874.79 1351.18,-1881.01"/>
</g>
<!-- sourcefile~fury_test_qreal_add_mixed_failure.f90 -->
<g id="node154" class="node"><title>sourcefile~fury_test_qreal_add_mixed_failure.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_add_mixed_failure.f90.html" xlink:title="fury_test_qreal_add_mixed_failure.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1540,-1836 1344,-1836 1344,-1810 1540,-1810 1540,-1836"/>
<text text-anchor="middle" x="1442" y="-1820.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_add_mixed_failure.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add_mixed_failure.f90 -->
<g id="edge156" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_add_mixed_failure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.21,-2557.97C1274.84,-2464.69 1286.69,-1900.51 1336,-1845 1336.75,-1844.16 1337.52,-1843.34 1338.31,-1842.55"/>
<polygon fill="#000000" stroke="#000000" points="1340.56,-1845.24 1346,-1836.15 1336.08,-1839.86 1340.56,-1845.24"/>
</g>
<!-- sourcefile~fury_test_qreal_aliases.f90 -->
<g id="node155" class="node"><title>sourcefile~fury_test_qreal_aliases.f90</title>
<a xlink:href="../sourcefile/fury_test_qreal_aliases.f90.html" xlink:title="fury_test_qreal_aliases.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1512,-1792 1372,-1792 1372,-1766 1512,-1766 1512,-1792"/>
<text text-anchor="middle" x="1442" y="-1776.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fury_test_qreal_aliases.f90</text>
</a>
</g>
<!-- sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_aliases.f90 -->
<g id="edge158" class="edge"><title>sourcefile~fury.f90&#45;&gt;sourcefile~fury_test_qreal_aliases.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1273.14,-2557.81C1274.33,-2460.82 1283.75,-1860.1 1336,-1801 1342.98,-1793.1 1351.99,-1787.61 1361.8,-1783.85"/>
<polygon fill="#000000" stroke="#000000" points="1362.97,-1787.15 1371.42,-1780.75 1360.83,-1780.48 1362.97,-1787.15"/>
</g>
<!-- sourcefile~fury_system_abstract64.f90&#45;&gt;sourcefile~fury_system_si64.f90 -->
<g id="edge162" class="edge"><title>sourcefile~fury_system_abstract64.f90&#45;&gt;sourcefile~fury_system_si64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1047.22,-2588.28C1057.63,-2586.49 1068.29,-2584.66 1078.61,-2582.9"/>
<polygon fill="#000000" stroke="#000000" points="1079.52,-2586.29 1088.79,-2581.15 1078.34,-2579.39 1079.52,-2586.29"/>
</g>
<!-- sourcefile~fury_system_abstract64.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge160" class="edge"><title>sourcefile~fury_system_abstract64.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M988.476,-2614.03C1025.33,-2644.33 1117.51,-2715.7 1148,-2698"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1148,-2698C1195.08,-2670.68 1236.49,-2620.92 1257.79,-2592.47"/>
<polygon fill="#000000" stroke="#000000" points="1260.88,-2594.17 1263.98,-2584.04 1255.24,-2590.03 1260.88,-2594.17"/>
</g>
<!-- sourcefile~fury_uom_symbol128.f90&#45;&gt;sourcefile~fury_uom128.f90 -->
<g id="edge170" class="edge"><title>sourcefile~fury_uom_symbol128.f90&#45;&gt;sourcefile~fury_uom128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M361.471,-2977.17C382.28,-2986.88 412.285,-2999.49 440,-3006 498.842,-3019.81 567.991,-3024.01 615.978,-3025.09"/>
<polygon fill="#000000" stroke="#000000" points="616.123,-3028.6 626.187,-3025.28 616.254,-3021.6 616.123,-3028.6"/>
</g>
<!-- sourcefile~fury_uom_symbol128.f90&#45;&gt;sourcefile~fury_uom_reference128.f90 -->
<g id="edge166" class="edge"><title>sourcefile~fury_uom_symbol128.f90&#45;&gt;sourcefile~fury_uom_reference128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M403.564,-2971.62C412.298,-2972.59 421.319,-2973.59 430.269,-2974.59"/>
<polygon fill="#000000" stroke="#000000" points="430.001,-2978.08 440.326,-2975.7 430.774,-2971.12 430.001,-2978.08"/>
</g>
<!-- sourcefile~fury_uom_symbol128.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge164" class="edge"><title>sourcefile~fury_uom_symbol128.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M403.653,-2957.9C437.34,-2954.42 478.44,-2949.45 515,-2943"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2943C545.768,-2937.57 731.138,-2816.96 760,-2805 781.318,-2796.16 787.277,-2795.03 810,-2791"/>
</g>
<!-- sourcefile~fury_uom_symbol128.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge168" class="edge"><title>sourcefile~fury_uom_symbol128.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515,-2943C615.189,-2923.2 882.255,-3027.85 973,-2981"/>
</g>
<!-- sourcefile~fury_qreal64.f90&#45;&gt;sourcefile~fury_system_si64.f90 -->
<g id="edge174" class="edge"><title>sourcefile~fury_qreal64.f90&#45;&gt;sourcefile~fury_system_si64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M857.164,-2526.82C889.759,-2530.32 934.084,-2535.4 973,-2541"/>
</g>
<!-- sourcefile~fury_qreal64.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge172" class="edge"><title>sourcefile~fury_qreal64.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M820.948,-2535.16C848.67,-2568.5 921.825,-2656.46 955.535,-2697"/>
<polygon fill="#000000" stroke="#000000" points="953.014,-2699.44 962.1,-2704.89 958.397,-2694.97 953.014,-2699.44"/>
</g>
<!-- sourcefile~fury_qreal64.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge178" class="edge"><title>sourcefile~fury_qreal64.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M827.85,-2508.7C856.608,-2488.43 915.781,-2451.5 973,-2445"/>
</g>
<!-- sourcefile~fury_qreal64.f90&#45;&gt;sourcefile~fury_system_abstract64.f90 -->
<g id="edge176" class="edge"><title>sourcefile~fury_qreal64.f90&#45;&gt;sourcefile~fury_system_abstract64.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M836.916,-2535.05C864.168,-2548.25 906.489,-2568.76 936.696,-2583.41"/>
<polygon fill="#000000" stroke="#000000" points="935.519,-2586.72 946.044,-2587.94 938.572,-2580.42 935.519,-2586.72"/>
</g>
<!-- sourcefile~fury_qreal128.f90&#45;&gt;sourcefile~fury_system_abstract128.f90 -->
<g id="edge180" class="edge"><title>sourcefile~fury_qreal128.f90&#45;&gt;sourcefile~fury_system_abstract128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M860.235,-3071.71C874.968,-3075.15 891.308,-3078.96 906.871,-3082.58"/>
<polygon fill="#000000" stroke="#000000" points="906.428,-3086.07 916.962,-3084.94 908.017,-3079.26 906.428,-3086.07"/>
</g>
<!-- sourcefile~fury_qreal128.f90&#45;&gt;sourcefile~fury_system_si128.f90 -->
<g id="edge184" class="edge"><title>sourcefile~fury_qreal128.f90&#45;&gt;sourcefile~fury_system_si128.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M839.505,-3047C871.751,-3034.11 925.204,-3016.62 973,-3019"/>
</g>
<!-- sourcefile~fury_qreal128.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge182" class="edge"><title>sourcefile~fury_qreal128.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M842.666,-3046.86C849.056,-3043.13 855.241,-3038.54 860,-3033 899.562,-2986.98 949.808,-2806.29 966.953,-2741.38"/>
<polygon fill="#000000" stroke="#000000" points="970.438,-2741.88 969.588,-2731.32 963.667,-2740.11 970.438,-2741.88"/>
</g>
<!-- sourcefile~fury_qreal128.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge186" class="edge"><title>sourcefile~fury_qreal128.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M836.168,-3046.92C843.99,-3042.74 852.481,-3037.91 860,-3033 876.976,-3021.92 878.036,-3014.39 896,-3005 927.769,-2988.4 940.581,-2996.29 973,-2981"/>
</g>
<!-- sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury_qreal32.f90 -->
<g id="edge192" class="edge"><title>sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury_qreal32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M720.705,-2351.13C731.247,-2348.17 742.583,-2344.98 753.522,-2341.9"/>
<polygon fill="#000000" stroke="#000000" points="754.745,-2345.19 763.423,-2339.11 752.848,-2338.45 754.745,-2345.19"/>
</g>
<!-- sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury_system_si32.f90 -->
<g id="edge188" class="edge"><title>sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury_system_si32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M720.654,-2364.12C746.827,-2364.42 780.283,-2365.17 810,-2367"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2367C902.935,-2372.73 1010.24,-2363.33 1078.57,-2355.33"/>
<polygon fill="#000000" stroke="#000000" points="1079.26,-2358.77 1088.78,-2354.11 1078.43,-2351.82 1079.26,-2358.77"/>
</g>
<!-- sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90 -->
<g id="edge190" class="edge"><title>sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury_mixed_kinds.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M678.013,-2377.1C688.841,-2423.27 726.901,-2577.63 760,-2615 792.688,-2651.9 815.614,-2641.55 860,-2663 885.783,-2675.46 914.831,-2689.6 937.019,-2700.43"/>
<polygon fill="#000000" stroke="#000000" points="935.557,-2703.61 946.079,-2704.85 938.626,-2697.31 935.557,-2703.61"/>
</g>
<!-- sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury_system_abstract32.f90 -->
<g id="edge196" class="edge"><title>sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury_system_abstract32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-2367C848.288,-2369.36 890.497,-2379.15 922.369,-2388.06"/>
<polygon fill="#000000" stroke="#000000" points="921.758,-2391.53 932.335,-2390.92 923.685,-2384.8 921.758,-2391.53"/>
</g>
<!-- sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury.f90 -->
<g id="edge194" class="edge"><title>sourcefile~fury_uom32.f90&#45;&gt;sourcefile~fury.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M688.327,-2350.82C703.98,-2336.31 731.455,-2313.75 760,-2304 923.34,-2248.19 1006.94,-2187.52 1148,-2287"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilestringifor_string_tf90AfferentGraph = svgPanZoom('#sourcefilestringifor_string_tf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="34pt"
 viewBox="0.00 0.00 188.00 34.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(1 1) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 185,-30 185,5 -4,5"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-26 2.84217e-14,-26 0,-1.24345e-14 66,-3.55271e-15 66,-26"/>
<text text-anchor="middle" x="33" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="180,-26 84,-26 84,-1.24345e-14 180,-3.55271e-15 180,-26"/>
<text text-anchor="middle" x="132" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which depends upon it. A file 
    is dependent upon another if the latter must be compiled before the former
    can be.
    </p>
    
                      </div>
                    </div>
                  </div>
                </div>
                
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/stringifor_string_t.html">stringifor_string_t</a>
      
    </div>
  </div>
</div>















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/stringifor_string_t.f90.html#src">stringifor_string_t.F90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!&lt; StringiFor, definition of `string` type.</span>
<a name="ln-2"></a><span class="k">module </span><span class="n">stringifor_string_t</span>
<a name="ln-3"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-4"></a><span class="c">!&lt; StringiFor, definition of `string` type.</span>
<a name="ln-5"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-6"></a><span class="k">use </span><span class="n">befor64</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">b64_decode</span><span class="p">,</span> <span class="n">b64_encode</span>
<a name="ln-7"></a><span class="k">use </span><span class="n">penf</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">I1P</span><span class="p">,</span> <span class="n">I2P</span><span class="p">,</span> <span class="n">I4P</span><span class="p">,</span> <span class="n">I8P</span><span class="p">,</span> <span class="n">R4P</span><span class="p">,</span> <span class="n">R8P</span><span class="p">,</span> <span class="n">R16P</span><span class="p">,</span> <span class="n">str</span>
<a name="ln-8"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-9"></a>
<a name="ln-10"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-11"></a><span class="k">implicit none</span>
<a name="ln-12"></a><span class="k">private</span>
<a name="ln-13"></a><span class="k">save</span>
<a name="ln-14"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">CK</span>
<a name="ln-15"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">sadjustl_character</span><span class="p">,</span> <span class="n">sadjustr_character</span><span class="p">,</span>                                 <span class="p">&amp;</span>
<a name="ln-16"></a>          <span class="n">sindex_string_string</span><span class="p">,</span> <span class="n">sindex_string_character</span><span class="p">,</span> <span class="n">sindex_character_string</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-17"></a>          <span class="n">slen</span><span class="p">,</span> <span class="n">slen_trim</span><span class="p">,</span>                                                        <span class="p">&amp;</span>
<a name="ln-18"></a>          <span class="n">srepeat_string_string</span><span class="p">,</span>                                                  <span class="p">&amp;</span>
<a name="ln-19"></a>          <span class="n">sscan_string_string</span><span class="p">,</span> <span class="n">sscan_string_character</span><span class="p">,</span> <span class="n">sscan_character_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-20"></a>          <span class="n">strim</span>
<a name="ln-21"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">string</span>
<a name="ln-22"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-23"></a>
<a name="ln-24"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-25"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">CK</span> <span class="o">=</span> <span class="nb">selected_char_kind</span><span class="p">(</span><span class="s1">&#39;DEFAULT&#39;</span><span class="p">)</span> <span class="c">!&lt; Default character kind.</span>
<a name="ln-26"></a>
<a name="ln-27"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">string</span>
<a name="ln-28"></a>  <span class="c">!&lt; OOP designed string class.</span>
<a name="ln-29"></a>  <span class="k">private</span>
<a name="ln-30"></a><span class="k">  </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">raw</span> <span class="c">!&lt; Raw data.</span>
<a name="ln-31"></a>  <span class="k">contains</span>
<a name="ln-32"></a>    <span class="c">! public methods</span>
<a name="ln-33"></a>    <span class="c">! builtins replacements</span>
<a name="ln-34"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">adjustl</span>  <span class="o">=&gt;</span> <span class="n">sadjustl</span>                 <span class="c">!&lt; Adjustl replacement.</span>
<a name="ln-35"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">adjustr</span>  <span class="o">=&gt;</span> <span class="n">sadjustr</span>                 <span class="c">!&lt; Adjustr replacement.</span>
<a name="ln-36"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">count</span>    <span class="o">=&gt;</span> <span class="n">scount</span>                   <span class="c">!&lt; Count replacement.</span>
<a name="ln-37"></a>    <span class="k">generic</span>               <span class="kd">::</span> <span class="nb">index</span>    <span class="o">=&gt;</span> <span class="n">sindex_string_string</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-38"></a>                                         <span class="n">sindex_string_character</span>  <span class="c">!&lt; Index replacement.</span>
<a name="ln-39"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">len</span>      <span class="o">=&gt;</span> <span class="n">slen</span>                     <span class="c">!&lt; Len replacement.</span>
<a name="ln-40"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">len_trim</span> <span class="o">=&gt;</span> <span class="n">slen_trim</span>                <span class="c">!&lt; Len_trim replacement.</span>
<a name="ln-41"></a>    <span class="k">generic</span>               <span class="kd">::</span> <span class="nb">repeat</span>   <span class="o">=&gt;</span> <span class="n">srepeat_string_string</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-42"></a>                                         <span class="n">srepeat_character_string</span> <span class="c">!&lt; Repeat replacement.</span>
<a name="ln-43"></a>    <span class="k">generic</span>               <span class="kd">::</span> <span class="nb">scan</span>     <span class="o">=&gt;</span> <span class="n">sscan_string_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-44"></a>                                         <span class="n">sscan_string_character</span>   <span class="c">!&lt; Scan replacement.</span>
<a name="ln-45"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">trim</span>     <span class="o">=&gt;</span> <span class="n">strim</span>                    <span class="c">!&lt; Trim replacement.</span>
<a name="ln-46"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">verify</span>   <span class="o">=&gt;</span> <span class="n">sverify</span>                  <span class="c">!&lt; Verify replacement.</span>
<a name="ln-47"></a>    <span class="c">! auxiliary methods</span>
<a name="ln-48"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">basedir</span>          <span class="c">!&lt; Return the base directory name of a string containing a file name.</span>
<a name="ln-49"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">basename</span>         <span class="c">!&lt; Return the base file name of a string containing a file name.</span>
<a name="ln-50"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">camelcase</span>        <span class="c">!&lt; Return a string with all words capitalized without spaces.</span>
<a name="ln-51"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">capitalize</span>       <span class="c">!&lt; Return a string with its first character capitalized and the rest lowercased.</span>
<a name="ln-52"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">chars</span>            <span class="c">!&lt; Return the raw characters data.</span>
<a name="ln-53"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="k">decode</span>           <span class="c">!&lt; Decode string.</span>
<a name="ln-54"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="k">encode</span>           <span class="c">!&lt; Encode string.</span>
<a name="ln-55"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">escape</span>           <span class="c">!&lt; Escape backslashes (or custom escape character).</span>
<a name="ln-56"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">extension</span>        <span class="c">!&lt; Return the extension of a string containing a file name.</span>
<a name="ln-57"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fill</span>             <span class="c">!&lt; Pad string on the left (or right) with zeros (or other char) to fill width.</span>
<a name="ln-58"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">free</span>             <span class="c">!&lt; Free dynamic memory.</span>
<a name="ln-59"></a>    <span class="k">generic</span>               <span class="kd">::</span> <span class="n">insert</span> <span class="o">=&gt;</span>      <span class="p">&amp;</span>
<a name="ln-60"></a>                             <span class="n">insert_string</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-61"></a>                             <span class="n">insert_character</span> <span class="c">!&lt; Insert substring into string at a specified position.</span>
<a name="ln-62"></a>    <span class="k">generic</span>               <span class="kd">::</span> <span class="n">join</span> <span class="o">=&gt;</span>       <span class="p">&amp;</span>
<a name="ln-63"></a>                             <span class="n">join_strings</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-64"></a>                             <span class="n">join_characters</span>  <span class="c">!&lt; Return a string that is a join of an array of strings or characters.</span>
<a name="ln-65"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lower</span>            <span class="c">!&lt; Return a string with all lowercase characters.</span>
<a name="ln-66"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">partition</span>        <span class="c">!&lt; Split string at separator and return the 3 parts (before, the separator and after).</span>
<a name="ln-67"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">read_file</span>        <span class="c">!&lt; Read a file a single string stream.</span>
<a name="ln-68"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">read_line</span>        <span class="c">!&lt; Read line (record) from a connected unit.</span>
<a name="ln-69"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">read_lines</span>       <span class="c">!&lt; Read (all) lines (records) from a connected unit as a single ascii stream.</span>
<a name="ln-70"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">replace</span>          <span class="c">!&lt; Return a string with all occurrences of substring old replaced by new.</span>
<a name="ln-71"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">reverse</span>          <span class="c">!&lt; Return a reversed string.</span>
<a name="ln-72"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">search</span>           <span class="c">!&lt; Search for *tagged* record into string.</span>
<a name="ln-73"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">slice</span>            <span class="c">!&lt; Return the raw characters data sliced.</span>
<a name="ln-74"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">snakecase</span>        <span class="c">!&lt; Return a string with all words lowercase separated by &quot;_&quot;.</span>
<a name="ln-75"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">split</span>            <span class="c">!&lt; Return a list of substring in the string, using sep as the delimiter string.</span>
<a name="ln-76"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">startcase</span>        <span class="c">!&lt; Return a string with all words capitalized, e.g. title case.</span>
<a name="ln-77"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">strip</span>            <span class="c">!&lt; Return a string with the leading and trailing characters removed.</span>
<a name="ln-78"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">swapcase</span>         <span class="c">!&lt; Return a string with uppercase chars converted to lowercase and vice versa.</span>
<a name="ln-79"></a>    <span class="k">generic</span>               <span class="kd">::</span> <span class="n">to_number</span> <span class="o">=&gt;</span>   <span class="p">&amp;</span>
<a name="ln-80"></a>                             <span class="n">to_integer_I1P</span><span class="p">,&amp;</span>
<a name="ln-81"></a>                             <span class="n">to_integer_I2P</span><span class="p">,&amp;</span>
<a name="ln-82"></a>                             <span class="n">to_integer_I4P</span><span class="p">,&amp;</span>
<a name="ln-83"></a>                             <span class="n">to_integer_I8P</span><span class="p">,&amp;</span>
<a name="ln-84"></a>                             <span class="n">to_real_R4P</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-85"></a><span class="cp">#ifdef r16p</span>
<a name="ln-86"></a>                             <span class="n">to_real_R8P</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-87"></a>                             <span class="n">to_real_R16P</span>     <span class="c">!&lt; Cast string to number.</span>
<a name="ln-88"></a><span class="cp">#else</span>
<a name="ln-89"></a>                             <span class="n">to_real_R8P</span>      <span class="c">!&lt; Cast string to number.</span>
<a name="ln-90"></a><span class="cp">#endif</span>
<a name="ln-91"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">unescape</span>         <span class="c">!&lt; Unescape double backslashes (or custom escaped character).</span>
<a name="ln-92"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">unique</span>           <span class="c">!&lt; Reduce to one (unique) multiple occurrences of a substring into a string.</span>
<a name="ln-93"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">upper</span>            <span class="c">!&lt; Return a string with all uppercase characters.</span>
<a name="ln-94"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">write_file</span>       <span class="c">!&lt; Write a single string stream into file.</span>
<a name="ln-95"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">write_line</span>       <span class="c">!&lt; Write line (record) to a connected unit.</span>
<a name="ln-96"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">write_lines</span>      <span class="c">!&lt; Write lines (records) to a connected unit.</span>
<a name="ln-97"></a>    <span class="c">! inquire methods</span>
<a name="ln-98"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">end_with</span>     <span class="c">!&lt; Return true if a string ends with a specified suffix.</span>
<a name="ln-99"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">is_allocated</span> <span class="c">!&lt; Return true if the string is allocated.</span>
<a name="ln-100"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">is_digit</span>     <span class="c">!&lt; Return true if all characters in the string are digits.</span>
<a name="ln-101"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">is_integer</span>   <span class="c">!&lt; Return true if the string contains an integer.</span>
<a name="ln-102"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">is_lower</span>     <span class="c">!&lt; Return true if all characters in the string are lowercase.</span>
<a name="ln-103"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">is_number</span>    <span class="c">!&lt; Return true if the string contains a number (real or integer).</span>
<a name="ln-104"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">is_real</span>      <span class="c">!&lt; Return true if the string contains an real.</span>
<a name="ln-105"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">is_upper</span>     <span class="c">!&lt; Return true if all characters in the string are uppercase.</span>
<a name="ln-106"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">start_with</span>   <span class="c">!&lt; Return true if a string starts with a specified prefix.</span>
<a name="ln-107"></a>    <span class="c">! operators</span>
<a name="ln-108"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">assignment</span><span class="p">(</span><span class="o">=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">string_assign_string</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-109"></a>                                <span class="n">string_assign_character</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-110"></a>                                <span class="n">string_assign_integer_I1P</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-111"></a>                                <span class="n">string_assign_integer_I2P</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-112"></a>                                <span class="n">string_assign_integer_I4P</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-113"></a>                                <span class="n">string_assign_integer_I8P</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-114"></a>                                <span class="n">string_assign_real_R4P</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-115"></a><span class="cp">#ifdef r16p</span>
<a name="ln-116"></a>                                <span class="n">string_assign_real_R8P</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-117"></a>                                <span class="n">string_assign_real_R16P</span>             <span class="c">!&lt; Assignment operator overloading.</span>
<a name="ln-118"></a><span class="cp">#else</span>
<a name="ln-119"></a>                                <span class="n">string_assign_real_R8P</span>              <span class="c">!&lt; Assignment operator overloading.</span>
<a name="ln-120"></a><span class="cp">#endif</span>
<a name="ln-121"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">//</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">string_concat_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-122"></a>                               <span class="n">string_concat_character</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-123"></a>                               <span class="n">character_concat_string</span>              <span class="c">!&lt; Concatenation operator overloading.</span>
<a name="ln-124"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(.</span><span class="n">cat</span><span class="p">.)</span> <span class="o">=&gt;</span> <span class="n">string_concat_string_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-125"></a>                                  <span class="n">string_concat_character_string</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-126"></a>                                  <span class="n">character_concat_string_string</span>    <span class="c">!&lt; Concatenation operator (string output) overloading.</span>
<a name="ln-127"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">==</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">string_eq_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-128"></a>                               <span class="n">string_eq_character</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-129"></a>                               <span class="n">character_eq_string</span>                  <span class="c">!&lt; Equal operator overloading.</span>
<a name="ln-130"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">/=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">string_ne_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-131"></a>                               <span class="n">string_ne_character</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-132"></a>                               <span class="n">character_ne_string</span>                  <span class="c">!&lt; Not equal operator overloading.</span>
<a name="ln-133"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">&lt;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">string_lt_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-134"></a>                              <span class="n">string_lt_character</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-135"></a>                              <span class="n">character_lt_string</span>                   <span class="c">!&lt; Lower than operator overloading.</span>
<a name="ln-136"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">&lt;=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">string_le_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-137"></a>                               <span class="n">string_le_character</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-138"></a>                               <span class="n">character_le_string</span>                  <span class="c">!&lt; Lower equal than operator overloading.</span>
<a name="ln-139"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">&gt;=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">string_ge_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-140"></a>                               <span class="n">string_ge_character</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-141"></a>                               <span class="n">character_ge_string</span>                  <span class="c">!&lt; Greater equal than operator overloading.</span>
<a name="ln-142"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">string_gt_string</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-143"></a>                              <span class="n">string_gt_character</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-144"></a>                              <span class="n">character_gt_string</span>                   <span class="c">!&lt; Greater than operator overloading.</span>
<a name="ln-145"></a>    <span class="c">! IO</span>
<a name="ln-146"></a><span class="cp">#ifndef __GFORTRAN__</span>
<a name="ln-147"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="k">read</span><span class="p">(</span><span class="n">formatted</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">read_formatted</span>       <span class="c">!&lt; Formatted input.</span>
<a name="ln-148"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="k">write</span><span class="p">(</span><span class="n">formatted</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">write_formatted</span>     <span class="c">!&lt; Formatted output.</span>
<a name="ln-149"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="k">read</span><span class="p">(</span><span class="n">unformatted</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">read_unformatted</span>   <span class="c">!&lt; Unformatted input.</span>
<a name="ln-150"></a>    <span class="k">generic</span> <span class="kd">::</span> <span class="k">write</span><span class="p">(</span><span class="n">unformatted</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">write_unformatted</span> <span class="c">!&lt; Unformatted output.</span>
<a name="ln-151"></a><span class="cp">#endif</span>
<a name="ln-152"></a>    <span class="c">! private methods</span>
<a name="ln-153"></a>    <span class="c">! builtins replacements</span>
<a name="ln-154"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sindex_string_string</span>     <span class="c">!&lt; Index replacement.</span>
<a name="ln-155"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sindex_string_character</span>  <span class="c">!&lt; Index replacement.</span>
<a name="ln-156"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">srepeat_string_string</span>    <span class="c">!&lt; Repeat replacement.</span>
<a name="ln-157"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">srepeat_character_string</span> <span class="c">!&lt; Repeat replacement.</span>
<a name="ln-158"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sscan_string_string</span>      <span class="c">!&lt; Scan replacement.</span>
<a name="ln-159"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sscan_string_character</span>   <span class="c">!&lt; Scan replacement.</span>
<a name="ln-160"></a>    <span class="c">! auxiliary methods</span>
<a name="ln-161"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">insert_string</span>    <span class="c">!&lt; Insert substring into string at a specified position.</span>
<a name="ln-162"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">insert_character</span> <span class="c">!&lt; Insert substring into string at a specified position.</span>
<a name="ln-163"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">join_strings</span>     <span class="c">!&lt; Return join string of an array of strings.</span>
<a name="ln-164"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">join_characters</span>  <span class="c">!&lt; Return join string of an array of characters.</span>
<a name="ln-165"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">to_integer_I1P</span>   <span class="c">!&lt; Cast string to integer.</span>
<a name="ln-166"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">to_integer_I2P</span>   <span class="c">!&lt; Cast string to integer.</span>
<a name="ln-167"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">to_integer_I4P</span>   <span class="c">!&lt; Cast string to integer.</span>
<a name="ln-168"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">to_integer_I8P</span>   <span class="c">!&lt; Cast string to integer.</span>
<a name="ln-169"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">to_real_R4P</span>      <span class="c">!&lt; Cast string to real.</span>
<a name="ln-170"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">to_real_R8P</span>      <span class="c">!&lt; Cast string to real.</span>
<a name="ln-171"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">to_real_R16P</span>     <span class="c">!&lt; Cast string to real.</span>
<a name="ln-172"></a>    <span class="c">! assignments</span>
<a name="ln-173"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_string</span>      <span class="c">!&lt; Assignment operator from string input.</span>
<a name="ln-174"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_character</span>   <span class="c">!&lt; Assignment operator from character input.</span>
<a name="ln-175"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_integer_I1P</span> <span class="c">!&lt; Assignment operator from integer input.</span>
<a name="ln-176"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_integer_I2P</span> <span class="c">!&lt; Assignment operator from integer input.</span>
<a name="ln-177"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_integer_I4P</span> <span class="c">!&lt; Assignment operator from integer input.</span>
<a name="ln-178"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_integer_I8P</span> <span class="c">!&lt; Assignment operator from integer input.</span>
<a name="ln-179"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_real_R4P</span>    <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-180"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_real_R8P</span>    <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-181"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_assign_real_R16P</span>   <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-182"></a>    <span class="c">! concatenation operators</span>
<a name="ln-183"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_concat_string</span>           <span class="c">!&lt; Concatenation with string.</span>
<a name="ln-184"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_concat_character</span>        <span class="c">!&lt; Concatenation with character.</span>
<a name="ln-185"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">character_concat_string</span>        <span class="c">!&lt; Concatenation with character (inverted).</span>
<a name="ln-186"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_concat_string_string</span>    <span class="c">!&lt; Concatenation with string (string output).</span>
<a name="ln-187"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_concat_character_string</span> <span class="c">!&lt; Concatenation with character (string output).</span>
<a name="ln-188"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">character_concat_string_string</span> <span class="c">!&lt; Concatenation with character (inverted, string output).</span>
<a name="ln-189"></a>    <span class="c">! logical operators</span>
<a name="ln-190"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_eq_string</span>    <span class="c">!&lt; Equal to string logical operator.</span>
<a name="ln-191"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_eq_character</span> <span class="c">!&lt; Equal to character logical operator.</span>
<a name="ln-192"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">character_eq_string</span> <span class="c">!&lt; Equal to character (inverted) logical operator.</span>
<a name="ln-193"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_ne_string</span>    <span class="c">!&lt; Not equal to string logical operator.</span>
<a name="ln-194"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_ne_character</span> <span class="c">!&lt; Not equal to character logical operator.</span>
<a name="ln-195"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">character_ne_string</span> <span class="c">!&lt; Not equal to character (inverted) logical operator.</span>
<a name="ln-196"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_lt_string</span>    <span class="c">!&lt; Lower than to string logical operator.</span>
<a name="ln-197"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_lt_character</span> <span class="c">!&lt; Lower than to character logical operator.</span>
<a name="ln-198"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">character_lt_string</span> <span class="c">!&lt; Lower than to character (inverted) logical operator.</span>
<a name="ln-199"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_le_string</span>    <span class="c">!&lt; Lower equal than to string logical operator.</span>
<a name="ln-200"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_le_character</span> <span class="c">!&lt; Lower equal than to character logical operator.</span>
<a name="ln-201"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">character_le_string</span> <span class="c">!&lt; Lower equal than to character (inverted) logical operator.</span>
<a name="ln-202"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_ge_string</span>    <span class="c">!&lt; Greater equal than to string logical operator.</span>
<a name="ln-203"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_ge_character</span> <span class="c">!&lt; Greater equal than to character logical operator.</span>
<a name="ln-204"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">character_ge_string</span> <span class="c">!&lt; Greater equal than to character (inverted) logical operator.</span>
<a name="ln-205"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_gt_string</span>    <span class="c">!&lt; Greater than to string logical operator.</span>
<a name="ln-206"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string_gt_character</span> <span class="c">!&lt; Greater than to character logical operator.</span>
<a name="ln-207"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">character_gt_string</span> <span class="c">!&lt; Greater than to character (inverted) logical operator.</span>
<a name="ln-208"></a>    <span class="c">! IO</span>
<a name="ln-209"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">dtv</span><span class="p">)</span> <span class="kd">::</span> <span class="n">read_formatted</span>                <span class="c">!&lt; Formatted input.</span>
<a name="ln-210"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">dtv</span><span class="p">)</span> <span class="kd">::</span> <span class="n">read_delimited</span>                <span class="c">!&lt; Read a delimited input.</span>
<a name="ln-211"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">dtv</span><span class="p">)</span> <span class="kd">::</span> <span class="n">read_undelimited</span>              <span class="c">!&lt; Read an undelimited input.</span>
<a name="ln-212"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">dtv</span><span class="p">)</span> <span class="kd">::</span> <span class="n">read_undelimited_listdirected</span> <span class="c">!&lt; Read an undelimited list directed input.</span>
<a name="ln-213"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">dtv</span><span class="p">)</span> <span class="kd">::</span> <span class="n">write_formatted</span>               <span class="c">!&lt; Formatted output.</span>
<a name="ln-214"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">dtv</span><span class="p">)</span> <span class="kd">::</span> <span class="n">read_unformatted</span>              <span class="c">!&lt; Unformatted input.</span>
<a name="ln-215"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">dtv</span><span class="p">)</span> <span class="kd">::</span> <span class="n">write_unformatted</span>             <span class="c">!&lt; Unformatted output.</span>
<a name="ln-216"></a>    <span class="c">! miscellanea</span>
<a name="ln-217"></a>    <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">replace_one_occurrence</span> <span class="c">!&lt; Replace the first occurrence of substring old by new.</span>
<a name="ln-218"></a><span class="n">endtype</span> <span class="n">string</span>
<a name="ln-219"></a>
<a name="ln-220"></a><span class="c">! internal parameters</span>
<a name="ln-221"></a><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">26</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">UPPER_ALPHABET</span> <span class="o">=</span> <span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span> <span class="c">!&lt; Upper case alphabet.</span>
<a name="ln-222"></a><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">26</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">LOWER_ALPHABET</span> <span class="o">=</span> <span class="s1">&#39;abcdefghijklmnopqrstuvwxyz&#39;</span> <span class="c">!&lt; Lower case alphabet.</span>
<a name="ln-223"></a><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>  <span class="k">parameter</span> <span class="kd">::</span> <span class="n">SPACE</span>          <span class="o">=</span> <span class="s1">&#39; &#39;</span>                          <span class="c">!&lt; Space character.</span>
<a name="ln-224"></a><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>  <span class="k">parameter</span> <span class="kd">::</span> <span class="n">TAB</span>            <span class="o">=</span> <span class="nb">achar</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>                     <span class="c">!&lt; Tab character.</span>
<a name="ln-225"></a><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>  <span class="k">parameter</span> <span class="kd">::</span> <span class="n">UIX_DIR_SEP</span>    <span class="o">=</span> <span class="nb">char</span><span class="p">(</span><span class="mi">47</span><span class="p">)</span>                     <span class="c">!&lt; Unix/Linux directories separator (/).</span>
<a name="ln-226"></a><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>  <span class="k">parameter</span> <span class="kd">::</span> <span class="n">BACKSLASH</span>      <span class="o">=</span> <span class="nb">char</span><span class="p">(</span><span class="mi">92</span><span class="p">)</span>                     <span class="c">!&lt; Backslash character.</span>
<a name="ln-227"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-228"></a><span class="k">contains</span>
<a name="ln-229"></a>  <span class="c">! public methods</span>
<a name="ln-230"></a>
<a name="ln-231"></a>  <span class="c">! builtins replacements</span>
<a name="ln-232"></a>  <span class="k">elemental function </span><span class="n">sadjustl</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">adjusted</span><span class="p">)</span>
<a name="ln-233"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-234"></a>  <span class="c">!&lt; Left adjust a string by removing leading spaces.</span>
<a name="ln-235"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-236"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-237"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">adjusted</span> <span class="c">!&lt; Adjusted string.</span>
<a name="ln-238"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-239"></a>
<a name="ln-240"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-241"></a>  <span class="n">adjusted</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-242"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">adjusted</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">adjusted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">adjustl</span><span class="p">(</span><span class="n">adjusted</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-243"></a>  <span class="k">return</span>
<a name="ln-244"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-245"></a>  <span class="n">endfunction</span> <span class="n">sadjustl</span>
<a name="ln-246"></a>
<a name="ln-247"></a>  <span class="k">pure function </span><span class="n">sadjustl_character</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">adjusted</span><span class="p">)</span>
<a name="ln-248"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-249"></a>  <span class="c">!&lt; Left adjust a string by removing leading spaces (character output).</span>
<a name="ln-250"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-251"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-252"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="kd">::</span> <span class="n">adjusted</span> <span class="c">!&lt; Adjusted string.</span>
<a name="ln-253"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-254"></a>
<a name="ln-255"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-256"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">adjusted</span> <span class="o">=</span> <span class="nb">adjustl</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-257"></a>  <span class="k">return</span>
<a name="ln-258"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-259"></a>  <span class="n">endfunction</span> <span class="n">sadjustl_character</span>
<a name="ln-260"></a>
<a name="ln-261"></a>  <span class="k">elemental function </span><span class="n">sadjustr</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">adjusted</span><span class="p">)</span>
<a name="ln-262"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-263"></a>  <span class="c">!&lt; Right adjust a string by removing leading spaces.</span>
<a name="ln-264"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-265"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-266"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">adjusted</span> <span class="c">!&lt; Adjusted string.</span>
<a name="ln-267"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-268"></a>
<a name="ln-269"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-270"></a>  <span class="n">adjusted</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-271"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">adjusted</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">adjusted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">adjustr</span><span class="p">(</span><span class="n">adjusted</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-272"></a>  <span class="k">return</span>
<a name="ln-273"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-274"></a>  <span class="n">endfunction</span> <span class="n">sadjustr</span>
<a name="ln-275"></a>
<a name="ln-276"></a>  <span class="k">pure function </span><span class="n">sadjustr_character</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">adjusted</span><span class="p">)</span>
<a name="ln-277"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-278"></a>  <span class="c">!&lt; Right adjust a string by removing leading spaces (character output).</span>
<a name="ln-279"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-280"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-281"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="kd">::</span> <span class="n">adjusted</span> <span class="c">!&lt; Adjusted string.</span>
<a name="ln-282"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-283"></a>
<a name="ln-284"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-285"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">adjusted</span> <span class="o">=</span> <span class="nb">adjustr</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-286"></a>  <span class="k">return</span>
<a name="ln-287"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-288"></a>  <span class="n">endfunction</span> <span class="n">sadjustr_character</span>
<a name="ln-289"></a>
<a name="ln-290"></a>  <span class="k">elemental function </span><span class="n">scount</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">substring</span><span class="p">,</span> <span class="n">ignore_isolated</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">No</span><span class="p">)</span>
<a name="ln-291"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-292"></a>  <span class="c">!&lt; Count the number of occurences of a substring into a string.</span>
<a name="ln-293"></a>  <span class="c">!&lt;</span>
<a name="ln-294"></a>  <span class="c">!&lt; @note If `ignore_isolated` is set to true the eventual &quot;isolated&quot; occurences are ignored: an isolated occurrences are those</span>
<a name="ln-295"></a>  <span class="c">!&lt; occurrences happening at the start of string (thus not having a left companion) or at the end of the string (thus not having a</span>
<a name="ln-296"></a>  <span class="c">!&lt; right companion).</span>
<a name="ln-297"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-298"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">self</span>             <span class="c">!&lt; The string.</span>
<a name="ln-299"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">substring</span>        <span class="c">!&lt; Substring.</span>
<a name="ln-300"></a>  <span class="kt">logical</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>    <span class="kd">::</span> <span class="n">ignore_isolated</span>  <span class="c">!&lt; Ignore &quot;isolated&quot; occurrences.</span>
<a name="ln-301"></a>  <span class="kt">integer</span>                                <span class="kd">::</span> <span class="n">No</span>               <span class="c">!&lt; Number of occurrences.</span>
<a name="ln-302"></a>  <span class="kt">logical</span>                                <span class="kd">::</span> <span class="n">ignore_isolated_</span> <span class="c">!&lt; Ignore &quot;isolated&quot; occurrences, local variable.</span>
<a name="ln-303"></a>  <span class="kt">integer</span>                                <span class="kd">::</span> <span class="n">c1</span>               <span class="c">!&lt; Counter.</span>
<a name="ln-304"></a>  <span class="kt">integer</span>                                <span class="kd">::</span> <span class="n">c2</span>               <span class="c">!&lt; Counter.</span>
<a name="ln-305"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-306"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">temporary</span>        <span class="c">!&lt; Temporary storage, workaround for GNU bug.</span>
<a name="ln-307"></a><span class="cp">#endif</span>
<a name="ln-308"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-309"></a>
<a name="ln-310"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-311"></a>  <span class="n">No</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-312"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-313"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">substring</span><span class="p">)</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">return</span>
<a name="ln-314"></a><span class="k">    </span><span class="n">ignore_isolated_</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">ignore_isolated</span><span class="p">))</span> <span class="n">ignore_isolated_</span> <span class="o">=</span> <span class="n">ignore_isolated</span>
<a name="ln-315"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-316"></a>    <span class="n">temporary</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-317"></a><span class="cp">#endif</span>
<a name="ln-318"></a>    <span class="n">c1</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-319"></a>    <span class="k">do</span>
<a name="ln-320"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-321"></a>      <span class="n">c2</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">temporary</span><span class="p">(</span><span class="n">c1</span><span class="p">:),</span> <span class="n">substring</span><span class="o">=</span><span class="n">substring</span><span class="p">)</span>
<a name="ln-322"></a><span class="cp">#else</span>
<a name="ln-323"></a>      <span class="n">c2</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c1</span><span class="p">:),</span> <span class="n">substring</span><span class="o">=</span><span class="n">substring</span><span class="p">)</span>
<a name="ln-324"></a><span class="cp">#endif</span>
<a name="ln-325"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">c2</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-326"></a><span class="k">      if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">ignore_isolated_</span><span class="p">.</span><span class="nb">and</span><span class="p">.(</span><span class="n">c1</span><span class="o">==</span><span class="mf">1.</span><span class="nb">or</span><span class="p">.</span><span class="n">c1</span><span class="o">+</span><span class="n">c2</span><span class="o">-</span><span class="mi">1</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">substring</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span> <span class="k">then</span>
<a name="ln-327"></a><span class="k">        </span><span class="n">No</span> <span class="o">=</span> <span class="n">No</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-328"></a>      <span class="n">endif</span>
<a name="ln-329"></a>      <span class="n">c1</span> <span class="o">=</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">substring</span><span class="p">)</span>
<a name="ln-330"></a>    <span class="n">enddo</span>
<a name="ln-331"></a>  <span class="n">endif</span>
<a name="ln-332"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-333"></a>  <span class="n">endfunction</span> <span class="n">scount</span>
<a name="ln-334"></a>
<a name="ln-335"></a>  <span class="k">elemental function </span><span class="n">sindex_string_string</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">substring</span><span class="p">,</span> <span class="n">back</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-336"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-337"></a>  <span class="c">!&lt; Return the position of the start of the first occurrence of string `substring` as a substring in `string`, counting from one.</span>
<a name="ln-338"></a>  <span class="c">!&lt; If `substring` is not present in `string`, zero is returned. If the back argument is present and true, the return value is</span>
<a name="ln-339"></a>  <span class="c">!&lt; the start of the last occurrence rather than the first.</span>
<a name="ln-340"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-341"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-342"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">substring</span> <span class="c">!&lt; Searched substring.</span>
<a name="ln-343"></a>  <span class="kt">logical</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">back</span>      <span class="c">!&lt; Start of the last occurrence rather than the first.</span>
<a name="ln-344"></a>  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">i</span>         <span class="c">!&lt; Result of the search.</span>
<a name="ln-345"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-346"></a>
<a name="ln-347"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-348"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-349"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">substring</span><span class="o">=</span><span class="n">substring</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="n">back</span><span class="p">)</span>
<a name="ln-350"></a>  <span class="k">else</span>
<a name="ln-351"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-352"></a>  <span class="n">endif</span>
<a name="ln-353"></a>  <span class="k">return</span>
<a name="ln-354"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-355"></a>  <span class="n">endfunction</span> <span class="n">sindex_string_string</span>
<a name="ln-356"></a>
<a name="ln-357"></a>  <span class="k">elemental function </span><span class="n">sindex_string_character</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">substring</span><span class="p">,</span> <span class="n">back</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-358"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-359"></a>  <span class="c">!&lt; Return the position of the start of the first occurrence of string `substring` as a substring in `string`, counting from one.</span>
<a name="ln-360"></a>  <span class="c">!&lt; If `substring` is not present in `string`, zero is returned. If the back argument is present and true, the return value is</span>
<a name="ln-361"></a>  <span class="c">!&lt; the start of the last occurrence rather than the first.</span>
<a name="ln-362"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-363"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-364"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">substring</span> <span class="c">!&lt; Searched substring.</span>
<a name="ln-365"></a>  <span class="kt">logical</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">back</span>      <span class="c">!&lt; Start of the last occurrence rather than the first.</span>
<a name="ln-366"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">i</span>         <span class="c">!&lt; Result of the search.</span>
<a name="ln-367"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-368"></a>
<a name="ln-369"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-370"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-371"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">substring</span><span class="o">=</span><span class="n">substring</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="n">back</span><span class="p">)</span>
<a name="ln-372"></a>  <span class="k">else</span>
<a name="ln-373"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-374"></a>  <span class="n">endif</span>
<a name="ln-375"></a>  <span class="k">return</span>
<a name="ln-376"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-377"></a>  <span class="n">endfunction</span> <span class="n">sindex_string_character</span>
<a name="ln-378"></a>
<a name="ln-379"></a>  <span class="k">elemental function </span><span class="n">sindex_character_string</span><span class="p">(</span><span class="n">string_</span><span class="p">,</span> <span class="n">substring</span><span class="p">,</span> <span class="n">back</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-380"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-381"></a>  <span class="c">!&lt; Return the position of the start of the first occurrence of string `substring` as a substring in `string`, counting from one.</span>
<a name="ln-382"></a>  <span class="c">!&lt; If `substring` is not present in `string`, zero is returned. If the back argument is present and true, the return value is</span>
<a name="ln-383"></a>  <span class="c">!&lt; the start of the last occurrence rather than the first.</span>
<a name="ln-384"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-385"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">string_</span>   <span class="c">!&lt; The string.</span>
<a name="ln-386"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>              <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">substring</span> <span class="c">!&lt; Searched substring.</span>
<a name="ln-387"></a>  <span class="kt">logical</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">back</span>      <span class="c">!&lt; Start of the last occurrence rather than the first.</span>
<a name="ln-388"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">i</span>         <span class="c">!&lt; Result of the search.</span>
<a name="ln-389"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-390"></a>
<a name="ln-391"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-392"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">substring</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-393"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">string_</span><span class="p">,</span> <span class="n">substring</span><span class="o">=</span><span class="n">substring</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="n">back</span><span class="p">)</span>
<a name="ln-394"></a>  <span class="k">else</span>
<a name="ln-395"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-396"></a>  <span class="n">endif</span>
<a name="ln-397"></a>  <span class="k">return</span>
<a name="ln-398"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-399"></a>  <span class="n">endfunction</span> <span class="n">sindex_character_string</span>
<a name="ln-400"></a>
<a name="ln-401"></a>  <span class="k">elemental function </span><span class="n">slen</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<a name="ln-402"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-403"></a>  <span class="c">!&lt; Return the length of a string.</span>
<a name="ln-404"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-405"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span> <span class="c">!&lt; The string.</span>
<a name="ln-406"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">l</span>    <span class="c">!&lt; String length.</span>
<a name="ln-407"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-408"></a>
<a name="ln-409"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-410"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-411"></a><span class="k">    </span><span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-412"></a>  <span class="k">else</span>
<a name="ln-413"></a><span class="k">    </span><span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-414"></a>  <span class="n">endif</span>
<a name="ln-415"></a>  <span class="k">return</span>
<a name="ln-416"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-417"></a>  <span class="n">endfunction</span> <span class="n">slen</span>
<a name="ln-418"></a>
<a name="ln-419"></a>  <span class="k">elemental function </span><span class="n">slen_trim</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<a name="ln-420"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-421"></a>  <span class="c">!&lt; Return the length of a string, ignoring any trailing blanks.</span>
<a name="ln-422"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-423"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span> <span class="c">!&lt; The string.</span>
<a name="ln-424"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">l</span>    <span class="c">!&lt; String length.</span>
<a name="ln-425"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-426"></a>
<a name="ln-427"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-428"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-429"></a><span class="k">    </span><span class="n">l</span> <span class="o">=</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-430"></a>  <span class="k">else</span>
<a name="ln-431"></a><span class="k">    </span><span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-432"></a>  <span class="n">endif</span>
<a name="ln-433"></a>  <span class="k">return</span>
<a name="ln-434"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-435"></a>  <span class="n">endfunction</span> <span class="n">slen_trim</span>
<a name="ln-436"></a>
<a name="ln-437"></a>  <span class="k">elemental function </span><span class="n">srepeat_string_string</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">ncopies</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">repeated</span><span class="p">)</span>
<a name="ln-438"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-439"></a>  <span class="c">!&lt; Concatenates several copies of an input string.</span>
<a name="ln-440"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-441"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; String to be repeated.</span>
<a name="ln-442"></a>  <span class="kt">integer</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ncopies</span>  <span class="c">!&lt; Number of string copies.</span>
<a name="ln-443"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">repeated</span> <span class="c">!&lt; Repeated string.</span>
<a name="ln-444"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-445"></a>
<a name="ln-446"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-447"></a>  <span class="n">repeated</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">ncopies</span><span class="o">=</span><span class="n">ncopies</span><span class="p">)</span>
<a name="ln-448"></a>  <span class="k">return</span>
<a name="ln-449"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-450"></a>  <span class="n">endfunction</span> <span class="n">srepeat_string_string</span>
<a name="ln-451"></a>
<a name="ln-452"></a>  <span class="k">elemental function </span><span class="n">srepeat_character_string</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">rstring</span><span class="p">,</span> <span class="n">ncopies</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">repeated</span><span class="p">)</span>
<a name="ln-453"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-454"></a>  <span class="c">!&lt; Concatenates several copies of an input string.</span>
<a name="ln-455"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-456"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; String to be repeated.</span>
<a name="ln-457"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rstring</span>  <span class="c">!&lt; String to be repeated.</span>
<a name="ln-458"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ncopies</span>  <span class="c">!&lt; Number of string copies.</span>
<a name="ln-459"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">repeated</span> <span class="c">!&lt; Repeated string.</span>
<a name="ln-460"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-461"></a>
<a name="ln-462"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-463"></a>  <span class="n">repeated</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">rstring</span><span class="p">,</span> <span class="n">ncopies</span><span class="o">=</span><span class="n">ncopies</span><span class="p">)</span>
<a name="ln-464"></a>  <span class="k">return</span>
<a name="ln-465"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-466"></a>  <span class="n">endfunction</span> <span class="n">srepeat_character_string</span>
<a name="ln-467"></a>
<a name="ln-468"></a>  <span class="k">elemental function </span><span class="n">sscan_string_string</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">set</span><span class="p">,</span> <span class="n">back</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-469"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-470"></a>  <span class="c">!&lt; Return the leftmost (if `back` is either absent or equals false, otherwise the rightmost) character of string that is in `set`.</span>
<a name="ln-471"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-472"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>  <span class="c">!&lt; The string.</span>
<a name="ln-473"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">set</span>   <span class="c">!&lt; Searched set.</span>
<a name="ln-474"></a>  <span class="kt">logical</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">back</span>  <span class="c">!&lt; Start of the last occurrence rather than the first.</span>
<a name="ln-475"></a>  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">i</span>     <span class="c">!&lt; Result of the search.</span>
<a name="ln-476"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-477"></a>
<a name="ln-478"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-479"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">set</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-480"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="nb">scan</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">set</span><span class="o">=</span><span class="n">set</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="n">back</span><span class="p">)</span>
<a name="ln-481"></a>  <span class="k">else</span>
<a name="ln-482"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-483"></a>  <span class="n">endif</span>
<a name="ln-484"></a>  <span class="k">return</span>
<a name="ln-485"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-486"></a>  <span class="n">endfunction</span> <span class="n">sscan_string_string</span>
<a name="ln-487"></a>
<a name="ln-488"></a>  <span class="k">elemental function </span><span class="n">sscan_string_character</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">set</span><span class="p">,</span> <span class="n">back</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-489"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-490"></a>  <span class="c">!&lt; Return the leftmost (if `back` is either absent or equals false, otherwise the rightmost) character of string that is in `set`.</span>
<a name="ln-491"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-492"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>  <span class="c">!&lt; The string.</span>
<a name="ln-493"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">set</span>   <span class="c">!&lt; Searched set.</span>
<a name="ln-494"></a>  <span class="kt">logical</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">back</span>  <span class="c">!&lt; Start of the last occurrence rather than the first.</span>
<a name="ln-495"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">i</span>     <span class="c">!&lt; Result of the search.</span>
<a name="ln-496"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-497"></a>
<a name="ln-498"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-499"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-500"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="nb">scan</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">set</span><span class="o">=</span><span class="n">set</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="n">back</span><span class="p">)</span>
<a name="ln-501"></a>  <span class="k">else</span>
<a name="ln-502"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-503"></a>  <span class="n">endif</span>
<a name="ln-504"></a>  <span class="k">return</span>
<a name="ln-505"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-506"></a>  <span class="n">endfunction</span> <span class="n">sscan_string_character</span>
<a name="ln-507"></a>
<a name="ln-508"></a>  <span class="k">elemental function </span><span class="n">sscan_character_string</span><span class="p">(</span><span class="n">sstring</span><span class="p">,</span> <span class="n">set</span><span class="p">,</span> <span class="n">back</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-509"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-510"></a>  <span class="c">!&lt; Return the leftmost (if `back` is either absent or equals false, otherwise the rightmost) character of string that is in `set`.</span>
<a name="ln-511"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-512"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">sstring</span> <span class="c">!&lt; The string.</span>
<a name="ln-513"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>              <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">set</span>     <span class="c">!&lt; Searched set.</span>
<a name="ln-514"></a>  <span class="kt">logical</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">back</span>    <span class="c">!&lt; Start of the last occurrence rather than the first.</span>
<a name="ln-515"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">i</span>       <span class="c">!&lt; Result of the search.</span>
<a name="ln-516"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-517"></a>
<a name="ln-518"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-519"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">set</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-520"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="nb">scan</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">sstring</span><span class="p">,</span> <span class="n">set</span><span class="o">=</span><span class="n">set</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="n">back</span><span class="p">)</span>
<a name="ln-521"></a>  <span class="k">else</span>
<a name="ln-522"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-523"></a>  <span class="n">endif</span>
<a name="ln-524"></a>  <span class="k">return</span>
<a name="ln-525"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-526"></a>  <span class="n">endfunction</span> <span class="n">sscan_character_string</span>
<a name="ln-527"></a>
<a name="ln-528"></a>  <span class="k">elemental function </span><span class="n">strim</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">trimmed</span><span class="p">)</span>
<a name="ln-529"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-530"></a>  <span class="c">!&lt; Remove leading spaces.</span>
<a name="ln-531"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-532"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">!&lt; The string.</span>
<a name="ln-533"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">trimmed</span> <span class="c">!&lt; Trimmed string.</span>
<a name="ln-534"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-535"></a>
<a name="ln-536"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-537"></a>  <span class="n">trimmed</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-538"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">trimmed</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">trimmed</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">trimmed</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-539"></a>  <span class="k">return</span>
<a name="ln-540"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-541"></a>  <span class="n">endfunction</span> <span class="n">strim</span>
<a name="ln-542"></a>
<a name="ln-543"></a>  <span class="k">elemental function </span><span class="n">sverify</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">set</span><span class="p">,</span> <span class="n">back</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-544"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-545"></a>  <span class="c">!&lt; Return the leftmost (if `back` is either absent or equals false, otherwise the rightmost) character of string that is not</span>
<a name="ln-546"></a>  <span class="c">!&lt; in `set`. If all characters of `string` are found in `set`, the result is zero.</span>
<a name="ln-547"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-548"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>  <span class="c">!&lt; The string.</span>
<a name="ln-549"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">set</span>   <span class="c">!&lt; Searched set.</span>
<a name="ln-550"></a>  <span class="kt">logical</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">back</span>  <span class="c">!&lt; Start of the last occurrence rather than the first.</span>
<a name="ln-551"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">i</span>     <span class="c">!&lt; Result of the search.</span>
<a name="ln-552"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-553"></a>
<a name="ln-554"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-555"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-556"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="nb">verify</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">set</span><span class="o">=</span><span class="n">set</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="n">back</span><span class="p">)</span>
<a name="ln-557"></a>  <span class="k">else</span>
<a name="ln-558"></a><span class="k">    </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-559"></a>  <span class="n">endif</span>
<a name="ln-560"></a>  <span class="k">return</span>
<a name="ln-561"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-562"></a>  <span class="n">endfunction</span> <span class="n">sverify</span>
<a name="ln-563"></a>
<a name="ln-564"></a>  <span class="c">! auxiliary methods</span>
<a name="ln-565"></a>  <span class="k">elemental function </span><span class="n">basedir</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
<a name="ln-566"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-567"></a>  <span class="c">!&lt; Return the base directory name of a string containing a file name.</span>
<a name="ln-568"></a>  <span class="c">!&lt;</span>
<a name="ln-569"></a>  <span class="c">!&lt;### Example</span>
<a name="ln-570"></a>  <span class="c">!&lt;</span>
<a name="ln-571"></a>  <span class="c">!&lt;```fortran</span>
<a name="ln-572"></a>  <span class="c">!&lt; type(string) :: astring</span>
<a name="ln-573"></a>  <span class="c">!&lt; astring = &#39;/bar/foo.tar.bz2&#39;</span>
<a name="ln-574"></a>  <span class="c">!&lt; print &#39;(A)&#39;, astring%basedir()//&#39;&#39; ! print &quot;/bar&quot;</span>
<a name="ln-575"></a>  <span class="c">!&lt;```</span>
<a name="ln-576"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-577"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>    <span class="c">!&lt; The string.</span>
<a name="ln-578"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>     <span class="c">!&lt; Directory separator.</span>
<a name="ln-579"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">basedir</span> <span class="c">!&lt; Base directory name.</span>
<a name="ln-580"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">sep_</span>    <span class="c">!&lt; Separator, default value.</span>
<a name="ln-581"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">pos</span>     <span class="c">!&lt; Character position.</span>
<a name="ln-582"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-583"></a>
<a name="ln-584"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-585"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-586"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="n">UIX_DIR_SEP</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span> <span class="n">sep_</span> <span class="o">=</span> <span class="n">sep</span>
<a name="ln-587"></a>    <span class="n">basedir</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-588"></a>    <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">sep_</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-589"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">basedir</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-590"></a>  <span class="n">endif</span>
<a name="ln-591"></a>  <span class="k">return</span>
<a name="ln-592"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-593"></a>  <span class="n">endfunction</span> <span class="n">basedir</span>
<a name="ln-594"></a>
<a name="ln-595"></a>  <span class="k">elemental function </span><span class="n">basename</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">extension</span><span class="p">,</span> <span class="n">strip_last_extension</span><span class="p">)</span>
<a name="ln-596"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-597"></a>  <span class="c">!&lt; Return the base file name of a string containing a file name.</span>
<a name="ln-598"></a>  <span class="c">!&lt;</span>
<a name="ln-599"></a>  <span class="c">!&lt; Optionally, the extension is also stripped if provided or the last one if required, e.g.</span>
<a name="ln-600"></a>  <span class="c">!&lt;</span>
<a name="ln-601"></a>  <span class="c">!&lt;### Example</span>
<a name="ln-602"></a>  <span class="c">!&lt;</span>
<a name="ln-603"></a>  <span class="c">!&lt;```fortran</span>
<a name="ln-604"></a>  <span class="c">!&lt; type(string) :: astring</span>
<a name="ln-605"></a>  <span class="c">!&lt; astring = &#39;bar/foo.tar.bz2&#39;</span>
<a name="ln-606"></a>  <span class="c">!&lt; print &#39;(A)&#39;, astring%basename(extension=&#39;.tar.bz2&#39;)//&#39;&#39;        ! print &quot;foo&quot;</span>
<a name="ln-607"></a>  <span class="c">!&lt; print &#39;(A)&#39;, astring%basename(strip_last_extension=.true.)//&#39;&#39; ! print &quot;foo.tar&quot;</span>
<a name="ln-608"></a>  <span class="c">!&lt;```</span>
<a name="ln-609"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-610"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>                 <span class="c">!&lt; The string.</span>
<a name="ln-611"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>                  <span class="c">!&lt; Directory separator.</span>
<a name="ln-612"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">extension</span>            <span class="c">!&lt; File extension.</span>
<a name="ln-613"></a>  <span class="kt">logical</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">strip_last_extension</span> <span class="c">!&lt; Flag to enable the stripping of last extension.</span>
<a name="ln-614"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">basename</span>             <span class="c">!&lt; Base file name.</span>
<a name="ln-615"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">sep_</span>                 <span class="c">!&lt; Separator, default value.</span>
<a name="ln-616"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">pos</span>                  <span class="c">!&lt; Character position.</span>
<a name="ln-617"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-618"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">temporary</span>            <span class="c">!&lt; Temporary storage, workaround for GNU bug.</span>
<a name="ln-619"></a><span class="cp">#endif</span>
<a name="ln-620"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-621"></a>
<a name="ln-622"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-623"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-624"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="n">UIX_DIR_SEP</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span> <span class="n">sep_</span> <span class="o">=</span> <span class="n">sep</span>
<a name="ln-625"></a>    <span class="n">basename</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-626"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-627"></a>    <span class="n">temporary</span> <span class="o">=</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-628"></a>    <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">temporary</span><span class="p">,</span> <span class="n">sep_</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-629"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">(</span><span class="n">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-630"></a><span class="cp">#else</span>
<a name="ln-631"></a>    <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">basename</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">sep_</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-632"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-633"></a><span class="cp">#endif</span>
<a name="ln-634"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">extension</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-635"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-636"></a>      <span class="n">temporary</span> <span class="o">=</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-637"></a>      <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">temporary</span><span class="p">,</span> <span class="n">extension</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-638"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-639"></a><span class="cp">#else</span>
<a name="ln-640"></a>      <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">basename</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">extension</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-641"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-642"></a><span class="cp">#endif</span>
<a name="ln-643"></a>    <span class="n">elseif</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">strip_last_extension</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-644"></a><span class="k">      if</span> <span class="p">(</span><span class="n">strip_last_extension</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-645"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-646"></a>        <span class="n">temporary</span> <span class="o">=</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-647"></a>        <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">temporary</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-648"></a>        <span class="n">basename</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-649"></a><span class="cp">#else</span>
<a name="ln-650"></a>        <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">basename</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-651"></a>        <span class="n">basename</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">basename</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-652"></a><span class="cp">#endif</span>
<a name="ln-653"></a>      <span class="n">endif</span>
<a name="ln-654"></a>    <span class="n">endif</span>
<a name="ln-655"></a>  <span class="n">endif</span>
<a name="ln-656"></a>  <span class="k">return</span>
<a name="ln-657"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-658"></a>  <span class="n">endfunction</span> <span class="n">basename</span>
<a name="ln-659"></a>
<a name="ln-660"></a>  <span class="k">elemental function </span><span class="n">camelcase</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
<a name="ln-661"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-662"></a>  <span class="c">!&lt; Return a string with all words capitalized without spaces.</span>
<a name="ln-663"></a>  <span class="c">!&lt;</span>
<a name="ln-664"></a>  <span class="c">!&lt; @note Multiple subsequent separators are collapsed to one occurence.</span>
<a name="ln-665"></a>  <span class="c">!&lt;</span>
<a name="ln-666"></a>  <span class="c">!&lt;### Example</span>
<a name="ln-667"></a>  <span class="c">!&lt;</span>
<a name="ln-668"></a>  <span class="c">!&lt;```fortran</span>
<a name="ln-669"></a>  <span class="c">!&lt; type(string) :: astring</span>
<a name="ln-670"></a>  <span class="c">!&lt; astring = &#39;caMeL caSe var&#39;</span>
<a name="ln-671"></a>  <span class="c">!&lt; print &#39;(A)&#39;, astring%camelcase()//&#39;&#39; ! print &quot;CamelCaseVar&quot;</span>
<a name="ln-672"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-673"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-674"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>       <span class="c">!&lt; Separator.</span>
<a name="ln-675"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">camelcase</span> <span class="c">!&lt; Camel case string.</span>
<a name="ln-676"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">allocatable</span>                       <span class="kd">::</span> <span class="n">tokens</span><span class="p">(:)</span> <span class="c">!&lt; String tokens.</span>
<a name="ln-677"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-678"></a>
<a name="ln-679"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-680"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-681"></a><span class="k">    call </span><span class="n">self</span><span class="p">%</span><span class="n">split</span><span class="p">(</span><span class="n">tokens</span><span class="o">=</span><span class="n">tokens</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">)</span>
<a name="ln-682"></a>    <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">%</span><span class="n">capitalize</span><span class="p">()</span>
<a name="ln-683"></a>    <span class="n">camelcase</span> <span class="o">=</span> <span class="n">camelcase</span><span class="p">%</span><span class="n">join</span><span class="p">(</span><span class="k">array</span><span class="o">=</span><span class="n">tokens</span><span class="p">)</span>
<a name="ln-684"></a>  <span class="n">endif</span>
<a name="ln-685"></a>  <span class="k">return</span>
<a name="ln-686"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-687"></a>  <span class="n">endfunction</span> <span class="n">camelcase</span>
<a name="ln-688"></a>
<a name="ln-689"></a>  <span class="k">elemental function </span><span class="n">capitalize</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">capitalized</span><span class="p">)</span>
<a name="ln-690"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-691"></a>  <span class="c">!&lt; Return a string with its first character capitalized and the rest lowercased.</span>
<a name="ln-692"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-693"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>        <span class="c">!&lt; The string.</span>
<a name="ln-694"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">capitalized</span> <span class="c">!&lt; Upper case string.</span>
<a name="ln-695"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">c</span>           <span class="c">!&lt; Character counter.</span>
<a name="ln-696"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-697"></a>
<a name="ln-698"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-699"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-700"></a><span class="k">    </span><span class="n">capitalized</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">lower</span><span class="p">()</span>
<a name="ln-701"></a>    <span class="n">c</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">LOWER_ALPHABET</span><span class="p">,</span> <span class="n">capitalized</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-702"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">c</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">capitalized</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">UPPER_ALPHABET</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span>
<a name="ln-703"></a>  <span class="n">endif</span>
<a name="ln-704"></a>  <span class="k">return</span>
<a name="ln-705"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-706"></a>  <span class="n">endfunction</span> <span class="n">capitalize</span>
<a name="ln-707"></a>
<a name="ln-708"></a>  <span class="k">pure function </span><span class="n">chars</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-709"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-710"></a>  <span class="c">!&lt; Return the raw characters data.</span>
<a name="ln-711"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-712"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">self</span> <span class="c">!&lt; The string.</span>
<a name="ln-713"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">raw</span>  <span class="c">!&lt; Raw characters data.</span>
<a name="ln-714"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-715"></a>
<a name="ln-716"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-717"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-718"></a><span class="k">    </span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-719"></a>  <span class="k">else</span>
<a name="ln-720"></a><span class="k">    </span><span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-721"></a>  <span class="n">endif</span>
<a name="ln-722"></a>  <span class="k">return</span>
<a name="ln-723"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-724"></a>  <span class="n">endfunction</span> <span class="n">chars</span>
<a name="ln-725"></a>
<a name="ln-726"></a>  <span class="k">elemental function decode</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">codec</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">decoded</span><span class="p">)</span>
<a name="ln-727"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-728"></a>  <span class="c">!&lt; Return a string decoded accordingly the codec.</span>
<a name="ln-729"></a>  <span class="c">!&lt;</span>
<a name="ln-730"></a>  <span class="c">!&lt; @note Only BASE64 codec is currently available.</span>
<a name="ln-731"></a>  <span class="c">!&lt;</span>
<a name="ln-732"></a>  <span class="c">!&lt;### Example</span>
<a name="ln-733"></a>  <span class="c">!&lt;</span>
<a name="ln-734"></a>  <span class="c">!&lt;```fortran</span>
<a name="ln-735"></a>  <span class="c">!&lt; type(string) :: astring</span>
<a name="ln-736"></a>  <span class="c">!&lt; astring = &#39;SG93IGFyZSB5b3U/&#39;</span>
<a name="ln-737"></a>  <span class="c">!&lt; print &#39;(A)&#39;, astring%decode(codec=&#39;base64&#39;)//&#39;&#39; ! print &quot;How are you?&quot;</span>
<a name="ln-738"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-739"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">!&lt; The string.</span>
<a name="ln-740"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">codec</span>   <span class="c">!&lt; Encoding codec.</span>
<a name="ln-741"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">decoded</span> <span class="c">!&lt; Decoded string.</span>
<a name="ln-742"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">codec_u</span> <span class="c">!&lt; Encoding codec in upper case string.</span>
<a name="ln-743"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-744"></a>
<a name="ln-745"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-746"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-747"></a><span class="k">    </span><span class="n">decoded</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-748"></a>    <span class="n">codec_u</span> <span class="o">=</span> <span class="n">codec</span>
<a name="ln-749"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">codec_u</span><span class="p">%</span><span class="n">upper</span><span class="p">()</span><span class="o">//</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-750"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;BASE64&#39;</span><span class="p">)</span>
<a name="ln-751"></a>      <span class="k">call </span><span class="n">b64_decode</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">decoded</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-752"></a>    <span class="n">endselect</span>
<a name="ln-753"></a>    <span class="n">decoded</span> <span class="o">=</span> <span class="n">decoded</span><span class="p">%</span><span class="n">strip</span><span class="p">(</span><span class="n">remove_nulls</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-754"></a>  <span class="n">endif</span>
<a name="ln-755"></a>  <span class="k">return</span>
<a name="ln-756"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-757"></a>  <span class="n">endfunction</span> <span class="k">decode</span>
<a name="ln-758"></a>
<a name="ln-759"></a><span class="k">  elemental function encode</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">codec</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">encoded</span><span class="p">)</span>
<a name="ln-760"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-761"></a>  <span class="c">!&lt; Return a string encoded accordingly the codec.</span>
<a name="ln-762"></a>  <span class="c">!&lt;</span>
<a name="ln-763"></a>  <span class="c">!&lt; @note Only BASE64 codec is currently available.</span>
<a name="ln-764"></a>  <span class="c">!&lt;</span>
<a name="ln-765"></a>  <span class="c">!&lt;### Example</span>
<a name="ln-766"></a>  <span class="c">!&lt;</span>
<a name="ln-767"></a>  <span class="c">!&lt;```fortran</span>
<a name="ln-768"></a>  <span class="c">!&lt; type(string) :: astring</span>
<a name="ln-769"></a>  <span class="c">!&lt; astring = &#39;How are you?&#39;</span>
<a name="ln-770"></a>  <span class="c">!&lt; print &#39;(A)&#39;, astring%encode(codec=&#39;base64&#39;)//&#39;&#39; ! print &quot;SG93IGFyZSB5b3U/&quot;</span>
<a name="ln-771"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-772"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">!&lt; The string.</span>
<a name="ln-773"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">codec</span>   <span class="c">!&lt; Encoding codec.</span>
<a name="ln-774"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">encoded</span> <span class="c">!&lt; Encoded string.</span>
<a name="ln-775"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-776"></a>
<a name="ln-777"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-778"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-779"></a><span class="k">    </span><span class="n">encoded</span> <span class="o">=</span> <span class="n">codec</span>
<a name="ln-780"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">encoded</span><span class="p">%</span><span class="n">upper</span><span class="p">()</span><span class="o">//</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-781"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;BASE64&#39;</span><span class="p">)</span>
<a name="ln-782"></a>      <span class="k">call </span><span class="n">b64_encode</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="n">encoded</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-783"></a>    <span class="n">endselect</span>
<a name="ln-784"></a>  <span class="n">endif</span>
<a name="ln-785"></a>  <span class="k">return</span>
<a name="ln-786"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-787"></a>  <span class="n">endfunction</span> <span class="k">encode</span>
<a name="ln-788"></a>
<a name="ln-789"></a><span class="k">  elemental function </span><span class="n">escape</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">to_escape</span><span class="p">,</span> <span class="n">esc</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">escaped</span><span class="p">)</span>
<a name="ln-790"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-791"></a>  <span class="c">!&lt; Escape backslashes (or custom escape character).</span>
<a name="ln-792"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-793"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-794"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">to_escape</span> <span class="c">!&lt; Character to be escaped.</span>
<a name="ln-795"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">esc</span>       <span class="c">!&lt; Character used to escape.</span>
<a name="ln-796"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">escaped</span>   <span class="c">!&lt; Escaped string.</span>
<a name="ln-797"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">esc_</span>      <span class="c">!&lt; Character to escape, local variable.</span>
<a name="ln-798"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">c</span>         <span class="c">!&lt; Character counter.</span>
<a name="ln-799"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-800"></a>
<a name="ln-801"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-802"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-803"></a><span class="k">    </span><span class="n">esc_</span> <span class="o">=</span> <span class="n">BACKSLASH</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">esc</span><span class="p">))</span> <span class="n">esc_</span> <span class="o">=</span> <span class="n">esc</span>
<a name="ln-804"></a>    <span class="n">escaped</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-805"></a>    <span class="k">do </span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-806"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span><span class="o">==</span><span class="n">to_escape</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-807"></a><span class="k">        </span><span class="n">escaped</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">escaped</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">esc_</span><span class="o">//</span><span class="n">to_escape</span>
<a name="ln-808"></a>      <span class="k">else</span>
<a name="ln-809"></a><span class="k">        </span><span class="n">escaped</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">escaped</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span>
<a name="ln-810"></a>      <span class="n">endif</span>
<a name="ln-811"></a>    <span class="n">enddo</span>
<a name="ln-812"></a>  <span class="n">endif</span>
<a name="ln-813"></a>  <span class="k">return</span>
<a name="ln-814"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-815"></a>  <span class="n">endfunction</span> <span class="n">escape</span>
<a name="ln-816"></a>
<a name="ln-817"></a>  <span class="k">elemental function </span><span class="n">extension</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-818"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-819"></a>  <span class="c">!&lt; Return the extension of a string containing a file name.</span>
<a name="ln-820"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-821"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-822"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                           <span class="kd">::</span> <span class="n">extension</span> <span class="c">!&lt; Extension file name.</span>
<a name="ln-823"></a>  <span class="kt">integer</span>                                <span class="kd">::</span> <span class="n">pos</span>       <span class="c">!&lt; Character position.</span>
<a name="ln-824"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-825"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">temporary</span> <span class="c">!&lt; Temporary storage, workaround for GNU bug.</span>
<a name="ln-826"></a><span class="cp">#endif</span>
<a name="ln-827"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-828"></a>
<a name="ln-829"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-830"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-831"></a><span class="k">    </span><span class="n">extension</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-832"></a>    <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-833"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-834"></a>    <span class="n">temporary</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-835"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">extension</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">(</span><span class="n">pos</span><span class="p">:)</span>
<a name="ln-836"></a><span class="cp">#else</span>
<a name="ln-837"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">extension</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">pos</span><span class="p">:)</span>
<a name="ln-838"></a><span class="cp">#endif</span>
<a name="ln-839"></a>  <span class="n">endif</span>
<a name="ln-840"></a>  <span class="k">return</span>
<a name="ln-841"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-842"></a>  <span class="n">endfunction</span> <span class="n">extension</span>
<a name="ln-843"></a>
<a name="ln-844"></a>  <span class="k">elemental function </span><span class="n">fill</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">filling_char</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">filled</span><span class="p">)</span>
<a name="ln-845"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-846"></a>  <span class="c">!&lt; Pad string on the left (or right) with zeros (or other char) to fill width.</span>
<a name="ln-847"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-848"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>          <span class="c">!&lt; The string.</span>
<a name="ln-849"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">width</span>         <span class="c">!&lt; Final width of filled string.</span>
<a name="ln-850"></a>  <span class="kt">logical</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">right</span>         <span class="c">!&lt; Fill on the right instead of left.</span>
<a name="ln-851"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">filling_char</span>  <span class="c">!&lt; Filling character (default &quot;0&quot;).</span>
<a name="ln-852"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">filled</span>        <span class="c">!&lt; Filled string.</span>
<a name="ln-853"></a>  <span class="kt">logical</span>                                         <span class="kd">::</span> <span class="n">right_</span>        <span class="c">!&lt; Fill on the right instead of left, local variable.</span>
<a name="ln-854"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">filling_char_</span> <span class="c">!&lt; Filling character (default &quot;0&quot;), local variable.</span>
<a name="ln-855"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-856"></a>
<a name="ln-857"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-858"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-859"></a><span class="k">    if</span> <span class="p">(</span><span class="n">width</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-860"></a><span class="k">      </span><span class="n">right_</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">right</span><span class="p">))</span> <span class="n">right_</span> <span class="o">=</span> <span class="n">right</span>
<a name="ln-861"></a>      <span class="n">filling_char_</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">filling_char</span><span class="p">))</span> <span class="n">filling_char_</span> <span class="o">=</span> <span class="n">filling_char</span>
<a name="ln-862"></a>      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">right_</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-863"></a><span class="k">        </span><span class="n">filled</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="n">filling_char_</span><span class="p">,</span> <span class="n">width</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-864"></a>      <span class="k">else</span>
<a name="ln-865"></a><span class="k">        </span><span class="n">filled</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="nb">repeat</span><span class="p">(</span><span class="n">filling_char_</span><span class="p">,</span> <span class="n">width</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span>
<a name="ln-866"></a>      <span class="n">endif</span>
<a name="ln-867"></a>    <span class="n">endif</span>
<a name="ln-868"></a>  <span class="n">endif</span>
<a name="ln-869"></a>  <span class="k">return</span>
<a name="ln-870"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-871"></a>  <span class="n">endfunction</span> <span class="n">fill</span>
<a name="ln-872"></a>
<a name="ln-873"></a>  <span class="k">elemental subroutine </span><span class="n">free</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-874"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-875"></a>  <span class="c">!&lt; Free dynamic memory.</span>
<a name="ln-876"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-877"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span> <span class="c">!&lt; The string.</span>
<a name="ln-878"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-879"></a>
<a name="ln-880"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-881"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-882"></a>  <span class="k">return</span>
<a name="ln-883"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-884"></a>  <span class="n">endsubroutine</span> <span class="n">free</span>
<a name="ln-885"></a>
<a name="ln-886"></a>  <span class="k">elemental function </span><span class="n">insert_character</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">substring</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">inserted</span><span class="p">)</span>
<a name="ln-887"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-888"></a>  <span class="c">!&lt; Insert substring into string at a specified position.</span>
<a name="ln-889"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-890"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-891"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">substring</span> <span class="c">!&lt; Substring.</span>
<a name="ln-892"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pos</span>       <span class="c">!&lt; Position from which insert substring.</span>
<a name="ln-893"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">inserted</span>  <span class="c">!&lt; Inserted string.</span>
<a name="ln-894"></a>  <span class="kt">integer</span>                      <span class="kd">::</span> <span class="n">safepos</span>   <span class="c">!&lt; Safe position from which insert substring.</span>
<a name="ln-895"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-896"></a>
<a name="ln-897"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-898"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-899"></a><span class="k">    </span><span class="n">inserted</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-900"></a>    <span class="n">safepos</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span>
<a name="ln-901"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">safepos</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-902"></a><span class="k">      </span><span class="n">inserted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">substring</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-903"></a>    <span class="n">elseif</span> <span class="p">(</span><span class="n">safepos</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-904"></a><span class="k">      </span><span class="n">inserted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">substring</span>
<a name="ln-905"></a>    <span class="k">else</span>
<a name="ln-906"></a><span class="k">      </span><span class="n">inserted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">safepos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">substring</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">safepos</span><span class="p">:)</span>
<a name="ln-907"></a>    <span class="n">endif</span>
<a name="ln-908"></a>  <span class="k">else</span>
<a name="ln-909"></a><span class="k">    </span><span class="n">inserted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">substring</span>
<a name="ln-910"></a>  <span class="n">endif</span>
<a name="ln-911"></a>  <span class="k">return</span>
<a name="ln-912"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-913"></a>  <span class="n">endfunction</span> <span class="n">insert_character</span>
<a name="ln-914"></a>
<a name="ln-915"></a>  <span class="k">elemental function </span><span class="n">insert_string</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">substring</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">inserted</span><span class="p">)</span>
<a name="ln-916"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-917"></a>  <span class="c">!&lt; Insert substring into string at a specified position.</span>
<a name="ln-918"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-919"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-920"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">substring</span> <span class="c">!&lt; Substring.</span>
<a name="ln-921"></a>  <span class="kt">integer</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pos</span>       <span class="c">!&lt; Position from which insert substring.</span>
<a name="ln-922"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">inserted</span>  <span class="c">!&lt; Inserted string.</span>
<a name="ln-923"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">safepos</span>   <span class="c">!&lt; Safe position from which insert substring.</span>
<a name="ln-924"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-925"></a>
<a name="ln-926"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-927"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-928"></a><span class="k">    </span><span class="n">inserted</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-929"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">substring</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-930"></a><span class="k">      </span><span class="n">safepos</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span>
<a name="ln-931"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">safepos</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-932"></a><span class="k">        </span><span class="n">inserted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">substring</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-933"></a>      <span class="n">elseif</span> <span class="p">(</span><span class="n">safepos</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-934"></a><span class="k">        </span><span class="n">inserted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">substring</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-935"></a>      <span class="k">else</span>
<a name="ln-936"></a><span class="k">        </span><span class="n">inserted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">safepos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">substring</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">safepos</span><span class="p">:)</span>
<a name="ln-937"></a>      <span class="n">endif</span>
<a name="ln-938"></a>    <span class="n">endif</span>
<a name="ln-939"></a>  <span class="k">else</span>
<a name="ln-940"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">substring</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">inserted</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">substring</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-941"></a>  <span class="n">endif</span>
<a name="ln-942"></a>  <span class="k">return</span>
<a name="ln-943"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-944"></a>  <span class="n">endfunction</span> <span class="n">insert_string</span>
<a name="ln-945"></a>
<a name="ln-946"></a>  <span class="k">pure function </span><span class="n">join_strings</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="k">array</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">join</span><span class="p">)</span>
<a name="ln-947"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-948"></a>  <span class="c">!&lt; Return a string that is a join of an array of strings.</span>
<a name="ln-949"></a>  <span class="c">!&lt;</span>
<a name="ln-950"></a>  <span class="c">!&lt; The join-separator is set equals to self if self has a value or it is set to a null string &#39;&#39;. This value can be overridden</span>
<a name="ln-951"></a>  <span class="c">!&lt; passing a custom separator.</span>
<a name="ln-952"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-953"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-954"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>              <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">:)</span> <span class="c">!&lt; Array to be joined.</span>
<a name="ln-955"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>       <span class="c">!&lt; Separator.</span>
<a name="ln-956"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">join</span>      <span class="c">!&lt; The join of array.</span>
<a name="ln-957"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">sep_</span>      <span class="c">!&lt; Separator, default value.</span>
<a name="ln-958"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">a</span>         <span class="c">!&lt; Counter.</span>
<a name="ln-959"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-960"></a>
<a name="ln-961"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-962"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-963"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-964"></a>  <span class="k">else</span>
<a name="ln-965"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-966"></a>  <span class="n">endif</span>
<a name="ln-967"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span> <span class="n">sep_</span> <span class="o">=</span> <span class="n">sep</span>
<a name="ln-968"></a>  <span class="n">join</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-969"></a>  <span class="k">do </span><span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="k">array</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-970"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="n">a</span><span class="p">)%</span><span class="n">raw</span><span class="p">))</span> <span class="n">join</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">join</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">sep_</span><span class="o">//</span><span class="k">array</span><span class="p">(</span><span class="n">a</span><span class="p">)%</span><span class="n">raw</span>
<a name="ln-971"></a>  <span class="n">enddo</span>
<a name="ln-972"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-973"></a><span class="k">    </span><span class="n">join</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">raw</span><span class="o">//</span><span class="n">join</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-974"></a>  <span class="k">else</span>
<a name="ln-975"></a><span class="k">    </span><span class="n">join</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">join</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">join</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span>
<a name="ln-976"></a>  <span class="n">endif</span>
<a name="ln-977"></a>  <span class="k">return</span>
<a name="ln-978"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-979"></a>  <span class="n">endfunction</span> <span class="n">join_strings</span>
<a name="ln-980"></a>
<a name="ln-981"></a>  <span class="k">pure function </span><span class="n">join_characters</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="k">array</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">join</span><span class="p">)</span>
<a name="ln-982"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-983"></a>  <span class="c">!&lt; Return a string that is a join of an array of characters.</span>
<a name="ln-984"></a>  <span class="c">!&lt;</span>
<a name="ln-985"></a>  <span class="c">!&lt; The join-separator is set equals to self if self has a value or it is set to a null string &#39;&#39;. This value can be overridden</span>
<a name="ln-986"></a>  <span class="c">!&lt; passing a custom separator.</span>
<a name="ln-987"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-988"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-989"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">:)</span> <span class="c">!&lt; Array to be joined.</span>
<a name="ln-990"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>       <span class="c">!&lt; Separator.</span>
<a name="ln-991"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">join</span>      <span class="c">!&lt; The join of array.</span>
<a name="ln-992"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">sep_</span>      <span class="c">!&lt; Separator, default value.</span>
<a name="ln-993"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">a</span>         <span class="c">!&lt; Counter.</span>
<a name="ln-994"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-995"></a>
<a name="ln-996"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-997"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-998"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-999"></a>  <span class="k">else</span>
<a name="ln-1000"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1001"></a>  <span class="n">endif</span>
<a name="ln-1002"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span> <span class="n">sep_</span> <span class="o">=</span> <span class="n">sep</span>
<a name="ln-1003"></a>  <span class="n">join</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1004"></a>  <span class="k">do </span><span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="k">array</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1005"></a>    <span class="k">if</span> <span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="n">join</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">join</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">sep_</span><span class="o">//</span><span class="k">array</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a name="ln-1006"></a>  <span class="n">enddo</span>
<a name="ln-1007"></a>  <span class="k">if</span> <span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1008"></a><span class="k">    </span><span class="n">join</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">join</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-1009"></a>  <span class="k">else</span>
<a name="ln-1010"></a><span class="k">    </span><span class="n">join</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">join</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">join</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span>
<a name="ln-1011"></a>  <span class="n">endif</span>
<a name="ln-1012"></a>  <span class="k">return</span>
<a name="ln-1013"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1014"></a>  <span class="n">endfunction</span> <span class="n">join_characters</span>
<a name="ln-1015"></a>
<a name="ln-1016"></a>  <span class="k">elemental function </span><span class="n">lower</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-1017"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1018"></a>  <span class="c">!&lt; Return a string with all lowercase characters.</span>
<a name="ln-1019"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1020"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>  <span class="c">!&lt; The string.</span>
<a name="ln-1021"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">lower</span> <span class="c">!&lt; Upper case string.</span>
<a name="ln-1022"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">n1</span>    <span class="c">!&lt; Characters counter.</span>
<a name="ln-1023"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">n2</span>    <span class="c">!&lt; Characters counter.</span>
<a name="ln-1024"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1025"></a>
<a name="ln-1026"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1027"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1028"></a><span class="k">    </span><span class="n">lower</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-1029"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-1030"></a>      <span class="n">n2</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">UPPER_ALPHABET</span><span class="p">,</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">))</span>
<a name="ln-1031"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">n2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">lower</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="n">LOWER_ALPHABET</span><span class="p">(</span><span class="n">n2</span><span class="p">:</span><span class="n">n2</span><span class="p">)</span>
<a name="ln-1032"></a>    <span class="n">enddo</span>
<a name="ln-1033"></a>  <span class="n">endif</span>
<a name="ln-1034"></a>  <span class="k">return</span>
<a name="ln-1035"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1036"></a>  <span class="n">endfunction</span> <span class="n">lower</span>
<a name="ln-1037"></a>
<a name="ln-1038"></a>  <span class="k">pure function </span><span class="n">partition</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">partitions</span><span class="p">)</span>
<a name="ln-1039"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1040"></a>  <span class="c">!&lt; Split string at separator and return the 3 parts (before, the separator and after).</span>
<a name="ln-1041"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1042"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>            <span class="c">!&lt; The string.</span>
<a name="ln-1043"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>             <span class="c">!&lt; Separator.</span>
<a name="ln-1044"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">partitions</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="c">!&lt; Partions: before the separator, the separator itsels and</span>
<a name="ln-1045"></a>                                                                     <span class="c">!&lt; after the separator.</span>
<a name="ln-1046"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">sep_</span>            <span class="c">!&lt; Separator, default value.</span>
<a name="ln-1047"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">c</span>               <span class="c">!&lt; Character counter.</span>
<a name="ln-1048"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-1049"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">temporary</span>       <span class="c">!&lt; Temporary storage, workaround for GNU bug.</span>
<a name="ln-1050"></a><span class="cp">#endif</span>
<a name="ln-1051"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1052"></a>
<a name="ln-1053"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1054"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1055"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="n">SPACE</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span> <span class="n">sep_</span> <span class="o">=</span> <span class="n">sep</span>
<a name="ln-1056"></a>
<a name="ln-1057"></a>    <span class="n">partitions</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-1058"></a>    <span class="n">partitions</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">sep_</span>
<a name="ln-1059"></a>    <span class="n">partitions</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1060"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span><span class="o">&gt;=</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">return</span>
<a name="ln-1061"></a><span class="k">    </span><span class="n">c</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">sep_</span><span class="p">)</span>
<a name="ln-1062"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">c</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1063"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-1064"></a>      <span class="n">temporary</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-1065"></a>      <span class="n">partitions</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1066"></a>      <span class="n">partitions</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1067"></a>      <span class="n">partitions</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">sep_</span><span class="p">):)</span>
<a name="ln-1068"></a><span class="cp">#else</span>
<a name="ln-1069"></a>      <span class="n">partitions</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1070"></a>      <span class="n">partitions</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1071"></a>      <span class="n">partitions</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">sep_</span><span class="p">):)</span>
<a name="ln-1072"></a><span class="cp">#endif</span>
<a name="ln-1073"></a>    <span class="n">endif</span>
<a name="ln-1074"></a>  <span class="n">endif</span>
<a name="ln-1075"></a>  <span class="k">return</span>
<a name="ln-1076"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1077"></a>  <span class="n">endfunction</span> <span class="n">partition</span>
<a name="ln-1078"></a>
<a name="ln-1079"></a>  <span class="k">subroutine </span><span class="n">read_file</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="k">file</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-1080"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1081"></a>  <span class="c">!&lt; Read a file as a single string stream.</span>
<a name="ln-1082"></a>  <span class="c">!&lt;</span>
<a name="ln-1083"></a>  <span class="c">!&lt; @note All the lines are stored into the string self as a single ascii stream. Each line (record) is separated by a `new_line`</span>
<a name="ln-1084"></a>  <span class="c">!&lt; character.</span>
<a name="ln-1085"></a>  <span class="c">!&lt;</span>
<a name="ln-1086"></a>  <span class="c">!&lt; @note For unformatted read only `access=&#39;stream&#39;` is supported with new_line as line terminator.</span>
<a name="ln-1087"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1088"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>       <span class="c">!&lt; The string.</span>
<a name="ln-1089"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="k">file</span>       <span class="c">!&lt; File name.</span>
<a name="ln-1090"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span>    <span class="k">optional</span> <span class="kd">::</span> <span class="n">form</span>       <span class="c">!&lt; Format of unit.</span>
<a name="ln-1091"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span>   <span class="k">optional</span> <span class="kd">::</span> <span class="n">iostat</span>     <span class="c">!&lt; IO status code.</span>
<a name="ln-1092"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">iomsg</span>      <span class="c">!&lt; IO status message.</span>
<a name="ln-1093"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                              <span class="kd">::</span> <span class="n">form_</span>      <span class="c">!&lt; Format of unit, local variable.</span>
<a name="ln-1094"></a>  <span class="kt">integer</span>                                   <span class="kd">::</span> <span class="n">iostat_</span>    <span class="c">!&lt; IO status code, local variable.</span>
<a name="ln-1095"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>             <span class="kd">::</span> <span class="n">iomsg_</span>     <span class="c">!&lt; IO status message, local variable.</span>
<a name="ln-1096"></a>  <span class="kt">integer</span>                                   <span class="kd">::</span> <span class="n">unit</span>       <span class="c">!&lt; Logical unit.</span>
<a name="ln-1097"></a>  <span class="kt">logical</span>                                   <span class="kd">::</span> <span class="n">does_exist</span> <span class="c">!&lt; Check if file exist.</span>
<a name="ln-1098"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1099"></a>
<a name="ln-1100"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1101"></a>  <span class="n">iomsg_</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg_</span> <span class="o">=</span> <span class="n">iomsg</span>
<a name="ln-1102"></a>  <span class="k">inquire</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="k">file</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">exist</span><span class="o">=</span><span class="n">does_exist</span><span class="p">)</span>
<a name="ln-1103"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">does_exist</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1104"></a><span class="k">    </span><span class="n">form_</span> <span class="o">=</span> <span class="s1">&#39;FORMATTED&#39;</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">form</span><span class="p">))</span> <span class="n">form_</span> <span class="o">=</span> <span class="n">form</span> <span class="p">;</span> <span class="n">form_</span> <span class="o">=</span> <span class="n">form_</span><span class="p">%</span><span class="n">upper</span><span class="p">()</span>
<a name="ln-1105"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">form_</span><span class="p">%</span><span class="n">chars</span><span class="p">())</span>
<a name="ln-1106"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;FORMATTED&#39;</span><span class="p">)</span>
<a name="ln-1107"></a>      <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="k">file</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;OLD&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;READ&#39;</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1108"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">)</span>
<a name="ln-1109"></a>      <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="k">file</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;OLD&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;READ&#39;</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">,</span> <span class="nb">access</span><span class="o">=</span><span class="s1">&#39;STREAM&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1110"></a>           <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1111"></a>    <span class="n">endselect</span>
<a name="ln-1112"></a>    <span class="k">call </span><span class="n">self</span><span class="p">%</span><span class="n">read_lines</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">)</span>
<a name="ln-1113"></a>    <span class="mi">10</span> <span class="k">close</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
<a name="ln-1114"></a>  <span class="n">endif</span>
<a name="ln-1115"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="n">iostat</span> <span class="o">=</span> <span class="n">iostat_</span>
<a name="ln-1116"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg</span> <span class="o">=</span> <span class="n">iomsg_</span>
<a name="ln-1117"></a>  <span class="k">return</span>
<a name="ln-1118"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1119"></a>  <span class="n">endsubroutine</span> <span class="n">read_file</span>
<a name="ln-1120"></a>
<a name="ln-1121"></a>  <span class="k">subroutine </span><span class="n">read_line</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-1122"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1123"></a>  <span class="c">!&lt; Read line (record) from a connected unit.</span>
<a name="ln-1124"></a>  <span class="c">!&lt;</span>
<a name="ln-1125"></a>  <span class="c">!&lt; The line is read as an ascii stream read until the eor is reached.</span>
<a name="ln-1126"></a>  <span class="c">!&lt;</span>
<a name="ln-1127"></a>  <span class="c">!&lt; @note For unformatted read only `access=&#39;stream&#39;` is supported with new_line as line terminator.</span>
<a name="ln-1128"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1129"></a>  <span class="k">use</span><span class="p">,</span> <span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">iostat_eor</span>
<a name="ln-1130"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1131"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>    <span class="c">!&lt; The string.</span>
<a name="ln-1132"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">unit</span>    <span class="c">!&lt; Logical unit.</span>
<a name="ln-1133"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span>    <span class="k">optional</span> <span class="kd">::</span> <span class="n">form</span>    <span class="c">!&lt; Format of unit.</span>
<a name="ln-1134"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span>   <span class="k">optional</span> <span class="kd">::</span> <span class="n">iostat</span>  <span class="c">!&lt; IO status code.</span>
<a name="ln-1135"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">iomsg</span>   <span class="c">!&lt; IO status message.</span>
<a name="ln-1136"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                              <span class="kd">::</span> <span class="n">form_</span>   <span class="c">!&lt; Format of unit, local variable.</span>
<a name="ln-1137"></a>  <span class="kt">integer</span>                                   <span class="kd">::</span> <span class="n">iostat_</span> <span class="c">!&lt; IO status code, local variable.</span>
<a name="ln-1138"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span>          <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">iomsg_</span>  <span class="c">!&lt; IO status message, local variable.</span>
<a name="ln-1139"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">line</span>    <span class="c">!&lt; Line storage.</span>
<a name="ln-1140"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">ch</span>      <span class="c">!&lt; Character storage.</span>
<a name="ln-1141"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1142"></a>
<a name="ln-1143"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1144"></a>  <span class="n">form_</span> <span class="o">=</span> <span class="s1">&#39;FORMATTED&#39;</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">form</span><span class="p">))</span> <span class="n">form_</span> <span class="o">=</span> <span class="n">form</span> <span class="p">;</span> <span class="n">form_</span> <span class="o">=</span> <span class="n">form_</span><span class="p">%</span><span class="n">upper</span><span class="p">()</span>
<a name="ln-1145"></a>  <span class="n">iomsg_</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg_</span> <span class="o">=</span> <span class="n">iomsg</span>
<a name="ln-1146"></a>  <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1147"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">form_</span><span class="p">%</span><span class="n">chars</span><span class="p">())</span>
<a name="ln-1148"></a>  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;FORMATTED&#39;</span><span class="p">)</span>
<a name="ln-1149"></a>    <span class="k">do</span>
<a name="ln-1150"></a><span class="k">      read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="k">end</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">eor</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="n">ch</span>
<a name="ln-1151"></a>      <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">//</span><span class="n">ch</span>
<a name="ln-1152"></a>    <span class="n">enddo</span>
<a name="ln-1153"></a>  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">)</span>
<a name="ln-1154"></a>    <span class="k">do</span>
<a name="ln-1155"></a><span class="k">      read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="k">end</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="n">ch</span>
<a name="ln-1156"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">ch</span><span class="o">==</span><span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1157"></a><span class="k">        </span><span class="n">iostat_</span> <span class="o">=</span> <span class="n">iostat_eor</span>
<a name="ln-1158"></a>        <span class="k">exit</span>
<a name="ln-1159"></a><span class="k">      </span><span class="n">endif</span>
<a name="ln-1160"></a>      <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">//</span><span class="n">ch</span>
<a name="ln-1161"></a>    <span class="n">enddo</span>
<a name="ln-1162"></a>  <span class="n">endselect</span>
<a name="ln-1163"></a>  <span class="mi">10</span> <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">line</span>
<a name="ln-1164"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="n">iostat</span> <span class="o">=</span> <span class="n">iostat_</span>
<a name="ln-1165"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg</span> <span class="o">=</span> <span class="n">iomsg_</span>
<a name="ln-1166"></a>  <span class="k">return</span>
<a name="ln-1167"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1168"></a>  <span class="n">endsubroutine</span> <span class="n">read_line</span>
<a name="ln-1169"></a>
<a name="ln-1170"></a>  <span class="k">subroutine </span><span class="n">read_lines</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-1171"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1172"></a>  <span class="c">!&lt; Read (all) lines (records) from a connected unit as a single ascii stream.</span>
<a name="ln-1173"></a>  <span class="c">!&lt;</span>
<a name="ln-1174"></a>  <span class="c">!&lt; @note All the lines are stored into the string self as a single ascii stream. Each line (record) is separated by a `new_line`</span>
<a name="ln-1175"></a>  <span class="c">!&lt; character. The line is read as an ascii stream read until the eor is reached.</span>
<a name="ln-1176"></a>  <span class="c">!&lt;</span>
<a name="ln-1177"></a>  <span class="c">!&lt; @note The connected unit is rewinded. At a successful exit current record is at eof, at the beginning otherwise.</span>
<a name="ln-1178"></a>  <span class="c">!&lt;</span>
<a name="ln-1179"></a>  <span class="c">!&lt; @note For unformatted read only `access=&#39;stream&#39;` is supported with new_line as line terminator.</span>
<a name="ln-1180"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1181"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>    <span class="c">!&lt; The string.</span>
<a name="ln-1182"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">unit</span>    <span class="c">!&lt; Logical unit.</span>
<a name="ln-1183"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span>    <span class="k">optional</span> <span class="kd">::</span> <span class="n">form</span>    <span class="c">!&lt; Format of unit.</span>
<a name="ln-1184"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span>   <span class="k">optional</span> <span class="kd">::</span> <span class="n">iostat</span>  <span class="c">!&lt; IO status code.</span>
<a name="ln-1185"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">iomsg</span>   <span class="c">!&lt; IO status message.</span>
<a name="ln-1186"></a>  <span class="kt">integer</span>                                   <span class="kd">::</span> <span class="n">iostat_</span> <span class="c">!&lt; IO status code, local variable.</span>
<a name="ln-1187"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>             <span class="kd">::</span> <span class="n">iomsg_</span>  <span class="c">!&lt; IO status message, local variable.</span>
<a name="ln-1188"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                              <span class="kd">::</span> <span class="n">lines</span>   <span class="c">!&lt; Lines storage.</span>
<a name="ln-1189"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                              <span class="kd">::</span> <span class="n">line</span>    <span class="c">!&lt; Line storage.</span>
<a name="ln-1190"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1191"></a>
<a name="ln-1192"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1193"></a>  <span class="n">iomsg_</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg_</span> <span class="o">=</span> <span class="n">iomsg</span>
<a name="ln-1194"></a>  <span class="k">rewind</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
<a name="ln-1195"></a>  <span class="n">iostat_</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1196"></a>  <span class="n">lines</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1197"></a>  <span class="k">do</span>
<a name="ln-1198"></a><span class="k">    </span><span class="n">line</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1199"></a>    <span class="k">call </span><span class="n">line</span><span class="p">%</span><span class="n">read_line</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">)</span>
<a name="ln-1200"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">iostat_</span><span class="o">/=</span><span class="mf">0.</span><span class="nb">and</span><span class="p">..</span><span class="nb">not</span><span class="p">.</span><span class="nb">is_iostat_eor</span><span class="p">(</span><span class="n">iostat_</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1201"></a><span class="k">      exit</span>
<a name="ln-1202"></a><span class="k">    </span><span class="n">elseif</span> <span class="p">(</span><span class="n">line</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1203"></a><span class="k">      </span><span class="n">lines</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">lines</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">line</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<a name="ln-1204"></a>    <span class="n">endif</span>
<a name="ln-1205"></a>  <span class="n">enddo</span>
<a name="ln-1206"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lines</span><span class="p">%</span><span class="n">raw</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">lines</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-1207"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="n">iostat</span> <span class="o">=</span> <span class="n">iostat_</span>
<a name="ln-1208"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg</span> <span class="o">=</span> <span class="n">iomsg_</span>
<a name="ln-1209"></a>  <span class="k">return</span>
<a name="ln-1210"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1211"></a>  <span class="n">endsubroutine</span> <span class="n">read_lines</span>
<a name="ln-1212"></a>
<a name="ln-1213"></a>  <span class="k">elemental function </span><span class="n">replace</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">,</span> <span class="nb">count</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">replaced</span><span class="p">)</span>
<a name="ln-1214"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1215"></a>  <span class="c">!&lt; Return a string with all occurrences of substring old replaced by new.</span>
<a name="ln-1216"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1217"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1218"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">old</span>       <span class="c">!&lt; Old substring.</span>
<a name="ln-1219"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">new</span>       <span class="c">!&lt; New substring.</span>
<a name="ln-1220"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="nb">count</span>     <span class="c">!&lt; Number of old occurences to be replaced.</span>
<a name="ln-1221"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">replaced</span>  <span class="c">!&lt; The string with old replaced by new.</span>
<a name="ln-1222"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">r</span>         <span class="c">!&lt; Counter.</span>
<a name="ln-1223"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1224"></a>
<a name="ln-1225"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1226"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1227"></a><span class="k">    </span><span class="n">replaced</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-1228"></a>    <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1229"></a>    <span class="k">do</span>
<a name="ln-1230"></a><span class="k">      if</span> <span class="p">(</span><span class="nb">index</span><span class="p">(</span><span class="n">replaced</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">old</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1231"></a><span class="k">        </span><span class="n">replaced</span> <span class="o">=</span> <span class="n">replaced</span><span class="p">%</span><span class="n">replace_one_occurrence</span><span class="p">(</span><span class="n">old</span><span class="o">=</span><span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="n">new</span><span class="p">)</span>
<a name="ln-1232"></a>        <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1233"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="nb">count</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1234"></a><span class="k">          if</span> <span class="p">(</span><span class="n">r</span><span class="o">&gt;=</span><span class="nb">count</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-1235"></a><span class="k">        </span><span class="n">endif</span>
<a name="ln-1236"></a>      <span class="k">else</span>
<a name="ln-1237"></a><span class="k">        exit</span>
<a name="ln-1238"></a><span class="k">      </span><span class="n">endif</span>
<a name="ln-1239"></a>    <span class="n">enddo</span>
<a name="ln-1240"></a>  <span class="n">endif</span>
<a name="ln-1241"></a>  <span class="k">return</span>
<a name="ln-1242"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1243"></a>  <span class="n">endfunction</span> <span class="n">replace</span>
<a name="ln-1244"></a>
<a name="ln-1245"></a>  <span class="k">elemental function </span><span class="n">reverse</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">reversed</span><span class="p">)</span>
<a name="ln-1246"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1247"></a>  <span class="c">!&lt; Return a reversed string.</span>
<a name="ln-1248"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1249"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-1250"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">reversed</span> <span class="c">!&lt; The reversed string.</span>
<a name="ln-1251"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">length</span>   <span class="c">!&lt; Length of the string.</span>
<a name="ln-1252"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">c</span>        <span class="c">!&lt; Counter.</span>
<a name="ln-1253"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1254"></a>
<a name="ln-1255"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1256"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1257"></a><span class="k">    </span><span class="n">reversed</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-1258"></a>    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-1259"></a>    <span class="k">do </span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">length</span>
<a name="ln-1260"></a>      <span class="n">reversed</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">length</span><span class="o">-</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="o">-</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1261"></a>    <span class="n">enddo</span>
<a name="ln-1262"></a>  <span class="n">endif</span>
<a name="ln-1263"></a>  <span class="k">return</span>
<a name="ln-1264"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1265"></a>  <span class="n">endfunction</span> <span class="n">reverse</span>
<a name="ln-1266"></a>
<a name="ln-1267"></a>  <span class="k">function </span><span class="n">search</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">tag_start</span><span class="p">,</span> <span class="n">tag_end</span><span class="p">,</span> <span class="n">in_string</span><span class="p">,</span> <span class="n">in_character</span><span class="p">,</span> <span class="n">istart</span><span class="p">,</span> <span class="n">iend</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
<a name="ln-1268"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1269"></a>  <span class="c">!&lt; Search for *tagged* record into string, return the first record found (if any) matching the tags.</span>
<a name="ln-1270"></a>  <span class="c">!&lt;</span>
<a name="ln-1271"></a>  <span class="c">!&lt; Optionally, returns the indexes of tag start/end, thus this is not an `elemental` function.</span>
<a name="ln-1272"></a>  <span class="c">!&lt;</span>
<a name="ln-1273"></a>  <span class="c">!&lt; @note The tagged record is searched into self if allocated otherwise into `in_string` if passed or, eventually, into</span>
<a name="ln-1274"></a>  <span class="c">!&lt; `in_character` is passed. If tag is not found the return string is not allocated and the start/end indexes (if requested) are</span>
<a name="ln-1275"></a>  <span class="c">!&lt; zero.</span>
<a name="ln-1276"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1277"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">self</span>         <span class="c">!&lt; The string.</span>
<a name="ln-1278"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">tag_start</span>    <span class="c">!&lt; Start tag.</span>
<a name="ln-1279"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">tag_end</span>      <span class="c">!&lt; End tag.</span>
<a name="ln-1280"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>              <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span>  <span class="k">optional</span> <span class="kd">::</span> <span class="n">in_string</span>    <span class="c">!&lt; Search into this string.</span>
<a name="ln-1281"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span>  <span class="k">optional</span> <span class="kd">::</span> <span class="n">in_character</span> <span class="c">!&lt; Search into this character string.</span>
<a name="ln-1282"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">istart</span>       <span class="c">!&lt; Starting index of tag inside the string.</span>
<a name="ln-1283"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">iend</span>         <span class="c">!&lt; Ending index of tag inside the string.</span>
<a name="ln-1284"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                     <span class="kd">::</span> <span class="n">tag</span>          <span class="c">!&lt; First tag found.</span>
<a name="ln-1285"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>           <span class="kd">::</span> <span class="n">raw</span>          <span class="c">!&lt; Raw string into which search the tag.</span>
<a name="ln-1286"></a>  <span class="kt">integer</span>                                          <span class="kd">::</span> <span class="n">istart_</span>      <span class="c">!&lt; Starting index of tag inside the string, local variable.</span>
<a name="ln-1287"></a>  <span class="kt">integer</span>                                          <span class="kd">::</span> <span class="n">iend_</span>        <span class="c">!&lt; Ending index of tag inside the string, local variable.</span>
<a name="ln-1288"></a>  <span class="kt">logical</span>                                          <span class="kd">::</span> <span class="n">found</span>        <span class="c">!&lt; Flag for inquiring search result.</span>
<a name="ln-1289"></a>  <span class="kt">integer</span>                                          <span class="kd">::</span> <span class="n">nested_tags</span>  <span class="c">!&lt; Number of nested tags inside tag.</span>
<a name="ln-1290"></a>  <span class="kt">integer</span>                                          <span class="kd">::</span> <span class="n">t</span>            <span class="c">!&lt; Counter.</span>
<a name="ln-1291"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1292"></a>
<a name="ln-1293"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1294"></a>  <span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1295"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">in_string</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1296"></a><span class="k">    </span><span class="n">raw</span> <span class="o">=</span> <span class="n">in_string</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-1297"></a>  <span class="n">elseif</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">in_character</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1298"></a><span class="k">    </span><span class="n">raw</span> <span class="o">=</span> <span class="n">in_character</span>
<a name="ln-1299"></a>  <span class="k">else</span>
<a name="ln-1300"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1301"></a><span class="k">      </span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-1302"></a>    <span class="n">endif</span>
<a name="ln-1303"></a>  <span class="n">endif</span>
<a name="ln-1304"></a>  <span class="n">istart_</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1305"></a>  <span class="n">iend_</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1306"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">raw</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1307"></a><span class="k">    </span><span class="n">found</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1308"></a>    <span class="n">istart_</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">tag_start</span><span class="p">)</span>
<a name="ln-1309"></a>    <span class="n">iend_</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">tag_end</span><span class="p">)</span>
<a name="ln-1310"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">istart_</span><span class="o">&gt;</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">iend_</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1311"></a><span class="k">      </span><span class="n">iend_</span> <span class="o">=</span> <span class="n">iend_</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">tag_end</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-1312"></a>      <span class="n">tag</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">raw</span><span class="p">(</span><span class="n">istart_</span><span class="p">:</span><span class="n">iend_</span><span class="p">)</span>
<a name="ln-1313"></a>      <span class="n">nested_tags</span> <span class="o">=</span> <span class="n">tag</span><span class="p">%</span><span class="nb">count</span><span class="p">(</span><span class="n">tag_start</span><span class="p">)</span>
<a name="ln-1314"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">nested_tags</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1315"></a><span class="k">        do </span><span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nested_tags</span>
<a name="ln-1316"></a>          <span class="n">iend_</span> <span class="o">=</span> <span class="n">iend_</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">tag_end</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">index</span><span class="p">(</span><span class="n">raw</span><span class="p">(</span><span class="n">iend_</span><span class="o">+</span><span class="mi">1</span><span class="p">:),</span> <span class="n">tag_end</span><span class="p">)</span>
<a name="ln-1317"></a>        <span class="n">enddo</span>
<a name="ln-1318"></a>        <span class="n">tag</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">raw</span><span class="p">(</span><span class="n">istart_</span><span class="p">:</span><span class="n">iend_</span><span class="p">)</span>
<a name="ln-1319"></a>      <span class="n">endif</span>
<a name="ln-1320"></a>    <span class="n">endif</span>
<a name="ln-1321"></a>  <span class="n">endif</span>
<a name="ln-1322"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">istart</span><span class="p">))</span> <span class="n">istart</span> <span class="o">=</span> <span class="n">istart_</span>
<a name="ln-1323"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iend</span><span class="p">))</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">iend_</span>
<a name="ln-1324"></a>  <span class="k">return</span>
<a name="ln-1325"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1326"></a>  <span class="n">endfunction</span> <span class="n">search</span>
<a name="ln-1327"></a>
<a name="ln-1328"></a>  <span class="k">pure function </span><span class="n">slice</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">istart</span><span class="p">,</span> <span class="n">iend</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-1329"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1330"></a>  <span class="c">!&lt; Return the raw characters data sliced.</span>
<a name="ln-1331"></a>  <span class="c">!&lt;</span>
<a name="ln-1332"></a>  <span class="c">!&lt;### Example</span>
<a name="ln-1333"></a>  <span class="c">!&lt;</span>
<a name="ln-1334"></a>  <span class="c">!&lt;```fortran</span>
<a name="ln-1335"></a>  <span class="c">!&lt; type(string) :: astring        !&lt; A string.</span>
<a name="ln-1336"></a>  <span class="c">!&lt; astring = &#39;the Quick Brown fox Jumps over the Lazy Dog.&#39;</span>
<a name="ln-1337"></a>  <span class="c">!&lt; print &quot;(A)&quot;, astring%slice(11,25) ! print &quot;Brown fox Jumps&quot;</span>
<a name="ln-1338"></a>  <span class="c">!&lt;```</span>
<a name="ln-1339"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1340"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">self</span>   <span class="c">!&lt; The string.</span>
<a name="ln-1341"></a>  <span class="kt">integer</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">istart</span> <span class="c">!&lt; Slice start index.</span>
<a name="ln-1342"></a>  <span class="kt">integer</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">iend</span>   <span class="c">!&lt; Slice end   index.</span>
<a name="ln-1343"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">raw</span>    <span class="c">!&lt; Raw characters data.</span>
<a name="ln-1344"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1345"></a>
<a name="ln-1346"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1347"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1348"></a><span class="k">    </span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">istart</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-1349"></a>  <span class="k">else</span>
<a name="ln-1350"></a><span class="k">    </span><span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1351"></a>  <span class="n">endif</span>
<a name="ln-1352"></a>  <span class="k">return</span>
<a name="ln-1353"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1354"></a>  <span class="n">endfunction</span> <span class="n">slice</span>
<a name="ln-1355"></a>
<a name="ln-1356"></a>  <span class="k">elemental function </span><span class="n">snakecase</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
<a name="ln-1357"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1358"></a>  <span class="c">!&lt; Return a string with all words lowercase separated by &quot;_&quot;.</span>
<a name="ln-1359"></a>  <span class="c">!&lt;</span>
<a name="ln-1360"></a>  <span class="c">!&lt; @note Multiple subsequent separators are collapsed to one occurence.</span>
<a name="ln-1361"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1362"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1363"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>       <span class="c">!&lt; Separator.</span>
<a name="ln-1364"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">snakecase</span> <span class="c">!&lt; Snake case string.</span>
<a name="ln-1365"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">allocatable</span>                       <span class="kd">::</span> <span class="n">tokens</span><span class="p">(:)</span> <span class="c">!&lt; String tokens.</span>
<a name="ln-1366"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1367"></a>
<a name="ln-1368"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1369"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1370"></a><span class="k">    call </span><span class="n">self</span><span class="p">%</span><span class="n">split</span><span class="p">(</span><span class="n">tokens</span><span class="o">=</span><span class="n">tokens</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">)</span>
<a name="ln-1371"></a>    <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">%</span><span class="n">lower</span><span class="p">()</span>
<a name="ln-1372"></a>    <span class="n">snakecase</span> <span class="o">=</span> <span class="n">snakecase</span><span class="p">%</span><span class="n">join</span><span class="p">(</span><span class="k">array</span><span class="o">=</span><span class="n">tokens</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
<a name="ln-1373"></a>  <span class="n">endif</span>
<a name="ln-1374"></a>  <span class="k">return</span>
<a name="ln-1375"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1376"></a>  <span class="n">endfunction</span> <span class="n">snakecase</span>
<a name="ln-1377"></a>
<a name="ln-1378"></a>  <span class="k">pure subroutine </span><span class="n">split</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">tokens</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
<a name="ln-1379"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1380"></a>  <span class="c">!&lt; Return a list of substring in the string, using sep as the delimiter string.</span>
<a name="ln-1381"></a>  <span class="c">!&lt;</span>
<a name="ln-1382"></a>  <span class="c">!&lt; @note Multiple subsequent separators are collapsed to one occurence.</span>
<a name="ln-1383"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1384"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>           <span class="c">!&lt; The string.</span>
<a name="ln-1385"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>            <span class="c">!&lt; Separator.</span>
<a name="ln-1386"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">tokens</span><span class="p">(:)</span>      <span class="c">!&lt; Tokens substring.</span>
<a name="ln-1387"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">sep_</span>           <span class="c">!&lt; Separator, default value.</span>
<a name="ln-1388"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">No</span>             <span class="c">!&lt; Number of occurrences of sep.</span>
<a name="ln-1389"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">t</span>              <span class="c">!&lt; Character counter.</span>
<a name="ln-1390"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">temporary</span>      <span class="c">!&lt; Temporary storage.</span>
<a name="ln-1391"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">allocatable</span>                       <span class="kd">::</span> <span class="n">temp_toks</span><span class="p">(:,:)</span> <span class="c">!&lt; Temporary tokens substring.</span>
<a name="ln-1392"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1393"></a>
<a name="ln-1394"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1395"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1396"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="n">SPACE</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span> <span class="n">sep_</span> <span class="o">=</span> <span class="n">sep</span>
<a name="ln-1397"></a>
<a name="ln-1398"></a>    <span class="n">temporary</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">unique</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span>
<a name="ln-1399"></a>    <span class="n">No</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">%</span><span class="nb">count</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span>
<a name="ln-1400"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">No</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1401"></a><span class="k">      allocate</span><span class="p">(</span><span class="n">temp_toks</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">No</span><span class="p">))</span>
<a name="ln-1402"></a>      <span class="n">temp_toks</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">%</span><span class="n">partition</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span>
<a name="ln-1403"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">No</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1404"></a><span class="k">        do </span><span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">No</span>
<a name="ln-1405"></a>          <span class="n">temp_toks</span><span class="p">(:,</span> <span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)%</span><span class="n">partition</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span>
<a name="ln-1406"></a>        <span class="n">enddo</span>
<a name="ln-1407"></a>      <span class="n">endif</span>
<a name="ln-1408"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">temp_toks</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)%</span><span class="n">raw</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">temp_toks</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">No</span><span class="p">)%</span><span class="n">raw</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1409"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">tokens</span><span class="p">(</span><span class="n">No</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1410"></a>        <span class="k">do </span><span class="n">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">No</span>
<a name="ln-1411"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="o">==</span><span class="n">No</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1412"></a><span class="k">            </span><span class="n">tokens</span><span class="p">(</span><span class="n">t</span>  <span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-1413"></a>            <span class="n">tokens</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-1414"></a>          <span class="k">else</span>
<a name="ln-1415"></a><span class="k">            </span><span class="n">tokens</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-1416"></a>          <span class="n">endif</span>
<a name="ln-1417"></a>        <span class="n">enddo</span>
<a name="ln-1418"></a>      <span class="n">elseif</span> <span class="p">(</span><span class="n">temp_toks</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)%</span><span class="n">raw</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1419"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">tokens</span><span class="p">(</span><span class="n">No</span><span class="p">))</span>
<a name="ln-1420"></a>        <span class="k">do </span><span class="n">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">No</span>
<a name="ln-1421"></a>          <span class="n">tokens</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-1422"></a>        <span class="n">enddo</span>
<a name="ln-1423"></a>      <span class="n">elseif</span> <span class="p">(</span><span class="n">temp_toks</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">No</span><span class="p">)%</span><span class="n">raw</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1424"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">tokens</span><span class="p">(</span><span class="n">No</span><span class="p">))</span>
<a name="ln-1425"></a>        <span class="k">do </span><span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">No</span>
<a name="ln-1426"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="o">==</span><span class="n">No</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1427"></a><span class="k">            </span><span class="n">tokens</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-1428"></a>            <span class="n">tokens</span><span class="p">(</span><span class="n">t</span>  <span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-1429"></a>          <span class="k">else</span>
<a name="ln-1430"></a><span class="k">            </span><span class="n">tokens</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-1431"></a>          <span class="n">endif</span>
<a name="ln-1432"></a>        <span class="n">enddo</span>
<a name="ln-1433"></a>      <span class="k">else</span>
<a name="ln-1434"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">tokens</span><span class="p">(</span><span class="n">No</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1435"></a>        <span class="k">do </span><span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">No</span>
<a name="ln-1436"></a>          <span class="n">tokens</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp_toks</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-1437"></a>        <span class="n">enddo</span>
<a name="ln-1438"></a>      <span class="n">endif</span>
<a name="ln-1439"></a>    <span class="k">else</span>
<a name="ln-1440"></a><span class="k">      allocate</span><span class="p">(</span><span class="n">tokens</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1441"></a>      <span class="n">tokens</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-1442"></a>    <span class="n">endif</span>
<a name="ln-1443"></a>  <span class="n">endif</span>
<a name="ln-1444"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1445"></a>  <span class="n">endsubroutine</span> <span class="n">split</span>
<a name="ln-1446"></a>
<a name="ln-1447"></a>  <span class="k">elemental function </span><span class="n">startcase</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
<a name="ln-1448"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1449"></a>  <span class="c">!&lt; Return a string with all words capitalized, e.g. title case.</span>
<a name="ln-1450"></a>  <span class="c">!&lt;</span>
<a name="ln-1451"></a>  <span class="c">!&lt; @note Multiple subsequent separators are collapsed to one occurence.</span>
<a name="ln-1452"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1453"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1454"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>       <span class="c">!&lt; Separator.</span>
<a name="ln-1455"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">startcase</span> <span class="c">!&lt; Start case string.</span>
<a name="ln-1456"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">sep_</span>      <span class="c">!&lt; Separator, default value.</span>
<a name="ln-1457"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">allocatable</span>                       <span class="kd">::</span> <span class="n">tokens</span><span class="p">(:)</span> <span class="c">!&lt; String tokens.</span>
<a name="ln-1458"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1459"></a>
<a name="ln-1460"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1461"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1462"></a><span class="k">    </span><span class="n">sep_</span> <span class="o">=</span> <span class="n">SPACE</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span> <span class="n">sep_</span> <span class="o">=</span> <span class="n">sep</span>
<a name="ln-1463"></a>    <span class="k">call </span><span class="n">self</span><span class="p">%</span><span class="n">split</span><span class="p">(</span><span class="n">tokens</span><span class="o">=</span><span class="n">tokens</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep_</span><span class="p">)</span>
<a name="ln-1464"></a>    <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">%</span><span class="n">capitalize</span><span class="p">()</span>
<a name="ln-1465"></a>    <span class="n">startcase</span> <span class="o">=</span> <span class="n">startcase</span><span class="p">%</span><span class="n">join</span><span class="p">(</span><span class="k">array</span><span class="o">=</span><span class="n">tokens</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep_</span><span class="p">)</span>
<a name="ln-1466"></a>  <span class="n">endif</span>
<a name="ln-1467"></a>  <span class="k">return</span>
<a name="ln-1468"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1469"></a>  <span class="n">endfunction</span> <span class="n">startcase</span>
<a name="ln-1470"></a>
<a name="ln-1471"></a>  <span class="k">elemental function </span><span class="n">strip</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">remove_nulls</span><span class="p">)</span>
<a name="ln-1472"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1473"></a>  <span class="c">!&lt; Return a copy of the string with the leading and trailing characters removed.</span>
<a name="ln-1474"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1475"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>         <span class="c">!&lt; The string.</span>
<a name="ln-1476"></a>  <span class="kt">logical</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">remove_nulls</span> <span class="c">!&lt; Remove null characters at the end.</span>
<a name="ln-1477"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">strip</span>        <span class="c">!&lt; The stripped string.</span>
<a name="ln-1478"></a>  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">c</span>            <span class="c">!&lt; Counter.</span>
<a name="ln-1479"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1480"></a>
<a name="ln-1481"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1482"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1483"></a><span class="k">    </span><span class="n">strip</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="nb">adjustl</span><span class="p">()</span>
<a name="ln-1484"></a>    <span class="n">strip</span> <span class="o">=</span> <span class="n">strip</span><span class="p">%</span><span class="nb">trim</span><span class="p">()</span>
<a name="ln-1485"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">remove_nulls</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1486"></a><span class="k">      if</span> <span class="p">(</span><span class="n">remove_nulls</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1487"></a><span class="k">        </span><span class="n">c</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="nb">char</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-1488"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">c</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">strip</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">strip</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1489"></a>      <span class="n">endif</span>
<a name="ln-1490"></a>    <span class="n">endif</span>
<a name="ln-1491"></a>  <span class="n">endif</span>
<a name="ln-1492"></a>  <span class="k">return</span>
<a name="ln-1493"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1494"></a>  <span class="n">endfunction</span> <span class="n">strip</span>
<a name="ln-1495"></a>
<a name="ln-1496"></a>  <span class="k">elemental function </span><span class="n">swapcase</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-1497"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1498"></a>  <span class="c">!&lt; Return a copy of the string with uppercase characters converted to lowercase and vice versa.</span>
<a name="ln-1499"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1500"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-1501"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">swapcase</span> <span class="c">!&lt; Upper case string.</span>
<a name="ln-1502"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">n1</span>       <span class="c">!&lt; Characters counter.</span>
<a name="ln-1503"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">n2</span>       <span class="c">!&lt; Characters counter.</span>
<a name="ln-1504"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1505"></a>
<a name="ln-1506"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1507"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1508"></a><span class="k">    </span><span class="n">swapcase</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-1509"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-1510"></a>      <span class="n">n2</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">UPPER_ALPHABET</span><span class="p">,</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">))</span>
<a name="ln-1511"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">n2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1512"></a><span class="k">        </span><span class="n">swapcase</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="n">LOWER_ALPHABET</span><span class="p">(</span><span class="n">n2</span><span class="p">:</span><span class="n">n2</span><span class="p">)</span>
<a name="ln-1513"></a>      <span class="k">else</span>
<a name="ln-1514"></a><span class="k">        </span><span class="n">n2</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">LOWER_ALPHABET</span><span class="p">,</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">))</span>
<a name="ln-1515"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">n2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">swapcase</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="n">UPPER_ALPHABET</span><span class="p">(</span><span class="n">n2</span><span class="p">:</span><span class="n">n2</span><span class="p">)</span>
<a name="ln-1516"></a>      <span class="n">endif</span>
<a name="ln-1517"></a>    <span class="n">enddo</span>
<a name="ln-1518"></a>  <span class="n">endif</span>
<a name="ln-1519"></a>  <span class="k">return</span>
<a name="ln-1520"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1521"></a>  <span class="n">endfunction</span> <span class="n">swapcase</span>
<a name="ln-1522"></a>
<a name="ln-1523"></a>  <span class="k">elemental function </span><span class="n">to_integer_I1P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nb">kind</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">to_number</span><span class="p">)</span>
<a name="ln-1524"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1525"></a>  <span class="c">!&lt; Cast string to integer (I1P).</span>
<a name="ln-1526"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1527"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1528"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">kind</span>      <span class="c">!&lt; Mold parameter for kind detection.</span>
<a name="ln-1529"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">to_number</span> <span class="c">!&lt; The number into the string.</span>
<a name="ln-1530"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1531"></a>
<a name="ln-1532"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1533"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1534"></a><span class="k">    if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">is_integer</span><span class="p">())</span> <span class="k">read</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">to_number</span>
<a name="ln-1535"></a>  <span class="n">endif</span>
<a name="ln-1536"></a>  <span class="k">return</span>
<a name="ln-1537"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1538"></a>  <span class="n">endfunction</span> <span class="n">to_integer_I1P</span>
<a name="ln-1539"></a>
<a name="ln-1540"></a>  <span class="k">elemental function </span><span class="n">to_integer_I2P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nb">kind</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">to_number</span><span class="p">)</span>
<a name="ln-1541"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1542"></a>  <span class="c">!&lt; Cast string to integer (I2P).</span>
<a name="ln-1543"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1544"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1545"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">kind</span>      <span class="c">!&lt; Mold parameter for kind detection.</span>
<a name="ln-1546"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">to_number</span> <span class="c">!&lt; The number into the string.</span>
<a name="ln-1547"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1548"></a>
<a name="ln-1549"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1550"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1551"></a><span class="k">    if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">is_integer</span><span class="p">())</span> <span class="k">read</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">to_number</span>
<a name="ln-1552"></a>  <span class="n">endif</span>
<a name="ln-1553"></a>  <span class="k">return</span>
<a name="ln-1554"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1555"></a>  <span class="n">endfunction</span> <span class="n">to_integer_I2P</span>
<a name="ln-1556"></a>
<a name="ln-1557"></a>  <span class="k">elemental function </span><span class="n">to_integer_I4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nb">kind</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">to_number</span><span class="p">)</span>
<a name="ln-1558"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1559"></a>  <span class="c">!&lt; Cast string to integer (I4P).</span>
<a name="ln-1560"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1561"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1562"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">kind</span>      <span class="c">!&lt; Mold parameter for kind detection.</span>
<a name="ln-1563"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">to_number</span> <span class="c">!&lt; The number into the string.</span>
<a name="ln-1564"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1565"></a>
<a name="ln-1566"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1567"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1568"></a><span class="k">    if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">is_integer</span><span class="p">())</span> <span class="k">read</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">to_number</span>
<a name="ln-1569"></a>  <span class="n">endif</span>
<a name="ln-1570"></a>  <span class="k">return</span>
<a name="ln-1571"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1572"></a>  <span class="n">endfunction</span> <span class="n">to_integer_I4P</span>
<a name="ln-1573"></a>
<a name="ln-1574"></a>  <span class="k">elemental function </span><span class="n">to_integer_I8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nb">kind</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">to_number</span><span class="p">)</span>
<a name="ln-1575"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1576"></a>  <span class="c">!&lt; Cast string to integer (I8P).</span>
<a name="ln-1577"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1578"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1579"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">kind</span>      <span class="c">!&lt; Mold parameter for kind detection.</span>
<a name="ln-1580"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">to_number</span> <span class="c">!&lt; The number into the string.</span>
<a name="ln-1581"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1582"></a>
<a name="ln-1583"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1584"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1585"></a><span class="k">    if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">is_integer</span><span class="p">())</span> <span class="k">read</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">to_number</span>
<a name="ln-1586"></a>  <span class="n">endif</span>
<a name="ln-1587"></a>  <span class="k">return</span>
<a name="ln-1588"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1589"></a>  <span class="n">endfunction</span> <span class="n">to_integer_I8P</span>
<a name="ln-1590"></a>
<a name="ln-1591"></a>  <span class="k">elemental function </span><span class="n">to_real_R4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nb">kind</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">to_number</span><span class="p">)</span>
<a name="ln-1592"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1593"></a>  <span class="c">!&lt; Cast string to real (R4P).</span>
<a name="ln-1594"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1595"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1596"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">kind</span>      <span class="c">!&lt; Mold parameter for kind detection.</span>
<a name="ln-1597"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">to_number</span> <span class="c">!&lt; The number into the string.</span>
<a name="ln-1598"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1599"></a>
<a name="ln-1600"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1601"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1602"></a><span class="k">    if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">is_real</span><span class="p">())</span> <span class="k">read</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">to_number</span>
<a name="ln-1603"></a>  <span class="n">endif</span>
<a name="ln-1604"></a>  <span class="k">return</span>
<a name="ln-1605"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1606"></a>  <span class="n">endfunction</span> <span class="n">to_real_R4P</span>
<a name="ln-1607"></a>
<a name="ln-1608"></a>  <span class="k">elemental function </span><span class="n">to_real_R8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nb">kind</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">to_number</span><span class="p">)</span>
<a name="ln-1609"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1610"></a>  <span class="c">!&lt; Cast string to real (R8P).</span>
<a name="ln-1611"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1612"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1613"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">kind</span>      <span class="c">!&lt; Mold parameter for kind detection.</span>
<a name="ln-1614"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">to_number</span> <span class="c">!&lt; The number into the string.</span>
<a name="ln-1615"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1616"></a>
<a name="ln-1617"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1618"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1619"></a><span class="k">    if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">is_real</span><span class="p">())</span> <span class="k">read</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">to_number</span>
<a name="ln-1620"></a>  <span class="n">endif</span>
<a name="ln-1621"></a>  <span class="k">return</span>
<a name="ln-1622"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1623"></a>  <span class="n">endfunction</span> <span class="n">to_real_R8P</span>
<a name="ln-1624"></a>
<a name="ln-1625"></a>  <span class="k">elemental function </span><span class="n">to_real_R16P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nb">kind</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">to_number</span><span class="p">)</span>
<a name="ln-1626"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1627"></a>  <span class="c">!&lt; Cast string to real (R16P).</span>
<a name="ln-1628"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1629"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-1630"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">kind</span>      <span class="c">!&lt; Mold parameter for kind detection.</span>
<a name="ln-1631"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">to_number</span> <span class="c">!&lt; The number into the string.</span>
<a name="ln-1632"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1633"></a>
<a name="ln-1634"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1635"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1636"></a><span class="k">    if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">is_real</span><span class="p">())</span> <span class="k">read</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">to_number</span>
<a name="ln-1637"></a>  <span class="n">endif</span>
<a name="ln-1638"></a>  <span class="k">return</span>
<a name="ln-1639"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1640"></a>  <span class="n">endfunction</span> <span class="n">to_real_R16P</span>
<a name="ln-1641"></a>
<a name="ln-1642"></a>  <span class="k">elemental function </span><span class="n">unescape</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">to_unescape</span><span class="p">,</span> <span class="n">unesc</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">unescaped</span><span class="p">)</span>
<a name="ln-1643"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1644"></a>  <span class="c">!&lt; Unescape double backslashes (or custom escaped character).</span>
<a name="ln-1645"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1646"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>        <span class="c">!&lt; The string.</span>
<a name="ln-1647"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">to_unescape</span> <span class="c">!&lt; Character to be unescaped.</span>
<a name="ln-1648"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">unesc</span>       <span class="c">!&lt; Character used to unescape.</span>
<a name="ln-1649"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">unescaped</span>   <span class="c">!&lt; Escaped string.</span>
<a name="ln-1650"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">unesc_</span>      <span class="c">!&lt; Character to unescape, local variable.</span>
<a name="ln-1651"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">c</span>           <span class="c">!&lt; Character counter.</span>
<a name="ln-1652"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1653"></a>
<a name="ln-1654"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1655"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1656"></a><span class="k">    </span><span class="n">unesc_</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">unesc</span><span class="p">))</span> <span class="n">unesc_</span> <span class="o">=</span> <span class="n">unesc</span>
<a name="ln-1657"></a>    <span class="n">unescaped</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1658"></a>    <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1659"></a>    <span class="k">do</span>
<a name="ln-1660"></a><span class="k">      if</span> <span class="p">(</span><span class="n">c</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">exit</span>
<a name="ln-1661"></a><span class="k">      if</span> <span class="p">(</span><span class="n">c</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1662"></a><span class="k">        </span><span class="n">unescaped</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">unescaped</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span>
<a name="ln-1663"></a>        <span class="k">exit</span>
<a name="ln-1664"></a><span class="k">      else</span>
<a name="ln-1665"></a><span class="k">        if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="n">BACKSLASH</span><span class="o">//</span><span class="n">to_unescape</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1666"></a><span class="k">          </span><span class="n">unescaped</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">unescaped</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">to_unescape</span>
<a name="ln-1667"></a>          <span class="n">c</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1668"></a>        <span class="k">else</span>
<a name="ln-1669"></a><span class="k">          </span><span class="n">unescaped</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">unescaped</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">)</span>
<a name="ln-1670"></a>          <span class="n">c</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1671"></a>        <span class="n">endif</span>
<a name="ln-1672"></a>      <span class="n">endif</span>
<a name="ln-1673"></a>    <span class="n">enddo</span>
<a name="ln-1674"></a>  <span class="n">endif</span>
<a name="ln-1675"></a>  <span class="k">return</span>
<a name="ln-1676"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1677"></a>  <span class="n">endfunction</span> <span class="n">unescape</span>
<a name="ln-1678"></a>
<a name="ln-1679"></a>  <span class="k">elemental function </span><span class="n">unique</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">substring</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">uniq</span><span class="p">)</span>
<a name="ln-1680"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1681"></a>  <span class="c">!&lt; Reduce to one (unique) multiple (sequential) occurrences of a substring into a string.</span>
<a name="ln-1682"></a>  <span class="c">!&lt;</span>
<a name="ln-1683"></a>  <span class="c">!&lt; For example the string &#39; ab-cre-cre-ab&#39; is reduce to &#39;ab-cre-ab&#39; if the substring is &#39;-cre&#39;.</span>
<a name="ln-1684"></a>  <span class="c">!&lt; @note Eventual multiple trailing white space are not reduced to one occurrence.</span>
<a name="ln-1685"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1686"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>       <span class="c">!&lt; The string.</span>
<a name="ln-1687"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">substring</span>  <span class="c">!&lt; Substring which multiple occurences must be reduced to one.</span>
<a name="ln-1688"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">substring_</span> <span class="c">!&lt; Substring, default value.</span>
<a name="ln-1689"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">uniq</span>       <span class="c">!&lt; String parsed.</span>
<a name="ln-1690"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1691"></a>
<a name="ln-1692"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1693"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1694"></a><span class="k">    </span><span class="n">substring_</span> <span class="o">=</span> <span class="n">SPACE</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">substring</span><span class="p">))</span> <span class="n">substring_</span> <span class="o">=</span> <span class="n">substring</span>
<a name="ln-1695"></a>
<a name="ln-1696"></a>    <span class="n">uniq</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-1697"></a>    <span class="k">do</span>
<a name="ln-1698"></a><span class="k">      if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">uniq</span><span class="p">%</span><span class="nb">index</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="n">substring_</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-1699"></a><span class="k">      </span><span class="n">uniq</span> <span class="o">=</span> <span class="n">uniq</span><span class="p">%</span><span class="n">replace</span><span class="p">(</span><span class="n">old</span><span class="o">=</span><span class="nb">repeat</span><span class="p">(</span><span class="n">substring_</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">new</span><span class="o">=</span><span class="n">substring_</span><span class="p">)</span>
<a name="ln-1700"></a>    <span class="n">enddo</span>
<a name="ln-1701"></a>  <span class="n">endif</span>
<a name="ln-1702"></a>  <span class="k">return</span>
<a name="ln-1703"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1704"></a>  <span class="n">endfunction</span> <span class="n">unique</span>
<a name="ln-1705"></a>
<a name="ln-1706"></a>  <span class="k">elemental function </span><span class="n">upper</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-1707"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1708"></a>  <span class="c">!&lt; Return a string with all uppercase characters.</span>
<a name="ln-1709"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1710"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>  <span class="c">!&lt; The string.</span>
<a name="ln-1711"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">upper</span> <span class="c">!&lt; Upper case string.</span>
<a name="ln-1712"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">n1</span>    <span class="c">!&lt; Characters counter.</span>
<a name="ln-1713"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">n2</span>    <span class="c">!&lt; Characters counter.</span>
<a name="ln-1714"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1715"></a>
<a name="ln-1716"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1717"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1718"></a><span class="k">    </span><span class="n">upper</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-1719"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-1720"></a>      <span class="n">n2</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">LOWER_ALPHABET</span><span class="p">,</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">))</span>
<a name="ln-1721"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">n2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">upper</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="n">UPPER_ALPHABET</span><span class="p">(</span><span class="n">n2</span><span class="p">:</span><span class="n">n2</span><span class="p">)</span>
<a name="ln-1722"></a>    <span class="n">enddo</span>
<a name="ln-1723"></a>  <span class="n">endif</span>
<a name="ln-1724"></a>  <span class="k">return</span>
<a name="ln-1725"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1726"></a>  <span class="n">endfunction</span> <span class="n">upper</span>
<a name="ln-1727"></a>
<a name="ln-1728"></a>  <span class="k">subroutine </span><span class="n">write_file</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="k">file</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-1729"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1730"></a>  <span class="c">!&lt; Write a single string stream into file.</span>
<a name="ln-1731"></a>  <span class="c">!&lt;</span>
<a name="ln-1732"></a>  <span class="c">!&lt; @note For unformatted read only `access=&#39;stream&#39;` is supported with new_line as line terminator.</span>
<a name="ln-1733"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1734"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">self</span>    <span class="c">!&lt; The string.</span>
<a name="ln-1735"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="k">file</span>    <span class="c">!&lt; File name.</span>
<a name="ln-1736"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span>    <span class="k">optional</span> <span class="kd">::</span> <span class="n">form</span>    <span class="c">!&lt; Format of unit.</span>
<a name="ln-1737"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span>   <span class="k">optional</span> <span class="kd">::</span> <span class="n">iostat</span>  <span class="c">!&lt; IO status code.</span>
<a name="ln-1738"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">iomsg</span>   <span class="c">!&lt; IO status message.</span>
<a name="ln-1739"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                              <span class="kd">::</span> <span class="n">form_</span>   <span class="c">!&lt; Format of unit, local variable.</span>
<a name="ln-1740"></a>  <span class="kt">integer</span>                                   <span class="kd">::</span> <span class="n">iostat_</span> <span class="c">!&lt; IO status code, local variable.</span>
<a name="ln-1741"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>             <span class="kd">::</span> <span class="n">iomsg_</span>  <span class="c">!&lt; IO status message, local variable.</span>
<a name="ln-1742"></a>  <span class="kt">integer</span>                                   <span class="kd">::</span> <span class="n">unit</span>    <span class="c">!&lt; Logical unit.</span>
<a name="ln-1743"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1744"></a>
<a name="ln-1745"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1746"></a>  <span class="n">iomsg_</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg_</span> <span class="o">=</span> <span class="n">iomsg</span>
<a name="ln-1747"></a>  <span class="n">form_</span> <span class="o">=</span> <span class="s1">&#39;FORMATTED&#39;</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">form</span><span class="p">))</span> <span class="n">form_</span> <span class="o">=</span> <span class="n">form</span> <span class="p">;</span> <span class="n">form_</span> <span class="o">=</span> <span class="n">form_</span><span class="p">%</span><span class="n">upper</span><span class="p">()</span>
<a name="ln-1748"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">form_</span><span class="p">%</span><span class="n">chars</span><span class="p">())</span>
<a name="ln-1749"></a>  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;FORMATTED&#39;</span><span class="p">)</span>
<a name="ln-1750"></a>    <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="k">file</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;WRITE&#39;</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1751"></a>  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">)</span>
<a name="ln-1752"></a>    <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="k">file</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;WRITE&#39;</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">,</span> <span class="nb">access</span><span class="o">=</span><span class="s1">&#39;STREAM&#39;</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1753"></a>  <span class="n">endselect</span>
<a name="ln-1754"></a>  <span class="k">call </span><span class="n">self</span><span class="p">%</span><span class="n">write_lines</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">)</span>
<a name="ln-1755"></a>  <span class="mi">10</span> <span class="k">close</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
<a name="ln-1756"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="n">iostat</span> <span class="o">=</span> <span class="n">iostat_</span>
<a name="ln-1757"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg</span> <span class="o">=</span> <span class="n">iomsg_</span>
<a name="ln-1758"></a>  <span class="k">return</span>
<a name="ln-1759"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1760"></a>  <span class="n">endsubroutine</span> <span class="n">write_file</span>
<a name="ln-1761"></a>
<a name="ln-1762"></a>  <span class="k">subroutine </span><span class="n">write_line</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-1763"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1764"></a>  <span class="c">!&lt; Write line (record) to a connected unit.</span>
<a name="ln-1765"></a>  <span class="c">!&lt;</span>
<a name="ln-1766"></a>  <span class="c">!&lt; @note If the connected unit is unformatted a `new_line()` character is added at the end (if necessary) to mark the end of line.</span>
<a name="ln-1767"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1768"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">self</span>    <span class="c">!&lt; The string.</span>
<a name="ln-1769"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">unit</span>    <span class="c">!&lt; Logical unit.</span>
<a name="ln-1770"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span>    <span class="k">optional</span> <span class="kd">::</span> <span class="n">form</span>    <span class="c">!&lt; Format of unit.</span>
<a name="ln-1771"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span>   <span class="k">optional</span> <span class="kd">::</span> <span class="n">iostat</span>  <span class="c">!&lt; IO status code.</span>
<a name="ln-1772"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">iomsg</span>   <span class="c">!&lt; IO status message.</span>
<a name="ln-1773"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                              <span class="kd">::</span> <span class="n">form_</span>   <span class="c">!&lt; Format of unit, local variable.</span>
<a name="ln-1774"></a>  <span class="kt">integer</span>                                   <span class="kd">::</span> <span class="n">iostat_</span> <span class="c">!&lt; IO status code, local variable.</span>
<a name="ln-1775"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>             <span class="kd">::</span> <span class="n">iomsg_</span>  <span class="c">!&lt; IO status message, local variable.</span>
<a name="ln-1776"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1777"></a>
<a name="ln-1778"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1779"></a>  <span class="n">iostat_</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1780"></a>  <span class="n">iomsg_</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg_</span> <span class="o">=</span> <span class="n">iomsg</span>
<a name="ln-1781"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1782"></a><span class="k">    </span><span class="n">form_</span> <span class="o">=</span> <span class="s1">&#39;FORMATTED&#39;</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">form</span><span class="p">))</span> <span class="n">form_</span> <span class="o">=</span> <span class="n">form</span> <span class="p">;</span> <span class="n">form_</span> <span class="o">=</span> <span class="n">form_</span><span class="p">%</span><span class="n">upper</span><span class="p">()</span>
<a name="ln-1783"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">form_</span><span class="p">%</span><span class="n">chars</span><span class="p">())</span>
<a name="ln-1784"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;FORMATTED&#39;</span><span class="p">)</span>
<a name="ln-1785"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">)</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-1786"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">)</span>
<a name="ln-1787"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">end_with</span><span class="p">(</span><span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)))</span> <span class="k">then</span>
<a name="ln-1788"></a><span class="k">        write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">)</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-1789"></a>      <span class="k">else</span>
<a name="ln-1790"></a><span class="k">        write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat_</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg_</span><span class="p">)</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<a name="ln-1791"></a>      <span class="n">endif</span>
<a name="ln-1792"></a>    <span class="n">endselect</span>
<a name="ln-1793"></a>  <span class="n">endif</span>
<a name="ln-1794"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="n">iostat</span> <span class="o">=</span> <span class="n">iostat_</span>
<a name="ln-1795"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span> <span class="n">iomsg</span> <span class="o">=</span> <span class="n">iomsg_</span>
<a name="ln-1796"></a>  <span class="k">return</span>
<a name="ln-1797"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1798"></a>  <span class="n">endsubroutine</span> <span class="n">write_line</span>
<a name="ln-1799"></a>
<a name="ln-1800"></a>  <span class="k">subroutine </span><span class="n">write_lines</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-1801"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1802"></a>  <span class="c">!&lt; Write lines (records) to a connected unit.</span>
<a name="ln-1803"></a>  <span class="c">!&lt;</span>
<a name="ln-1804"></a>  <span class="c">!&lt; This method checks if self contains more than one line (records) and writes them as lines (records).</span>
<a name="ln-1805"></a>  <span class="c">!&lt;</span>
<a name="ln-1806"></a>  <span class="c">!&lt; @note If the connected unit is unformatted a `new_line()` character is added at the end (if necessary) to mark the end of line.</span>
<a name="ln-1807"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1808"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-1809"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">unit</span>     <span class="c">!&lt; Logical unit.</span>
<a name="ln-1810"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span>    <span class="k">optional</span> <span class="kd">::</span> <span class="n">form</span>     <span class="c">!&lt; Format of unit.</span>
<a name="ln-1811"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span>   <span class="k">optional</span> <span class="kd">::</span> <span class="n">iostat</span>   <span class="c">!&lt; IO status code.</span>
<a name="ln-1812"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">iomsg</span>    <span class="c">!&lt; IO status message.</span>
<a name="ln-1813"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">lines</span><span class="p">(:)</span> <span class="c">!&lt; Lines.</span>
<a name="ln-1814"></a>  <span class="kt">integer</span>                                   <span class="kd">::</span> <span class="n">l</span>        <span class="c">!&lt; Counter.</span>
<a name="ln-1815"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1816"></a>
<a name="ln-1817"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1818"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1819"></a><span class="k">    call </span><span class="n">self</span><span class="p">%</span><span class="n">split</span><span class="p">(</span><span class="n">tokens</span><span class="o">=</span><span class="n">lines</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<a name="ln-1820"></a>    <span class="k">do </span><span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1821"></a>       <span class="k">call </span><span class="n">lines</span><span class="p">(</span><span class="n">l</span><span class="p">)%</span><span class="n">write_line</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span>
<a name="ln-1822"></a>    <span class="n">enddo</span>
<a name="ln-1823"></a>  <span class="n">endif</span>
<a name="ln-1824"></a>  <span class="k">return</span>
<a name="ln-1825"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1826"></a>  <span class="n">endsubroutine</span> <span class="n">write_lines</span>
<a name="ln-1827"></a>
<a name="ln-1828"></a>  <span class="c">! inquire</span>
<a name="ln-1829"></a>  <span class="k">elemental function </span><span class="n">end_with</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">suffix</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="k">end</span><span class="p">)</span>
<a name="ln-1830"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1831"></a>  <span class="c">!&lt; Return true if a string ends with a specified suffix.</span>
<a name="ln-1832"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1833"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-1834"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">suffix</span>   <span class="c">!&lt; Searched suffix.</span>
<a name="ln-1835"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">start</span>    <span class="c">!&lt; Start position into the string.</span>
<a name="ln-1836"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="k">end</span>      <span class="c">!&lt; End position into the string.</span>
<a name="ln-1837"></a>  <span class="kt">logical</span>                                         <span class="kd">::</span> <span class="n">end_with</span> <span class="c">!&lt; Result of the test.</span>
<a name="ln-1838"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">start_</span>   <span class="c">!&lt; Start position into the string, local variable.</span>
<a name="ln-1839"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">end_</span>     <span class="c">!&lt; End position into the string, local variable.</span>
<a name="ln-1840"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1841"></a>
<a name="ln-1842"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1843"></a>  <span class="n">end_with</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1844"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1845"></a><span class="k">    </span><span class="n">start_</span> <span class="o">=</span> <span class="mi">1</span>             <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">start</span><span class="p">))</span> <span class="n">start_</span> <span class="o">=</span> <span class="n">start</span>
<a name="ln-1846"></a>    <span class="n">end_</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="k">end</span><span class="p">))</span>   <span class="n">end_</span>   <span class="o">=</span> <span class="k">end</span>
<a name="ln-1847"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span><span class="o">&lt;=</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">start_</span><span class="p">:</span><span class="n">end_</span><span class="p">)))</span> <span class="k">then</span>
<a name="ln-1848"></a><span class="k">      </span><span class="n">end_with</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">start_</span><span class="p">:</span><span class="n">end_</span><span class="p">),</span> <span class="n">suffix</span><span class="p">)</span><span class="o">==</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">start_</span><span class="p">:</span><span class="n">end_</span><span class="p">))</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1849"></a>    <span class="n">endif</span>
<a name="ln-1850"></a>  <span class="n">endif</span>
<a name="ln-1851"></a>  <span class="k">return</span>
<a name="ln-1852"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1853"></a>  <span class="n">endfunction</span> <span class="n">end_with</span>
<a name="ln-1854"></a>
<a name="ln-1855"></a>  <span class="k">elemental function </span><span class="n">is_allocated</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-1856"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1857"></a>  <span class="c">!&lt; Return true if the string is allocated.</span>
<a name="ln-1858"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1859"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-1860"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_allocated</span> <span class="c">!&lt; Result of the test.</span>
<a name="ln-1861"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1862"></a>
<a name="ln-1863"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1864"></a>  <span class="n">is_allocated</span> <span class="o">=</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-1865"></a>  <span class="k">return</span>
<a name="ln-1866"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1867"></a>  <span class="n">endfunction</span> <span class="n">is_allocated</span>
<a name="ln-1868"></a>
<a name="ln-1869"></a>  <span class="k">elemental function </span><span class="n">is_digit</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-1870"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1871"></a>  <span class="c">!&lt; Return true if all characters in the string are digits.</span>
<a name="ln-1872"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1873"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-1874"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_digit</span> <span class="c">!&lt; Result of the test.</span>
<a name="ln-1875"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">c</span>        <span class="c">!&lt; Character counter.</span>
<a name="ln-1876"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1877"></a>
<a name="ln-1878"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1879"></a>  <span class="n">is_digit</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1880"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1881"></a><span class="k">    do </span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-1882"></a>      <span class="k">select case</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">))</span>
<a name="ln-1883"></a>      <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">:</span><span class="s1">&#39;9&#39;</span><span class="p">)</span>
<a name="ln-1884"></a>        <span class="n">is_digit</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1885"></a>      <span class="k">case </span><span class="n">default</span>
<a name="ln-1886"></a>        <span class="n">is_digit</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1887"></a>        <span class="k">exit</span>
<a name="ln-1888"></a><span class="k">      end select</span>
<a name="ln-1889"></a><span class="k">    </span><span class="n">enddo</span>
<a name="ln-1890"></a>  <span class="n">endif</span>
<a name="ln-1891"></a>  <span class="k">return</span>
<a name="ln-1892"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1893"></a>  <span class="n">endfunction</span> <span class="n">is_digit</span>
<a name="ln-1894"></a>
<a name="ln-1895"></a>  <span class="k">elemental function </span><span class="n">is_integer</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">allow_spaces</span><span class="p">)</span>
<a name="ln-1896"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1897"></a>  <span class="c">!&lt; Return true if the string contains an integer.</span>
<a name="ln-1898"></a>  <span class="c">!&lt;</span>
<a name="ln-1899"></a>  <span class="c">!&lt; The regular expression is `\s*[\+\-]?\d+([eE]\+?\d+)?\s*`. The parse algorithm is done in stages:</span>
<a name="ln-1900"></a>  <span class="c">!&lt;</span>
<a name="ln-1901"></a>  <span class="c">!&lt; | S0  | S1      | S2  | S3   | S4  | S5  | S6  |</span>
<a name="ln-1902"></a>  <span class="c">!&lt; |-----|---------|-----|------|-----|-----|-----|</span>
<a name="ln-1903"></a>  <span class="c">!&lt; |`\s*`|`[\+\-]?`|`\d+`|`[eE]`|`\+?`|`\d+`|`\s*`|</span>
<a name="ln-1904"></a>  <span class="c">!&lt;</span>
<a name="ln-1905"></a>  <span class="c">!&lt; Exit on stages-parsing results in:</span>
<a name="ln-1906"></a>  <span class="c">!&lt;</span>
<a name="ln-1907"></a>  <span class="c">!&lt; | S0 | S1 | S2 | S3 | S4 | S5 | S6 |</span>
<a name="ln-1908"></a>  <span class="c">!&lt; |----|----|----|----|----|----|----|</span>
<a name="ln-1909"></a>  <span class="c">!&lt; |  F |  F |  T |  F |  F |  T |  T |</span>
<a name="ln-1910"></a>  <span class="c">!&lt;</span>
<a name="ln-1911"></a>  <span class="c">!&lt; @note This implementation is courtesy of</span>
<a name="ln-1912"></a>  <span class="c">!&lt; [tomedunn](https://github.com/tomedunn/fortran-string-utility-module/blob/master/src/string_utility_module.f90#L294)</span>
<a name="ln-1913"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1914"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>          <span class="c">!&lt; The string.</span>
<a name="ln-1915"></a>  <span class="kt">logical</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">allow_spaces</span>  <span class="c">!&lt; Allow leading-trailing spaces.</span>
<a name="ln-1916"></a>  <span class="kt">logical</span>                             <span class="kd">::</span> <span class="n">is_integer</span>    <span class="c">!&lt; Result of the test.</span>
<a name="ln-1917"></a>  <span class="kt">logical</span>                             <span class="kd">::</span> <span class="n">allow_spaces_</span> <span class="c">!&lt; Allow leading-trailing spaces, local variable.</span>
<a name="ln-1918"></a>  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">stage</span>         <span class="c">!&lt; Stages counter.</span>
<a name="ln-1919"></a>  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">c</span>             <span class="c">!&lt; Character counter.</span>
<a name="ln-1920"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1921"></a>
<a name="ln-1922"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1923"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1924"></a><span class="k">    </span><span class="n">allow_spaces_</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">allow_spaces</span><span class="p">))</span> <span class="n">allow_spaces_</span> <span class="o">=</span> <span class="n">allow_spaces</span>
<a name="ln-1925"></a>    <span class="n">stage</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1926"></a>    <span class="n">is_integer</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1927"></a>    <span class="k">do </span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-1928"></a>      <span class="k">select case</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">))</span>
<a name="ln-1929"></a>      <span class="k">case</span><span class="p">(</span><span class="n">SPACE</span><span class="p">,</span> <span class="n">TAB</span><span class="p">)</span>
<a name="ln-1930"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-1931"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a name="ln-1932"></a>          <span class="n">is_integer</span> <span class="o">=</span> <span class="n">allow_spaces_</span>
<a name="ln-1933"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a name="ln-1934"></a>          <span class="n">is_integer</span> <span class="o">=</span> <span class="n">allow_spaces_</span>
<a name="ln-1935"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">6</span>
<a name="ln-1936"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-1937"></a>          <span class="n">is_integer</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1938"></a>        <span class="n">endselect</span>
<a name="ln-1939"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<a name="ln-1940"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-1941"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-1942"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1943"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-1944"></a>          <span class="n">is_integer</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1945"></a>        <span class="k">end select</span>
<a name="ln-1946"></a><span class="k">      case</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
<a name="ln-1947"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-1948"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-1949"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1950"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1951"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-1952"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-1953"></a>          <span class="n">is_integer</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1954"></a>        <span class="n">endselect</span>
<a name="ln-1955"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">:</span><span class="s1">&#39;9&#39;</span><span class="p">)</span>
<a name="ln-1956"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-1957"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1958"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-1959"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1960"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-1961"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-1962"></a>          <span class="k">continue</span>
<a name="ln-1963"></a><span class="k">        </span><span class="n">endselect</span>
<a name="ln-1964"></a>      <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
<a name="ln-1965"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-1966"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1967"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-1968"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-1969"></a>          <span class="n">is_integer</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1970"></a>        <span class="n">endselect</span>
<a name="ln-1971"></a>      <span class="k">case </span><span class="n">default</span>
<a name="ln-1972"></a>        <span class="n">is_integer</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1973"></a>      <span class="n">endselect</span>
<a name="ln-1974"></a>      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">is_integer</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-1975"></a><span class="k">    </span><span class="n">enddo</span>
<a name="ln-1976"></a>  <span class="n">endif</span>
<a name="ln-1977"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">is_integer</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1978"></a><span class="k">    select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-1979"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a name="ln-1980"></a>      <span class="n">is_integer</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1981"></a>    <span class="k">case </span><span class="n">default</span>
<a name="ln-1982"></a>      <span class="n">is_integer</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1983"></a>    <span class="k">end select</span>
<a name="ln-1984"></a><span class="k">  </span><span class="n">endif</span>
<a name="ln-1985"></a>  <span class="k">return</span>
<a name="ln-1986"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1987"></a>  <span class="n">endfunction</span> <span class="n">is_integer</span>
<a name="ln-1988"></a>
<a name="ln-1989"></a>  <span class="k">elemental function </span><span class="n">is_lower</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-1990"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1991"></a>  <span class="c">!&lt; Return true if all characters in the string are lowercase.</span>
<a name="ln-1992"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1993"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-1994"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_lower</span> <span class="c">!&lt; Result of the test.</span>
<a name="ln-1995"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">c</span>        <span class="c">!&lt; Character counter.</span>
<a name="ln-1996"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1997"></a>
<a name="ln-1998"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1999"></a>  <span class="n">is_lower</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2000"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2001"></a><span class="k">    </span><span class="n">is_lower</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2002"></a>    <span class="k">do </span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-2003"></a>      <span class="k">if</span> <span class="p">(</span><span class="nb">index</span><span class="p">(</span><span class="n">UPPER_ALPHABET</span><span class="p">,</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2004"></a><span class="k">        </span><span class="n">is_lower</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2005"></a>        <span class="k">exit</span>
<a name="ln-2006"></a><span class="k">      </span><span class="n">endif</span>
<a name="ln-2007"></a>    <span class="n">enddo</span>
<a name="ln-2008"></a>  <span class="n">endif</span>
<a name="ln-2009"></a>  <span class="k">return</span>
<a name="ln-2010"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2011"></a>  <span class="n">endfunction</span> <span class="n">is_lower</span>
<a name="ln-2012"></a>
<a name="ln-2013"></a>  <span class="k">elemental function </span><span class="n">is_number</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">allow_spaces</span><span class="p">)</span>
<a name="ln-2014"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2015"></a>  <span class="c">!&lt; Return true if the string contains a number (real or integer).</span>
<a name="ln-2016"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2017"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>         <span class="c">!&lt; The string.</span>
<a name="ln-2018"></a>  <span class="kt">logical</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">allow_spaces</span> <span class="c">!&lt; Allow leading-trailing spaces.</span>
<a name="ln-2019"></a>  <span class="kt">logical</span>                             <span class="kd">::</span> <span class="n">is_number</span>    <span class="c">!&lt; Result of the test.</span>
<a name="ln-2020"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2021"></a>
<a name="ln-2022"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2023"></a>  <span class="n">is_number</span> <span class="o">=</span> <span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">is_integer</span><span class="p">(</span><span class="n">allow_spaces</span><span class="o">=</span><span class="n">allow_spaces</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span><span class="n">self</span><span class="p">%</span><span class="n">is_real</span><span class="p">(</span><span class="n">allow_spaces</span><span class="o">=</span><span class="n">allow_spaces</span><span class="p">))</span>
<a name="ln-2024"></a>  <span class="k">return</span>
<a name="ln-2025"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2026"></a>  <span class="n">endfunction</span> <span class="n">is_number</span>
<a name="ln-2027"></a>
<a name="ln-2028"></a>  <span class="k">elemental function </span><span class="n">is_real</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">allow_spaces</span><span class="p">)</span>
<a name="ln-2029"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2030"></a>  <span class="c">!&lt; Return true if the string contains a real.</span>
<a name="ln-2031"></a>  <span class="c">!&lt;</span>
<a name="ln-2032"></a>  <span class="c">!&lt; The regular expression is `\s*[\+\-]?\d*(|\.?\d*([deDE][\+\-]?\d+)?)\s*`. The parse algorithm is done in stages:</span>
<a name="ln-2033"></a>  <span class="c">!&lt;</span>
<a name="ln-2034"></a>  <span class="c">!&lt; | S0  | S1      | S2  | S3  | S4  | S5     | S6      | S7  | S8  |</span>
<a name="ln-2035"></a>  <span class="c">!&lt; |-----|---------|-----|-----|-----|--------|---------|-----|-----|</span>
<a name="ln-2036"></a>  <span class="c">!&lt; |`\s*`|`[\+\-]?`|`\d*`|`\.?`|`\d*`|`[deDE]`|`[\+\-]?`|`\d*`|`\s*`|</span>
<a name="ln-2037"></a>  <span class="c">!&lt;</span>
<a name="ln-2038"></a>  <span class="c">!&lt; Exit on stages-parsing results in:</span>
<a name="ln-2039"></a>  <span class="c">!&lt;</span>
<a name="ln-2040"></a>  <span class="c">!&lt; | S0 | S1 | S2 | S3 | S4 | S5 | S6 | S7 | S8 |</span>
<a name="ln-2041"></a>  <span class="c">!&lt; |----|----|----|----|----|----|----|----|----|</span>
<a name="ln-2042"></a>  <span class="c">!  |  F |  F |  T |  T |  T |  F |  F |  T |  T |</span>
<a name="ln-2043"></a>  <span class="c">!&lt;</span>
<a name="ln-2044"></a>  <span class="c">!&lt; @note This implementation is courtesy of</span>
<a name="ln-2045"></a>  <span class="c">!&lt; [tomedunn](https://github.com/tomedunn/fortran-string-utility-module/blob/master/src/string_utility_module.f90#L614)</span>
<a name="ln-2046"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2047"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>              <span class="c">!&lt; The string.</span>
<a name="ln-2048"></a>  <span class="kt">logical</span><span class="p">,</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">allow_spaces</span>      <span class="c">!&lt; Allow leading-trailing spaces.</span>
<a name="ln-2049"></a>  <span class="kt">logical</span>                             <span class="kd">::</span> <span class="n">is_real</span>           <span class="c">!&lt; Result of the test.</span>
<a name="ln-2050"></a>  <span class="kt">logical</span>                             <span class="kd">::</span> <span class="n">allow_spaces_</span>     <span class="c">!&lt; Allow leading-trailing spaces, local variable.</span>
<a name="ln-2051"></a>  <span class="kt">logical</span>                             <span class="kd">::</span> <span class="n">has_leading_digit</span> <span class="c">!&lt; Check the presence of leading digits.</span>
<a name="ln-2052"></a>  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">stage</span>             <span class="c">!&lt; Stages counter.</span>
<a name="ln-2053"></a>  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">c</span>                 <span class="c">!&lt; Character counter.</span>
<a name="ln-2054"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2055"></a>
<a name="ln-2056"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2057"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2058"></a><span class="k">    </span><span class="n">allow_spaces_</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">allow_spaces</span><span class="p">))</span> <span class="n">allow_spaces_</span> <span class="o">=</span> <span class="n">allow_spaces</span>
<a name="ln-2059"></a>    <span class="n">stage</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2060"></a>    <span class="n">is_real</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2061"></a>    <span class="n">has_leading_digit</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2062"></a>    <span class="k">do </span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-2063"></a>      <span class="k">select case</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">))</span>
<a name="ln-2064"></a>      <span class="k">case</span><span class="p">(</span><span class="n">SPACE</span><span class="p">,</span> <span class="n">TAB</span><span class="p">)</span>
<a name="ln-2065"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-2066"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<a name="ln-2067"></a>          <span class="n">is_real</span> <span class="o">=</span> <span class="n">allow_spaces_</span>
<a name="ln-2068"></a>          <span class="k">continue</span>
<a name="ln-2069"></a><span class="k">        case</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-2070"></a>          <span class="n">is_real</span> <span class="o">=</span> <span class="n">allow_spaces_</span>
<a name="ln-2071"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">8</span>
<a name="ln-2072"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-2073"></a>          <span class="n">is_real</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2074"></a>        <span class="n">endselect</span>
<a name="ln-2075"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<a name="ln-2076"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-2077"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-2078"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2079"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-2080"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">6</span>
<a name="ln-2081"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-2082"></a>          <span class="n">is_real</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2083"></a>        <span class="n">endselect</span>
<a name="ln-2084"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">:</span><span class="s1">&#39;9&#39;</span><span class="p">)</span>
<a name="ln-2085"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-2086"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2087"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-2088"></a>          <span class="n">has_leading_digit</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2089"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2090"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-2091"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">5</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-2092"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">7</span>
<a name="ln-2093"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-2094"></a>          <span class="k">continue</span>
<a name="ln-2095"></a><span class="k">        </span><span class="n">endselect</span>
<a name="ln-2096"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-2097"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-2098"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2099"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-2100"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-2101"></a>          <span class="n">is_real</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2102"></a>        <span class="n">endselect</span>
<a name="ln-2103"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<a name="ln-2104"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-2105"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-2106"></a>          <span class="n">stage</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-2107"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-2108"></a>          <span class="n">is_real</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2109"></a>        <span class="n">endselect</span>
<a name="ln-2110"></a>      <span class="k">case </span><span class="n">default</span>
<a name="ln-2111"></a>        <span class="n">is_real</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2112"></a>      <span class="n">endselect</span>
<a name="ln-2113"></a>      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">is_real</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-2114"></a><span class="k">    </span><span class="n">enddo</span>
<a name="ln-2115"></a>  <span class="n">endif</span>
<a name="ln-2116"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">is_real</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2117"></a><span class="k">    select case</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<a name="ln-2118"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<a name="ln-2119"></a>      <span class="n">is_real</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2120"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2121"></a>      <span class="n">is_real</span> <span class="o">=</span> <span class="n">has_leading_digit</span>
<a name="ln-2122"></a>    <span class="k">case </span><span class="n">default</span>
<a name="ln-2123"></a>      <span class="n">is_real</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2124"></a>    <span class="n">endselect</span>
<a name="ln-2125"></a>  <span class="n">endif</span>
<a name="ln-2126"></a>  <span class="k">return</span>
<a name="ln-2127"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2128"></a>  <span class="n">endfunction</span> <span class="n">is_real</span>
<a name="ln-2129"></a>
<a name="ln-2130"></a>  <span class="k">elemental function </span><span class="n">is_upper</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-2131"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2132"></a>  <span class="c">!&lt; Return true if all characters in the string are uppercase.</span>
<a name="ln-2133"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2134"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>     <span class="c">!&lt; The string.</span>
<a name="ln-2135"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_upper</span> <span class="c">!&lt; Result of the test.</span>
<a name="ln-2136"></a>  <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">c</span>        <span class="c">!&lt; Character counter.</span>
<a name="ln-2137"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2138"></a>
<a name="ln-2139"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2140"></a>  <span class="n">is_upper</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2141"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2142"></a><span class="k">    </span><span class="n">is_upper</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2143"></a>    <span class="k">do </span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span>
<a name="ln-2144"></a>      <span class="k">if</span> <span class="p">(</span><span class="nb">index</span><span class="p">(</span><span class="n">LOWER_ALPHABET</span><span class="p">,</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2145"></a><span class="k">        </span><span class="n">is_upper</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2146"></a>        <span class="k">exit</span>
<a name="ln-2147"></a><span class="k">      </span><span class="n">endif</span>
<a name="ln-2148"></a>    <span class="n">enddo</span>
<a name="ln-2149"></a>  <span class="n">endif</span>
<a name="ln-2150"></a>  <span class="k">return</span>
<a name="ln-2151"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2152"></a>  <span class="n">endfunction</span> <span class="n">is_upper</span>
<a name="ln-2153"></a>
<a name="ln-2154"></a>  <span class="k">elemental function </span><span class="n">start_with</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="k">end</span><span class="p">)</span>
<a name="ln-2155"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2156"></a>  <span class="c">!&lt; Return true if a string starts with a specified prefix.</span>
<a name="ln-2157"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2158"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">self</span>       <span class="c">!&lt; The string.</span>
<a name="ln-2159"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">prefix</span>     <span class="c">!&lt; Searched prefix.</span>
<a name="ln-2160"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">start</span>      <span class="c">!&lt; Start position into the string.</span>
<a name="ln-2161"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="k">end</span>        <span class="c">!&lt; End position into the string.</span>
<a name="ln-2162"></a>  <span class="kt">logical</span>                                         <span class="kd">::</span> <span class="n">start_with</span> <span class="c">!&lt; Result of the test.</span>
<a name="ln-2163"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">start_</span>     <span class="c">!&lt; Start position into the string, local variable.</span>
<a name="ln-2164"></a>  <span class="kt">integer</span>                                         <span class="kd">::</span> <span class="n">end_</span>       <span class="c">!&lt; End position into the string, local variable.</span>
<a name="ln-2165"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2166"></a>
<a name="ln-2167"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2168"></a>  <span class="n">start_with</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2169"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2170"></a><span class="k">    </span><span class="n">start_</span> <span class="o">=</span> <span class="mi">1</span>             <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">start</span><span class="p">))</span> <span class="n">start_</span> <span class="o">=</span> <span class="n">start</span>
<a name="ln-2171"></a>    <span class="n">end_</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="k">end</span><span class="p">))</span>   <span class="n">end_</span>   <span class="o">=</span> <span class="k">end</span>
<a name="ln-2172"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span><span class="o">&lt;=</span><span class="nb">len</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">start_</span><span class="p">:</span><span class="n">end_</span><span class="p">)))</span> <span class="k">then</span>
<a name="ln-2173"></a><span class="k">      </span><span class="n">start_with</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">start_</span><span class="p">:</span><span class="n">end_</span><span class="p">),</span> <span class="n">prefix</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span>
<a name="ln-2174"></a>    <span class="n">endif</span>
<a name="ln-2175"></a>  <span class="n">endif</span>
<a name="ln-2176"></a>  <span class="k">return</span>
<a name="ln-2177"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2178"></a>  <span class="n">endfunction</span> <span class="n">start_with</span>
<a name="ln-2179"></a>
<a name="ln-2180"></a>  <span class="c">! private methods</span>
<a name="ln-2181"></a>
<a name="ln-2182"></a>  <span class="c">! assignments</span>
<a name="ln-2183"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2184"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2185"></a>  <span class="c">!&lt; Assignment operator from string input.</span>
<a name="ln-2186"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2187"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2188"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2189"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2190"></a>
<a name="ln-2191"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2192"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2193"></a>  <span class="k">return</span>
<a name="ln-2194"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2195"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_string</span>
<a name="ln-2196"></a>
<a name="ln-2197"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_character</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2198"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2199"></a>  <span class="c">!&lt; Assignment operator from character input.</span>
<a name="ln-2200"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2201"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2202"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2203"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2204"></a>
<a name="ln-2205"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2206"></a>  <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">rhs</span>
<a name="ln-2207"></a>  <span class="k">return</span>
<a name="ln-2208"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2209"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_character</span>
<a name="ln-2210"></a>
<a name="ln-2211"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_integer_I1P</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2212"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2213"></a>  <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-2214"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2215"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2216"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2217"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2218"></a>
<a name="ln-2219"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2220"></a>  <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">rhs</span><span class="p">))</span>
<a name="ln-2221"></a>  <span class="k">return</span>
<a name="ln-2222"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2223"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_integer_I1P</span>
<a name="ln-2224"></a>
<a name="ln-2225"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_integer_I2P</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2226"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2227"></a>  <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-2228"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2229"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2230"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2231"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2232"></a>
<a name="ln-2233"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2234"></a>  <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">rhs</span><span class="p">))</span>
<a name="ln-2235"></a>  <span class="k">return</span>
<a name="ln-2236"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2237"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_integer_I2P</span>
<a name="ln-2238"></a>
<a name="ln-2239"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_integer_I4P</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2240"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2241"></a>  <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-2242"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2243"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2244"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2245"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2246"></a>
<a name="ln-2247"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2248"></a>  <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">rhs</span><span class="p">))</span>
<a name="ln-2249"></a>  <span class="k">return</span>
<a name="ln-2250"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2251"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_integer_I4P</span>
<a name="ln-2252"></a>
<a name="ln-2253"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_integer_I8P</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2254"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2255"></a>  <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-2256"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2257"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2258"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2259"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2260"></a>
<a name="ln-2261"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2262"></a>  <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">rhs</span><span class="p">))</span>
<a name="ln-2263"></a>  <span class="k">return</span>
<a name="ln-2264"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2265"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_integer_I8P</span>
<a name="ln-2266"></a>
<a name="ln-2267"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_real_R4P</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2268"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2269"></a>  <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-2270"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2271"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2272"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2273"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2274"></a>
<a name="ln-2275"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2276"></a>  <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">rhs</span><span class="p">))</span>
<a name="ln-2277"></a>  <span class="k">return</span>
<a name="ln-2278"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2279"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_real_R4P</span>
<a name="ln-2280"></a>
<a name="ln-2281"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_real_R8P</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2282"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2283"></a>  <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-2284"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2285"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2286"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2287"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2288"></a>
<a name="ln-2289"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2290"></a>  <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">rhs</span><span class="p">))</span>
<a name="ln-2291"></a>  <span class="k">return</span>
<a name="ln-2292"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2293"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_real_R8P</span>
<a name="ln-2294"></a>
<a name="ln-2295"></a>  <span class="k">elemental subroutine </span><span class="n">string_assign_real_R16P</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a name="ln-2296"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2297"></a>  <span class="c">!&lt; Assignment operator from real input.</span>
<a name="ln-2298"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2299"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span> <span class="c">!&lt; Left hand side.</span>
<a name="ln-2300"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rhs</span> <span class="c">!&lt; Right hand side.</span>
<a name="ln-2301"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2302"></a>
<a name="ln-2303"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2304"></a>  <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">rhs</span><span class="p">))</span>
<a name="ln-2305"></a>  <span class="k">return</span>
<a name="ln-2306"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2307"></a>  <span class="n">endsubroutine</span> <span class="n">string_assign_real_R16P</span>
<a name="ln-2308"></a>
<a name="ln-2309"></a>  <span class="c">! contatenation operators</span>
<a name="ln-2310"></a>  <span class="k">pure function </span><span class="n">string_concat_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">concat</span><span class="p">)</span>
<a name="ln-2311"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2312"></a>  <span class="c">!&lt; Concatenation with string.</span>
<a name="ln-2313"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2314"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">lhs</span>    <span class="c">!&lt; Left hand side.</span>
<a name="ln-2315"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">rhs</span>    <span class="c">!&lt; Right hand side.</span>
<a name="ln-2316"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">concat</span> <span class="c">!&lt; Concatenated string.</span>
<a name="ln-2317"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2318"></a>
<a name="ln-2319"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2320"></a>  <span class="n">concat</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-2321"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">lhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">concat</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2322"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">concat</span> <span class="o">=</span> <span class="n">concat</span><span class="o">//</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2323"></a>  <span class="k">return</span>
<a name="ln-2324"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2325"></a>  <span class="n">endfunction</span> <span class="n">string_concat_string</span>
<a name="ln-2326"></a>
<a name="ln-2327"></a>  <span class="k">pure function </span><span class="n">string_concat_character</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">concat</span><span class="p">)</span>
<a name="ln-2328"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2329"></a>  <span class="c">!&lt; Concatenation with character.</span>
<a name="ln-2330"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2331"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">lhs</span>    <span class="c">!&lt; Left hand side.</span>
<a name="ln-2332"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">rhs</span>    <span class="c">!&lt; Right hand side.</span>
<a name="ln-2333"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">concat</span> <span class="c">!&lt; Concatenated string.</span>
<a name="ln-2334"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2335"></a>
<a name="ln-2336"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2337"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">lhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2338"></a><span class="k">    </span><span class="n">concat</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">rhs</span>
<a name="ln-2339"></a>  <span class="k">else</span>
<a name="ln-2340"></a><span class="k">    </span><span class="n">concat</span> <span class="o">=</span> <span class="n">rhs</span>
<a name="ln-2341"></a>  <span class="n">endif</span>
<a name="ln-2342"></a>  <span class="k">return</span>
<a name="ln-2343"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2344"></a>  <span class="n">endfunction</span> <span class="n">string_concat_character</span>
<a name="ln-2345"></a>
<a name="ln-2346"></a>  <span class="k">pure function </span><span class="n">character_concat_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">concat</span><span class="p">)</span>
<a name="ln-2347"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2348"></a>  <span class="c">!&lt; Concatenation with character (inverted).</span>
<a name="ln-2349"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2350"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">lhs</span>    <span class="c">!&lt; Left hand side.</span>
<a name="ln-2351"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">rhs</span>    <span class="c">!&lt; Right hand side.</span>
<a name="ln-2352"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">concat</span> <span class="c">!&lt; Concatenated string.</span>
<a name="ln-2353"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2354"></a>
<a name="ln-2355"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2356"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2357"></a><span class="k">    </span><span class="n">concat</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">//</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2358"></a>  <span class="k">else</span>
<a name="ln-2359"></a><span class="k">    </span><span class="n">concat</span> <span class="o">=</span> <span class="n">lhs</span>
<a name="ln-2360"></a>  <span class="n">endif</span>
<a name="ln-2361"></a>  <span class="k">return</span>
<a name="ln-2362"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2363"></a>  <span class="n">endfunction</span> <span class="n">character_concat_string</span>
<a name="ln-2364"></a>
<a name="ln-2365"></a>  <span class="k">elemental function </span><span class="n">string_concat_string_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">concat</span><span class="p">)</span>
<a name="ln-2366"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2367"></a>  <span class="c">!&lt; Concatenation with string.</span>
<a name="ln-2368"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2369"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">lhs</span>       <span class="c">!&lt; Left hand side.</span>
<a name="ln-2370"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">rhs</span>       <span class="c">!&lt; Right hand side.</span>
<a name="ln-2371"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                           <span class="kd">::</span> <span class="n">concat</span>    <span class="c">!&lt; Concatenated string.</span>
<a name="ln-2372"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">temporary</span> <span class="c">!&lt; Temporary concatenated string.</span>
<a name="ln-2373"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2374"></a>
<a name="ln-2375"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2376"></a>  <span class="n">temporary</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-2377"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">lhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">temporary</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2378"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="n">temporary</span> <span class="o">=</span> <span class="n">temporary</span><span class="o">//</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2379"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">temporary</span><span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="n">concat</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span>
<a name="ln-2380"></a>  <span class="k">return</span>
<a name="ln-2381"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2382"></a>  <span class="n">endfunction</span> <span class="n">string_concat_string_string</span>
<a name="ln-2383"></a>
<a name="ln-2384"></a>  <span class="k">elemental function </span><span class="n">string_concat_character_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">concat</span><span class="p">)</span>
<a name="ln-2385"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2386"></a>  <span class="c">!&lt; Concatenation with character.</span>
<a name="ln-2387"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2388"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">lhs</span>    <span class="c">!&lt; Left hand side.</span>
<a name="ln-2389"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">rhs</span>    <span class="c">!&lt; Right hand side.</span>
<a name="ln-2390"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                           <span class="kd">::</span> <span class="n">concat</span> <span class="c">!&lt; Concatenated string.</span>
<a name="ln-2391"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2392"></a>
<a name="ln-2393"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2394"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">lhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2395"></a><span class="k">    </span><span class="n">concat</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span><span class="o">//</span><span class="n">rhs</span>
<a name="ln-2396"></a>  <span class="k">else</span>
<a name="ln-2397"></a><span class="k">    </span><span class="n">concat</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">rhs</span>
<a name="ln-2398"></a>  <span class="n">endif</span>
<a name="ln-2399"></a>  <span class="k">return</span>
<a name="ln-2400"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2401"></a>  <span class="n">endfunction</span> <span class="n">string_concat_character_string</span>
<a name="ln-2402"></a>
<a name="ln-2403"></a>  <span class="k">elemental function </span><span class="n">character_concat_string_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">concat</span><span class="p">)</span>
<a name="ln-2404"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2405"></a>  <span class="c">!&lt; Concatenation with character (inverted).</span>
<a name="ln-2406"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2407"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">lhs</span>    <span class="c">!&lt; Left hand side.</span>
<a name="ln-2408"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">rhs</span>    <span class="c">!&lt; Right hand side.</span>
<a name="ln-2409"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                           <span class="kd">::</span> <span class="n">concat</span> <span class="c">!&lt; Concatenated string.</span>
<a name="ln-2410"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2411"></a>
<a name="ln-2412"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2413"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2414"></a><span class="k">    </span><span class="n">concat</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">//</span><span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2415"></a>  <span class="k">else</span>
<a name="ln-2416"></a><span class="k">    </span><span class="n">concat</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">lhs</span>
<a name="ln-2417"></a>  <span class="n">endif</span>
<a name="ln-2418"></a>  <span class="k">return</span>
<a name="ln-2419"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2420"></a>  <span class="n">endfunction</span> <span class="n">character_concat_string_string</span>
<a name="ln-2421"></a>
<a name="ln-2422"></a>  <span class="c">! logical operators</span>
<a name="ln-2423"></a>  <span class="k">elemental function </span><span class="n">string_eq_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2424"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2425"></a>  <span class="c">!&lt; Equal to string logical operator.</span>
<a name="ln-2426"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2427"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2428"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2429"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2430"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2431"></a>
<a name="ln-2432"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2433"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">==</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2434"></a>  <span class="k">return</span>
<a name="ln-2435"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2436"></a>  <span class="n">endfunction</span> <span class="n">string_eq_string</span>
<a name="ln-2437"></a>
<a name="ln-2438"></a>  <span class="k">elemental function </span><span class="n">string_eq_character</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2439"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2440"></a>  <span class="c">!&lt; Equal to character logical operator.</span>
<a name="ln-2441"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2442"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2443"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2444"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2445"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2446"></a>
<a name="ln-2447"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2448"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">==</span> <span class="n">rhs</span>
<a name="ln-2449"></a>  <span class="k">return</span>
<a name="ln-2450"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2451"></a>  <span class="n">endfunction</span> <span class="n">string_eq_character</span>
<a name="ln-2452"></a>
<a name="ln-2453"></a>  <span class="k">elemental function </span><span class="n">character_eq_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2454"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2455"></a>  <span class="c">!&lt; Equal to character (inverted) logical operator.</span>
<a name="ln-2456"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2457"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2458"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2459"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2460"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2461"></a>
<a name="ln-2462"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2463"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">==</span> <span class="n">lhs</span>
<a name="ln-2464"></a>  <span class="k">return</span>
<a name="ln-2465"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2466"></a>  <span class="n">endfunction</span> <span class="n">character_eq_string</span>
<a name="ln-2467"></a>
<a name="ln-2468"></a>  <span class="k">elemental function </span><span class="n">string_ne_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2469"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2470"></a>  <span class="c">!&lt; Not equal to string logical operator.</span>
<a name="ln-2471"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2472"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2473"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2474"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2475"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2476"></a>
<a name="ln-2477"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2478"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">/=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2479"></a>  <span class="k">return</span>
<a name="ln-2480"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2481"></a>  <span class="n">endfunction</span> <span class="n">string_ne_string</span>
<a name="ln-2482"></a>
<a name="ln-2483"></a>  <span class="k">elemental function </span><span class="n">string_ne_character</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2484"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2485"></a>  <span class="c">!&lt; Not equal to character logical operator.</span>
<a name="ln-2486"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2487"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2488"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2489"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2490"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2491"></a>
<a name="ln-2492"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2493"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">/=</span> <span class="n">rhs</span>
<a name="ln-2494"></a>  <span class="k">return</span>
<a name="ln-2495"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2496"></a>  <span class="n">endfunction</span> <span class="n">string_ne_character</span>
<a name="ln-2497"></a>
<a name="ln-2498"></a>  <span class="k">elemental function </span><span class="n">character_ne_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2499"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2500"></a>  <span class="c">!&lt; Not equal to character (inverted) logical operator.</span>
<a name="ln-2501"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2502"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2503"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2504"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2505"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2506"></a>
<a name="ln-2507"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2508"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">/=</span> <span class="n">lhs</span>
<a name="ln-2509"></a>  <span class="k">return</span>
<a name="ln-2510"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2511"></a>  <span class="n">endfunction</span> <span class="n">character_ne_string</span>
<a name="ln-2512"></a>
<a name="ln-2513"></a>  <span class="k">elemental function </span><span class="n">string_lt_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2514"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2515"></a>  <span class="c">!&lt; Lower than to string logical operator.</span>
<a name="ln-2516"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2517"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2518"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2519"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2520"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2521"></a>
<a name="ln-2522"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2523"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">&lt;</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2524"></a>  <span class="k">return</span>
<a name="ln-2525"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2526"></a>  <span class="n">endfunction</span> <span class="n">string_lt_string</span>
<a name="ln-2527"></a>
<a name="ln-2528"></a>  <span class="k">elemental function </span><span class="n">string_lt_character</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2529"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2530"></a>  <span class="c">!&lt; Lower than to character logical operator.</span>
<a name="ln-2531"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2532"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2533"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2534"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2535"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2536"></a>
<a name="ln-2537"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2538"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">&lt;</span> <span class="n">rhs</span>
<a name="ln-2539"></a>  <span class="k">return</span>
<a name="ln-2540"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2541"></a>  <span class="n">endfunction</span> <span class="n">string_lt_character</span>
<a name="ln-2542"></a>
<a name="ln-2543"></a>  <span class="k">elemental function </span><span class="n">character_lt_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2544"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2545"></a>  <span class="c">!&lt; Lower than to character (inverted) logical operator.</span>
<a name="ln-2546"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2547"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2548"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2549"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2550"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2551"></a>
<a name="ln-2552"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2553"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span> <span class="o">&lt;</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2554"></a>  <span class="k">return</span>
<a name="ln-2555"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2556"></a>  <span class="n">endfunction</span> <span class="n">character_lt_string</span>
<a name="ln-2557"></a>
<a name="ln-2558"></a>  <span class="k">elemental function </span><span class="n">string_le_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2559"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2560"></a>  <span class="c">!&lt; Lower equal than to string logical operator.</span>
<a name="ln-2561"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2562"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2563"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2564"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2565"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2566"></a>
<a name="ln-2567"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2568"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">&lt;=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2569"></a>  <span class="k">return</span>
<a name="ln-2570"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2571"></a>  <span class="n">endfunction</span> <span class="n">string_le_string</span>
<a name="ln-2572"></a>
<a name="ln-2573"></a>  <span class="k">elemental function </span><span class="n">string_le_character</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2574"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2575"></a>  <span class="c">!&lt; Lower equal than to character logical operator.</span>
<a name="ln-2576"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2577"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2578"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2579"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2580"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2581"></a>
<a name="ln-2582"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2583"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">&lt;=</span> <span class="n">rhs</span>
<a name="ln-2584"></a>  <span class="k">return</span>
<a name="ln-2585"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2586"></a>  <span class="n">endfunction</span> <span class="n">string_le_character</span>
<a name="ln-2587"></a>
<a name="ln-2588"></a>  <span class="k">elemental function </span><span class="n">character_le_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2589"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2590"></a>  <span class="c">!&lt; Lower equal than to character (inverted) logical operator.</span>
<a name="ln-2591"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2592"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2593"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2594"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2595"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2596"></a>
<a name="ln-2597"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2598"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span> <span class="o">&lt;=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2599"></a>  <span class="k">return</span>
<a name="ln-2600"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2601"></a>  <span class="n">endfunction</span> <span class="n">character_le_string</span>
<a name="ln-2602"></a>
<a name="ln-2603"></a>  <span class="k">elemental function </span><span class="n">string_ge_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2604"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2605"></a>  <span class="c">!&lt; Greater equal than to string logical operator.</span>
<a name="ln-2606"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2607"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2608"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2609"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2610"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2611"></a>
<a name="ln-2612"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2613"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">&gt;=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2614"></a>  <span class="k">return</span>
<a name="ln-2615"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2616"></a>  <span class="n">endfunction</span> <span class="n">string_ge_string</span>
<a name="ln-2617"></a>
<a name="ln-2618"></a>  <span class="k">elemental function </span><span class="n">string_ge_character</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2619"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2620"></a>  <span class="c">!&lt; Greater equal than to character logical operator.</span>
<a name="ln-2621"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2622"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2623"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2624"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2625"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2626"></a>
<a name="ln-2627"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2628"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">&gt;=</span> <span class="n">rhs</span>
<a name="ln-2629"></a>  <span class="k">return</span>
<a name="ln-2630"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2631"></a>  <span class="n">endfunction</span> <span class="n">string_ge_character</span>
<a name="ln-2632"></a>
<a name="ln-2633"></a>  <span class="k">elemental function </span><span class="n">character_ge_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2634"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2635"></a>  <span class="c">!&lt; Greater equal than to character (inverted) logical operator.</span>
<a name="ln-2636"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2637"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2638"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2639"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2640"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2641"></a>
<a name="ln-2642"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2643"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span> <span class="o">&gt;=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2644"></a>  <span class="k">return</span>
<a name="ln-2645"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2646"></a>  <span class="n">endfunction</span> <span class="n">character_ge_string</span>
<a name="ln-2647"></a>
<a name="ln-2648"></a>  <span class="k">elemental function </span><span class="n">string_gt_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2649"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2650"></a>  <span class="c">!&lt; Greater than to string logical operator.</span>
<a name="ln-2651"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2652"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2653"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2654"></a>  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2655"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2656"></a>
<a name="ln-2657"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2658"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">&gt;</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2659"></a>  <span class="k">return</span>
<a name="ln-2660"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2661"></a>  <span class="n">endfunction</span> <span class="n">string_gt_string</span>
<a name="ln-2662"></a>
<a name="ln-2663"></a>  <span class="k">elemental function </span><span class="n">string_gt_character</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2664"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2665"></a>  <span class="c">!&lt; Greater than to character logical operator.</span>
<a name="ln-2666"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2667"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2668"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2669"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2670"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2671"></a>
<a name="ln-2672"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2673"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">%</span><span class="n">raw</span> <span class="o">&gt;</span> <span class="n">rhs</span>
<a name="ln-2674"></a>  <span class="k">return</span>
<a name="ln-2675"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2676"></a>  <span class="n">endfunction</span> <span class="n">string_gt_character</span>
<a name="ln-2677"></a>
<a name="ln-2678"></a>  <span class="k">elemental function </span><span class="n">character_gt_string</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">is_it</span><span class="p">)</span>
<a name="ln-2679"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2680"></a>  <span class="c">!&lt; Greater than to character (inverted) logical operator.</span>
<a name="ln-2681"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2682"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>   <span class="c">!&lt; Left hand side.</span>
<a name="ln-2683"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>   <span class="c">!&lt; Right hand side.</span>
<a name="ln-2684"></a>  <span class="kt">logical</span>                               <span class="kd">::</span> <span class="n">is_it</span> <span class="c">!&lt; Opreator test result.</span>
<a name="ln-2685"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2686"></a>
<a name="ln-2687"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2688"></a>  <span class="n">is_it</span> <span class="o">=</span> <span class="n">lhs</span> <span class="o">&gt;</span> <span class="n">rhs</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2689"></a>  <span class="k">return</span>
<a name="ln-2690"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2691"></a>  <span class="n">endfunction</span> <span class="n">character_gt_string</span>
<a name="ln-2692"></a>
<a name="ln-2693"></a>  <span class="c">! IO</span>
<a name="ln-2694"></a>  <span class="k">subroutine </span><span class="n">read_formatted</span><span class="p">(</span><span class="n">dtv</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">iotype</span><span class="p">,</span> <span class="n">v_list</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2695"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2696"></a>  <span class="c">!&lt; Formatted input.</span>
<a name="ln-2697"></a>  <span class="c">!&lt;</span>
<a name="ln-2698"></a>  <span class="c">!&lt; @bug Change temporary acks: find a more precise length of the input string and avoid the trimming!</span>
<a name="ln-2699"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2700"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dtv</span>         <span class="c">!&lt; The string.</span>
<a name="ln-2701"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>        <span class="c">!&lt; Logical unit.</span>
<a name="ln-2702"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>          <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">iotype</span>      <span class="c">!&lt; Edit descriptor.</span>
<a name="ln-2703"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">v_list</span><span class="p">(:)</span>   <span class="c">!&lt; Edit descriptor list.</span>
<a name="ln-2704"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>      <span class="c">!&lt; IO status code.</span>
<a name="ln-2705"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>          <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>       <span class="c">!&lt; IO status message.</span>
<a name="ln-2706"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span>                <span class="kd">::</span> <span class="n">local_iomsg</span> <span class="c">!&lt; Local variant of iomsg, so it doesn&#39;t get inappropriately redefined.</span>
<a name="ln-2707"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">delim</span>       <span class="c">!&lt; String delimiter, if any.</span>
<a name="ln-2708"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">temporary</span>   <span class="c">!&lt; Temporary storage string.</span>
<a name="ln-2709"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2710"></a>
<a name="ln-2711"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2712"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">iotype</span> <span class="o">==</span> <span class="s1">&#39;LISTDIRECTED&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2713"></a><span class="k">    call </span><span class="n">get_next_non_blank_character_any_record</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">ch</span><span class="o">=</span><span class="n">delim</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2714"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">iostat</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2715"></a><span class="k">    if</span> <span class="p">(</span><span class="n">delim</span><span class="o">==</span><span class="s1">&#39;&quot;&#39;</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">delim</span><span class="o">==</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2716"></a><span class="k">      call </span><span class="n">dtv</span><span class="p">%</span><span class="n">read_delimited</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">delim</span><span class="o">=</span><span class="n">delim</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">local_iomsg</span><span class="p">)</span>
<a name="ln-2717"></a>    <span class="k">else</span>
<a name="ln-2718"></a>      <span class="c">! step back before the non-blank</span>
<a name="ln-2719"></a>      <span class="k">read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(TL1)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2720"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2721"></a><span class="k">      call </span><span class="n">dtv</span><span class="p">%</span><span class="n">read_undelimited_listdirected</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">local_iomsg</span><span class="p">)</span>
<a name="ln-2722"></a>    <span class="n">endif</span>
<a name="ln-2723"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">is_iostat_eor</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2724"></a>      <span class="c">! suppress IOSTAT_EOR</span>
<a name="ln-2725"></a>      <span class="n">iostat</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2726"></a>    <span class="n">elseif</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2727"></a><span class="k">      </span><span class="n">iomsg</span> <span class="o">=</span> <span class="n">local_iomsg</span>
<a name="ln-2728"></a>    <span class="n">endif</span>
<a name="ln-2729"></a>    <span class="k">return</span>
<a name="ln-2730"></a><span class="k">  else</span>
<a name="ln-2731"></a><span class="k">    read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span><span class="n">temporary</span>
<a name="ln-2732"></a>    <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">temporary</span><span class="p">)</span>
<a name="ln-2733"></a>  <span class="n">endif</span>
<a name="ln-2734"></a>  <span class="k">return</span>
<a name="ln-2735"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2736"></a>  <span class="n">endsubroutine</span> <span class="n">read_formatted</span>
<a name="ln-2737"></a>
<a name="ln-2738"></a>  <span class="k">subroutine </span><span class="n">read_delimited</span><span class="p">(</span><span class="n">dtv</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">delim</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2739"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2740"></a>  <span class="c">!&lt; Read a delimited string from a unit connected for formatted input.</span>
<a name="ln-2741"></a>  <span class="c">!&lt;</span>
<a name="ln-2742"></a>  <span class="c">!&lt; If the closing delimiter is followed by end of record, then we return end of record.</span>
<a name="ln-2743"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2744"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">dtv</span>       <span class="c">!&lt; The string.</span>
<a name="ln-2745"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>      <span class="c">!&lt; Logical unit.</span>
<a name="ln-2746"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">delim</span>     <span class="c">!&lt; String delimiter.</span>
<a name="ln-2747"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>    <span class="c">!&lt; IO status code.</span>
<a name="ln-2748"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>     <span class="c">!&lt; IO status message.</span>
<a name="ln-2749"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">ch</span>        <span class="c">!&lt; A character read.</span>
<a name="ln-2750"></a>  <span class="kt">logical</span>                                  <span class="kd">::</span> <span class="n">was_delim</span> <span class="c">!&lt; Indicates that the last character read was a delimiter.</span>
<a name="ln-2751"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2752"></a>
<a name="ln-2753"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2754"></a>  <span class="n">was_delim</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2755"></a>  <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-2756"></a>  <span class="k">do</span>
<a name="ln-2757"></a><span class="k">    read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span> <span class="n">ch</span>
<a name="ln-2758"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">is_iostat_eor</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2759"></a><span class="k">      if</span> <span class="p">(</span><span class="n">was_delim</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2760"></a>        <span class="c">! end of delimited string followed by end of record is end of the string. Pass back the end of record condition to the</span>
<a name="ln-2761"></a>        <span class="c">! caller</span>
<a name="ln-2762"></a>        <span class="k">return</span>
<a name="ln-2763"></a><span class="k">      else</span>
<a name="ln-2764"></a>        <span class="c">! end of record without terminating delimiter - move along</span>
<a name="ln-2765"></a>        <span class="k">cycle</span>
<a name="ln-2766"></a><span class="k">      </span><span class="n">endif</span>
<a name="ln-2767"></a>    <span class="n">elseif</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2768"></a><span class="k">      return</span>
<a name="ln-2769"></a><span class="k">    </span><span class="n">endif</span>
<a name="ln-2770"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="n">delim</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2771"></a><span class="k">      if</span> <span class="p">(</span><span class="n">was_delim</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2772"></a>        <span class="c">! doubled delimiter is one delimiter in the value</span>
<a name="ln-2773"></a>        <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">//</span> <span class="n">ch</span>
<a name="ln-2774"></a>        <span class="n">was_delim</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2775"></a>      <span class="k">else</span>
<a name="ln-2776"></a>        <span class="c">! need to test next character to see what is happening</span>
<a name="ln-2777"></a>        <span class="n">was_delim</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2778"></a>      <span class="n">endif</span>
<a name="ln-2779"></a>    <span class="n">elseif</span> <span class="p">(</span><span class="n">was_delim</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2780"></a>      <span class="c">! the previous character was actually the delimiter for the end of the string. Put back this character</span>
<a name="ln-2781"></a>      <span class="k">read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(TL1)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2782"></a>      <span class="k">return</span>
<a name="ln-2783"></a><span class="k">    else</span>
<a name="ln-2784"></a><span class="k">      </span><span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">//</span> <span class="n">ch</span>
<a name="ln-2785"></a>    <span class="n">endif</span>
<a name="ln-2786"></a>  <span class="n">enddo</span>
<a name="ln-2787"></a>  <span class="k">return</span>
<a name="ln-2788"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2789"></a>  <span class="n">endsubroutine</span> <span class="n">read_delimited</span>
<a name="ln-2790"></a>
<a name="ln-2791"></a>  <span class="k">subroutine </span><span class="n">read_undelimited_listdirected</span><span class="p">(</span><span class="n">dtv</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2792"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2793"></a>  <span class="c">!&lt; Read an undelimited (no leading apostrophe or double quote) character value according to the rules for list directed input.</span>
<a name="ln-2794"></a>  <span class="c">!&lt;</span>
<a name="ln-2795"></a>  <span class="c">!&lt; A blank, comma/semicolon (depending on the decimal mode), slash or end of record terminates the string.</span>
<a name="ln-2796"></a>  <span class="c">!&lt;</span>
<a name="ln-2797"></a>  <span class="c">!&lt; If input is terminated by end of record, then this procedure returns an end-of-record condition.</span>
<a name="ln-2798"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2799"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dtv</span>           <span class="c">!&lt; The string.</span>
<a name="ln-2800"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>          <span class="c">!&lt; Logical unit.</span>
<a name="ln-2801"></a>  <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>        <span class="c">!&lt; IO status code.</span>
<a name="ln-2802"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>         <span class="c">!&lt; IO status message.</span>
<a name="ln-2803"></a>  <span class="kt">logical</span>                         <span class="kd">::</span> <span class="n">decimal_point</span> <span class="c">!&lt;True if DECIMAL=POINT in effect.</span>
<a name="ln-2804"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2805"></a>
<a name="ln-2806"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2807"></a>  <span class="k">call </span><span class="n">get_decimal_mode</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">decimal_point</span><span class="o">=</span><span class="n">decimal_point</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2808"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2809"></a><span class="k">  call </span><span class="n">dtv</span><span class="p">%</span><span class="n">read_undelimited</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">terminators</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="nb">merge</span><span class="p">(</span><span class="n">CK_</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">CK_</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">decimal_point</span><span class="p">),</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2810"></a>  <span class="k">return</span>
<a name="ln-2811"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2812"></a>  <span class="n">endsubroutine</span> <span class="n">read_undelimited_listdirected</span>
<a name="ln-2813"></a>
<a name="ln-2814"></a>  <span class="k">subroutine </span><span class="n">read_undelimited</span><span class="p">(</span><span class="n">dtv</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">terminators</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2815"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2816"></a>  <span class="c">!&lt; Read an undelimited string up until end of record or a character from a set of terminators is encountered.</span>
<a name="ln-2817"></a>  <span class="c">!&lt;</span>
<a name="ln-2818"></a>  <span class="c">!&lt; If a terminator is encountered, the file position will be at that terminating character. If end of record is encountered, the</span>
<a name="ln-2819"></a>  <span class="c">!&lt; file remains at end of record.</span>
<a name="ln-2820"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2821"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dtv</span>         <span class="c">!&lt; The string.</span>
<a name="ln-2822"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>        <span class="c">!&lt; Logical unit.</span>
<a name="ln-2823"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">terminators</span> <span class="c">!&lt; Characters that are considered to terminate the string.</span>
<a name="ln-2824"></a>                                                          <span class="c">!&lt; Blanks in this string are meaningful.</span>
<a name="ln-2825"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>      <span class="c">!&lt; IO status code.</span>
<a name="ln-2826"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>          <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>       <span class="c">!&lt; IO status message.</span>
<a name="ln-2827"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">ch</span>          <span class="c">!&lt; A character read.</span>
<a name="ln-2828"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2829"></a>
<a name="ln-2830"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2831"></a>  <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-2832"></a>  <span class="k">do</span>
<a name="ln-2833"></a><span class="k">    read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span> <span class="n">ch</span>
<a name="ln-2834"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">is_iostat_eor</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2835"></a>      <span class="c">! end of record just means end of string. We pass on the condition</span>
<a name="ln-2836"></a>      <span class="k">return</span>
<a name="ln-2837"></a><span class="k">    </span><span class="n">elseif</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2838"></a>      <span class="c">! something odd happened</span>
<a name="ln-2839"></a>      <span class="k">return</span>
<a name="ln-2840"></a><span class="k">    </span><span class="n">endif</span>
<a name="ln-2841"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">scan</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="n">terminators</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2842"></a>      <span class="c">! change the file position so that the next read sees the terminator</span>
<a name="ln-2843"></a>      <span class="k">read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(TL1)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2844"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2845"></a><span class="k">      </span><span class="n">iostat</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2846"></a>      <span class="k">return</span>
<a name="ln-2847"></a><span class="k">    </span><span class="n">endif</span>
<a name="ln-2848"></a>    <span class="c">! we got a character - append it</span>
<a name="ln-2849"></a>    <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">//</span> <span class="n">ch</span>
<a name="ln-2850"></a>  <span class="n">enddo</span>
<a name="ln-2851"></a>  <span class="k">return</span>
<a name="ln-2852"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2853"></a>  <span class="n">endsubroutine</span> <span class="n">read_undelimited</span>
<a name="ln-2854"></a>
<a name="ln-2855"></a>  <span class="k">subroutine </span><span class="n">write_formatted</span><span class="p">(</span><span class="n">dtv</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">iotype</span><span class="p">,</span> <span class="n">v_list</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2856"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2857"></a>  <span class="c">!&lt; Formatted output.</span>
<a name="ln-2858"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2859"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">dtv</span>       <span class="c">!&lt; The string.</span>
<a name="ln-2860"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>      <span class="c">!&lt; Logical unit.</span>
<a name="ln-2861"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">iotype</span>    <span class="c">!&lt; Edit descriptor.</span>
<a name="ln-2862"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">v_list</span><span class="p">(:)</span> <span class="c">!&lt; Edit descriptor list.</span>
<a name="ln-2863"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>    <span class="c">!&lt; IO status code.</span>
<a name="ln-2864"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>     <span class="c">!&lt; IO status message.</span>
<a name="ln-2865"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2866"></a>
<a name="ln-2867"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2868"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">dtv</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2869"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span><span class="n">dtv</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2870"></a>  <span class="k">else</span>
<a name="ln-2871"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span><span class="s1">&#39;&#39;</span>
<a name="ln-2872"></a>  <span class="n">endif</span>
<a name="ln-2873"></a>  <span class="k">return</span>
<a name="ln-2874"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2875"></a>  <span class="n">endsubroutine</span> <span class="n">write_formatted</span>
<a name="ln-2876"></a>
<a name="ln-2877"></a>  <span class="k">subroutine </span><span class="n">read_unformatted</span><span class="p">(</span><span class="n">dtv</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2878"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2879"></a>  <span class="c">!&lt; Unformatted input.</span>
<a name="ln-2880"></a>  <span class="c">!&lt;</span>
<a name="ln-2881"></a>  <span class="c">!&lt; @bug Change temporary acks: find a more precise length of the input string and avoid the trimming!</span>
<a name="ln-2882"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2883"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dtv</span>       <span class="c">!&lt; The string.</span>
<a name="ln-2884"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>      <span class="c">!&lt; Logical unit.</span>
<a name="ln-2885"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>    <span class="c">!&lt; IO status code.</span>
<a name="ln-2886"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>     <span class="c">!&lt; IO status message.</span>
<a name="ln-2887"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">temporary</span> <span class="c">!&lt; Temporary storage string.</span>
<a name="ln-2888"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2889"></a>
<a name="ln-2890"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2891"></a>  <span class="k">read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span><span class="n">temporary</span>
<a name="ln-2892"></a>  <span class="n">dtv</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">temporary</span><span class="p">)</span>
<a name="ln-2893"></a>  <span class="k">return</span>
<a name="ln-2894"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2895"></a>  <span class="n">endsubroutine</span> <span class="n">read_unformatted</span>
<a name="ln-2896"></a>
<a name="ln-2897"></a>  <span class="k">subroutine </span><span class="n">write_unformatted</span><span class="p">(</span><span class="n">dtv</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2898"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2899"></a>  <span class="c">!&lt; Unformatted output.</span>
<a name="ln-2900"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2901"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">dtv</span>    <span class="c">!&lt; The string.</span>
<a name="ln-2902"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>   <span class="c">!&lt; Logical unit.</span>
<a name="ln-2903"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span> <span class="c">!&lt; IO status code.</span>
<a name="ln-2904"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>  <span class="c">!&lt; IO status message.</span>
<a name="ln-2905"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2906"></a>
<a name="ln-2907"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2908"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">dtv</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2909"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span><span class="n">dtv</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2910"></a>  <span class="k">else</span>
<a name="ln-2911"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span><span class="s1">&#39;&#39;</span>
<a name="ln-2912"></a>  <span class="n">endif</span>
<a name="ln-2913"></a>  <span class="k">return</span>
<a name="ln-2914"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2915"></a>  <span class="n">endsubroutine</span> <span class="n">write_unformatted</span>
<a name="ln-2916"></a>
<a name="ln-2917"></a>  <span class="c">! miscellanea</span>
<a name="ln-2918"></a>  <span class="k">elemental function </span><span class="n">replace_one_occurrence</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">replaced</span><span class="p">)</span>
<a name="ln-2919"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2920"></a>  <span class="c">!&lt; Return a string with the first occurrence of substring old replaced by new.</span>
<a name="ln-2921"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2922"></a>  <span class="k">class</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>             <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">self</span>      <span class="c">!&lt; The string.</span>
<a name="ln-2923"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">old</span>       <span class="c">!&lt; Old substring.</span>
<a name="ln-2924"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">new</span>       <span class="c">!&lt; New substring.</span>
<a name="ln-2925"></a>  <span class="k">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>                           <span class="kd">::</span> <span class="n">replaced</span>  <span class="c">!&lt; The string with old replaced by new.</span>
<a name="ln-2926"></a>  <span class="kt">integer</span>                                <span class="kd">::</span> <span class="n">pos</span>       <span class="c">!&lt; Position from which replace old.</span>
<a name="ln-2927"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-2928"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">temporary</span> <span class="c">!&lt; Temporary storage, workaround for GNU bug.</span>
<a name="ln-2929"></a><span class="cp">#endif</span>
<a name="ln-2930"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2931"></a>
<a name="ln-2932"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2933"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2934"></a><span class="k">    </span><span class="n">replaced</span> <span class="o">=</span> <span class="n">self</span>
<a name="ln-2935"></a>    <span class="n">pos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">,</span> <span class="n">substring</span><span class="o">=</span><span class="n">old</span><span class="p">)</span>
<a name="ln-2936"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2937"></a><span class="cp">#ifdef __GFORTRAN__</span>
<a name="ln-2938"></a>      <span class="n">temporary</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span>
<a name="ln-2939"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2940"></a><span class="k">        </span><span class="n">replaced</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">new</span><span class="o">//</span><span class="n">temporary</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">old</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-2941"></a>      <span class="k">else</span>
<a name="ln-2942"></a><span class="k">        </span><span class="n">replaced</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">temporary</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">new</span><span class="o">//</span><span class="n">temporary</span><span class="p">(</span><span class="n">pos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">old</span><span class="p">):)</span>
<a name="ln-2943"></a>      <span class="n">endif</span>
<a name="ln-2944"></a><span class="cp">#else</span>
<a name="ln-2945"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2946"></a><span class="k">        </span><span class="n">replaced</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">new</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">old</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-2947"></a>      <span class="k">else</span>
<a name="ln-2948"></a><span class="k">        </span><span class="n">replaced</span><span class="p">%</span><span class="n">raw</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">new</span><span class="o">//</span><span class="n">self</span><span class="p">%</span><span class="n">raw</span><span class="p">(</span><span class="n">pos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">old</span><span class="p">):)</span>
<a name="ln-2949"></a>      <span class="n">endif</span>
<a name="ln-2950"></a><span class="cp">#endif</span>
<a name="ln-2951"></a>    <span class="n">endif</span>
<a name="ln-2952"></a>  <span class="n">endif</span>
<a name="ln-2953"></a>  <span class="k">return</span>
<a name="ln-2954"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2955"></a>  <span class="n">endfunction</span> <span class="n">replace_one_occurrence</span>
<a name="ln-2956"></a>
<a name="ln-2957"></a>  <span class="c">! non type-bound-procedures</span>
<a name="ln-2958"></a>  <span class="k">subroutine </span><span class="n">get_delimiter_mode</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">delim</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2959"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2960"></a>  <span class="c">!&lt; Get the DELIM changeable connection mode for the given unit.</span>
<a name="ln-2961"></a>  <span class="c">!&lt;</span>
<a name="ln-2962"></a>  <span class="c">!&lt; If the unit is connected to an internal file, then the default value of NONE is always returned.</span>
<a name="ln-2963"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2964"></a>  <span class="k">use</span><span class="p">,</span> <span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">iostat_inquire_internal_unit</span>
<a name="ln-2965"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2966"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>         <span class="c">!&lt; The unit for the connection.</span>
<a name="ln-2967"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">delim</span>        <span class="c">!&lt; Represents the value of the DELIM mode.</span>
<a name="ln-2968"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>       <span class="c">!&lt; IOSTAT error code, non-zero on error.</span>
<a name="ln-2969"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span>              <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>        <span class="c">!&lt; IOMSG explanatory message - only defined if iostat is non-zero.</span>
<a name="ln-2970"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>                            <span class="kd">::</span> <span class="n">delim_buffer</span> <span class="c">!&lt; Buffer for INQUIRE about DELIM, sized for APOSTROHPE.</span>
<a name="ln-2971"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span>                    <span class="kd">::</span> <span class="n">local_iomsg</span>  <span class="c">!&lt; Local variant of iomsg, so it doesn&#39;t get inappropriately redefined.</span>
<a name="ln-2972"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2973"></a>
<a name="ln-2974"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2975"></a>  <span class="c">! get the string representation of the changeable mode</span>
<a name="ln-2976"></a>  <span class="k">inquire</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">delim</span><span class="o">=</span><span class="n">delim_buffer</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">local_iomsg</span><span class="p">)</span>
<a name="ln-2977"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">==</span> <span class="n">iostat_inquire_internal_unit</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2978"></a>    <span class="c">! no way of determining the DELIM mode for an internal file</span>
<a name="ln-2979"></a>    <span class="n">iostat</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2980"></a>    <span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-2981"></a>    <span class="k">return</span>
<a name="ln-2982"></a><span class="k">  </span><span class="n">elseif</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2983"></a><span class="k">    </span><span class="n">iomsg</span> <span class="o">=</span> <span class="n">local_iomsg</span>
<a name="ln-2984"></a>    <span class="k">return</span>
<a name="ln-2985"></a><span class="k">  </span><span class="n">endif</span>
<a name="ln-2986"></a>  <span class="c">! interpret the DELIM string</span>
<a name="ln-2987"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">delim_buffer</span> <span class="o">==</span> <span class="s1">&#39;QUOTE&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2988"></a><span class="k">    </span><span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span>
<a name="ln-2989"></a>  <span class="n">elseif</span> <span class="p">(</span><span class="n">delim_buffer</span> <span class="o">==</span> <span class="s1">&#39;APOSTROPHE&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2990"></a><span class="k">    </span><span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;&#39;</span>
<a name="ln-2991"></a>  <span class="k">else</span>
<a name="ln-2992"></a><span class="k">    </span><span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span>
<a name="ln-2993"></a>  <span class="n">endif</span>
<a name="ln-2994"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2995"></a>  <span class="n">endsubroutine</span> <span class="n">get_delimiter_mode</span>
<a name="ln-2996"></a>
<a name="ln-2997"></a>  <span class="k">subroutine </span><span class="n">get_next_non_blank_character_this_record</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">ch</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-2998"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2999"></a>  <span class="c">!&lt; Get the next non-blank character in the current record.</span>
<a name="ln-3000"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3001"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>   <span class="c">!&lt; Logical unit.</span>
<a name="ln-3002"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ch</span>     <span class="c">!&lt; The non-blank character read. Not valid if IOSTAT is non-zero.</span>
<a name="ln-3003"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span> <span class="c">!&lt; IO status code.</span>
<a name="ln-3004"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>  <span class="c">!&lt; IO status message.</span>
<a name="ln-3005"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3006"></a>
<a name="ln-3007"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3008"></a>  <span class="k">do</span>
<a name="ln-3009"></a>    <span class="c">! we spcify non-advancing, just in case we want this callable outside the context of a child input statement</span>
<a name="ln-3010"></a>    <span class="c">! the PAD specifier simply saves the need for the READ statement to define ch if EOR is hit</span>
<a name="ln-3011"></a>    <span class="c">! read(unit, &quot;(A)&quot;, iostat=iostat, iomsg=iomsg, advance=&#39;NO&#39;) ch</span>
<a name="ln-3012"></a>    <span class="c">! ...but that causes ifort to blow up at runtime</span>
<a name="ln-3013"></a>    <span class="k">read</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="s1">&#39;NO&#39;</span><span class="p">)</span> <span class="n">ch</span>
<a name="ln-3014"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-3015"></a><span class="k">    if</span> <span class="p">(</span><span class="n">ch</span> <span class="o">/=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-3016"></a><span class="k">  </span><span class="n">enddo</span>
<a name="ln-3017"></a>  <span class="k">return</span>
<a name="ln-3018"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3019"></a>  <span class="n">endsubroutine</span> <span class="n">get_next_non_blank_character_this_record</span>
<a name="ln-3020"></a>
<a name="ln-3021"></a>  <span class="k">subroutine </span><span class="n">get_next_non_blank_character_any_record</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">ch</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-3022"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3023"></a>  <span class="c">!&lt; Get the next non-blank character, advancing records if necessary.</span>
<a name="ln-3024"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3025"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>        <span class="c">!&lt; Logical unit.</span>
<a name="ln-3026"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ch</span>          <span class="c">!&lt; The non-blank character read. Not valid if IOSTAT is non-zero.</span>
<a name="ln-3027"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>      <span class="c">!&lt; IO status code.</span>
<a name="ln-3028"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>       <span class="c">!&lt; IO status message.</span>
<a name="ln-3029"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span>                    <span class="kd">::</span> <span class="n">local_iomsg</span> <span class="c">!&lt; Local variant of iomsg, so it doesn&#39;t get inappropriately redefined.</span>
<a name="ln-3030"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3031"></a>
<a name="ln-3032"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3033"></a>  <span class="k">do</span>
<a name="ln-3034"></a><span class="k">    call </span><span class="n">get_next_non_blank_character_this_record</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">ch</span><span class="o">=</span><span class="n">ch</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">local_iomsg</span><span class="p">)</span>
<a name="ln-3035"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">is_iostat_eor</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-3036"></a>      <span class="c">! try again on the next record</span>
<a name="ln-3037"></a>      <span class="k">read</span> <span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;(/)&quot;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span>
<a name="ln-3038"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-3039"></a><span class="k">    </span><span class="n">elseif</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3040"></a>      <span class="c">! some sort of problem</span>
<a name="ln-3041"></a>      <span class="n">iomsg</span> <span class="o">=</span> <span class="n">local_iomsg</span>
<a name="ln-3042"></a>      <span class="k">return</span>
<a name="ln-3043"></a><span class="k">    else</span>
<a name="ln-3044"></a>      <span class="c">! got it</span>
<a name="ln-3045"></a>      <span class="k">exit</span>
<a name="ln-3046"></a><span class="k">    </span><span class="n">endif</span>
<a name="ln-3047"></a>  <span class="n">enddo</span>
<a name="ln-3048"></a>  <span class="k">return</span>
<a name="ln-3049"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3050"></a>  <span class="n">endsubroutine</span> <span class="n">get_next_non_blank_character_any_record</span>
<a name="ln-3051"></a>
<a name="ln-3052"></a>  <span class="k">subroutine </span><span class="n">get_decimal_mode</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">decimal_point</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
<a name="ln-3053"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3054"></a>  <span class="c">!&lt; Get the DECIMAL changeable connection mode for the given unit.</span>
<a name="ln-3055"></a>  <span class="c">!&lt;</span>
<a name="ln-3056"></a>  <span class="c">!&lt; If the unit is connected to an internal file, then the default value of DECIMAL is always returned. This may not be the</span>
<a name="ln-3057"></a>  <span class="c">!&lt; actual value in force at the time of the call to this procedure.</span>
<a name="ln-3058"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3059"></a>  <span class="k">use</span><span class="p">,</span> <span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">iostat_inquire_internal_unit</span>
<a name="ln-3060"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3061"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>           <span class="c">!&lt; Logical unit.</span>
<a name="ln-3062"></a>  <span class="kt">logical</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">decimal_point</span>  <span class="c">!&lt; True if the decimal mode is POINT, false otherwise.</span>
<a name="ln-3063"></a>  <span class="kt">integer</span><span class="p">,</span>                   <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>         <span class="c">!&lt; IO status code.</span>
<a name="ln-3064"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>          <span class="c">!&lt; IO status message.</span>
<a name="ln-3065"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>                             <span class="kd">::</span> <span class="n">decimal_buffer</span> <span class="c">!&lt; Buffer for INQUIRE about DECIMAL, sized for POINT or COMMA.</span>
<a name="ln-3066"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span>                    <span class="kd">::</span> <span class="n">local_iomsg</span>    <span class="c">!&lt; Local variant of iomsg, so it doesn&#39;t get inappropriately redefined.</span>
<a name="ln-3067"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3068"></a>
<a name="ln-3069"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3070"></a>  <span class="k">inquire</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="n">decimal_buffer</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">local_iomsg</span><span class="p">)</span>
<a name="ln-3071"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">==</span> <span class="n">iostat_inquire_internal_unit</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3072"></a>    <span class="c">! no way of determining the decimal mode for an internal file</span>
<a name="ln-3073"></a>    <span class="n">iostat</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3074"></a>    <span class="n">decimal_point</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3075"></a>    <span class="k">return</span>
<a name="ln-3076"></a><span class="k">  else if</span> <span class="p">(</span><span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3077"></a><span class="k">    </span><span class="n">iomsg</span> <span class="o">=</span> <span class="n">local_iomsg</span>
<a name="ln-3078"></a>    <span class="k">return</span>
<a name="ln-3079"></a><span class="k">  </span><span class="n">endif</span>
<a name="ln-3080"></a>  <span class="n">decimal_point</span> <span class="o">=</span> <span class="n">decimal_buffer</span> <span class="o">==</span> <span class="s1">&#39;POINT&#39;</span>
<a name="ln-3081"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-3082"></a>  <span class="n">endsubroutine</span> <span class="n">get_decimal_mode</span>
<a name="ln-3083"></a><span class="n">endmodule</span> <span class="n">stringifor_string_t</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>
    

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../sourcefile/assignments.f90.html">assignments.f90</a>
      
      <a class="list-group-item" href="../sourcefile/basename_dir.f90.html">basename_dir.f90</a>
      
      <a class="list-group-item" href="../sourcefile/befor64.f90.html">befor64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/befor64.f90%7E2.html">befor64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/befor64_pack_data_m.f90.html">befor64_pack_data_m.F90</a>
      
      <a class="list-group-item" href="../sourcefile/befor64_pack_data_m.f90%7E2.html">befor64_pack_data_m.F90</a>
      
      <a class="list-group-item" href="../sourcefile/camelcase.f90.html">camelcase.f90</a>
      
      <a class="list-group-item" href="../sourcefile/capitalize.f90.html">capitalize.f90</a>
      
      <a class="list-group-item" href="../sourcefile/compact_real.f90.html">compact_real.f90</a>
      
      <a class="list-group-item" href="../sourcefile/compact_real.f90%7E2.html">compact_real.f90</a>
      
      <a class="list-group-item" href="../sourcefile/compact_real.f90%7E3.html">compact_real.f90</a>
      
      <a class="list-group-item" href="../sourcefile/concatenation.f90.html">concatenation.f90</a>
      
      <a class="list-group-item" href="../sourcefile/csv_naive_parser.f90.html">csv_naive_parser.f90</a>
      
      <a class="list-group-item" href="../sourcefile/decode.f90.html">decode.f90</a>
      
      <a class="list-group-item" href="../sourcefile/encode.f90.html">encode.f90</a>
      
      <a class="list-group-item" href="../sourcefile/equal.f90.html">equal.f90</a>
      
      <a class="list-group-item" href="../sourcefile/escape.f90.html">escape.f90</a>
      
      <a class="list-group-item" href="../sourcefile/extension.f90.html">extension.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fill.f90.html">fill.f90</a>
      
      <a class="list-group-item" href="../sourcefile/free.f90.html">free.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury.f90.html">fury.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_mixed_kinds.f90.html">fury_mixed_kinds.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_qreal128.f90.html">fury_qreal128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_qreal32.f90.html">fury_qreal32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_qreal64.f90.html">fury_qreal64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_abstract128.f90.html">fury_system_abstract128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_abstract32.f90.html">fury_system_abstract32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_abstract64.f90.html">fury_system_abstract64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_si128.f90.html">fury_system_si128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_si32.f90.html">fury_system_si32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_system_si64.f90.html">fury_system_si64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_bolt32.f90.html">fury_test_bolt32.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_bolt64.f90.html">fury_test_bolt64.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add.f90.html">fury_test_qreal_add.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add_aliases_failure.f90.html">fury_test_qreal_add_aliases_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add_failure.f90.html">fury_test_qreal_add_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add_mixed.f90.html">fury_test_qreal_add_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_add_mixed_failure.f90.html">fury_test_qreal_add_mixed_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_aliases.f90.html">fury_test_qreal_aliases.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_assign.f90.html">fury_test_qreal_assign.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_conversions_complex.f90.html">fury_test_qreal_conversions_complex.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_conversions_si.f90.html">fury_test_qreal_conversions_si.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_conversions_simple.f90.html">fury_test_qreal_conversions_simple.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_div.f90.html">fury_test_qreal_div.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_div_mixed.f90.html">fury_test_qreal_div_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_eq.f90.html">fury_test_qreal_eq.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_eq_mixed.f90.html">fury_test_qreal_eq_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_mul.f90.html">fury_test_qreal_mul.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_mul_mixed.f90.html">fury_test_qreal_mul_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_not_eq.f90.html">fury_test_qreal_not_eq.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_not_eq_mixed.f90.html">fury_test_qreal_not_eq_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_pow.f90.html">fury_test_qreal_pow.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_sub.f90.html">fury_test_qreal_sub.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_sub_failure.f90.html">fury_test_qreal_sub_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_sub_mixed.f90.html">fury_test_qreal_sub_mixed.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_qreal_sub_mixed_failure.f90.html">fury_test_qreal_sub_mixed_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_system_si.f90.html">fury_test_system_si.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_add.f90.html">fury_test_uom_add.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_add_failure.f90.html">fury_test_uom_add_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_aliases.f90.html">fury_test_uom_aliases.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_assign.f90.html">fury_test_uom_assign.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_assign_failure.f90.html">fury_test_uom_assign_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_div.f90.html">fury_test_uom_div.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_mul.f90.html">fury_test_uom_mul.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_parse_failure.f90.html">fury_test_uom_parse_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_pow.f90.html">fury_test_uom_pow.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_sub.f90.html">fury_test_uom_sub.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_test_uom_sub_failure.f90.html">fury_test_uom_sub_failure.f90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom128.f90.html">fury_uom128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom32.f90.html">fury_uom32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom64.f90.html">fury_uom64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_converter.f90.html">fury_uom_converter.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_reference128.f90.html">fury_uom_reference128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_reference32.f90.html">fury_uom_reference32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_reference64.f90.html">fury_uom_reference64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_symbol128.f90.html">fury_uom_symbol128.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_symbol32.f90.html">fury_uom_symbol32.F90</a>
      
      <a class="list-group-item" href="../sourcefile/fury_uom_symbol64.f90.html">fury_uom_symbol64.F90</a>
      
      <a class="list-group-item" href="../sourcefile/greater_equal_than.f90.html">greater_equal_than.f90</a>
      
      <a class="list-group-item" href="../sourcefile/greater_than.f90.html">greater_than.f90</a>
      
      <a class="list-group-item" href="../sourcefile/insert.f90.html">insert.f90</a>
      
      <a class="list-group-item" href="../sourcefile/io_basic.f90.html">io_basic.F90</a>
      
      <a class="list-group-item" href="../sourcefile/io_listdirected.f90.html">io_listdirected.F90</a>
      
      <a class="list-group-item" href="../sourcefile/is_digit.f90.html">is_digit.f90</a>
      
      <a class="list-group-item" href="../sourcefile/is_integer.f90.html">is_integer.f90</a>
      
      <a class="list-group-item" href="../sourcefile/is_number.f90.html">is_number.f90</a>
      
      <a class="list-group-item" href="../sourcefile/is_real.f90.html">is_real.f90</a>
      
      <a class="list-group-item" href="../sourcefile/join.f90.html">join.f90</a>
      
      <a class="list-group-item" href="../sourcefile/lower_equal_than.f90.html">lower_equal_than.f90</a>
      
      <a class="list-group-item" href="../sourcefile/lower_than.f90.html">lower_than.f90</a>
      
      <a class="list-group-item" href="../sourcefile/not_equal.f90.html">not_equal.f90</a>
      
      <a class="list-group-item" href="../sourcefile/partition.f90.html">partition.f90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90%7E2.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90%7E3.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90%7E4.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf.f90%7E5.html">penf.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf_b_size.f90.html">penf_b_size.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf_global_parameters_variables.f90.html">penf_global_parameters_variables.F90</a>
      
      <a class="list-group-item" href="../sourcefile/penf_stringify.f90.html">penf_stringify.F90</a>
      
      <a class="list-group-item" href="../sourcefile/read_file.f90.html">read_file.f90</a>
      
      <a class="list-group-item" href="../sourcefile/read_line.f90.html">read_line.f90</a>
      
      <a class="list-group-item" href="../sourcefile/read_lines.f90.html">read_lines.f90</a>
      
      <a class="list-group-item" href="../sourcefile/replace.f90.html">replace.f90</a>
      
      <a class="list-group-item" href="../sourcefile/reverse.f90.html">reverse.f90</a>
      
      <a class="list-group-item" href="../sourcefile/sadjustlr.f90.html">sadjustlr.f90</a>
      
      <a class="list-group-item" href="../sourcefile/scount.f90.html">scount.f90</a>
      
      <a class="list-group-item" href="../sourcefile/search.f90.html">search.f90</a>
      
      <a class="list-group-item" href="../sourcefile/sindex.f90.html">sindex.f90</a>
      
      <a class="list-group-item" href="../sourcefile/slen.f90.html">slen.f90</a>
      
      <a class="list-group-item" href="../sourcefile/slice.f90.html">slice.f90</a>
      
      <a class="list-group-item" href="../sourcefile/snakecase.f90.html">snakecase.f90</a>
      
      <a class="list-group-item" href="../sourcefile/split.f90.html">split.f90</a>
      
      <a class="list-group-item" href="../sourcefile/srepeat.f90.html">srepeat.f90</a>
      
      <a class="list-group-item" href="../sourcefile/sscan.f90.html">sscan.f90</a>
      
      <a class="list-group-item" href="../sourcefile/start_end.f90.html">start_end.f90</a>
      
      <a class="list-group-item" href="../sourcefile/startcase.f90.html">startcase.f90</a>
      
      <a class="list-group-item" href="../sourcefile/strim.f90.html">strim.f90</a>
      
      <a class="list-group-item" href="../sourcefile/stringifor.f90.html">stringifor.F90</a>
      
      <a class="list-group-item" href="../sourcefile/stringifor_string_t.f90.html">stringifor_string_t.F90</a>
      
      <a class="list-group-item" href="../sourcefile/strip.f90.html">strip.f90</a>
      
      <a class="list-group-item" href="../sourcefile/sverify.f90.html">sverify.f90</a>
      
      <a class="list-group-item" href="../sourcefile/swapcase.f90.html">swapcase.f90</a>
      
      <a class="list-group-item" href="../sourcefile/test_all.f90.html">test_all.F90</a>
      
      <a class="list-group-item" href="../sourcefile/test_all.f90.html">test_all.f90</a>
      
      <a class="list-group-item" href="../sourcefile/test_all.f90%7E2.html">test_all.f90</a>
      
      <a class="list-group-item" href="../sourcefile/test_driver.f90.html">Test_Driver.f90</a>
      
      <a class="list-group-item" href="../sourcefile/to_number.f90.html">to_number.f90</a>
      
      <a class="list-group-item" href="../sourcefile/unescape.f90.html">unescape.f90</a>
      
      <a class="list-group-item" href="../sourcefile/unique.f90.html">unique.f90</a>
      
      <a class="list-group-item" href="../sourcefile/upper_lower.f90.html">upper_lower.f90</a>
      
      <a class="list-group-item" href="../sourcefile/write_file.f90.html">write_file.f90</a>
      
      <a class="list-group-item" href="../sourcefile/write_lines.f90.html">write_lines.f90</a>
      
    </div>
  </div>
</div>


  </section>
  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2016 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FURY was developed by Stefano Zaghi</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>